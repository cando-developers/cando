template <typename HESSIAN>
struct Angle {
  static constexpr size_t PositionSize = 9;
  static std::string description() { return "mathkernel-angle"; };
double energy(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double cos_theta;
  double cse_p11_t1_g34751;
  double cse_p11_t2_g34752;
  double cse_p11_t3_g34753;
  double dot;
  double dtheta;
  double energy;
  double energy_added;
  double n1;
  double n1_sq;
  double n2;
  double n2_sq;
  double sin_theta;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    DOUBLE x3 = position[i3x3 + 0];
    DOUBLE y3 = position[i3x3 + 1];
    DOUBLE z3 = position[i3x3 + 2];
    {
      /* !BASE */
      cse_p11_t1_g34751 = (-(x2));
      cse_p11_t2_g34752 = (-(y2));
      cse_p11_t3_g34753 = (-(z2));
      vx1 = (cse_p11_t1_g34751 + x1);
      vy1 = (cse_p11_t2_g34752 + y1);
      vz1 = (cse_p11_t3_g34753 + z1);
      vx2 = (cse_p11_t1_g34751 + x3);
      vy2 = (cse_p11_t2_g34752 + y3);
      vz2 = (cse_p11_t3_g34753 + z3);
      dot = ((vx1 * vx2) + (vy1 * vy2) + (vz1 * vz2));
      n1_sq = ((vx1 * vx1) + (vy1 * vy1) + (vz1 * vz1));
      n2_sq = ((vx2 * vx2) + (vy2 * vy2) + (vz2 * vz2));
      n1 = sqrt(n1_sq);
      n2 = sqrt(n2_sq);
      cos_theta = (dot * (1.0 / ((n1 * n2))));
      if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
      sin_theta = sqrt((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))));
      theta = acos(cos_theta);
      dtheta = (theta + (-(t0)));
      energy = (dtheta * dtheta * kt);
      energy_added += energy;
      *energy_accumulate += energy;
    }
  }
  return energy_added;
}
void energy_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(kt, t0, i3x1, i3x2, i3x3, position, energy_accumulate, force, hessian, dvec, hdvec);
}

double gradient(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double cos_theta;
  double cse_p113_t1_g34773;
  double cse_p11_t1_g34762;
  double cse_p11_t1_g34765;
  double cse_p11_t1_g34766;
  double cse_p11_t1_g34767;
  double cse_p11_t1_g34769;
  double cse_p11_t1_g34770;
  double cse_p11_t1_g34771;
  double cse_p11_t2_g34763;
  double cse_p11_t3_g34764;
  double cse_p1_t1_sqrt34754;
  double cse_p1_t2_invsqrt34755;
  double cse_p1_t3_sqrt34756;
  double cse_p1_t4_invsqrt34757;
  double cse_p1_t5_invr34758;
  double cse_p1_t6_invr234759;
  double cse_p1_t7_sqrt34760;
  double cse_p1_t8_invsqrt34761;
  double cse_p62_t1_g34772;
  double dot;
  double dtheta;
  double energy;
  double energy_added;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_z1;
  double g_z2;
  double g_z3;
  double n1_sq;
  double n2_sq;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    DOUBLE x3 = position[i3x3 + 0];
    DOUBLE y3 = position[i3x3 + 1];
    DOUBLE z3 = position[i3x3 + 2];
    {
      /* !BASE */
      cse_p11_t1_g34762 = (-(x2));
      cse_p11_t2_g34763 = (-(y2));
      cse_p11_t3_g34764 = (-(z2));
      vx1 = (cse_p11_t1_g34762 + x1);
      vy1 = (cse_p11_t2_g34763 + y1);
      vz1 = (cse_p11_t3_g34764 + z1);
      vx2 = (cse_p11_t1_g34762 + x3);
      vy2 = (cse_p11_t2_g34763 + y3);
      vz2 = (cse_p11_t3_g34764 + z3);
      dot = ((vx1 * vx2) + (vy1 * vy2) + (vz1 * vz2));
      n1_sq = ((vx1 * vx1) + (vy1 * vy1) + (vz1 * vz1));
      n2_sq = ((vx2 * vx2) + (vy2 * vy2) + (vz2 * vz2));
      cse_p1_t1_sqrt34754 = sqrt(n1_sq);
      cse_p1_t2_invsqrt34755 = (1.0 / (cse_p1_t1_sqrt34754));
      cse_p1_t3_sqrt34756 = sqrt(n2_sq);
      cse_p1_t4_invsqrt34757 = (1.0 / (cse_p1_t3_sqrt34756));
      cse_p1_t5_invr34758 = (1.0 / ((cse_p1_t1_sqrt34754 * cse_p1_t3_sqrt34756)));
      cse_p1_t6_invr234759 = (cse_p1_t5_invr34758 * cse_p1_t5_invr34758);
      cse_p113_t1_g34773 = (cse_p1_t6_invr234759 * dot);
      cos_theta = (cse_p1_t5_invr34758 * dot);
      if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
      cse_p1_t7_sqrt34760 = sqrt((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))));
      cse_p1_t8_invsqrt34761 = (1.0 / (cse_p1_t7_sqrt34760));
      theta = acos(cos_theta);
      dtheta = (theta + (-(t0)));
      cse_p11_t1_g34771 = (dtheta * kt);
      energy = (cse_p11_t1_g34771 * dtheta);
      energy_added += energy;
      *energy_accumulate += energy;
      cse_p11_t1_g34765 = (2.0000000000000000     * cse_p11_t1_g34771);
      cse_p11_t1_g34766 = (cse_p1_t2_invsqrt34755 * cse_p1_t3_sqrt34756);
      cse_p11_t1_g34769 = (cse_p113_t1_g34773 * cse_p11_t1_g34766);
      cse_p62_t1_g34772 = (cse_p11_t1_g34765 * cse_p1_t8_invsqrt34761);
      g_x1 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * vx2) + (-((cse_p11_t1_g34769 * vx1)))))));
      KernelGradientAcc(i3x1, 0, g_x1);
      g_y1 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * vy2) + (-((cse_p11_t1_g34769 * vy1)))))));
      KernelGradientAcc(i3x1, 1, g_y1);
      g_z1 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * vz2) + (-((cse_p11_t1_g34769 * vz1)))))));
      KernelGradientAcc(i3x1, 2, g_z1);
      cse_p11_t1_g34767 = (cse_p1_t1_sqrt34754 * cse_p1_t4_invsqrt34757);
      g_x2 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * ((-(vx1)) + (-(vx2)))) + (-((cse_p113_t1_g34773 * ((-((cse_p11_t1_g34766 * vx1))) + (-((cse_p11_t1_g34767 * vx2)))))))))));
      KernelGradientAcc(i3x2, 0, g_x2);
      g_y2 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * ((-(vy1)) + (-(vy2)))) + (-((cse_p113_t1_g34773 * ((-((cse_p11_t1_g34766 * vy1))) + (-((cse_p11_t1_g34767 * vy2)))))))))));
      KernelGradientAcc(i3x2, 1, g_y2);
      g_z2 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * ((-(vz1)) + (-(vz2)))) + (-((cse_p113_t1_g34773 * ((-((cse_p11_t1_g34766 * vz1))) + (-((cse_p11_t1_g34767 * vz2)))))))))));
      KernelGradientAcc(i3x2, 2, g_z2);
      cse_p11_t1_g34770 = (cse_p113_t1_g34773 * cse_p11_t1_g34767);
      g_x3 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * vx1) + (-((cse_p11_t1_g34770 * vx2)))))));
      KernelGradientAcc(i3x3, 0, g_x3);
      g_y3 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * vy1) + (-((cse_p11_t1_g34770 * vy2)))))));
      KernelGradientAcc(i3x3, 1, g_y3);
      g_z3 = (-((cse_p62_t1_g34772 * ((cse_p1_t5_invr34758 * vz1) + (-((cse_p11_t1_g34770 * vz2)))))));
      KernelGradientAcc(i3x3, 2, g_z3);
    }
  }
  return energy_added;
}
void gradient_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 9;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(kt, t0, i3x1, i3x2, i3x3, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
}

double hessian(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double cos_theta;
  double cse_p114_t1_g35034;
  double cse_p115_t1_g35037;
  double cse_p115_t1_g35038;
  double cse_p115_t2_g35036;
  double cse_p11_t100_g34881;
  double cse_p11_t101_g34882;
  double cse_p11_t102_g34883;
  double cse_p11_t103_g34884;
  double cse_p11_t105_g34886;
  double cse_p11_t106_g34887;
  double cse_p11_t107_g34888;
  double cse_p11_t108_g34889;
  double cse_p11_t10_g34791;
  double cse_p11_t110_g34891;
  double cse_p11_t111_g34892;
  double cse_p11_t112_g34893;
  double cse_p11_t114_g34895;
  double cse_p11_t115_g34896;
  double cse_p11_t116_g34897;
  double cse_p11_t117_g34898;
  double cse_p11_t118_g34899;
  double cse_p11_t119_g34900;
  double cse_p11_t11_g34792;
  double cse_p11_t120_g34901;
  double cse_p11_t121_g34902;
  double cse_p11_t122_g34903;
  double cse_p11_t123_g34904;
  double cse_p11_t124_g34905;
  double cse_p11_t125_g34906;
  double cse_p11_t126_g34907;
  double cse_p11_t127_g34908;
  double cse_p11_t128_g34909;
  double cse_p11_t129_g34910;
  double cse_p11_t12_g34793;
  double cse_p11_t130_g34911;
  double cse_p11_t131_g34912;
  double cse_p11_t132_g34913;
  double cse_p11_t133_g34914;
  double cse_p11_t134_g34915;
  double cse_p11_t135_g34916;
  double cse_p11_t136_g34917;
  double cse_p11_t137_g34918;
  double cse_p11_t138_g34919;
  double cse_p11_t139_g34920;
  double cse_p11_t13_g34794;
  double cse_p11_t140_g34921;
  double cse_p11_t141_g34922;
  double cse_p11_t142_g34923;
  double cse_p11_t143_g34924;
  double cse_p11_t144_g34925;
  double cse_p11_t145_g34926;
  double cse_p11_t146_g34927;
  double cse_p11_t147_g34928;
  double cse_p11_t148_g34929;
  double cse_p11_t149_g34930;
  double cse_p11_t14_g34795;
  double cse_p11_t150_g34931;
  double cse_p11_t151_g34932;
  double cse_p11_t152_g34933;
  double cse_p11_t153_g34934;
  double cse_p11_t154_g34935;
  double cse_p11_t155_g34936;
  double cse_p11_t156_g34937;
  double cse_p11_t157_g34938;
  double cse_p11_t158_g34939;
  double cse_p11_t159_g34940;
  double cse_p11_t15_g34796;
  double cse_p11_t160_g34941;
  double cse_p11_t161_g34942;
  double cse_p11_t162_g34943;
  double cse_p11_t163_g34944;
  double cse_p11_t164_g34945;
  double cse_p11_t165_g34946;
  double cse_p11_t166_g34947;
  double cse_p11_t167_g34948;
  double cse_p11_t168_g34949;
  double cse_p11_t169_g34950;
  double cse_p11_t16_g34797;
  double cse_p11_t170_g34951;
  double cse_p11_t171_g34952;
  double cse_p11_t172_g34953;
  double cse_p11_t173_g34954;
  double cse_p11_t174_g34955;
  double cse_p11_t175_g34956;
  double cse_p11_t176_g34957;
  double cse_p11_t177_g34958;
  double cse_p11_t178_g34959;
  double cse_p11_t179_g34960;
  double cse_p11_t17_g34798;
  double cse_p11_t180_g34961;
  double cse_p11_t181_g34962;
  double cse_p11_t182_g34963;
  double cse_p11_t183_g34964;
  double cse_p11_t184_g34965;
  double cse_p11_t185_g34966;
  double cse_p11_t186_g34967;
  double cse_p11_t187_g34968;
  double cse_p11_t188_g34969;
  double cse_p11_t18_g34799;
  double cse_p11_t193_g34974;
  double cse_p11_t19_g34800;
  double cse_p11_t1_g34782;
  double cse_p11_t1_g34979;
  double cse_p11_t1_g34980;
  double cse_p11_t1_g34982;
  double cse_p11_t1_g34983;
  double cse_p11_t20_g34801;
  double cse_p11_t21_g34802;
  double cse_p11_t22_g34803;
  double cse_p11_t23_g34804;
  double cse_p11_t24_g34805;
  double cse_p11_t25_g34806;
  double cse_p11_t26_g34807;
  double cse_p11_t27_g34808;
  double cse_p11_t28_g34809;
  double cse_p11_t29_g34810;
  double cse_p11_t2_g34783;
  double cse_p11_t30_g34811;
  double cse_p11_t31_g34812;
  double cse_p11_t32_g34813;
  double cse_p11_t33_g34814;
  double cse_p11_t34_g34815;
  double cse_p11_t35_g34816;
  double cse_p11_t37_g34818;
  double cse_p11_t38_g34819;
  double cse_p11_t39_g34820;
  double cse_p11_t3_g34784;
  double cse_p11_t40_g34821;
  double cse_p11_t41_g34822;
  double cse_p11_t42_g34823;
  double cse_p11_t43_g34824;
  double cse_p11_t44_g34825;
  double cse_p11_t45_g34826;
  double cse_p11_t46_g34827;
  double cse_p11_t47_g34828;
  double cse_p11_t48_g34829;
  double cse_p11_t49_g34830;
  double cse_p11_t4_g34785;
  double cse_p11_t50_g34831;
  double cse_p11_t51_g34832;
  double cse_p11_t52_g34833;
  double cse_p11_t53_g34834;
  double cse_p11_t54_g34835;
  double cse_p11_t55_g34836;
  double cse_p11_t56_g34837;
  double cse_p11_t57_g34838;
  double cse_p11_t58_g34839;
  double cse_p11_t59_g34840;
  double cse_p11_t5_g34786;
  double cse_p11_t60_g34841;
  double cse_p11_t61_g34842;
  double cse_p11_t62_g34843;
  double cse_p11_t63_g34844;
  double cse_p11_t64_g34845;
  double cse_p11_t65_g34846;
  double cse_p11_t66_g34847;
  double cse_p11_t67_g34848;
  double cse_p11_t68_g34849;
  double cse_p11_t69_g34850;
  double cse_p11_t6_g34787;
  double cse_p11_t70_g34851;
  double cse_p11_t71_g34852;
  double cse_p11_t72_g34853;
  double cse_p11_t73_g34854;
  double cse_p11_t74_g34855;
  double cse_p11_t75_g34856;
  double cse_p11_t76_g34857;
  double cse_p11_t77_g34858;
  double cse_p11_t78_g34859;
  double cse_p11_t79_g34860;
  double cse_p11_t7_g34788;
  double cse_p11_t80_g34861;
  double cse_p11_t81_g34862;
  double cse_p11_t82_g34863;
  double cse_p11_t83_g34864;
  double cse_p11_t84_g34865;
  double cse_p11_t85_g34866;
  double cse_p11_t86_g34867;
  double cse_p11_t87_g34868;
  double cse_p11_t88_g34869;
  double cse_p11_t8_g34789;
  double cse_p11_t91_g34872;
  double cse_p11_t92_g34873;
  double cse_p11_t93_g34874;
  double cse_p11_t94_g34875;
  double cse_p11_t95_g34876;
  double cse_p11_t96_g34877;
  double cse_p11_t97_g34878;
  double cse_p11_t98_g34879;
  double cse_p11_t99_g34880;
  double cse_p11_t9_g34790;
  double cse_p166_t1_g35045;
  double cse_p167_t1_g35046;
  double cse_p167_t1_g35047;
  double cse_p167_t1_g35048;
  double cse_p167_t1_g35049;
  double cse_p167_t1_g35050;
  double cse_p167_t1_g35051;
  double cse_p167_t1_g35052;
  double cse_p167_t1_g35053;
  double cse_p167_t1_g35054;
  double cse_p167_t1_g35055;
  double cse_p168_t1_g35056;
  double cse_p168_t1_g35057;
  double cse_p1_t2_invsqrt34775;
  double cse_p1_t4_invsqrt34777;
  double cse_p1_t8_invsqrt34781;
  double cse_p218_t1_g35064;
  double cse_p219_t1_g35065;
  double cse_p219_t1_g35066;
  double cse_p219_t1_g35067;
  double cse_p219_t1_g35068;
  double cse_p219_t1_g35069;
  double cse_p219_t1_g35070;
  double cse_p219_t1_g35071;
  double cse_p219_t1_g35072;
  double cse_p219_t1_g35073;
  double cse_p219_t1_g35074;
  double cse_p219_t1_g35075;
  double cse_p220_t1_g35076;
  double cse_p220_t1_g35077;
  double cse_p220_t1_g35078;
  double cse_p270_t1_g35085;
  double cse_p271_t1_g35086;
  double cse_p271_t1_g35087;
  double cse_p271_t1_g35088;
  double cse_p271_t1_g35089;
  double cse_p271_t1_g35090;
  double cse_p271_t1_g35091;
  double cse_p271_t1_g35092;
  double cse_p271_t1_g35093;
  double cse_p271_t1_g35094;
  double cse_p271_t1_g35095;
  double cse_p272_t1_g35096;
  double cse_p272_t1_g35097;
  double cse_p272_t1_g35098;
  double cse_p322_t1_g35105;
  double cse_p374_t1_g35112;
  double cse_p426_t1_g35119;
  double cse_p427_t1_g35120;
  double cse_p427_t1_g35121;
  double cse_p427_t1_g35122;
  double cse_p427_t1_g35123;
  double cse_p427_t1_g35124;
  double cse_p427_t1_g35125;
  double cse_p427_t1_g35126;
  double cse_p427_t1_g35127;
  double cse_p427_t1_g35128;
  double cse_p427_t1_g35129;
  double cse_p428_t1_g35130;
  double cse_p428_t1_g35131;
  double cse_p428_t1_g35132;
  double cse_p478_t1_g35139;
  double cse_p529_t1_sqrt35140;
  double cse_p529_t2_invr35141;
  double cse_p529_t3_sqrt35142;
  double cse_p529_t4_invr35143;
  double cse_p529_t5_sqrt35144;
  double cse_p529_t6_invr35145;
  double cse_p530_t1_g35146;
  double cse_p61_t10_invsqrt34994;
  double cse_p61_t3_invr234987;
  double cse_p61_t6_invr234990;
  double cse_p61_t7_invr34991;
  double cse_p61_t8_invr234992;
  double cse_p61_t9_invr334993;
  double cse_p62_t1_g34997;
  double cse_p63_t10_g35007;
  double cse_p63_t1_g34998;
  double cse_p63_t1_g35009;
  double cse_p63_t1_g35010;
  double cse_p63_t1_g35011;
  double cse_p63_t1_g35012;
  double cse_p63_t1_g35013;
  double cse_p63_t1_g35015;
  double cse_p63_t1_g35016;
  double cse_p63_t1_g35017;
  double cse_p63_t1_g35018;
  double cse_p63_t1_g35019;
  double cse_p63_t1_g35020;
  double cse_p63_t1_g35021;
  double cse_p63_t1_g35022;
  double cse_p63_t1_g35023;
  double cse_p63_t1_g35024;
  double cse_p63_t1_g35025;
  double cse_p63_t1_g35026;
  double cse_p63_t2_g34999;
  double cse_p63_t3_g35000;
  double cse_p63_t5_g35002;
  double cse_p63_t6_g35003;
  double cse_p63_t7_g35004;
  double cse_p63_t8_g35005;
  double cse_p63_t9_g35006;
  double cse_p64_t1_g35027;
  double dot;
  double dtheta;
  double energy;
  double energy_added;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_z1;
  double g_z2;
  double g_z3;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_z2;
  double h_x2_z3;
  double h_x3_x3;
  double h_x3_y3;
  double h_x3_z3;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y2_x3;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_z2;
  double h_y2_z3;
  double h_y3_y3;
  double h_y3_z3;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z2_x3;
  double h_z2_y3;
  double h_z2_z2;
  double h_z2_z3;
  double h_z3_z3;
  double n1_sq;
  double n2_sq;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    DOUBLE x3 = position[i3x3 + 0];
    DOUBLE y3 = position[i3x3 + 1];
    DOUBLE z3 = position[i3x3 + 2];
    {
      /* !BASE */
      cse_p11_t186_g34967 = (-(x2));
      cse_p11_t187_g34968 = (-(y2));
      cse_p11_t188_g34969 = (-(z2));
      vx1 = (cse_p11_t186_g34967 + x1);
      cse_p11_t180_g34961 = (-(vx1));
      vy1 = (cse_p11_t187_g34968 + y1);
      cse_p11_t182_g34963 = (-(vy1));
      vz1 = (cse_p11_t188_g34969 + z1);
      cse_p11_t184_g34965 = (-(vz1));
      vx2 = (cse_p11_t186_g34967 + x3);
      cse_p11_t138_g34919 = (cse_p11_t180_g34961 + (-(vx2)));
      cse_p11_t181_g34962 = (-(vx2));
      vy2 = (cse_p11_t187_g34968 + y3);
      cse_p11_t139_g34920 = (cse_p11_t182_g34963 + (-(vy2)));
      cse_p11_t183_g34964 = (-(vy2));
      vz2 = (cse_p11_t188_g34969 + z3);
      cse_p11_t140_g34921 = (cse_p11_t184_g34965 + (-(vz2)));
      cse_p11_t185_g34966 = (-(vz2));
      cse_p271_t1_g35087 = (vx1 * vx2);
      cse_p271_t1_g35091 = (vy1 * vy2);
      cse_p271_t1_g35094 = (vz1 * vz2);
      dot = (cse_p271_t1_g35087 + cse_p271_t1_g35091 + cse_p271_t1_g35094);
      cse_p427_t1_g35120 = (vx1 * vx1);
      cse_p427_t1_g35125 = (vy1 * vy1);
      cse_p427_t1_g35128 = (vz1 * vz1);
      n1_sq = (cse_p427_t1_g35120 + cse_p427_t1_g35125 + cse_p427_t1_g35128);
      cse_p529_t1_sqrt35140 = sqrt(n1_sq);
      cse_p529_t2_invr35141 = (1.0 / (n1_sq));
      cse_p61_t3_invr234987 = (cse_p529_t2_invr35141 * cse_p529_t2_invr35141);
      cse_p166_t1_g35045 = (-2.0000000000000000     * cse_p61_t3_invr234987);
      cse_p115_t2_g35036 = (cse_p166_t1_g35045 + cse_p61_t3_invr234987);
      cse_p271_t1_g35088 = (vx2 * vx2);
      cse_p271_t1_g35092 = (vy2 * vy2);
      cse_p271_t1_g35095 = (vz2 * vz2);
      n2_sq = (cse_p271_t1_g35088 + cse_p271_t1_g35092 + cse_p271_t1_g35095);
      cse_p529_t3_sqrt35142 = sqrt(n2_sq);
      cse_p529_t4_invr35143 = (1.0 / (n2_sq));
      cse_p114_t1_g35034 = (cse_p529_t1_sqrt35140 * cse_p529_t3_sqrt35142);
      cse_p61_t6_invr234990 = (cse_p529_t4_invr35143 * cse_p529_t4_invr35143);
      cse_p11_t115_g34896 = (cse_p271_t1_g35087 * cse_p529_t3_sqrt35142 * cse_p529_t4_invr35143);
      cse_p219_t1_g35069 = (cse_p529_t2_invr35141 * cse_p529_t3_sqrt35142);
      cse_p64_t1_g35027 = (cse_p219_t1_g35069 * cse_p529_t4_invr35143);
      cse_p11_t116_g34897 = (cse_p64_t1_g35027 * vx2);
      cse_p11_t117_g34898 = (cse_p271_t1_g35091 * cse_p529_t3_sqrt35142 * cse_p529_t4_invr35143);
      cse_p11_t118_g34899 = (cse_p64_t1_g35027 * vy2);
      cse_p11_t119_g34900 = (cse_p271_t1_g35094 * cse_p529_t3_sqrt35142 * cse_p529_t4_invr35143);
      cse_p11_t120_g34901 = (cse_p64_t1_g35027 * vz2);
      cse_p1_t2_invsqrt34775 = (1.0 / (cse_p529_t1_sqrt35140));
      cse_p167_t1_g35054 = (2.0000000000000000     * cse_p114_t1_g35034 * cse_p61_t6_invr234990);
      cse_p271_t1_g35089 = (vx2 * vy2);
      cse_p11_t20_g34801 = (cse_p167_t1_g35054 * cse_p271_t1_g35089);
      cse_p271_t1_g35090 = (vx2 * vz2);
      cse_p11_t21_g34802 = (cse_p167_t1_g35054 * cse_p271_t1_g35090);
      cse_p271_t1_g35093 = (vy2 * vz2);
      cse_p11_t22_g34803 = (cse_p167_t1_g35054 * cse_p271_t1_g35093);
      cse_p11_t1_g34979 = (cse_p114_t1_g35034 * cse_p529_t4_invr35143);
      cse_p11_t91_g34872 = (cse_p11_t1_g34979 * vx2);
      cse_p168_t1_g35057 = (cse_p11_t1_g34979 * cse_p529_t4_invr35143);
      cse_p11_t92_g34873 = (cse_p168_t1_g35057 * cse_p271_t1_g35088);
      cse_p11_t94_g34875 = (cse_p168_t1_g35057 * cse_p271_t1_g35089);
      cse_p11_t96_g34877 = (cse_p168_t1_g35057 * cse_p271_t1_g35090);
      cse_p11_t97_g34878 = (cse_p11_t1_g34979 * vy2);
      cse_p11_t98_g34879 = (cse_p168_t1_g35057 * cse_p271_t1_g35092);
      cse_p11_t100_g34881 = (cse_p168_t1_g35057 * cse_p271_t1_g35093);
      cse_p11_t101_g34882 = (cse_p11_t1_g34979 * vz2);
      cse_p11_t102_g34883 = (cse_p168_t1_g35057 * cse_p271_t1_g35095);
      cse_p11_t162_g34943 = (-(cse_p11_t91_g34872));
      cse_p11_t164_g34945 = (-(cse_p11_t94_g34875));
      cse_p11_t166_g34947 = (-(cse_p11_t96_g34877));
      cse_p11_t167_g34948 = (-(cse_p11_t97_g34878));
      cse_p11_t169_g34950 = (-(cse_p11_t100_g34881));
      cse_p11_t170_g34951 = (-(cse_p11_t101_g34882));
      cse_p11_t177_g34958 = (-(cse_p11_t1_g34979));
      cse_p1_t4_invsqrt34777 = (1.0 / (cse_p529_t3_sqrt35142));
      cse_p11_t1_g34980 = (cse_p114_t1_g35034 * cse_p529_t2_invr35141);
      cse_p530_t1_g35146 = (cse_p11_t1_g34980 * vz1);
      cse_p426_t1_g35119 = (cse_p11_t1_g34980 * vy1);
      cse_p270_t1_g35085 = (cse_p11_t1_g34980 * vx1);
      cse_p61_t7_invr34991 = (1.0 / (cse_p114_t1_g35034));
      cse_p61_t8_invr234992 = (cse_p61_t7_invr34991 * cse_p61_t7_invr34991);
      cse_p374_t1_g35112 = (cse_p11_t1_g34979 * cse_p61_t8_invr234992);
      cse_p218_t1_g35064 = (cse_p61_t8_invr234992 * dot);
      cse_p322_t1_g35105 = (cse_p11_t1_g34979 * cse_p218_t1_g35064);
      cse_p61_t9_invr334993 = (cse_p61_t7_invr34991 * cse_p61_t8_invr234992);
      cse_p11_t1_g34782 = (cse_p61_t8_invr234992 * (cse_p11_t162_g34943 + (-(cse_p270_t1_g35085))));
      cse_p11_t2_g34783 = (cse_p61_t8_invr234992 * (cse_p11_t167_g34948 + (-(cse_p426_t1_g35119))));
      cse_p11_t3_g34784 = (cse_p61_t8_invr234992 * (cse_p11_t170_g34951 + (-(cse_p530_t1_g35146))));
      cse_p11_t13_g34794 = (cse_p166_t1_g35045 * cse_p529_t3_sqrt35142 * vx1);
      cse_p11_t14_g34795 = (cse_p166_t1_g35045 * cse_p529_t3_sqrt35142 * vy1);
      cse_p11_t15_g34796 = (cse_p166_t1_g35045 * cse_p529_t3_sqrt35142 * vz1);
      cse_p219_t1_g35074 = (2.0000000000000000     * cse_p61_t8_invr234992);
      cse_p11_t16_g34797 = (cse_p219_t1_g35074 * cse_p61_t3_invr234987);
      cse_p11_t17_g34798 = (cse_p219_t1_g35074 * cse_p61_t6_invr234990);
      cse_p63_t1_g35013 = (2.0000000000000000     * cse_p61_t9_invr334993);
      cse_p11_t19_g34800 = (cse_p168_t1_g35057 * cse_p63_t1_g35013);
      cse_p11_t23_g34804 = (cse_p11_t1_g34980 * cse_p529_t2_invr35141 * cse_p63_t1_g35013);
      cse_p11_t33_g34814 = (dot * (-(cse_p11_t1_g34782)));
      cse_p11_t34_g34815 = (dot * (-(cse_p11_t2_g34783)));
      cse_p11_t35_g34816 = (dot * (-(cse_p11_t3_g34784)));
      cse_p11_t37_g34818 = (cse_p322_t1_g35105 * vx2);
      cse_p11_t38_g34819 = (cse_p322_t1_g35105 * vy2);
      cse_p11_t39_g34820 = (cse_p322_t1_g35105 * vz2);
      cse_p11_t40_g34821 = (cse_p11_t1_g34980 * cse_p218_t1_g35064);
      cse_p11_t41_g34822 = (cse_p218_t1_g35064 * cse_p270_t1_g35085);
      cse_p11_t42_g34823 = (cse_p218_t1_g35064 * cse_p426_t1_g35119);
      cse_p11_t43_g34824 = (cse_p218_t1_g35064 * cse_p530_t1_g35146);
      cse_p11_t93_g34874 = (cse_p271_t1_g35089 * cse_p374_t1_g35112);
      cse_p11_t95_g34876 = (cse_p271_t1_g35090 * cse_p374_t1_g35112);
      cse_p11_t99_g34880 = (cse_p271_t1_g35093 * cse_p374_t1_g35112);
      cse_p63_t1_g35026 = (cse_p219_t1_g35069 * cse_p529_t2_invr35141);
      cse_p11_t103_g34884 = (cse_p63_t1_g35026 * vx1);
      cse_p11_t105_g34886 = (cse_p219_t1_g35069 * cse_p427_t1_g35120);
      cse_p11_t106_g34887 = (cse_p270_t1_g35085 * cse_p61_t8_invr234992 * vy1);
      cse_p11_t107_g34888 = (cse_p270_t1_g35085 * cse_p61_t8_invr234992 * vz1);
      cse_p11_t108_g34889 = (cse_p63_t1_g35026 * vy1);
      cse_p11_t110_g34891 = (cse_p219_t1_g35069 * cse_p427_t1_g35125);
      cse_p11_t111_g34892 = (cse_p426_t1_g35119 * cse_p61_t8_invr234992 * vz1);
      cse_p11_t112_g34893 = (cse_p63_t1_g35026 * vz1);
      cse_p11_t114_g34895 = (cse_p219_t1_g35069 * cse_p427_t1_g35128);
      cse_p11_t121_g34902 = (cse_p11_t162_g34943 + (-(cse_p270_t1_g35085)));
      cse_p63_t1_g35020 = (cse_p219_t1_g35069 * cse_p63_t1_g35013);
      cse_p63_t1_g34998 = (cse_p11_t121_g34902 * cse_p63_t1_g35020);
      cse_p11_t122_g34903 = (cse_p11_t167_g34948 + (-(cse_p426_t1_g35119)));
      cse_p63_t2_g34999 = (cse_p11_t122_g34903 * cse_p63_t1_g35020);
      cse_p11_t123_g34904 = (cse_p11_t170_g34951 + (-(cse_p530_t1_g35146)));
      cse_p63_t3_g35000 = (cse_p11_t123_g34904 * cse_p63_t1_g35020);
      cse_p11_t124_g34905 = (cse_p11_t103_g34884 + cse_p11_t116_g34897 + cse_p11_t13_g34794);
      cse_p63_t5_g35002 = (cse_p11_t124_g34905 * cse_p61_t8_invr234992);
      cse_p63_t8_g35005 = (cse_p63_t1_g34998 + cse_p63_t5_g35002);
      cse_p11_t125_g34906 = (cse_p11_t108_g34889 + cse_p11_t118_g34899 + cse_p11_t14_g34795);
      cse_p63_t6_g35003 = (cse_p11_t125_g34906 * cse_p61_t8_invr234992);
      cse_p63_t9_g35006 = (cse_p63_t2_g34999 + cse_p63_t6_g35003);
      cse_p11_t126_g34907 = (cse_p11_t112_g34893 + cse_p11_t120_g34901 + cse_p11_t15_g34796);
      cse_p63_t7_g35004 = (cse_p11_t126_g34907 * cse_p61_t8_invr234992);
      cse_p63_t10_g35007 = (cse_p63_t3_g35000 + cse_p63_t7_g35004);
      cse_p11_t127_g34908 = (cse_p11_t16_g34797 + cse_p11_t23_g34804);
      cse_p11_t128_g34909 = (cse_p11_t17_g34798 + cse_p11_t19_g34800);
      cse_p11_t142_g34923 = (-((cse_p11_t121_g34902 * cse_p61_t8_invr234992)));
      cse_p11_t143_g34924 = (-((cse_p11_t122_g34903 * cse_p61_t8_invr234992)));
      cse_p11_t144_g34925 = (-((cse_p11_t123_g34904 * cse_p61_t8_invr234992)));
      cse_p11_t154_g34935 = (-(cse_p322_t1_g35105));
      cse_p11_t155_g34936 = (-(cse_p11_t37_g34818));
      cse_p11_t156_g34937 = (-(cse_p11_t38_g34819));
      cse_p11_t157_g34938 = (-(cse_p11_t39_g34820));
      cse_p11_t158_g34939 = (-(cse_p11_t40_g34821));
      cse_p11_t159_g34940 = (-(cse_p11_t41_g34822));
      cse_p11_t160_g34941 = (-(cse_p11_t42_g34823));
      cse_p11_t161_g34942 = (-(cse_p11_t43_g34824));
      cse_p11_t163_g34944 = (-(cse_p11_t93_g34874));
      cse_p11_t165_g34946 = (-(cse_p11_t95_g34876));
      cse_p11_t168_g34949 = (-(cse_p11_t99_g34880));
      cse_p11_t171_g34952 = (-(cse_p270_t1_g35085));
      cse_p11_t172_g34953 = (-(cse_p11_t106_g34887));
      cse_p11_t173_g34954 = (-(cse_p11_t107_g34888));
      cse_p11_t174_g34955 = (-(cse_p426_t1_g35119));
      cse_p11_t175_g34956 = (-(cse_p11_t111_g34892));
      cse_p11_t176_g34957 = (-(cse_p530_t1_g35146));
      cse_p11_t18_g34799 = (2.0000000000000000     * cse_p61_t7_invr34991);
      cse_p11_t24_g34805 = (cse_p61_t7_invr34991 * (cse_p11_t180_g34961 + cse_p11_t181_g34962));
      cse_p11_t25_g34806 = (cse_p61_t7_invr34991 * (cse_p11_t182_g34963 + cse_p11_t183_g34964));
      cse_p11_t26_g34807 = (cse_p61_t7_invr34991 * (cse_p11_t184_g34965 + cse_p11_t185_g34966));
      cse_p11_t27_g34808 = (cse_p61_t7_invr34991 * vx1);
      cse_p11_t28_g34809 = (cse_p61_t7_invr34991 * vx2);
      cse_p11_t29_g34810 = (cse_p61_t7_invr34991 * vy1);
      cse_p11_t30_g34811 = (cse_p61_t7_invr34991 * vy2);
      cse_p11_t31_g34812 = (cse_p61_t7_invr34991 * vz1);
      cse_p11_t32_g34813 = (cse_p61_t7_invr34991 * vz2);
      cse_p11_t129_g34910 = (cse_p11_t24_g34805 + (-((cse_p218_t1_g35064 * (cse_p11_t162_g34943 + cse_p11_t171_g34952)))));
      cse_p11_t130_g34911 = (cse_p11_t25_g34806 + (-((cse_p218_t1_g35064 * (cse_p11_t167_g34948 + cse_p11_t174_g34955)))));
      cse_p11_t131_g34912 = (cse_p11_t26_g34807 + (-((cse_p218_t1_g35064 * (cse_p11_t170_g34951 + cse_p11_t176_g34957)))));
      cse_p11_t132_g34913 = (cse_p11_t155_g34936 + cse_p11_t27_g34808);
      cse_p11_t133_g34914 = (cse_p11_t159_g34940 + cse_p11_t28_g34809);
      cse_p11_t134_g34915 = (cse_p11_t156_g34937 + cse_p11_t29_g34810);
      cse_p11_t135_g34916 = (cse_p11_t160_g34941 + cse_p11_t30_g34811);
      cse_p11_t136_g34917 = (cse_p11_t157_g34938 + cse_p11_t31_g34812);
      cse_p11_t137_g34918 = (cse_p11_t161_g34942 + cse_p11_t32_g34813);
      cse_p11_t179_g34960 = (-(cse_p61_t7_invr34991));
      cos_theta = (cse_p61_t7_invr34991 * dot);
      cse_p61_t10_invsqrt34994 = (1.0 / sqrt((1.0000000000000000     + (-(((cos_theta) * (cos_theta)))))));
      cse_p11_t4_g34785 = (cse_p11_t129_g34910 * cse_p61_t10_invsqrt34994);
      cse_p11_t5_g34786 = (cse_p11_t130_g34911 * cse_p61_t10_invsqrt34994);
      cse_p11_t6_g34787 = (cse_p11_t131_g34912 * cse_p61_t10_invsqrt34994);
      cse_p11_t7_g34788 = (cse_p11_t132_g34913 * cse_p61_t10_invsqrt34994);
      cse_p11_t8_g34789 = (cse_p11_t133_g34914 * cse_p61_t10_invsqrt34994);
      cse_p11_t9_g34790 = (cse_p11_t134_g34915 * cse_p61_t10_invsqrt34994);
      cse_p11_t10_g34791 = (cse_p11_t135_g34916 * cse_p61_t10_invsqrt34994);
      cse_p11_t11_g34792 = (cse_p11_t136_g34917 * cse_p61_t10_invsqrt34994);
      cse_p11_t12_g34793 = (cse_p11_t137_g34918 * cse_p61_t10_invsqrt34994);
      cse_p63_t1_g35009 = (cse_p61_t10_invsqrt34994 * cse_p61_t10_invsqrt34994 * kt);
      cse_p167_t1_g35047 = (cse_p11_t129_g34910 * cse_p63_t1_g35009);
      cse_p11_t44_g34825 = (cse_p11_t129_g34910 * cse_p167_t1_g35047);
      cse_p11_t45_g34826 = (cse_p11_t130_g34911 * cse_p167_t1_g35047);
      cse_p11_t46_g34827 = (cse_p11_t131_g34912 * cse_p167_t1_g35047);
      cse_p11_t47_g34828 = (cse_p11_t132_g34913 * cse_p167_t1_g35047);
      cse_p11_t48_g34829 = (cse_p11_t133_g34914 * cse_p167_t1_g35047);
      cse_p11_t49_g34830 = (cse_p11_t134_g34915 * cse_p167_t1_g35047);
      cse_p11_t50_g34831 = (cse_p11_t135_g34916 * cse_p167_t1_g35047);
      cse_p11_t51_g34832 = (cse_p11_t136_g34917 * cse_p167_t1_g35047);
      cse_p11_t52_g34833 = (cse_p11_t137_g34918 * cse_p167_t1_g35047);
      cse_p167_t1_g35051 = (cse_p11_t130_g34911 * cse_p63_t1_g35009);
      cse_p11_t53_g34834 = (cse_p11_t130_g34911 * cse_p167_t1_g35051);
      cse_p11_t54_g34835 = (cse_p11_t131_g34912 * cse_p167_t1_g35051);
      cse_p11_t55_g34836 = (cse_p11_t132_g34913 * cse_p167_t1_g35051);
      cse_p11_t56_g34837 = (cse_p11_t133_g34914 * cse_p167_t1_g35051);
      cse_p11_t57_g34838 = (cse_p11_t134_g34915 * cse_p167_t1_g35051);
      cse_p11_t58_g34839 = (cse_p11_t135_g34916 * cse_p167_t1_g35051);
      cse_p11_t59_g34840 = (cse_p11_t136_g34917 * cse_p167_t1_g35051);
      cse_p11_t60_g34841 = (cse_p11_t137_g34918 * cse_p167_t1_g35051);
      cse_p167_t1_g35055 = (cse_p11_t131_g34912 * cse_p63_t1_g35009);
      cse_p11_t61_g34842 = (cse_p11_t131_g34912 * cse_p167_t1_g35055);
      cse_p11_t62_g34843 = (cse_p11_t132_g34913 * cse_p167_t1_g35055);
      cse_p11_t63_g34844 = (cse_p11_t133_g34914 * cse_p167_t1_g35055);
      cse_p11_t64_g34845 = (cse_p11_t134_g34915 * cse_p167_t1_g35055);
      cse_p11_t65_g34846 = (cse_p11_t135_g34916 * cse_p167_t1_g35055);
      cse_p11_t66_g34847 = (cse_p11_t136_g34917 * cse_p167_t1_g35055);
      cse_p11_t67_g34848 = (cse_p11_t137_g34918 * cse_p167_t1_g35055);
      cse_p219_t1_g35067 = (cse_p11_t132_g34913 * cse_p63_t1_g35009);
      cse_p11_t68_g34849 = (cse_p11_t132_g34913 * cse_p219_t1_g35067);
      cse_p11_t69_g34850 = (cse_p11_t133_g34914 * cse_p219_t1_g35067);
      cse_p11_t70_g34851 = (cse_p11_t134_g34915 * cse_p219_t1_g35067);
      cse_p11_t71_g34852 = (cse_p11_t135_g34916 * cse_p219_t1_g35067);
      cse_p11_t72_g34853 = (cse_p11_t136_g34917 * cse_p219_t1_g35067);
      cse_p11_t73_g34854 = (cse_p11_t137_g34918 * cse_p219_t1_g35067);
      cse_p220_t1_g35077 = (cse_p11_t133_g34914 * cse_p63_t1_g35009);
      cse_p11_t74_g34855 = (cse_p11_t133_g34914 * cse_p220_t1_g35077);
      cse_p11_t75_g34856 = (cse_p11_t134_g34915 * cse_p220_t1_g35077);
      cse_p11_t76_g34857 = (cse_p11_t135_g34916 * cse_p220_t1_g35077);
      cse_p11_t77_g34858 = (cse_p11_t136_g34917 * cse_p220_t1_g35077);
      cse_p11_t78_g34859 = (cse_p11_t137_g34918 * cse_p220_t1_g35077);
      cse_p272_t1_g35097 = (cse_p11_t134_g34915 * cse_p63_t1_g35009);
      cse_p11_t79_g34860 = (cse_p11_t134_g34915 * cse_p272_t1_g35097);
      cse_p11_t80_g34861 = (cse_p11_t135_g34916 * cse_p272_t1_g35097);
      cse_p11_t81_g34862 = (cse_p11_t136_g34917 * cse_p272_t1_g35097);
      cse_p11_t82_g34863 = (cse_p11_t137_g34918 * cse_p272_t1_g35097);
      cse_p428_t1_g35131 = (cse_p11_t135_g34916 * cse_p63_t1_g35009);
      cse_p11_t83_g34864 = (cse_p11_t135_g34916 * cse_p428_t1_g35131);
      cse_p11_t84_g34865 = (cse_p11_t136_g34917 * cse_p428_t1_g35131);
      cse_p11_t85_g34866 = (cse_p11_t137_g34918 * cse_p428_t1_g35131);
      cse_p11_t86_g34867 = (cse_p11_t136_g34917 * cse_p11_t136_g34917 * cse_p63_t1_g35009);
      cse_p11_t87_g34868 = (cse_p11_t136_g34917 * cse_p11_t137_g34918 * cse_p63_t1_g35009);
      cse_p11_t88_g34869 = (cse_p11_t137_g34918 * cse_p11_t137_g34918 * cse_p63_t1_g35009);
      cse_p11_t141_g34922 = (1.0000000000000000     + (-(((cos_theta) * (cos_theta)))));
      cse_p11_t145_g34926 = (-(cse_p11_t4_g34785));
      cse_p11_t146_g34927 = (-(cse_p11_t5_g34786));
      cse_p11_t147_g34928 = (-(cse_p11_t6_g34787));
      cse_p11_t148_g34929 = (-(cse_p11_t7_g34788));
      cse_p11_t149_g34930 = (-(cse_p11_t8_g34789));
      cse_p11_t150_g34931 = (-(cse_p11_t9_g34790));
      cse_p11_t151_g34932 = (-(cse_p11_t10_g34791));
      cse_p11_t152_g34933 = (-(cse_p11_t11_g34792));
      cse_p11_t153_g34934 = (-(cse_p11_t12_g34793));
      cse_p11_t178_g34959 = (-(((cos_theta) * (cos_theta))));
      cse_p529_t5_sqrt35144 = sqrt(cse_p11_t141_g34922);
      cse_p529_t6_invr35145 = (1.0 / (cse_p11_t141_g34922));
      cse_p11_t193_g34974 = ((cos_theta) * (cos_theta));
      if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
      cse_p1_t8_invsqrt34781 = (1.0 / (cse_p529_t5_sqrt35144));
      theta = acos(cos_theta);
      dtheta = (theta + (-(t0)));
      cse_p62_t1_g34997 = (2.0000000000000000     * dtheta * kt);
      energy = (dtheta * dtheta * kt);
      energy_added += energy;
      *energy_accumulate += energy;
      cse_p63_t1_g35012 = (cse_p529_t3_sqrt35142 * dot);
      cse_p63_t1_g35025 = (cse_p1_t2_invsqrt34775 * cse_p61_t8_invr234992 * cse_p63_t1_g35012);
      cse_p167_t1_g35049 = (cse_p1_t8_invsqrt34781 * cse_p62_t1_g34997);
      g_x1 = (-((cse_p167_t1_g35049 * (cse_p11_t28_g34809 + (-((cse_p63_t1_g35025 * vx1)))))));
      KernelGradientAcc(i3x1, 0, g_x1);
      g_y1 = (-((cse_p167_t1_g35049 * (cse_p11_t30_g34811 + (-((cse_p63_t1_g35025 * vy1)))))));
      KernelGradientAcc(i3x1, 1, g_y1);
      g_z1 = (-((cse_p167_t1_g35049 * (cse_p11_t32_g34813 + (-((cse_p63_t1_g35025 * vz1)))))));
      KernelGradientAcc(i3x1, 2, g_z1);
      g_x2 = (-((cse_p167_t1_g35049 * (cse_p11_t24_g34805 + (-((cse_p218_t1_g35064 * ((-((cse_p1_t2_invsqrt34775 * cse_p529_t3_sqrt35142 * vx1))) + (-((cse_p1_t4_invsqrt34777 * cse_p529_t1_sqrt35140 * vx2)))))))))));
      KernelGradientAcc(i3x2, 0, g_x2);
      g_y2 = (-((cse_p167_t1_g35049 * (cse_p11_t25_g34806 + (-((cse_p218_t1_g35064 * ((-((cse_p1_t2_invsqrt34775 * cse_p529_t3_sqrt35142 * vy1))) + (-((cse_p1_t4_invsqrt34777 * cse_p529_t1_sqrt35140 * vy2)))))))))));
      KernelGradientAcc(i3x2, 1, g_y2);
      g_z2 = (-((cse_p167_t1_g35049 * (cse_p11_t26_g34807 + (-((cse_p218_t1_g35064 * ((-((cse_p1_t2_invsqrt34775 * cse_p529_t3_sqrt35142 * vz1))) + (-((cse_p1_t4_invsqrt34777 * cse_p529_t1_sqrt35140 * vz2)))))))))));
      KernelGradientAcc(i3x2, 2, g_z2);
      cse_p115_t1_g35037 = (cse_p529_t1_sqrt35140 * dot);
      cse_p115_t1_g35038 = (cse_p115_t1_g35037 * cse_p1_t4_invsqrt34777 * cse_p61_t8_invr234992);
      g_x3 = (-((cse_p167_t1_g35049 * (cse_p11_t27_g34808 + (-((cse_p115_t1_g35038 * vx2)))))));
      KernelGradientAcc(i3x3, 0, g_x3);
      g_y3 = (-((cse_p167_t1_g35049 * (cse_p11_t29_g34810 + (-((cse_p115_t1_g35038 * vy2)))))));
      KernelGradientAcc(i3x3, 1, g_y3);
      g_z3 = (-((cse_p167_t1_g35049 * (cse_p11_t31_g34812 + (-((cse_p115_t1_g35038 * vz2)))))));
      KernelGradientAcc(i3x3, 2, g_z3);
      cse_p271_t1_g35086 = (cse_p529_t1_sqrt35140 * cse_p529_t2_invr35141);
      cse_p11_t1_g34982 = (cse_p271_t1_g35086 * cse_p61_t8_invr234992);
      cse_p63_t1_g35010 = (cos_theta * cse_p529_t6_invr35145);
      cse_p63_t1_g35011 = (cse_p61_t10_invsqrt34994 * cse_p62_t1_g34997);
      cse_p63_t1_g35015 = (cse_p529_t1_sqrt35140 * cse_p63_t1_g35012);
      cse_p478_t1_g35139 = (cse_p11_t127_g34908 * cse_p63_t1_g35015);
      cse_p63_t1_g35019 = (cse_p11_t1_g34982 * cse_p529_t2_invr35141 * cse_p63_t1_g35012);
      cse_p63_t1_g35021 = (cse_p271_t1_g35086 * cse_p529_t2_invr35141 * cse_p63_t1_g35013 * cse_p63_t1_g35015);
      cse_p219_t1_g35075 = (cse_p115_t1_g35037 * cse_p219_t1_g35074 * cse_p61_t3_invr234987);
      cse_p220_t1_g35078 = (cse_p11_t133_g34914 * cse_p63_t1_g35010);
      cse_p427_t1_g35129 = (-2.0000000000000000     * cse_p11_t1_g34982);
      h_x1_x1 = (cse_p11_t74_g34855 + cse_p11_t74_g34855 + (-((cse_p63_t1_g35011 * (cse_p11_t158_g34939 + (cse_p11_t133_g34914 * cse_p220_t1_g35078) + (cse_p529_t3_sqrt35142 * vx1 * ((cse_p219_t1_g35075 * vx1) + (cse_p427_t1_g35129 * vx2) + (cse_p63_t1_g35021 * vx1))) + (-((cse_p427_t1_g35120 * cse_p63_t1_g35019))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
      cse_p63_t1_g35016 = (cse_p11_t1_g34982 * cse_p529_t3_sqrt35142);
      cse_p219_t1_g35071 = (cse_p63_t1_g35016 * vx1);
      cse_p219_t1_g35072 = (cse_p63_t1_g35016 * vy1);
      h_x1_y1 = (cse_p11_t76_g34857 + cse_p11_t76_g34857 + (-((cse_p63_t1_g35011 * ((cse_p11_t135_g34916 * cse_p220_t1_g35078) + (cse_p478_t1_g35139 * vx1 * vy1) + (-((cse_p219_t1_g35071 * vy2))) + (-((cse_p219_t1_g35072 * vx2))) + (-((cse_p63_t1_g35019 * vx1 * vy1))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
      cse_p219_t1_g35073 = (cse_p63_t1_g35016 * vz1);
      h_x1_z1 = (cse_p11_t78_g34859 + cse_p11_t78_g34859 + (-((cse_p63_t1_g35011 * ((cse_p11_t137_g34918 * cse_p220_t1_g35078) + (cse_p478_t1_g35139 * vx1 * vz1) + (-((cse_p219_t1_g35071 * vz2))) + (-((cse_p219_t1_g35073 * vx2))) + (-((cse_p63_t1_g35019 * vx1 * vz1))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
      cse_p167_t1_g35048 = (cse_p11_t129_g34910 * cse_p63_t1_g35010);
      cse_p220_t1_g35076 = (cse_p11_t121_g34902 * cse_p63_t1_g35013);
      h_x1_x2 = (cse_p11_t48_g34829 + cse_p11_t48_g34829 + (-((cse_p63_t1_g35011 * (cse_p11_t179_g34960 + (cse_p11_t133_g34914 * cse_p167_t1_g35048) + (cse_p11_t142_g34923 * vx2) + (cse_p11_t1_g34982 * dot * (cse_p11_t105_g34886 + cse_p11_t115_g34896 + cse_p529_t3_sqrt35142)) + (cse_p63_t1_g35015 * vx1 * ((cse_p166_t1_g35045 * cse_p61_t8_invr234992 * vx1) + (cse_p220_t1_g35076 * cse_p529_t2_invr35141))) + (-((cse_p11_t138_g34919 * cse_p219_t1_g35071))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
      cse_p167_t1_g35052 = (cse_p11_t130_g34911 * cse_p63_t1_g35010);
      h_x1_y2 = (cse_p11_t56_g34837 + cse_p11_t56_g34837 + (-((cse_p63_t1_g35011 * ((cse_p115_t1_g35037 * cse_p63_t9_g35006 * vx1) + (cse_p11_t133_g34914 * cse_p167_t1_g35052) + (cse_p11_t143_g34924 * vx2) + (-((cse_p11_t139_g34920 * cse_p219_t1_g35071))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
      cse_p168_t1_g35056 = (cse_p11_t131_g34912 * cse_p63_t1_g35010);
      h_x1_z2 = (cse_p11_t63_g34844 + cse_p11_t63_g34844 + (-((cse_p63_t1_g35011 * ((cse_p115_t1_g35037 * cse_p63_t10_g35007 * vx1) + (cse_p11_t133_g34914 * cse_p168_t1_g35056) + (cse_p11_t144_g34925 * vx2) + (-((cse_p11_t140_g34921 * cse_p219_t1_g35071))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
      cse_p11_t1_g34983 = (cse_p11_t1_g34979 * cse_p529_t2_invr35141);
      cse_p63_t1_g35017 = (cse_p11_t1_g34982 * cse_p529_t4_invr35143 * cse_p63_t1_g35012);
      cse_p63_t1_g35018 = (cse_p11_t1_g34983 * cse_p63_t1_g35013 * cse_p63_t1_g35015);
      cse_p167_t1_g35046 = (cse_p374_t1_g35112 * vx2);
      cse_p219_t1_g35068 = (cse_p11_t132_g34913 * cse_p63_t1_g35010);
      h_x1_x3 = (cse_p11_t69_g34850 + cse_p11_t69_g34850 + (-((cse_p63_t1_g35011 * (cse_p61_t7_invr34991 + (cse_p11_t133_g34914 * cse_p219_t1_g35068) + (cse_p271_t1_g35087 * cse_p63_t1_g35018) + (-((cse_p167_t1_g35046 * vx2))) + (-((cse_p219_t1_g35071 * vx1))) + (-((cse_p271_t1_g35087 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
      cse_p427_t1_g35121 = (vx1 * vy2);
      h_x1_y3 = (cse_p11_t75_g34856 + cse_p11_t75_g34856 + (-((cse_p63_t1_g35011 * (cse_p11_t163_g34944 + cse_p11_t172_g34953 + (cse_p11_t134_g34915 * cse_p220_t1_g35078) + (cse_p427_t1_g35121 * cse_p63_t1_g35018) + (-((cse_p427_t1_g35121 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
      cse_p427_t1_g35122 = (vx1 * vz2);
      h_x1_z3 = (cse_p11_t77_g34858 + cse_p11_t77_g34858 + (-((cse_p63_t1_g35011 * (cse_p11_t165_g34946 + cse_p11_t173_g34954 + (cse_p11_t136_g34917 * cse_p220_t1_g35078) + (cse_p427_t1_g35122 * cse_p63_t1_g35018) + (-((cse_p427_t1_g35122 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
      cse_p428_t1_g35132 = (cse_p11_t135_g34916 * cse_p63_t1_g35010);
      h_y1_y1 = (cse_p11_t83_g34864 + cse_p11_t83_g34864 + (-((cse_p63_t1_g35011 * (cse_p11_t158_g34939 + (cse_p11_t135_g34916 * cse_p428_t1_g35132) + (cse_p529_t3_sqrt35142 * vy1 * ((cse_p219_t1_g35075 * vy1) + (cse_p427_t1_g35129 * vy2) + (cse_p63_t1_g35021 * vy1))) + (-((cse_p427_t1_g35125 * cse_p63_t1_g35019))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
      h_y1_z1 = (cse_p11_t85_g34866 + cse_p11_t85_g34866 + (-((cse_p63_t1_g35011 * ((cse_p11_t137_g34918 * cse_p428_t1_g35132) + (cse_p478_t1_g35139 * vy1 * vz1) + (-((cse_p219_t1_g35072 * vz2))) + (-((cse_p219_t1_g35073 * vy2))) + (-((cse_p63_t1_g35019 * vy1 * vz1))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
      h_y1_x2 = (cse_p11_t50_g34831 + cse_p11_t50_g34831 + (-((cse_p63_t1_g35011 * ((cse_p115_t1_g35037 * cse_p63_t8_g35005 * vy1) + (cse_p11_t135_g34916 * cse_p167_t1_g35048) + (cse_p11_t142_g34923 * vy2) + (-((cse_p11_t138_g34919 * cse_p219_t1_g35072))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
      cse_p272_t1_g35096 = (cse_p11_t122_g34903 * cse_p63_t1_g35013);
      h_y1_y2 = (cse_p11_t58_g34839 + cse_p11_t58_g34839 + (-((cse_p63_t1_g35011 * (cse_p11_t179_g34960 + (cse_p11_t135_g34916 * cse_p167_t1_g35052) + (cse_p11_t143_g34924 * vy2) + (cse_p11_t1_g34982 * dot * (cse_p11_t110_g34891 + cse_p11_t117_g34898 + cse_p529_t3_sqrt35142)) + (cse_p63_t1_g35015 * vy1 * ((cse_p166_t1_g35045 * cse_p61_t8_invr234992 * vy1) + (cse_p272_t1_g35096 * cse_p529_t2_invr35141))) + (-((cse_p11_t139_g34920 * cse_p219_t1_g35072))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
      h_y1_z2 = (cse_p11_t65_g34846 + cse_p11_t65_g34846 + (-((cse_p63_t1_g35011 * ((cse_p115_t1_g35037 * cse_p63_t10_g35007 * vy1) + (cse_p11_t135_g34916 * cse_p168_t1_g35056) + (cse_p11_t144_g34925 * vy2) + (-((cse_p11_t140_g34921 * cse_p219_t1_g35072))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
      cse_p427_t1_g35123 = (vx2 * vy1);
      h_y1_x3 = (cse_p11_t71_g34852 + cse_p11_t71_g34852 + (-((cse_p63_t1_g35011 * (cse_p11_t163_g34944 + cse_p11_t172_g34953 + (cse_p11_t135_g34916 * cse_p219_t1_g35068) + (cse_p427_t1_g35123 * cse_p63_t1_g35018) + (-((cse_p427_t1_g35123 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
      cse_p167_t1_g35050 = (cse_p374_t1_g35112 * vy2);
      cse_p272_t1_g35098 = (cse_p11_t134_g34915 * cse_p63_t1_g35010);
      h_y1_y3 = (cse_p11_t80_g34861 + cse_p11_t80_g34861 + (-((cse_p63_t1_g35011 * (cse_p61_t7_invr34991 + (cse_p11_t135_g34916 * cse_p272_t1_g35098) + (cse_p271_t1_g35091 * cse_p63_t1_g35018) + (-((cse_p167_t1_g35050 * vy2))) + (-((cse_p219_t1_g35072 * vy1))) + (-((cse_p271_t1_g35091 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
      cse_p427_t1_g35126 = (vy1 * vz2);
      h_y1_z3 = (cse_p11_t84_g34865 + cse_p11_t84_g34865 + (-((cse_p63_t1_g35011 * (cse_p11_t168_g34949 + cse_p11_t175_g34956 + (cse_p11_t136_g34917 * cse_p428_t1_g35132) + (cse_p427_t1_g35126 * cse_p63_t1_g35018) + (-((cse_p427_t1_g35126 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
      h_z1_z1 = (cse_p11_t88_g34869 + cse_p11_t88_g34869 + (-((cse_p63_t1_g35011 * (cse_p11_t158_g34939 + (cse_p11_t137_g34918 * cse_p11_t137_g34918 * cse_p63_t1_g35010) + (cse_p529_t3_sqrt35142 * vz1 * ((cse_p219_t1_g35075 * vz1) + (cse_p427_t1_g35129 * vz2) + (cse_p63_t1_g35021 * vz1))) + (-((cse_p427_t1_g35128 * cse_p63_t1_g35019))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
      h_z1_x2 = (cse_p11_t52_g34833 + cse_p11_t52_g34833 + (-((cse_p63_t1_g35011 * ((cse_p115_t1_g35037 * cse_p63_t8_g35005 * vz1) + (cse_p11_t137_g34918 * cse_p167_t1_g35048) + (cse_p11_t142_g34923 * vz2) + (-((cse_p11_t138_g34919 * cse_p219_t1_g35073))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
      h_z1_y2 = (cse_p11_t60_g34841 + cse_p11_t60_g34841 + (-((cse_p63_t1_g35011 * ((cse_p115_t1_g35037 * cse_p63_t9_g35006 * vz1) + (cse_p11_t137_g34918 * cse_p167_t1_g35052) + (cse_p11_t143_g34924 * vz2) + (-((cse_p11_t139_g34920 * cse_p219_t1_g35073))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
      cse_p428_t1_g35130 = (cse_p11_t123_g34904 * cse_p63_t1_g35013);
      h_z1_z2 = (cse_p11_t67_g34848 + cse_p11_t67_g34848 + (-((cse_p63_t1_g35011 * (cse_p11_t179_g34960 + (cse_p11_t137_g34918 * cse_p168_t1_g35056) + (cse_p11_t144_g34925 * vz2) + (cse_p11_t1_g34982 * dot * (cse_p11_t114_g34895 + cse_p11_t119_g34900 + cse_p529_t3_sqrt35142)) + (cse_p63_t1_g35015 * vz1 * ((cse_p166_t1_g35045 * cse_p61_t8_invr234992 * vz1) + (cse_p428_t1_g35130 * cse_p529_t2_invr35141))) + (-((cse_p11_t140_g34921 * cse_p219_t1_g35073))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
      cse_p427_t1_g35124 = (vx2 * vz1);
      h_z1_x3 = (cse_p11_t73_g34854 + cse_p11_t73_g34854 + (-((cse_p63_t1_g35011 * (cse_p11_t165_g34946 + cse_p11_t173_g34954 + (cse_p11_t137_g34918 * cse_p219_t1_g35068) + (cse_p427_t1_g35124 * cse_p63_t1_g35018) + (-((cse_p427_t1_g35124 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
      cse_p427_t1_g35127 = (vy2 * vz1);
      h_z1_y3 = (cse_p11_t82_g34863 + cse_p11_t82_g34863 + (-((cse_p63_t1_g35011 * (cse_p11_t168_g34949 + cse_p11_t175_g34956 + (cse_p11_t137_g34918 * cse_p272_t1_g35098) + (cse_p427_t1_g35127 * cse_p63_t1_g35018) + (-((cse_p427_t1_g35127 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
      cse_p167_t1_g35053 = (cse_p374_t1_g35112 * vz2);
      h_z1_z3 = (cse_p11_t87_g34868 + cse_p11_t87_g34868 + (-((cse_p63_t1_g35011 * (cse_p61_t7_invr34991 + (cse_p11_t136_g34917 * cse_p11_t137_g34918 * cse_p63_t1_g35010) + (cse_p271_t1_g35094 * cse_p63_t1_g35018) + (-((cse_p167_t1_g35053 * vz2))) + (-((cse_p219_t1_g35073 * vz1))) + (-((cse_p271_t1_g35094 * cse_p63_t1_g35017))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
      cse_p219_t1_g35065 = (-2.0000000000000000     * cse_p61_t6_invr234990);
      h_x2_x2 = (cse_p11_t44_g34825 + cse_p11_t44_g34825 + (-((cse_p63_t1_g35011 * (cse_p11_t18_g34799 + (2.0000000000000000     * cse_p11_t138_g34919 * cse_p11_t142_g34923) + (cse_p11_t129_g34910 * cse_p167_t1_g35048) + (dot * ((cse_p11_t121_g34902 * cse_p220_t1_g35076) + (-((cse_p61_t8_invr234992 * (cse_p11_t1_g34979 + cse_p11_t92_g34873 + (cse_p114_t1_g35034 * ((cse_p166_t1_g35045 * cse_p427_t1_g35120) + (cse_p219_t1_g35065 * cse_p271_t1_g35088))) + (cse_p271_t1_g35086 * (cse_p11_t105_g34886 + cse_p11_t115_g34896 + cse_p11_t115_g34896 + cse_p529_t3_sqrt35142)))))))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
      h_x2_y2 = (cse_p11_t45_g34826 + cse_p11_t45_g34826 + (-((cse_p63_t1_g35011 * ((cse_p11_t130_g34911 * cse_p167_t1_g35048) + (cse_p11_t138_g34919 * cse_p11_t143_g34924) + (cse_p11_t139_g34920 * cse_p11_t142_g34923) + (dot * ((cse_p11_t122_g34903 * cse_p220_t1_g35076) + (-((cse_p61_t8_invr234992 * (cse_p11_t94_g34875 + (cse_p114_t1_g35034 * ((cse_p115_t2_g35036 * vx1 * vy1) + (cse_p219_t1_g35065 * cse_p271_t1_g35089))) + (cse_p11_t1_g34983 * (cse_p427_t1_g35121 + cse_p427_t1_g35123)))))))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
      h_x2_z2 = (cse_p11_t46_g34827 + cse_p11_t46_g34827 + (-((cse_p63_t1_g35011 * ((cse_p11_t131_g34912 * cse_p167_t1_g35048) + (cse_p11_t138_g34919 * cse_p11_t144_g34925) + (cse_p11_t140_g34921 * cse_p11_t142_g34923) + (dot * ((cse_p11_t123_g34904 * cse_p220_t1_g35076) + (-((cse_p61_t8_invr234992 * (cse_p11_t96_g34877 + (cse_p114_t1_g35034 * ((cse_p115_t2_g35036 * vx1 * vz1) + (cse_p219_t1_g35065 * cse_p271_t1_g35090))) + (cse_p11_t1_g34983 * (cse_p427_t1_g35122 + cse_p427_t1_g35124)))))))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
      cse_p63_t1_g35022 = (cse_p11_t1_g34979 * cse_p220_t1_g35076);
      h_x2_x3 = (cse_p11_t47_g34828 + cse_p11_t47_g34828 + (-((cse_p63_t1_g35011 * (cse_p11_t179_g34960 + (cse_p11_t132_g34913 * cse_p167_t1_g35048) + (cse_p11_t142_g34923 * vx1) + (dot * ((cse_p63_t1_g35022 * vx2) + (-((cse_p61_t8_invr234992 * (cse_p11_t177_g34958 + (cse_p167_t1_g35054 * cse_p271_t1_g35088) + (-((cse_p11_t1_g34983 * cse_p271_t1_g35087))) + (-(cse_p11_t92_g34873)))))))) + (-((cse_p11_t138_g34919 * cse_p167_t1_g35046))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
      h_x2_y3 = (cse_p11_t49_g34830 + cse_p11_t49_g34830 + (-((cse_p63_t1_g35011 * ((cse_p11_t134_g34915 * cse_p167_t1_g35048) + (cse_p11_t142_g34923 * vy1) + (dot * ((cse_p63_t1_g35022 * vy2) + (-((cse_p61_t8_invr234992 * (cse_p11_t164_g34945 + cse_p11_t20_g34801 + (-((cse_p11_t1_g34983 * cse_p427_t1_g35121))))))))) + (-((cse_p11_t138_g34919 * cse_p167_t1_g35050))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
      h_x2_z3 = (cse_p11_t51_g34832 + cse_p11_t51_g34832 + (-((cse_p63_t1_g35011 * ((cse_p11_t136_g34917 * cse_p167_t1_g35048) + (cse_p11_t142_g34923 * vz1) + (dot * ((cse_p63_t1_g35022 * vz2) + (-((cse_p61_t8_invr234992 * (cse_p11_t166_g34947 + cse_p11_t21_g34802 + (-((cse_p11_t1_g34983 * cse_p427_t1_g35122))))))))) + (-((cse_p11_t138_g34919 * cse_p167_t1_g35053))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
      h_y2_y2 = (cse_p11_t53_g34834 + cse_p11_t53_g34834 + (-((cse_p63_t1_g35011 * (cse_p11_t18_g34799 + (2.0000000000000000     * cse_p11_t139_g34920 * cse_p11_t143_g34924) + (cse_p11_t130_g34911 * cse_p167_t1_g35052) + (dot * ((cse_p11_t122_g34903 * cse_p272_t1_g35096) + (-((cse_p61_t8_invr234992 * (cse_p11_t1_g34979 + cse_p11_t98_g34879 + (cse_p114_t1_g35034 * ((cse_p166_t1_g35045 * cse_p427_t1_g35125) + (cse_p219_t1_g35065 * cse_p271_t1_g35092))) + (cse_p271_t1_g35086 * (cse_p11_t110_g34891 + cse_p11_t117_g34898 + cse_p11_t117_g34898 + cse_p529_t3_sqrt35142)))))))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
      h_y2_z2 = (cse_p11_t54_g34835 + cse_p11_t54_g34835 + (-((cse_p63_t1_g35011 * ((cse_p11_t131_g34912 * cse_p167_t1_g35052) + (cse_p11_t139_g34920 * cse_p11_t144_g34925) + (cse_p11_t140_g34921 * cse_p11_t143_g34924) + (dot * ((cse_p11_t123_g34904 * cse_p272_t1_g35096) + (-((cse_p61_t8_invr234992 * (cse_p11_t100_g34881 + (cse_p114_t1_g35034 * ((cse_p115_t2_g35036 * vy1 * vz1) + (cse_p219_t1_g35065 * cse_p271_t1_g35093))) + (cse_p11_t1_g34983 * (cse_p427_t1_g35126 + cse_p427_t1_g35127)))))))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
      cse_p63_t1_g35023 = (cse_p11_t1_g34979 * cse_p272_t1_g35096);
      h_y2_x3 = (cse_p11_t55_g34836 + cse_p11_t55_g34836 + (-((cse_p63_t1_g35011 * ((cse_p11_t132_g34913 * cse_p167_t1_g35052) + (cse_p11_t143_g34924 * vx1) + (dot * ((cse_p63_t1_g35023 * vx2) + (-((cse_p61_t8_invr234992 * (cse_p11_t164_g34945 + cse_p11_t20_g34801 + (-((cse_p11_t1_g34983 * cse_p427_t1_g35123))))))))) + (-((cse_p11_t139_g34920 * cse_p167_t1_g35046))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
      h_y2_y3 = (cse_p11_t57_g34838 + cse_p11_t57_g34838 + (-((cse_p63_t1_g35011 * (cse_p11_t179_g34960 + (cse_p11_t134_g34915 * cse_p167_t1_g35052) + (cse_p11_t143_g34924 * vy1) + (dot * ((cse_p63_t1_g35023 * vy2) + (-((cse_p61_t8_invr234992 * (cse_p11_t177_g34958 + (cse_p167_t1_g35054 * cse_p271_t1_g35092) + (-((cse_p11_t1_g34983 * cse_p271_t1_g35091))) + (-(cse_p11_t98_g34879)))))))) + (-((cse_p11_t139_g34920 * cse_p167_t1_g35050))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
      h_y2_z3 = (cse_p11_t59_g34840 + cse_p11_t59_g34840 + (-((cse_p63_t1_g35011 * ((cse_p11_t136_g34917 * cse_p167_t1_g35052) + (cse_p11_t143_g34924 * vz1) + (dot * ((cse_p63_t1_g35023 * vz2) + (-((cse_p61_t8_invr234992 * (cse_p11_t169_g34950 + cse_p11_t22_g34803 + (-((cse_p11_t1_g34983 * cse_p427_t1_g35126))))))))) + (-((cse_p11_t139_g34920 * cse_p167_t1_g35053))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
      h_z2_z2 = (cse_p11_t61_g34842 + cse_p11_t61_g34842 + (-((cse_p63_t1_g35011 * (cse_p11_t18_g34799 + (2.0000000000000000     * cse_p11_t140_g34921 * cse_p11_t144_g34925) + (cse_p11_t131_g34912 * cse_p168_t1_g35056) + (dot * ((cse_p11_t123_g34904 * cse_p428_t1_g35130) + (-((cse_p61_t8_invr234992 * (cse_p11_t102_g34883 + cse_p11_t1_g34979 + (cse_p114_t1_g35034 * ((cse_p166_t1_g35045 * cse_p427_t1_g35128) + (cse_p219_t1_g35065 * cse_p271_t1_g35095))) + (cse_p271_t1_g35086 * (cse_p11_t114_g34895 + cse_p11_t119_g34900 + cse_p11_t119_g34900 + cse_p529_t3_sqrt35142)))))))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
      cse_p63_t1_g35024 = (cse_p11_t1_g34979 * cse_p428_t1_g35130);
      h_z2_x3 = (cse_p11_t62_g34843 + cse_p11_t62_g34843 + (-((cse_p63_t1_g35011 * ((cse_p11_t132_g34913 * cse_p168_t1_g35056) + (cse_p11_t144_g34925 * vx1) + (dot * ((cse_p63_t1_g35024 * vx2) + (-((cse_p61_t8_invr234992 * (cse_p11_t166_g34947 + cse_p11_t21_g34802 + (-((cse_p11_t1_g34983 * cse_p427_t1_g35124))))))))) + (-((cse_p11_t140_g34921 * cse_p167_t1_g35046))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
      h_z2_y3 = (cse_p11_t64_g34845 + cse_p11_t64_g34845 + (-((cse_p63_t1_g35011 * ((cse_p11_t134_g34915 * cse_p168_t1_g35056) + (cse_p11_t144_g34925 * vy1) + (dot * ((cse_p63_t1_g35024 * vy2) + (-((cse_p61_t8_invr234992 * (cse_p11_t169_g34950 + cse_p11_t22_g34803 + (-((cse_p11_t1_g34983 * cse_p427_t1_g35127))))))))) + (-((cse_p11_t140_g34921 * cse_p167_t1_g35050))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
      h_z2_z3 = (cse_p11_t66_g34847 + cse_p11_t66_g34847 + (-((cse_p63_t1_g35011 * (cse_p11_t179_g34960 + (cse_p11_t136_g34917 * cse_p168_t1_g35056) + (cse_p11_t144_g34925 * vz1) + (dot * ((cse_p63_t1_g35024 * vz2) + (-((cse_p61_t8_invr234992 * (cse_p11_t177_g34958 + (cse_p167_t1_g35054 * cse_p271_t1_g35095) + (-((cse_p11_t1_g34983 * cse_p271_t1_g35094))) + (-(cse_p11_t102_g34883)))))))) + (-((cse_p11_t140_g34921 * cse_p167_t1_g35053))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
      cse_p219_t1_g35066 = (cse_p11_t128_g34909 * cse_p63_t1_g35015);
      cse_p219_t1_g35070 = (cse_p529_t4_invr35143 * dot);
      h_x3_x3 = (cse_p11_t68_g34849 + cse_p11_t68_g34849 + (-((cse_p63_t1_g35011 * (cse_p11_t154_g34935 + (-2.0000000000000000     * cse_p167_t1_g35046 * vx1) + (cse_p11_t132_g34913 * cse_p219_t1_g35068) + (cse_p219_t1_g35066 * cse_p271_t1_g35088) + (-((cse_p167_t1_g35046 * cse_p219_t1_g35070 * vx2))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
      h_x3_y3 = (cse_p11_t70_g34851 + cse_p11_t70_g34851 + (-((cse_p63_t1_g35011 * ((cse_p11_t134_g34915 * cse_p219_t1_g35068) + (cse_p219_t1_g35066 * cse_p271_t1_g35089) + (-((cse_p167_t1_g35046 * cse_p219_t1_g35070 * vy2))) + (-((cse_p167_t1_g35046 * vy1))) + (-((cse_p167_t1_g35050 * vx1))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
      h_x3_z3 = (cse_p11_t72_g34853 + cse_p11_t72_g34853 + (-((cse_p63_t1_g35011 * ((cse_p11_t136_g34917 * cse_p219_t1_g35068) + (cse_p219_t1_g35066 * cse_p271_t1_g35090) + (-((cse_p167_t1_g35046 * cse_p219_t1_g35070 * vz2))) + (-((cse_p167_t1_g35046 * vz1))) + (-((cse_p167_t1_g35053 * vx1))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
      h_y3_y3 = (cse_p11_t79_g34860 + cse_p11_t79_g34860 + (-((cse_p63_t1_g35011 * (cse_p11_t154_g34935 + (-2.0000000000000000     * cse_p167_t1_g35050 * vy1) + (cse_p11_t134_g34915 * cse_p272_t1_g35098) + (cse_p219_t1_g35066 * cse_p271_t1_g35092) + (-((cse_p167_t1_g35050 * cse_p219_t1_g35070 * vy2))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
      h_y3_z3 = (cse_p11_t81_g34862 + cse_p11_t81_g34862 + (-((cse_p63_t1_g35011 * ((cse_p11_t136_g34917 * cse_p272_t1_g35098) + (cse_p219_t1_g35066 * cse_p271_t1_g35093) + (-((cse_p167_t1_g35050 * cse_p219_t1_g35070 * vz2))) + (-((cse_p167_t1_g35050 * vz1))) + (-((cse_p167_t1_g35053 * vy1))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
      h_z3_z3 = (cse_p11_t86_g34867 + cse_p11_t86_g34867 + (-((cse_p63_t1_g35011 * (cse_p11_t154_g34935 + (-2.0000000000000000     * cse_p167_t1_g35053 * vz1) + (cse_p11_t136_g34917 * cse_p11_t136_g34917 * cse_p63_t1_g35010) + (cse_p219_t1_g35066 * cse_p271_t1_g35095) + (-((cse_p167_t1_g35053 * cse_p219_t1_g35070 * vz2))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
    }
  }
  return energy_added;
}
void hessian_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 9;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(kt, t0, i3x1, i3x2, i3x3, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
}

};
