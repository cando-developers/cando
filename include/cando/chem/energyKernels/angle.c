template <typename HESSIAN>
struct Angle {
  static constexpr size_t PositionSize = 9;
  static std::string description() { return "mathkernel-angle"; };
void energy(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double cos_theta;
  double cse_p11_t1_g387;
  double cse_p11_t2_g388;
  double cse_p11_t3_g389;
  double dot;
  double dtheta;
  double energy;
  double n1;
  double n1_sq;
  double n2;
  double n2_sq;
  double sin_theta;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  {
    /* !BASE */
    cse_p11_t1_g387 = (-(x2));
    cse_p11_t2_g388 = (-(y2));
    cse_p11_t3_g389 = (-(z2));
    vx1 = (cse_p11_t1_g387 + x1);
    vy1 = (cse_p11_t2_g388 + y1);
    vz1 = (cse_p11_t3_g389 + z1);
    vx2 = (cse_p11_t1_g387 + x3);
    vy2 = (cse_p11_t2_g388 + y3);
    vz2 = (cse_p11_t3_g389 + z3);
    dot = ((vx1 * vx2) + (vy1 * vy2) + (vz1 * vz2));
    n1_sq = ((vx1 * vx1) + (vy1 * vy1) + (vz1 * vz1));
    n2_sq = ((vx2 * vx2) + (vy2 * vy2) + (vz2 * vz2));
    n1 = sqrt(n1_sq);
    n2 = sqrt(n2_sq);
    cos_theta = (dot * (1.0 / ((n1 * n2))));
    if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
    sin_theta = sqrt((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))));
    theta = acos(cos_theta);
    dtheta = (theta + (-(t0)));
    energy = (dtheta * dtheta * kt);
    *energy_accumulate += energy;
  }
}
void energy_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(kt, t0, i3x1, i3x2, i3x3, position, energy_accumulate, force, hessian, dvec, hdvec);
}

void gradient(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double cos_theta;
  double cse_p113_t1_g409;
  double cse_p11_t1_g398;
  double cse_p11_t1_g401;
  double cse_p11_t1_g402;
  double cse_p11_t1_g403;
  double cse_p11_t1_g405;
  double cse_p11_t1_g406;
  double cse_p11_t1_g407;
  double cse_p11_t2_g399;
  double cse_p11_t3_g400;
  double cse_p1_t1_sqrt390;
  double cse_p1_t2_invsqrt391;
  double cse_p1_t3_sqrt392;
  double cse_p1_t4_invsqrt393;
  double cse_p1_t5_invr394;
  double cse_p1_t6_invr2395;
  double cse_p1_t7_sqrt396;
  double cse_p1_t8_invsqrt397;
  double cse_p62_t1_g408;
  double dot;
  double dtheta;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_z1;
  double g_z2;
  double g_z3;
  double n1_sq;
  double n2_sq;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  {
    /* !BASE */
    cse_p11_t1_g398 = (-(x2));
    cse_p11_t2_g399 = (-(y2));
    cse_p11_t3_g400 = (-(z2));
    vx1 = (cse_p11_t1_g398 + x1);
    vy1 = (cse_p11_t2_g399 + y1);
    vz1 = (cse_p11_t3_g400 + z1);
    vx2 = (cse_p11_t1_g398 + x3);
    vy2 = (cse_p11_t2_g399 + y3);
    vz2 = (cse_p11_t3_g400 + z3);
    dot = ((vx1 * vx2) + (vy1 * vy2) + (vz1 * vz2));
    n1_sq = ((vx1 * vx1) + (vy1 * vy1) + (vz1 * vz1));
    n2_sq = ((vx2 * vx2) + (vy2 * vy2) + (vz2 * vz2));
    cse_p1_t1_sqrt390 = sqrt(n1_sq);
    cse_p1_t2_invsqrt391 = (1.0 / (cse_p1_t1_sqrt390));
    cse_p1_t3_sqrt392 = sqrt(n2_sq);
    cse_p1_t4_invsqrt393 = (1.0 / (cse_p1_t3_sqrt392));
    cse_p1_t5_invr394 = (1.0 / ((cse_p1_t1_sqrt390 * cse_p1_t3_sqrt392)));
    cse_p1_t6_invr2395 = (cse_p1_t5_invr394 * cse_p1_t5_invr394);
    cse_p113_t1_g409 = (cse_p1_t6_invr2395 * dot);
    cos_theta = (cse_p1_t5_invr394 * dot);
    if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
    cse_p1_t7_sqrt396 = sqrt((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))));
    cse_p1_t8_invsqrt397 = (1.0 / (cse_p1_t7_sqrt396));
    theta = acos(cos_theta);
    dtheta = (theta + (-(t0)));
    cse_p11_t1_g407 = (dtheta * kt);
    energy = (cse_p11_t1_g407 * dtheta);
    *energy_accumulate += energy;
    cse_p11_t1_g401 = (2.0000000000000000     * cse_p11_t1_g407);
    cse_p11_t1_g402 = (cse_p1_t2_invsqrt391 * cse_p1_t3_sqrt392);
    cse_p11_t1_g405 = (cse_p113_t1_g409 * cse_p11_t1_g402);
    cse_p62_t1_g408 = (cse_p11_t1_g401 * cse_p1_t8_invsqrt397);
    g_x1 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * vx2) + (-((cse_p11_t1_g405 * vx1)))))));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * vy2) + (-((cse_p11_t1_g405 * vy1)))))));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * vz2) + (-((cse_p11_t1_g405 * vz1)))))));
    KernelGradientAcc(i3x1, 2, g_z1);
    cse_p11_t1_g403 = (cse_p1_t1_sqrt390 * cse_p1_t4_invsqrt393);
    g_x2 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * ((-(vx1)) + (-(vx2)))) + (-((cse_p113_t1_g409 * ((-((cse_p11_t1_g402 * vx1))) + (-((cse_p11_t1_g403 * vx2)))))))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * ((-(vy1)) + (-(vy2)))) + (-((cse_p113_t1_g409 * ((-((cse_p11_t1_g402 * vy1))) + (-((cse_p11_t1_g403 * vy2)))))))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * ((-(vz1)) + (-(vz2)))) + (-((cse_p113_t1_g409 * ((-((cse_p11_t1_g402 * vz1))) + (-((cse_p11_t1_g403 * vz2)))))))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    cse_p11_t1_g406 = (cse_p113_t1_g409 * cse_p11_t1_g403);
    g_x3 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * vx1) + (-((cse_p11_t1_g406 * vx2)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * vy1) + (-((cse_p11_t1_g406 * vy2)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (-((cse_p62_t1_g408 * ((cse_p1_t5_invr394 * vz1) + (-((cse_p11_t1_g406 * vz2)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
  }
}
void gradient_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 9;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(kt, t0, i3x1, i3x2, i3x3, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
}

void hessian(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double cos_theta;
  double cse_p114_t1_g670;
  double cse_p115_t1_g673;
  double cse_p115_t1_g674;
  double cse_p115_t2_g672;
  double cse_p11_t100_g517;
  double cse_p11_t101_g518;
  double cse_p11_t102_g519;
  double cse_p11_t103_g520;
  double cse_p11_t105_g522;
  double cse_p11_t106_g523;
  double cse_p11_t107_g524;
  double cse_p11_t108_g525;
  double cse_p11_t10_g427;
  double cse_p11_t110_g527;
  double cse_p11_t111_g528;
  double cse_p11_t112_g529;
  double cse_p11_t114_g531;
  double cse_p11_t115_g532;
  double cse_p11_t116_g533;
  double cse_p11_t117_g534;
  double cse_p11_t118_g535;
  double cse_p11_t119_g536;
  double cse_p11_t11_g428;
  double cse_p11_t120_g537;
  double cse_p11_t121_g538;
  double cse_p11_t122_g539;
  double cse_p11_t123_g540;
  double cse_p11_t124_g541;
  double cse_p11_t125_g542;
  double cse_p11_t126_g543;
  double cse_p11_t127_g544;
  double cse_p11_t128_g545;
  double cse_p11_t129_g546;
  double cse_p11_t12_g429;
  double cse_p11_t130_g547;
  double cse_p11_t131_g548;
  double cse_p11_t132_g549;
  double cse_p11_t133_g550;
  double cse_p11_t134_g551;
  double cse_p11_t135_g552;
  double cse_p11_t136_g553;
  double cse_p11_t137_g554;
  double cse_p11_t138_g555;
  double cse_p11_t139_g556;
  double cse_p11_t13_g430;
  double cse_p11_t140_g557;
  double cse_p11_t141_g558;
  double cse_p11_t142_g559;
  double cse_p11_t143_g560;
  double cse_p11_t144_g561;
  double cse_p11_t145_g562;
  double cse_p11_t146_g563;
  double cse_p11_t147_g564;
  double cse_p11_t148_g565;
  double cse_p11_t149_g566;
  double cse_p11_t14_g431;
  double cse_p11_t150_g567;
  double cse_p11_t151_g568;
  double cse_p11_t152_g569;
  double cse_p11_t153_g570;
  double cse_p11_t154_g571;
  double cse_p11_t155_g572;
  double cse_p11_t156_g573;
  double cse_p11_t157_g574;
  double cse_p11_t158_g575;
  double cse_p11_t159_g576;
  double cse_p11_t15_g432;
  double cse_p11_t160_g577;
  double cse_p11_t161_g578;
  double cse_p11_t162_g579;
  double cse_p11_t163_g580;
  double cse_p11_t164_g581;
  double cse_p11_t165_g582;
  double cse_p11_t166_g583;
  double cse_p11_t167_g584;
  double cse_p11_t168_g585;
  double cse_p11_t169_g586;
  double cse_p11_t16_g433;
  double cse_p11_t170_g587;
  double cse_p11_t171_g588;
  double cse_p11_t172_g589;
  double cse_p11_t173_g590;
  double cse_p11_t174_g591;
  double cse_p11_t175_g592;
  double cse_p11_t176_g593;
  double cse_p11_t177_g594;
  double cse_p11_t178_g595;
  double cse_p11_t179_g596;
  double cse_p11_t17_g434;
  double cse_p11_t180_g597;
  double cse_p11_t181_g598;
  double cse_p11_t182_g599;
  double cse_p11_t183_g600;
  double cse_p11_t184_g601;
  double cse_p11_t185_g602;
  double cse_p11_t186_g603;
  double cse_p11_t187_g604;
  double cse_p11_t188_g605;
  double cse_p11_t18_g435;
  double cse_p11_t193_g610;
  double cse_p11_t19_g436;
  double cse_p11_t1_g418;
  double cse_p11_t1_g615;
  double cse_p11_t1_g616;
  double cse_p11_t1_g618;
  double cse_p11_t1_g619;
  double cse_p11_t20_g437;
  double cse_p11_t21_g438;
  double cse_p11_t22_g439;
  double cse_p11_t23_g440;
  double cse_p11_t24_g441;
  double cse_p11_t25_g442;
  double cse_p11_t26_g443;
  double cse_p11_t27_g444;
  double cse_p11_t28_g445;
  double cse_p11_t29_g446;
  double cse_p11_t2_g419;
  double cse_p11_t30_g447;
  double cse_p11_t31_g448;
  double cse_p11_t32_g449;
  double cse_p11_t33_g450;
  double cse_p11_t34_g451;
  double cse_p11_t35_g452;
  double cse_p11_t37_g454;
  double cse_p11_t38_g455;
  double cse_p11_t39_g456;
  double cse_p11_t3_g420;
  double cse_p11_t40_g457;
  double cse_p11_t41_g458;
  double cse_p11_t42_g459;
  double cse_p11_t43_g460;
  double cse_p11_t44_g461;
  double cse_p11_t45_g462;
  double cse_p11_t46_g463;
  double cse_p11_t47_g464;
  double cse_p11_t48_g465;
  double cse_p11_t49_g466;
  double cse_p11_t4_g421;
  double cse_p11_t50_g467;
  double cse_p11_t51_g468;
  double cse_p11_t52_g469;
  double cse_p11_t53_g470;
  double cse_p11_t54_g471;
  double cse_p11_t55_g472;
  double cse_p11_t56_g473;
  double cse_p11_t57_g474;
  double cse_p11_t58_g475;
  double cse_p11_t59_g476;
  double cse_p11_t5_g422;
  double cse_p11_t60_g477;
  double cse_p11_t61_g478;
  double cse_p11_t62_g479;
  double cse_p11_t63_g480;
  double cse_p11_t64_g481;
  double cse_p11_t65_g482;
  double cse_p11_t66_g483;
  double cse_p11_t67_g484;
  double cse_p11_t68_g485;
  double cse_p11_t69_g486;
  double cse_p11_t6_g423;
  double cse_p11_t70_g487;
  double cse_p11_t71_g488;
  double cse_p11_t72_g489;
  double cse_p11_t73_g490;
  double cse_p11_t74_g491;
  double cse_p11_t75_g492;
  double cse_p11_t76_g493;
  double cse_p11_t77_g494;
  double cse_p11_t78_g495;
  double cse_p11_t79_g496;
  double cse_p11_t7_g424;
  double cse_p11_t80_g497;
  double cse_p11_t81_g498;
  double cse_p11_t82_g499;
  double cse_p11_t83_g500;
  double cse_p11_t84_g501;
  double cse_p11_t85_g502;
  double cse_p11_t86_g503;
  double cse_p11_t87_g504;
  double cse_p11_t88_g505;
  double cse_p11_t8_g425;
  double cse_p11_t91_g508;
  double cse_p11_t92_g509;
  double cse_p11_t93_g510;
  double cse_p11_t94_g511;
  double cse_p11_t95_g512;
  double cse_p11_t96_g513;
  double cse_p11_t97_g514;
  double cse_p11_t98_g515;
  double cse_p11_t99_g516;
  double cse_p11_t9_g426;
  double cse_p166_t1_g681;
  double cse_p167_t1_g682;
  double cse_p167_t1_g683;
  double cse_p167_t1_g684;
  double cse_p167_t1_g685;
  double cse_p167_t1_g686;
  double cse_p167_t1_g687;
  double cse_p167_t1_g688;
  double cse_p167_t1_g689;
  double cse_p167_t1_g690;
  double cse_p167_t1_g691;
  double cse_p168_t1_g692;
  double cse_p168_t1_g693;
  double cse_p1_t2_invsqrt411;
  double cse_p1_t4_invsqrt413;
  double cse_p1_t8_invsqrt417;
  double cse_p218_t1_g700;
  double cse_p219_t1_g701;
  double cse_p219_t1_g702;
  double cse_p219_t1_g703;
  double cse_p219_t1_g704;
  double cse_p219_t1_g705;
  double cse_p219_t1_g706;
  double cse_p219_t1_g707;
  double cse_p219_t1_g708;
  double cse_p219_t1_g709;
  double cse_p219_t1_g710;
  double cse_p219_t1_g711;
  double cse_p220_t1_g712;
  double cse_p220_t1_g713;
  double cse_p220_t1_g714;
  double cse_p270_t1_g721;
  double cse_p271_t1_g722;
  double cse_p271_t1_g723;
  double cse_p271_t1_g724;
  double cse_p271_t1_g725;
  double cse_p271_t1_g726;
  double cse_p271_t1_g727;
  double cse_p271_t1_g728;
  double cse_p271_t1_g729;
  double cse_p271_t1_g730;
  double cse_p271_t1_g731;
  double cse_p272_t1_g732;
  double cse_p272_t1_g733;
  double cse_p272_t1_g734;
  double cse_p322_t1_g741;
  double cse_p374_t1_g748;
  double cse_p426_t1_g755;
  double cse_p427_t1_g756;
  double cse_p427_t1_g757;
  double cse_p427_t1_g758;
  double cse_p427_t1_g759;
  double cse_p427_t1_g760;
  double cse_p427_t1_g761;
  double cse_p427_t1_g762;
  double cse_p427_t1_g763;
  double cse_p427_t1_g764;
  double cse_p427_t1_g765;
  double cse_p428_t1_g766;
  double cse_p428_t1_g767;
  double cse_p428_t1_g768;
  double cse_p478_t1_g775;
  double cse_p529_t1_sqrt776;
  double cse_p529_t2_invr777;
  double cse_p529_t3_sqrt778;
  double cse_p529_t4_invr779;
  double cse_p529_t5_sqrt780;
  double cse_p529_t6_invr781;
  double cse_p530_t1_g782;
  double cse_p61_t10_invsqrt630;
  double cse_p61_t3_invr2623;
  double cse_p61_t6_invr2626;
  double cse_p61_t7_invr627;
  double cse_p61_t8_invr2628;
  double cse_p61_t9_invr3629;
  double cse_p62_t1_g633;
  double cse_p63_t10_g643;
  double cse_p63_t1_g634;
  double cse_p63_t1_g645;
  double cse_p63_t1_g646;
  double cse_p63_t1_g647;
  double cse_p63_t1_g648;
  double cse_p63_t1_g649;
  double cse_p63_t1_g651;
  double cse_p63_t1_g652;
  double cse_p63_t1_g653;
  double cse_p63_t1_g654;
  double cse_p63_t1_g655;
  double cse_p63_t1_g656;
  double cse_p63_t1_g657;
  double cse_p63_t1_g658;
  double cse_p63_t1_g659;
  double cse_p63_t1_g660;
  double cse_p63_t1_g661;
  double cse_p63_t1_g662;
  double cse_p63_t2_g635;
  double cse_p63_t3_g636;
  double cse_p63_t5_g638;
  double cse_p63_t6_g639;
  double cse_p63_t7_g640;
  double cse_p63_t8_g641;
  double cse_p63_t9_g642;
  double cse_p64_t1_g663;
  double dot;
  double dtheta;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_z1;
  double g_z2;
  double g_z3;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_z2;
  double h_x2_z3;
  double h_x3_x3;
  double h_x3_y3;
  double h_x3_z3;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y2_x3;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_z2;
  double h_y2_z3;
  double h_y3_y3;
  double h_y3_z3;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z2_x3;
  double h_z2_y3;
  double h_z2_z2;
  double h_z2_z3;
  double h_z3_z3;
  double n1_sq;
  double n2_sq;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  {
    /* !BASE */
    cse_p11_t186_g603 = (-(x2));
    cse_p11_t187_g604 = (-(y2));
    cse_p11_t188_g605 = (-(z2));
    vx1 = (cse_p11_t186_g603 + x1);
    cse_p11_t180_g597 = (-(vx1));
    vy1 = (cse_p11_t187_g604 + y1);
    cse_p11_t182_g599 = (-(vy1));
    vz1 = (cse_p11_t188_g605 + z1);
    cse_p11_t184_g601 = (-(vz1));
    vx2 = (cse_p11_t186_g603 + x3);
    cse_p11_t138_g555 = (cse_p11_t180_g597 + (-(vx2)));
    cse_p11_t181_g598 = (-(vx2));
    vy2 = (cse_p11_t187_g604 + y3);
    cse_p11_t139_g556 = (cse_p11_t182_g599 + (-(vy2)));
    cse_p11_t183_g600 = (-(vy2));
    vz2 = (cse_p11_t188_g605 + z3);
    cse_p11_t140_g557 = (cse_p11_t184_g601 + (-(vz2)));
    cse_p11_t185_g602 = (-(vz2));
    cse_p271_t1_g723 = (vx1 * vx2);
    cse_p271_t1_g727 = (vy1 * vy2);
    cse_p271_t1_g730 = (vz1 * vz2);
    dot = (cse_p271_t1_g723 + cse_p271_t1_g727 + cse_p271_t1_g730);
    cse_p427_t1_g756 = (vx1 * vx1);
    cse_p427_t1_g761 = (vy1 * vy1);
    cse_p427_t1_g764 = (vz1 * vz1);
    n1_sq = (cse_p427_t1_g756 + cse_p427_t1_g761 + cse_p427_t1_g764);
    cse_p529_t1_sqrt776 = sqrt(n1_sq);
    cse_p529_t2_invr777 = (1.0 / (n1_sq));
    cse_p61_t3_invr2623 = (cse_p529_t2_invr777 * cse_p529_t2_invr777);
    cse_p166_t1_g681 = (-2.0000000000000000     * cse_p61_t3_invr2623);
    cse_p115_t2_g672 = (cse_p166_t1_g681 + cse_p61_t3_invr2623);
    cse_p271_t1_g724 = (vx2 * vx2);
    cse_p271_t1_g728 = (vy2 * vy2);
    cse_p271_t1_g731 = (vz2 * vz2);
    n2_sq = (cse_p271_t1_g724 + cse_p271_t1_g728 + cse_p271_t1_g731);
    cse_p529_t3_sqrt778 = sqrt(n2_sq);
    cse_p529_t4_invr779 = (1.0 / (n2_sq));
    cse_p114_t1_g670 = (cse_p529_t1_sqrt776 * cse_p529_t3_sqrt778);
    cse_p61_t6_invr2626 = (cse_p529_t4_invr779 * cse_p529_t4_invr779);
    cse_p11_t115_g532 = (cse_p271_t1_g723 * cse_p529_t3_sqrt778 * cse_p529_t4_invr779);
    cse_p219_t1_g705 = (cse_p529_t2_invr777 * cse_p529_t3_sqrt778);
    cse_p64_t1_g663 = (cse_p219_t1_g705 * cse_p529_t4_invr779);
    cse_p11_t116_g533 = (cse_p64_t1_g663 * vx2);
    cse_p11_t117_g534 = (cse_p271_t1_g727 * cse_p529_t3_sqrt778 * cse_p529_t4_invr779);
    cse_p11_t118_g535 = (cse_p64_t1_g663 * vy2);
    cse_p11_t119_g536 = (cse_p271_t1_g730 * cse_p529_t3_sqrt778 * cse_p529_t4_invr779);
    cse_p11_t120_g537 = (cse_p64_t1_g663 * vz2);
    cse_p1_t2_invsqrt411 = (1.0 / (cse_p529_t1_sqrt776));
    cse_p167_t1_g690 = (2.0000000000000000     * cse_p114_t1_g670 * cse_p61_t6_invr2626);
    cse_p271_t1_g725 = (vx2 * vy2);
    cse_p11_t20_g437 = (cse_p167_t1_g690 * cse_p271_t1_g725);
    cse_p271_t1_g726 = (vx2 * vz2);
    cse_p11_t21_g438 = (cse_p167_t1_g690 * cse_p271_t1_g726);
    cse_p271_t1_g729 = (vy2 * vz2);
    cse_p11_t22_g439 = (cse_p167_t1_g690 * cse_p271_t1_g729);
    cse_p11_t1_g615 = (cse_p114_t1_g670 * cse_p529_t4_invr779);
    cse_p11_t91_g508 = (cse_p11_t1_g615 * vx2);
    cse_p168_t1_g693 = (cse_p11_t1_g615 * cse_p529_t4_invr779);
    cse_p11_t92_g509 = (cse_p168_t1_g693 * cse_p271_t1_g724);
    cse_p11_t94_g511 = (cse_p168_t1_g693 * cse_p271_t1_g725);
    cse_p11_t96_g513 = (cse_p168_t1_g693 * cse_p271_t1_g726);
    cse_p11_t97_g514 = (cse_p11_t1_g615 * vy2);
    cse_p11_t98_g515 = (cse_p168_t1_g693 * cse_p271_t1_g728);
    cse_p11_t100_g517 = (cse_p168_t1_g693 * cse_p271_t1_g729);
    cse_p11_t101_g518 = (cse_p11_t1_g615 * vz2);
    cse_p11_t102_g519 = (cse_p168_t1_g693 * cse_p271_t1_g731);
    cse_p11_t162_g579 = (-(cse_p11_t91_g508));
    cse_p11_t164_g581 = (-(cse_p11_t94_g511));
    cse_p11_t166_g583 = (-(cse_p11_t96_g513));
    cse_p11_t167_g584 = (-(cse_p11_t97_g514));
    cse_p11_t169_g586 = (-(cse_p11_t100_g517));
    cse_p11_t170_g587 = (-(cse_p11_t101_g518));
    cse_p11_t177_g594 = (-(cse_p11_t1_g615));
    cse_p1_t4_invsqrt413 = (1.0 / (cse_p529_t3_sqrt778));
    cse_p11_t1_g616 = (cse_p114_t1_g670 * cse_p529_t2_invr777);
    cse_p530_t1_g782 = (cse_p11_t1_g616 * vz1);
    cse_p426_t1_g755 = (cse_p11_t1_g616 * vy1);
    cse_p270_t1_g721 = (cse_p11_t1_g616 * vx1);
    cse_p61_t7_invr627 = (1.0 / (cse_p114_t1_g670));
    cse_p61_t8_invr2628 = (cse_p61_t7_invr627 * cse_p61_t7_invr627);
    cse_p374_t1_g748 = (cse_p11_t1_g615 * cse_p61_t8_invr2628);
    cse_p218_t1_g700 = (cse_p61_t8_invr2628 * dot);
    cse_p322_t1_g741 = (cse_p11_t1_g615 * cse_p218_t1_g700);
    cse_p61_t9_invr3629 = (cse_p61_t7_invr627 * cse_p61_t8_invr2628);
    cse_p11_t1_g418 = (cse_p61_t8_invr2628 * (cse_p11_t162_g579 + (-(cse_p270_t1_g721))));
    cse_p11_t2_g419 = (cse_p61_t8_invr2628 * (cse_p11_t167_g584 + (-(cse_p426_t1_g755))));
    cse_p11_t3_g420 = (cse_p61_t8_invr2628 * (cse_p11_t170_g587 + (-(cse_p530_t1_g782))));
    cse_p11_t13_g430 = (cse_p166_t1_g681 * cse_p529_t3_sqrt778 * vx1);
    cse_p11_t14_g431 = (cse_p166_t1_g681 * cse_p529_t3_sqrt778 * vy1);
    cse_p11_t15_g432 = (cse_p166_t1_g681 * cse_p529_t3_sqrt778 * vz1);
    cse_p219_t1_g710 = (2.0000000000000000     * cse_p61_t8_invr2628);
    cse_p11_t16_g433 = (cse_p219_t1_g710 * cse_p61_t3_invr2623);
    cse_p11_t17_g434 = (cse_p219_t1_g710 * cse_p61_t6_invr2626);
    cse_p63_t1_g649 = (2.0000000000000000     * cse_p61_t9_invr3629);
    cse_p11_t19_g436 = (cse_p168_t1_g693 * cse_p63_t1_g649);
    cse_p11_t23_g440 = (cse_p11_t1_g616 * cse_p529_t2_invr777 * cse_p63_t1_g649);
    cse_p11_t33_g450 = (dot * (-(cse_p11_t1_g418)));
    cse_p11_t34_g451 = (dot * (-(cse_p11_t2_g419)));
    cse_p11_t35_g452 = (dot * (-(cse_p11_t3_g420)));
    cse_p11_t37_g454 = (cse_p322_t1_g741 * vx2);
    cse_p11_t38_g455 = (cse_p322_t1_g741 * vy2);
    cse_p11_t39_g456 = (cse_p322_t1_g741 * vz2);
    cse_p11_t40_g457 = (cse_p11_t1_g616 * cse_p218_t1_g700);
    cse_p11_t41_g458 = (cse_p218_t1_g700 * cse_p270_t1_g721);
    cse_p11_t42_g459 = (cse_p218_t1_g700 * cse_p426_t1_g755);
    cse_p11_t43_g460 = (cse_p218_t1_g700 * cse_p530_t1_g782);
    cse_p11_t93_g510 = (cse_p271_t1_g725 * cse_p374_t1_g748);
    cse_p11_t95_g512 = (cse_p271_t1_g726 * cse_p374_t1_g748);
    cse_p11_t99_g516 = (cse_p271_t1_g729 * cse_p374_t1_g748);
    cse_p63_t1_g662 = (cse_p219_t1_g705 * cse_p529_t2_invr777);
    cse_p11_t103_g520 = (cse_p63_t1_g662 * vx1);
    cse_p11_t105_g522 = (cse_p219_t1_g705 * cse_p427_t1_g756);
    cse_p11_t106_g523 = (cse_p270_t1_g721 * cse_p61_t8_invr2628 * vy1);
    cse_p11_t107_g524 = (cse_p270_t1_g721 * cse_p61_t8_invr2628 * vz1);
    cse_p11_t108_g525 = (cse_p63_t1_g662 * vy1);
    cse_p11_t110_g527 = (cse_p219_t1_g705 * cse_p427_t1_g761);
    cse_p11_t111_g528 = (cse_p426_t1_g755 * cse_p61_t8_invr2628 * vz1);
    cse_p11_t112_g529 = (cse_p63_t1_g662 * vz1);
    cse_p11_t114_g531 = (cse_p219_t1_g705 * cse_p427_t1_g764);
    cse_p11_t121_g538 = (cse_p11_t162_g579 + (-(cse_p270_t1_g721)));
    cse_p63_t1_g656 = (cse_p219_t1_g705 * cse_p63_t1_g649);
    cse_p63_t1_g634 = (cse_p11_t121_g538 * cse_p63_t1_g656);
    cse_p11_t122_g539 = (cse_p11_t167_g584 + (-(cse_p426_t1_g755)));
    cse_p63_t2_g635 = (cse_p11_t122_g539 * cse_p63_t1_g656);
    cse_p11_t123_g540 = (cse_p11_t170_g587 + (-(cse_p530_t1_g782)));
    cse_p63_t3_g636 = (cse_p11_t123_g540 * cse_p63_t1_g656);
    cse_p11_t124_g541 = (cse_p11_t103_g520 + cse_p11_t116_g533 + cse_p11_t13_g430);
    cse_p63_t5_g638 = (cse_p11_t124_g541 * cse_p61_t8_invr2628);
    cse_p63_t8_g641 = (cse_p63_t1_g634 + cse_p63_t5_g638);
    cse_p11_t125_g542 = (cse_p11_t108_g525 + cse_p11_t118_g535 + cse_p11_t14_g431);
    cse_p63_t6_g639 = (cse_p11_t125_g542 * cse_p61_t8_invr2628);
    cse_p63_t9_g642 = (cse_p63_t2_g635 + cse_p63_t6_g639);
    cse_p11_t126_g543 = (cse_p11_t112_g529 + cse_p11_t120_g537 + cse_p11_t15_g432);
    cse_p63_t7_g640 = (cse_p11_t126_g543 * cse_p61_t8_invr2628);
    cse_p63_t10_g643 = (cse_p63_t3_g636 + cse_p63_t7_g640);
    cse_p11_t127_g544 = (cse_p11_t16_g433 + cse_p11_t23_g440);
    cse_p11_t128_g545 = (cse_p11_t17_g434 + cse_p11_t19_g436);
    cse_p11_t142_g559 = (-((cse_p11_t121_g538 * cse_p61_t8_invr2628)));
    cse_p11_t143_g560 = (-((cse_p11_t122_g539 * cse_p61_t8_invr2628)));
    cse_p11_t144_g561 = (-((cse_p11_t123_g540 * cse_p61_t8_invr2628)));
    cse_p11_t154_g571 = (-(cse_p322_t1_g741));
    cse_p11_t155_g572 = (-(cse_p11_t37_g454));
    cse_p11_t156_g573 = (-(cse_p11_t38_g455));
    cse_p11_t157_g574 = (-(cse_p11_t39_g456));
    cse_p11_t158_g575 = (-(cse_p11_t40_g457));
    cse_p11_t159_g576 = (-(cse_p11_t41_g458));
    cse_p11_t160_g577 = (-(cse_p11_t42_g459));
    cse_p11_t161_g578 = (-(cse_p11_t43_g460));
    cse_p11_t163_g580 = (-(cse_p11_t93_g510));
    cse_p11_t165_g582 = (-(cse_p11_t95_g512));
    cse_p11_t168_g585 = (-(cse_p11_t99_g516));
    cse_p11_t171_g588 = (-(cse_p270_t1_g721));
    cse_p11_t172_g589 = (-(cse_p11_t106_g523));
    cse_p11_t173_g590 = (-(cse_p11_t107_g524));
    cse_p11_t174_g591 = (-(cse_p426_t1_g755));
    cse_p11_t175_g592 = (-(cse_p11_t111_g528));
    cse_p11_t176_g593 = (-(cse_p530_t1_g782));
    cse_p11_t18_g435 = (2.0000000000000000     * cse_p61_t7_invr627);
    cse_p11_t24_g441 = (cse_p61_t7_invr627 * (cse_p11_t180_g597 + cse_p11_t181_g598));
    cse_p11_t25_g442 = (cse_p61_t7_invr627 * (cse_p11_t182_g599 + cse_p11_t183_g600));
    cse_p11_t26_g443 = (cse_p61_t7_invr627 * (cse_p11_t184_g601 + cse_p11_t185_g602));
    cse_p11_t27_g444 = (cse_p61_t7_invr627 * vx1);
    cse_p11_t28_g445 = (cse_p61_t7_invr627 * vx2);
    cse_p11_t29_g446 = (cse_p61_t7_invr627 * vy1);
    cse_p11_t30_g447 = (cse_p61_t7_invr627 * vy2);
    cse_p11_t31_g448 = (cse_p61_t7_invr627 * vz1);
    cse_p11_t32_g449 = (cse_p61_t7_invr627 * vz2);
    cse_p11_t129_g546 = (cse_p11_t24_g441 + (-((cse_p218_t1_g700 * (cse_p11_t162_g579 + cse_p11_t171_g588)))));
    cse_p11_t130_g547 = (cse_p11_t25_g442 + (-((cse_p218_t1_g700 * (cse_p11_t167_g584 + cse_p11_t174_g591)))));
    cse_p11_t131_g548 = (cse_p11_t26_g443 + (-((cse_p218_t1_g700 * (cse_p11_t170_g587 + cse_p11_t176_g593)))));
    cse_p11_t132_g549 = (cse_p11_t155_g572 + cse_p11_t27_g444);
    cse_p11_t133_g550 = (cse_p11_t159_g576 + cse_p11_t28_g445);
    cse_p11_t134_g551 = (cse_p11_t156_g573 + cse_p11_t29_g446);
    cse_p11_t135_g552 = (cse_p11_t160_g577 + cse_p11_t30_g447);
    cse_p11_t136_g553 = (cse_p11_t157_g574 + cse_p11_t31_g448);
    cse_p11_t137_g554 = (cse_p11_t161_g578 + cse_p11_t32_g449);
    cse_p11_t179_g596 = (-(cse_p61_t7_invr627));
    cos_theta = (cse_p61_t7_invr627 * dot);
    cse_p61_t10_invsqrt630 = (1.0 / sqrt((1.0000000000000000     + (-(((cos_theta) * (cos_theta)))))));
    cse_p11_t4_g421 = (cse_p11_t129_g546 * cse_p61_t10_invsqrt630);
    cse_p11_t5_g422 = (cse_p11_t130_g547 * cse_p61_t10_invsqrt630);
    cse_p11_t6_g423 = (cse_p11_t131_g548 * cse_p61_t10_invsqrt630);
    cse_p11_t7_g424 = (cse_p11_t132_g549 * cse_p61_t10_invsqrt630);
    cse_p11_t8_g425 = (cse_p11_t133_g550 * cse_p61_t10_invsqrt630);
    cse_p11_t9_g426 = (cse_p11_t134_g551 * cse_p61_t10_invsqrt630);
    cse_p11_t10_g427 = (cse_p11_t135_g552 * cse_p61_t10_invsqrt630);
    cse_p11_t11_g428 = (cse_p11_t136_g553 * cse_p61_t10_invsqrt630);
    cse_p11_t12_g429 = (cse_p11_t137_g554 * cse_p61_t10_invsqrt630);
    cse_p63_t1_g645 = (cse_p61_t10_invsqrt630 * cse_p61_t10_invsqrt630 * kt);
    cse_p167_t1_g683 = (cse_p11_t129_g546 * cse_p63_t1_g645);
    cse_p11_t44_g461 = (cse_p11_t129_g546 * cse_p167_t1_g683);
    cse_p11_t45_g462 = (cse_p11_t130_g547 * cse_p167_t1_g683);
    cse_p11_t46_g463 = (cse_p11_t131_g548 * cse_p167_t1_g683);
    cse_p11_t47_g464 = (cse_p11_t132_g549 * cse_p167_t1_g683);
    cse_p11_t48_g465 = (cse_p11_t133_g550 * cse_p167_t1_g683);
    cse_p11_t49_g466 = (cse_p11_t134_g551 * cse_p167_t1_g683);
    cse_p11_t50_g467 = (cse_p11_t135_g552 * cse_p167_t1_g683);
    cse_p11_t51_g468 = (cse_p11_t136_g553 * cse_p167_t1_g683);
    cse_p11_t52_g469 = (cse_p11_t137_g554 * cse_p167_t1_g683);
    cse_p167_t1_g687 = (cse_p11_t130_g547 * cse_p63_t1_g645);
    cse_p11_t53_g470 = (cse_p11_t130_g547 * cse_p167_t1_g687);
    cse_p11_t54_g471 = (cse_p11_t131_g548 * cse_p167_t1_g687);
    cse_p11_t55_g472 = (cse_p11_t132_g549 * cse_p167_t1_g687);
    cse_p11_t56_g473 = (cse_p11_t133_g550 * cse_p167_t1_g687);
    cse_p11_t57_g474 = (cse_p11_t134_g551 * cse_p167_t1_g687);
    cse_p11_t58_g475 = (cse_p11_t135_g552 * cse_p167_t1_g687);
    cse_p11_t59_g476 = (cse_p11_t136_g553 * cse_p167_t1_g687);
    cse_p11_t60_g477 = (cse_p11_t137_g554 * cse_p167_t1_g687);
    cse_p167_t1_g691 = (cse_p11_t131_g548 * cse_p63_t1_g645);
    cse_p11_t61_g478 = (cse_p11_t131_g548 * cse_p167_t1_g691);
    cse_p11_t62_g479 = (cse_p11_t132_g549 * cse_p167_t1_g691);
    cse_p11_t63_g480 = (cse_p11_t133_g550 * cse_p167_t1_g691);
    cse_p11_t64_g481 = (cse_p11_t134_g551 * cse_p167_t1_g691);
    cse_p11_t65_g482 = (cse_p11_t135_g552 * cse_p167_t1_g691);
    cse_p11_t66_g483 = (cse_p11_t136_g553 * cse_p167_t1_g691);
    cse_p11_t67_g484 = (cse_p11_t137_g554 * cse_p167_t1_g691);
    cse_p219_t1_g703 = (cse_p11_t132_g549 * cse_p63_t1_g645);
    cse_p11_t68_g485 = (cse_p11_t132_g549 * cse_p219_t1_g703);
    cse_p11_t69_g486 = (cse_p11_t133_g550 * cse_p219_t1_g703);
    cse_p11_t70_g487 = (cse_p11_t134_g551 * cse_p219_t1_g703);
    cse_p11_t71_g488 = (cse_p11_t135_g552 * cse_p219_t1_g703);
    cse_p11_t72_g489 = (cse_p11_t136_g553 * cse_p219_t1_g703);
    cse_p11_t73_g490 = (cse_p11_t137_g554 * cse_p219_t1_g703);
    cse_p220_t1_g713 = (cse_p11_t133_g550 * cse_p63_t1_g645);
    cse_p11_t74_g491 = (cse_p11_t133_g550 * cse_p220_t1_g713);
    cse_p11_t75_g492 = (cse_p11_t134_g551 * cse_p220_t1_g713);
    cse_p11_t76_g493 = (cse_p11_t135_g552 * cse_p220_t1_g713);
    cse_p11_t77_g494 = (cse_p11_t136_g553 * cse_p220_t1_g713);
    cse_p11_t78_g495 = (cse_p11_t137_g554 * cse_p220_t1_g713);
    cse_p272_t1_g733 = (cse_p11_t134_g551 * cse_p63_t1_g645);
    cse_p11_t79_g496 = (cse_p11_t134_g551 * cse_p272_t1_g733);
    cse_p11_t80_g497 = (cse_p11_t135_g552 * cse_p272_t1_g733);
    cse_p11_t81_g498 = (cse_p11_t136_g553 * cse_p272_t1_g733);
    cse_p11_t82_g499 = (cse_p11_t137_g554 * cse_p272_t1_g733);
    cse_p428_t1_g767 = (cse_p11_t135_g552 * cse_p63_t1_g645);
    cse_p11_t83_g500 = (cse_p11_t135_g552 * cse_p428_t1_g767);
    cse_p11_t84_g501 = (cse_p11_t136_g553 * cse_p428_t1_g767);
    cse_p11_t85_g502 = (cse_p11_t137_g554 * cse_p428_t1_g767);
    cse_p11_t86_g503 = (cse_p11_t136_g553 * cse_p11_t136_g553 * cse_p63_t1_g645);
    cse_p11_t87_g504 = (cse_p11_t136_g553 * cse_p11_t137_g554 * cse_p63_t1_g645);
    cse_p11_t88_g505 = (cse_p11_t137_g554 * cse_p11_t137_g554 * cse_p63_t1_g645);
    cse_p11_t141_g558 = (1.0000000000000000     + (-(((cos_theta) * (cos_theta)))));
    cse_p11_t145_g562 = (-(cse_p11_t4_g421));
    cse_p11_t146_g563 = (-(cse_p11_t5_g422));
    cse_p11_t147_g564 = (-(cse_p11_t6_g423));
    cse_p11_t148_g565 = (-(cse_p11_t7_g424));
    cse_p11_t149_g566 = (-(cse_p11_t8_g425));
    cse_p11_t150_g567 = (-(cse_p11_t9_g426));
    cse_p11_t151_g568 = (-(cse_p11_t10_g427));
    cse_p11_t152_g569 = (-(cse_p11_t11_g428));
    cse_p11_t153_g570 = (-(cse_p11_t12_g429));
    cse_p11_t178_g595 = (-(((cos_theta) * (cos_theta))));
    cse_p529_t5_sqrt780 = sqrt(cse_p11_t141_g558);
    cse_p529_t6_invr781 = (1.0 / (cse_p11_t141_g558));
    cse_p11_t193_g610 = ((cos_theta) * (cos_theta));
    if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
    cse_p1_t8_invsqrt417 = (1.0 / (cse_p529_t5_sqrt780));
    theta = acos(cos_theta);
    dtheta = (theta + (-(t0)));
    cse_p62_t1_g633 = (2.0000000000000000     * dtheta * kt);
    energy = (dtheta * dtheta * kt);
    *energy_accumulate += energy;
    cse_p63_t1_g648 = (cse_p529_t3_sqrt778 * dot);
    cse_p63_t1_g661 = (cse_p1_t2_invsqrt411 * cse_p61_t8_invr2628 * cse_p63_t1_g648);
    cse_p167_t1_g685 = (cse_p1_t8_invsqrt417 * cse_p62_t1_g633);
    g_x1 = (-((cse_p167_t1_g685 * (cse_p11_t28_g445 + (-((cse_p63_t1_g661 * vx1)))))));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (-((cse_p167_t1_g685 * (cse_p11_t30_g447 + (-((cse_p63_t1_g661 * vy1)))))));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (-((cse_p167_t1_g685 * (cse_p11_t32_g449 + (-((cse_p63_t1_g661 * vz1)))))));
    KernelGradientAcc(i3x1, 2, g_z1);
    g_x2 = (-((cse_p167_t1_g685 * (cse_p11_t24_g441 + (-((cse_p218_t1_g700 * ((-((cse_p1_t2_invsqrt411 * cse_p529_t3_sqrt778 * vx1))) + (-((cse_p1_t4_invsqrt413 * cse_p529_t1_sqrt776 * vx2)))))))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (-((cse_p167_t1_g685 * (cse_p11_t25_g442 + (-((cse_p218_t1_g700 * ((-((cse_p1_t2_invsqrt411 * cse_p529_t3_sqrt778 * vy1))) + (-((cse_p1_t4_invsqrt413 * cse_p529_t1_sqrt776 * vy2)))))))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (-((cse_p167_t1_g685 * (cse_p11_t26_g443 + (-((cse_p218_t1_g700 * ((-((cse_p1_t2_invsqrt411 * cse_p529_t3_sqrt778 * vz1))) + (-((cse_p1_t4_invsqrt413 * cse_p529_t1_sqrt776 * vz2)))))))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    cse_p115_t1_g673 = (cse_p529_t1_sqrt776 * dot);
    cse_p115_t1_g674 = (cse_p115_t1_g673 * cse_p1_t4_invsqrt413 * cse_p61_t8_invr2628);
    g_x3 = (-((cse_p167_t1_g685 * (cse_p11_t27_g444 + (-((cse_p115_t1_g674 * vx2)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (-((cse_p167_t1_g685 * (cse_p11_t29_g446 + (-((cse_p115_t1_g674 * vy2)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (-((cse_p167_t1_g685 * (cse_p11_t31_g448 + (-((cse_p115_t1_g674 * vz2)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    cse_p271_t1_g722 = (cse_p529_t1_sqrt776 * cse_p529_t2_invr777);
    cse_p11_t1_g618 = (cse_p271_t1_g722 * cse_p61_t8_invr2628);
    cse_p63_t1_g646 = (cos_theta * cse_p529_t6_invr781);
    cse_p63_t1_g647 = (cse_p61_t10_invsqrt630 * cse_p62_t1_g633);
    cse_p63_t1_g651 = (cse_p529_t1_sqrt776 * cse_p63_t1_g648);
    cse_p478_t1_g775 = (cse_p11_t127_g544 * cse_p63_t1_g651);
    cse_p63_t1_g655 = (cse_p11_t1_g618 * cse_p529_t2_invr777 * cse_p63_t1_g648);
    cse_p63_t1_g657 = (cse_p271_t1_g722 * cse_p529_t2_invr777 * cse_p63_t1_g649 * cse_p63_t1_g651);
    cse_p219_t1_g711 = (cse_p115_t1_g673 * cse_p219_t1_g710 * cse_p61_t3_invr2623);
    cse_p220_t1_g714 = (cse_p11_t133_g550 * cse_p63_t1_g646);
    cse_p427_t1_g765 = (-2.0000000000000000     * cse_p11_t1_g618);
    h_x1_x1 = (cse_p11_t74_g491 + cse_p11_t74_g491 + (-((cse_p63_t1_g647 * (cse_p11_t158_g575 + (cse_p11_t133_g550 * cse_p220_t1_g714) + (cse_p529_t3_sqrt778 * vx1 * ((cse_p219_t1_g711 * vx1) + (cse_p427_t1_g765 * vx2) + (cse_p63_t1_g657 * vx1))) + (-((cse_p427_t1_g756 * cse_p63_t1_g655))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
    cse_p63_t1_g652 = (cse_p11_t1_g618 * cse_p529_t3_sqrt778);
    cse_p219_t1_g707 = (cse_p63_t1_g652 * vx1);
    cse_p219_t1_g708 = (cse_p63_t1_g652 * vy1);
    h_x1_y1 = (cse_p11_t76_g493 + cse_p11_t76_g493 + (-((cse_p63_t1_g647 * ((cse_p11_t135_g552 * cse_p220_t1_g714) + (cse_p478_t1_g775 * vx1 * vy1) + (-((cse_p219_t1_g707 * vy2))) + (-((cse_p219_t1_g708 * vx2))) + (-((cse_p63_t1_g655 * vx1 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
    cse_p219_t1_g709 = (cse_p63_t1_g652 * vz1);
    h_x1_z1 = (cse_p11_t78_g495 + cse_p11_t78_g495 + (-((cse_p63_t1_g647 * ((cse_p11_t137_g554 * cse_p220_t1_g714) + (cse_p478_t1_g775 * vx1 * vz1) + (-((cse_p219_t1_g707 * vz2))) + (-((cse_p219_t1_g709 * vx2))) + (-((cse_p63_t1_g655 * vx1 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
    cse_p167_t1_g684 = (cse_p11_t129_g546 * cse_p63_t1_g646);
    cse_p220_t1_g712 = (cse_p11_t121_g538 * cse_p63_t1_g649);
    h_x1_x2 = (cse_p11_t48_g465 + cse_p11_t48_g465 + (-((cse_p63_t1_g647 * (cse_p11_t179_g596 + (cse_p11_t133_g550 * cse_p167_t1_g684) + (cse_p11_t142_g559 * vx2) + (cse_p11_t1_g618 * dot * (cse_p11_t105_g522 + cse_p11_t115_g532 + cse_p529_t3_sqrt778)) + (cse_p63_t1_g651 * vx1 * ((cse_p166_t1_g681 * cse_p61_t8_invr2628 * vx1) + (cse_p220_t1_g712 * cse_p529_t2_invr777))) + (-((cse_p11_t138_g555 * cse_p219_t1_g707))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
    cse_p167_t1_g688 = (cse_p11_t130_g547 * cse_p63_t1_g646);
    h_x1_y2 = (cse_p11_t56_g473 + cse_p11_t56_g473 + (-((cse_p63_t1_g647 * ((cse_p115_t1_g673 * cse_p63_t9_g642 * vx1) + (cse_p11_t133_g550 * cse_p167_t1_g688) + (cse_p11_t143_g560 * vx2) + (-((cse_p11_t139_g556 * cse_p219_t1_g707))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
    cse_p168_t1_g692 = (cse_p11_t131_g548 * cse_p63_t1_g646);
    h_x1_z2 = (cse_p11_t63_g480 + cse_p11_t63_g480 + (-((cse_p63_t1_g647 * ((cse_p115_t1_g673 * cse_p63_t10_g643 * vx1) + (cse_p11_t133_g550 * cse_p168_t1_g692) + (cse_p11_t144_g561 * vx2) + (-((cse_p11_t140_g557 * cse_p219_t1_g707))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
    cse_p11_t1_g619 = (cse_p11_t1_g615 * cse_p529_t2_invr777);
    cse_p63_t1_g653 = (cse_p11_t1_g618 * cse_p529_t4_invr779 * cse_p63_t1_g648);
    cse_p63_t1_g654 = (cse_p11_t1_g619 * cse_p63_t1_g649 * cse_p63_t1_g651);
    cse_p167_t1_g682 = (cse_p374_t1_g748 * vx2);
    cse_p219_t1_g704 = (cse_p11_t132_g549 * cse_p63_t1_g646);
    h_x1_x3 = (cse_p11_t69_g486 + cse_p11_t69_g486 + (-((cse_p63_t1_g647 * (cse_p61_t7_invr627 + (cse_p11_t133_g550 * cse_p219_t1_g704) + (cse_p271_t1_g723 * cse_p63_t1_g654) + (-((cse_p167_t1_g682 * vx2))) + (-((cse_p219_t1_g707 * vx1))) + (-((cse_p271_t1_g723 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
    cse_p427_t1_g757 = (vx1 * vy2);
    h_x1_y3 = (cse_p11_t75_g492 + cse_p11_t75_g492 + (-((cse_p63_t1_g647 * (cse_p11_t163_g580 + cse_p11_t172_g589 + (cse_p11_t134_g551 * cse_p220_t1_g714) + (cse_p427_t1_g757 * cse_p63_t1_g654) + (-((cse_p427_t1_g757 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
    cse_p427_t1_g758 = (vx1 * vz2);
    h_x1_z3 = (cse_p11_t77_g494 + cse_p11_t77_g494 + (-((cse_p63_t1_g647 * (cse_p11_t165_g582 + cse_p11_t173_g590 + (cse_p11_t136_g553 * cse_p220_t1_g714) + (cse_p427_t1_g758 * cse_p63_t1_g654) + (-((cse_p427_t1_g758 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
    cse_p428_t1_g768 = (cse_p11_t135_g552 * cse_p63_t1_g646);
    h_y1_y1 = (cse_p11_t83_g500 + cse_p11_t83_g500 + (-((cse_p63_t1_g647 * (cse_p11_t158_g575 + (cse_p11_t135_g552 * cse_p428_t1_g768) + (cse_p529_t3_sqrt778 * vy1 * ((cse_p219_t1_g711 * vy1) + (cse_p427_t1_g765 * vy2) + (cse_p63_t1_g657 * vy1))) + (-((cse_p427_t1_g761 * cse_p63_t1_g655))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
    h_y1_z1 = (cse_p11_t85_g502 + cse_p11_t85_g502 + (-((cse_p63_t1_g647 * ((cse_p11_t137_g554 * cse_p428_t1_g768) + (cse_p478_t1_g775 * vy1 * vz1) + (-((cse_p219_t1_g708 * vz2))) + (-((cse_p219_t1_g709 * vy2))) + (-((cse_p63_t1_g655 * vy1 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
    h_y1_x2 = (cse_p11_t50_g467 + cse_p11_t50_g467 + (-((cse_p63_t1_g647 * ((cse_p115_t1_g673 * cse_p63_t8_g641 * vy1) + (cse_p11_t135_g552 * cse_p167_t1_g684) + (cse_p11_t142_g559 * vy2) + (-((cse_p11_t138_g555 * cse_p219_t1_g708))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
    cse_p272_t1_g732 = (cse_p11_t122_g539 * cse_p63_t1_g649);
    h_y1_y2 = (cse_p11_t58_g475 + cse_p11_t58_g475 + (-((cse_p63_t1_g647 * (cse_p11_t179_g596 + (cse_p11_t135_g552 * cse_p167_t1_g688) + (cse_p11_t143_g560 * vy2) + (cse_p11_t1_g618 * dot * (cse_p11_t110_g527 + cse_p11_t117_g534 + cse_p529_t3_sqrt778)) + (cse_p63_t1_g651 * vy1 * ((cse_p166_t1_g681 * cse_p61_t8_invr2628 * vy1) + (cse_p272_t1_g732 * cse_p529_t2_invr777))) + (-((cse_p11_t139_g556 * cse_p219_t1_g708))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
    h_y1_z2 = (cse_p11_t65_g482 + cse_p11_t65_g482 + (-((cse_p63_t1_g647 * ((cse_p115_t1_g673 * cse_p63_t10_g643 * vy1) + (cse_p11_t135_g552 * cse_p168_t1_g692) + (cse_p11_t144_g561 * vy2) + (-((cse_p11_t140_g557 * cse_p219_t1_g708))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
    cse_p427_t1_g759 = (vx2 * vy1);
    h_y1_x3 = (cse_p11_t71_g488 + cse_p11_t71_g488 + (-((cse_p63_t1_g647 * (cse_p11_t163_g580 + cse_p11_t172_g589 + (cse_p11_t135_g552 * cse_p219_t1_g704) + (cse_p427_t1_g759 * cse_p63_t1_g654) + (-((cse_p427_t1_g759 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
    cse_p167_t1_g686 = (cse_p374_t1_g748 * vy2);
    cse_p272_t1_g734 = (cse_p11_t134_g551 * cse_p63_t1_g646);
    h_y1_y3 = (cse_p11_t80_g497 + cse_p11_t80_g497 + (-((cse_p63_t1_g647 * (cse_p61_t7_invr627 + (cse_p11_t135_g552 * cse_p272_t1_g734) + (cse_p271_t1_g727 * cse_p63_t1_g654) + (-((cse_p167_t1_g686 * vy2))) + (-((cse_p219_t1_g708 * vy1))) + (-((cse_p271_t1_g727 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
    cse_p427_t1_g762 = (vy1 * vz2);
    h_y1_z3 = (cse_p11_t84_g501 + cse_p11_t84_g501 + (-((cse_p63_t1_g647 * (cse_p11_t168_g585 + cse_p11_t175_g592 + (cse_p11_t136_g553 * cse_p428_t1_g768) + (cse_p427_t1_g762 * cse_p63_t1_g654) + (-((cse_p427_t1_g762 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
    h_z1_z1 = (cse_p11_t88_g505 + cse_p11_t88_g505 + (-((cse_p63_t1_g647 * (cse_p11_t158_g575 + (cse_p11_t137_g554 * cse_p11_t137_g554 * cse_p63_t1_g646) + (cse_p529_t3_sqrt778 * vz1 * ((cse_p219_t1_g711 * vz1) + (cse_p427_t1_g765 * vz2) + (cse_p63_t1_g657 * vz1))) + (-((cse_p427_t1_g764 * cse_p63_t1_g655))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
    h_z1_x2 = (cse_p11_t52_g469 + cse_p11_t52_g469 + (-((cse_p63_t1_g647 * ((cse_p115_t1_g673 * cse_p63_t8_g641 * vz1) + (cse_p11_t137_g554 * cse_p167_t1_g684) + (cse_p11_t142_g559 * vz2) + (-((cse_p11_t138_g555 * cse_p219_t1_g709))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
    h_z1_y2 = (cse_p11_t60_g477 + cse_p11_t60_g477 + (-((cse_p63_t1_g647 * ((cse_p115_t1_g673 * cse_p63_t9_g642 * vz1) + (cse_p11_t137_g554 * cse_p167_t1_g688) + (cse_p11_t143_g560 * vz2) + (-((cse_p11_t139_g556 * cse_p219_t1_g709))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
    cse_p428_t1_g766 = (cse_p11_t123_g540 * cse_p63_t1_g649);
    h_z1_z2 = (cse_p11_t67_g484 + cse_p11_t67_g484 + (-((cse_p63_t1_g647 * (cse_p11_t179_g596 + (cse_p11_t137_g554 * cse_p168_t1_g692) + (cse_p11_t144_g561 * vz2) + (cse_p11_t1_g618 * dot * (cse_p11_t114_g531 + cse_p11_t119_g536 + cse_p529_t3_sqrt778)) + (cse_p63_t1_g651 * vz1 * ((cse_p166_t1_g681 * cse_p61_t8_invr2628 * vz1) + (cse_p428_t1_g766 * cse_p529_t2_invr777))) + (-((cse_p11_t140_g557 * cse_p219_t1_g709))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
    cse_p427_t1_g760 = (vx2 * vz1);
    h_z1_x3 = (cse_p11_t73_g490 + cse_p11_t73_g490 + (-((cse_p63_t1_g647 * (cse_p11_t165_g582 + cse_p11_t173_g590 + (cse_p11_t137_g554 * cse_p219_t1_g704) + (cse_p427_t1_g760 * cse_p63_t1_g654) + (-((cse_p427_t1_g760 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
    cse_p427_t1_g763 = (vy2 * vz1);
    h_z1_y3 = (cse_p11_t82_g499 + cse_p11_t82_g499 + (-((cse_p63_t1_g647 * (cse_p11_t168_g585 + cse_p11_t175_g592 + (cse_p11_t137_g554 * cse_p272_t1_g734) + (cse_p427_t1_g763 * cse_p63_t1_g654) + (-((cse_p427_t1_g763 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
    cse_p167_t1_g689 = (cse_p374_t1_g748 * vz2);
    h_z1_z3 = (cse_p11_t87_g504 + cse_p11_t87_g504 + (-((cse_p63_t1_g647 * (cse_p61_t7_invr627 + (cse_p11_t136_g553 * cse_p11_t137_g554 * cse_p63_t1_g646) + (cse_p271_t1_g730 * cse_p63_t1_g654) + (-((cse_p167_t1_g689 * vz2))) + (-((cse_p219_t1_g709 * vz1))) + (-((cse_p271_t1_g730 * cse_p63_t1_g653))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
    cse_p219_t1_g701 = (-2.0000000000000000     * cse_p61_t6_invr2626);
    h_x2_x2 = (cse_p11_t44_g461 + cse_p11_t44_g461 + (-((cse_p63_t1_g647 * (cse_p11_t18_g435 + (2.0000000000000000     * cse_p11_t138_g555 * cse_p11_t142_g559) + (cse_p11_t129_g546 * cse_p167_t1_g684) + (dot * ((cse_p11_t121_g538 * cse_p220_t1_g712) + (-((cse_p61_t8_invr2628 * (cse_p11_t1_g615 + cse_p11_t92_g509 + (cse_p114_t1_g670 * ((cse_p166_t1_g681 * cse_p427_t1_g756) + (cse_p219_t1_g701 * cse_p271_t1_g724))) + (cse_p271_t1_g722 * (cse_p11_t105_g522 + cse_p11_t115_g532 + cse_p11_t115_g532 + cse_p529_t3_sqrt778)))))))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
    h_x2_y2 = (cse_p11_t45_g462 + cse_p11_t45_g462 + (-((cse_p63_t1_g647 * ((cse_p11_t130_g547 * cse_p167_t1_g684) + (cse_p11_t138_g555 * cse_p11_t143_g560) + (cse_p11_t139_g556 * cse_p11_t142_g559) + (dot * ((cse_p11_t122_g539 * cse_p220_t1_g712) + (-((cse_p61_t8_invr2628 * (cse_p11_t94_g511 + (cse_p114_t1_g670 * ((cse_p115_t2_g672 * vx1 * vy1) + (cse_p219_t1_g701 * cse_p271_t1_g725))) + (cse_p11_t1_g619 * (cse_p427_t1_g757 + cse_p427_t1_g759)))))))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
    h_x2_z2 = (cse_p11_t46_g463 + cse_p11_t46_g463 + (-((cse_p63_t1_g647 * ((cse_p11_t131_g548 * cse_p167_t1_g684) + (cse_p11_t138_g555 * cse_p11_t144_g561) + (cse_p11_t140_g557 * cse_p11_t142_g559) + (dot * ((cse_p11_t123_g540 * cse_p220_t1_g712) + (-((cse_p61_t8_invr2628 * (cse_p11_t96_g513 + (cse_p114_t1_g670 * ((cse_p115_t2_g672 * vx1 * vz1) + (cse_p219_t1_g701 * cse_p271_t1_g726))) + (cse_p11_t1_g619 * (cse_p427_t1_g758 + cse_p427_t1_g760)))))))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
    cse_p63_t1_g658 = (cse_p11_t1_g615 * cse_p220_t1_g712);
    h_x2_x3 = (cse_p11_t47_g464 + cse_p11_t47_g464 + (-((cse_p63_t1_g647 * (cse_p11_t179_g596 + (cse_p11_t132_g549 * cse_p167_t1_g684) + (cse_p11_t142_g559 * vx1) + (dot * ((cse_p63_t1_g658 * vx2) + (-((cse_p61_t8_invr2628 * (cse_p11_t177_g594 + (cse_p167_t1_g690 * cse_p271_t1_g724) + (-((cse_p11_t1_g619 * cse_p271_t1_g723))) + (-(cse_p11_t92_g509)))))))) + (-((cse_p11_t138_g555 * cse_p167_t1_g682))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
    h_x2_y3 = (cse_p11_t49_g466 + cse_p11_t49_g466 + (-((cse_p63_t1_g647 * ((cse_p11_t134_g551 * cse_p167_t1_g684) + (cse_p11_t142_g559 * vy1) + (dot * ((cse_p63_t1_g658 * vy2) + (-((cse_p61_t8_invr2628 * (cse_p11_t164_g581 + cse_p11_t20_g437 + (-((cse_p11_t1_g619 * cse_p427_t1_g757))))))))) + (-((cse_p11_t138_g555 * cse_p167_t1_g686))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
    h_x2_z3 = (cse_p11_t51_g468 + cse_p11_t51_g468 + (-((cse_p63_t1_g647 * ((cse_p11_t136_g553 * cse_p167_t1_g684) + (cse_p11_t142_g559 * vz1) + (dot * ((cse_p63_t1_g658 * vz2) + (-((cse_p61_t8_invr2628 * (cse_p11_t166_g583 + cse_p11_t21_g438 + (-((cse_p11_t1_g619 * cse_p427_t1_g758))))))))) + (-((cse_p11_t138_g555 * cse_p167_t1_g689))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
    h_y2_y2 = (cse_p11_t53_g470 + cse_p11_t53_g470 + (-((cse_p63_t1_g647 * (cse_p11_t18_g435 + (2.0000000000000000     * cse_p11_t139_g556 * cse_p11_t143_g560) + (cse_p11_t130_g547 * cse_p167_t1_g688) + (dot * ((cse_p11_t122_g539 * cse_p272_t1_g732) + (-((cse_p61_t8_invr2628 * (cse_p11_t1_g615 + cse_p11_t98_g515 + (cse_p114_t1_g670 * ((cse_p166_t1_g681 * cse_p427_t1_g761) + (cse_p219_t1_g701 * cse_p271_t1_g728))) + (cse_p271_t1_g722 * (cse_p11_t110_g527 + cse_p11_t117_g534 + cse_p11_t117_g534 + cse_p529_t3_sqrt778)))))))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
    h_y2_z2 = (cse_p11_t54_g471 + cse_p11_t54_g471 + (-((cse_p63_t1_g647 * ((cse_p11_t131_g548 * cse_p167_t1_g688) + (cse_p11_t139_g556 * cse_p11_t144_g561) + (cse_p11_t140_g557 * cse_p11_t143_g560) + (dot * ((cse_p11_t123_g540 * cse_p272_t1_g732) + (-((cse_p61_t8_invr2628 * (cse_p11_t100_g517 + (cse_p114_t1_g670 * ((cse_p115_t2_g672 * vy1 * vz1) + (cse_p219_t1_g701 * cse_p271_t1_g729))) + (cse_p11_t1_g619 * (cse_p427_t1_g762 + cse_p427_t1_g763)))))))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
    cse_p63_t1_g659 = (cse_p11_t1_g615 * cse_p272_t1_g732);
    h_y2_x3 = (cse_p11_t55_g472 + cse_p11_t55_g472 + (-((cse_p63_t1_g647 * ((cse_p11_t132_g549 * cse_p167_t1_g688) + (cse_p11_t143_g560 * vx1) + (dot * ((cse_p63_t1_g659 * vx2) + (-((cse_p61_t8_invr2628 * (cse_p11_t164_g581 + cse_p11_t20_g437 + (-((cse_p11_t1_g619 * cse_p427_t1_g759))))))))) + (-((cse_p11_t139_g556 * cse_p167_t1_g682))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
    h_y2_y3 = (cse_p11_t57_g474 + cse_p11_t57_g474 + (-((cse_p63_t1_g647 * (cse_p11_t179_g596 + (cse_p11_t134_g551 * cse_p167_t1_g688) + (cse_p11_t143_g560 * vy1) + (dot * ((cse_p63_t1_g659 * vy2) + (-((cse_p61_t8_invr2628 * (cse_p11_t177_g594 + (cse_p167_t1_g690 * cse_p271_t1_g728) + (-((cse_p11_t1_g619 * cse_p271_t1_g727))) + (-(cse_p11_t98_g515)))))))) + (-((cse_p11_t139_g556 * cse_p167_t1_g686))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
    h_y2_z3 = (cse_p11_t59_g476 + cse_p11_t59_g476 + (-((cse_p63_t1_g647 * ((cse_p11_t136_g553 * cse_p167_t1_g688) + (cse_p11_t143_g560 * vz1) + (dot * ((cse_p63_t1_g659 * vz2) + (-((cse_p61_t8_invr2628 * (cse_p11_t169_g586 + cse_p11_t22_g439 + (-((cse_p11_t1_g619 * cse_p427_t1_g762))))))))) + (-((cse_p11_t139_g556 * cse_p167_t1_g689))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
    h_z2_z2 = (cse_p11_t61_g478 + cse_p11_t61_g478 + (-((cse_p63_t1_g647 * (cse_p11_t18_g435 + (2.0000000000000000     * cse_p11_t140_g557 * cse_p11_t144_g561) + (cse_p11_t131_g548 * cse_p168_t1_g692) + (dot * ((cse_p11_t123_g540 * cse_p428_t1_g766) + (-((cse_p61_t8_invr2628 * (cse_p11_t102_g519 + cse_p11_t1_g615 + (cse_p114_t1_g670 * ((cse_p166_t1_g681 * cse_p427_t1_g764) + (cse_p219_t1_g701 * cse_p271_t1_g731))) + (cse_p271_t1_g722 * (cse_p11_t114_g531 + cse_p11_t119_g536 + cse_p11_t119_g536 + cse_p529_t3_sqrt778)))))))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
    cse_p63_t1_g660 = (cse_p11_t1_g615 * cse_p428_t1_g766);
    h_z2_x3 = (cse_p11_t62_g479 + cse_p11_t62_g479 + (-((cse_p63_t1_g647 * ((cse_p11_t132_g549 * cse_p168_t1_g692) + (cse_p11_t144_g561 * vx1) + (dot * ((cse_p63_t1_g660 * vx2) + (-((cse_p61_t8_invr2628 * (cse_p11_t166_g583 + cse_p11_t21_g438 + (-((cse_p11_t1_g619 * cse_p427_t1_g760))))))))) + (-((cse_p11_t140_g557 * cse_p167_t1_g682))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
    h_z2_y3 = (cse_p11_t64_g481 + cse_p11_t64_g481 + (-((cse_p63_t1_g647 * ((cse_p11_t134_g551 * cse_p168_t1_g692) + (cse_p11_t144_g561 * vy1) + (dot * ((cse_p63_t1_g660 * vy2) + (-((cse_p61_t8_invr2628 * (cse_p11_t169_g586 + cse_p11_t22_g439 + (-((cse_p11_t1_g619 * cse_p427_t1_g763))))))))) + (-((cse_p11_t140_g557 * cse_p167_t1_g686))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
    h_z2_z3 = (cse_p11_t66_g483 + cse_p11_t66_g483 + (-((cse_p63_t1_g647 * (cse_p11_t179_g596 + (cse_p11_t136_g553 * cse_p168_t1_g692) + (cse_p11_t144_g561 * vz1) + (dot * ((cse_p63_t1_g660 * vz2) + (-((cse_p61_t8_invr2628 * (cse_p11_t177_g594 + (cse_p167_t1_g690 * cse_p271_t1_g731) + (-((cse_p11_t1_g619 * cse_p271_t1_g730))) + (-(cse_p11_t102_g519)))))))) + (-((cse_p11_t140_g557 * cse_p167_t1_g689))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
    cse_p219_t1_g702 = (cse_p11_t128_g545 * cse_p63_t1_g651);
    cse_p219_t1_g706 = (cse_p529_t4_invr779 * dot);
    h_x3_x3 = (cse_p11_t68_g485 + cse_p11_t68_g485 + (-((cse_p63_t1_g647 * (cse_p11_t154_g571 + (-2.0000000000000000     * cse_p167_t1_g682 * vx1) + (cse_p11_t132_g549 * cse_p219_t1_g704) + (cse_p219_t1_g702 * cse_p271_t1_g724) + (-((cse_p167_t1_g682 * cse_p219_t1_g706 * vx2))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
    h_x3_y3 = (cse_p11_t70_g487 + cse_p11_t70_g487 + (-((cse_p63_t1_g647 * ((cse_p11_t134_g551 * cse_p219_t1_g704) + (cse_p219_t1_g702 * cse_p271_t1_g725) + (-((cse_p167_t1_g682 * cse_p219_t1_g706 * vy2))) + (-((cse_p167_t1_g682 * vy1))) + (-((cse_p167_t1_g686 * vx1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
    h_x3_z3 = (cse_p11_t72_g489 + cse_p11_t72_g489 + (-((cse_p63_t1_g647 * ((cse_p11_t136_g553 * cse_p219_t1_g704) + (cse_p219_t1_g702 * cse_p271_t1_g726) + (-((cse_p167_t1_g682 * cse_p219_t1_g706 * vz2))) + (-((cse_p167_t1_g682 * vz1))) + (-((cse_p167_t1_g689 * vx1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
    h_y3_y3 = (cse_p11_t79_g496 + cse_p11_t79_g496 + (-((cse_p63_t1_g647 * (cse_p11_t154_g571 + (-2.0000000000000000     * cse_p167_t1_g686 * vy1) + (cse_p11_t134_g551 * cse_p272_t1_g734) + (cse_p219_t1_g702 * cse_p271_t1_g728) + (-((cse_p167_t1_g686 * cse_p219_t1_g706 * vy2))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
    h_y3_z3 = (cse_p11_t81_g498 + cse_p11_t81_g498 + (-((cse_p63_t1_g647 * ((cse_p11_t136_g553 * cse_p272_t1_g734) + (cse_p219_t1_g702 * cse_p271_t1_g729) + (-((cse_p167_t1_g686 * cse_p219_t1_g706 * vz2))) + (-((cse_p167_t1_g686 * vz1))) + (-((cse_p167_t1_g689 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
    h_z3_z3 = (cse_p11_t86_g503 + cse_p11_t86_g503 + (-((cse_p63_t1_g647 * (cse_p11_t154_g571 + (-2.0000000000000000     * cse_p167_t1_g689 * vz1) + (cse_p11_t136_g553 * cse_p11_t136_g553 * cse_p63_t1_g646) + (cse_p219_t1_g702 * cse_p271_t1_g731) + (-((cse_p167_t1_g689 * cse_p219_t1_g706 * vz2))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
  }
}
void hessian_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 9;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(kt, t0, i3x1, i3x2, i3x3, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
}

};
