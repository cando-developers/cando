template <typename HESSIAN>
void nonbond_dd_cutoff_hessian(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  constexpr size_t PositionSize = 6;
  /* !BASE */
  double cse_p1_t1_g28396;
  double cse_p1_t1_g28397;
  double cse_p1_t1_g28398;
  double cse_p1_t1_g28399;
  double cse_p1_t1_g28400;
  double cse_p1_t1_g28401;
  double cse_p1_t1_g28403;
  double cse_p1_t1_g28404;
  double cse_p1_t46_g28378;
  double cse_p1_t47_g28379;
  double cse_p1_t48_g28380;
  double cse_p1_t49_g28381;
  double cse_p1_t50_g28382;
  double cse_p1_t51_g28383;
  double cse_p1_t52_g28384;
  double cse_p1_t53_g28385;
  double cse_p1_t54_g28386;
  double cse_p1_t55_g28387;
  double cse_p1_t56_g28388;
  double cse_p1_t57_g28389;
  double cse_p2_t11_g28415;
  double cse_p2_t12_g28416;
  double cse_p2_t13_g28417;
  double cse_p2_t1_g28457;
  double cse_p2_t1_g28459;
  double cse_p2_t1_g28460;
  double cse_p2_t1_g28461;
  double cse_p2_t1_g28462;
  double cse_p2_t1_g28463;
  double cse_p2_t1_g28464;
  double cse_p2_t1_g28465;
  double cse_p2_t1_g28466;
  double cse_p2_t29_g28433;
  double cse_p2_t2_g28406;
  double cse_p2_t30_g28434;
  double cse_p2_t31_g28435;
  double cse_p2_t32_g28436;
  double cse_p2_t33_g28437;
  double cse_p2_t34_g28438;
  double cse_p2_t39_g28443;
  double cse_p2_t3_g28407;
  double cse_p2_t40_g28444;
  double cse_p2_t41_g28445;
  double cse_p2_t42_g28446;
  double cse_p2_t43_g28447;
  double cse_p2_t44_g28448;
  double cse_p2_t4_g28408;
  double cse_p3_t19_g28485;
  double cse_p3_t1_g28506;
  double cse_p3_t1_g28507;
  double cse_p3_t1_g28508;
  double cse_p3_t1_g28509;
  double cse_p3_t1_g28510;
  double cse_p3_t20_g28486;
  double cse_p3_t21_g28487;
  double cse_p3_t22_g28488;
  double cse_p3_t23_g28489;
  double cse_p3_t24_g28490;
  double cse_p3_t25_g28491;
  double cse_p3_t26_g28492;
  double cse_p3_t27_g28493;
  double cse_p3_t28_g28494;
  double cse_p3_t29_g28495;
  double cse_p3_t30_g28496;
  double cse_p3_t32_g28498;
  double cse_p3_t33_g28499;
  double cse_p3_t34_g28500;
  double cse_p3_t35_g28501;
  double cse_p3_t36_g28502;
  double cse_p3_t37_g28503;
  double cse_p3_t3_g28469;
  double cse_p3_t5_g28471;
  double cse_p4_t10_g28525;
  double cse_p4_t11_g28526;
  double cse_p4_t12_g28527;
  double cse_p4_t13_g28528;
  double cse_p4_t14_g28529;
  double cse_p4_t15_g28530;
  double cse_p4_t16_g28531;
  double cse_p4_t5_g28520;
  double cse_p4_t6_g28521;
  double cse_p4_t7_g28522;
  double cse_p4_t8_g28523;
  double cse_p4_t9_g28524;
  double cse_p502_t1_g41985;
  double cse_p503_t1_g42079;
  double cse_p503_t1_g42080;
  double cse_p503_t1_g42081;
  double cse_p503_t1_g42082;
  double cse_p503_t1_g42083;
  double cse_p503_t1_g42084;
  double cse_p503_t1_g42085;
  double cse_p503_t1_g42095;
  double cse_p503_t40_g42037;
  double cse_p503_t41_g42038;
  double cse_p503_t42_g42039;
  double cse_p504_t44_g42139;
  double cse_p504_t45_g42140;
  double cse_p504_t46_g42141;
  double cse_p504_t47_g42142;
  double cse_p504_t48_g42143;
  double cse_p504_t49_g42144;
  double cse_p504_t50_g42145;
  double cse_p504_t52_g42147;
  double cse_p504_t53_g42148;
  double cse_p504_t54_g42149;
  double cse_p504_t55_g42150;
  double cse_p504_t56_g42151;
  double cse_p504_t57_g42152;
  double cse_p504_t58_g42153;
  double cse_p504_t59_g42154;
  double cse_p504_t60_g42155;
  double cse_p504_t61_g42156;
  double cse_p504_t62_g42157;
  double cse_p504_t63_g42158;
  double cse_p504_t64_g42159;
  double cse_p505_t14_g42190;
  double cse_p505_t15_g42191;
  double cse_p505_t16_g42192;
  double cse_p505_t17_g42193;
  double cse_p505_t18_g42194;
  double cse_p505_t19_g42195;
  double cse_p505_t20_g42196;
  double cse_p505_t21_g42197;
  double cse_p505_t22_g42198;
  double cse_p505_t26_g42202;
  double cse_p505_t27_g42203;
  double cse_p505_t28_g42204;
  double cse_p505_t29_g42205;
  double cse_p505_t30_g42206;
  double cse_p505_t31_g42207;
  double cse_p505_t32_g42208;
  double cse_p505_t33_g42209;
  double cse_p505_t34_g42210;
  double cse_p505_t35_g42211;
  double cse_p505_t36_g42212;
  double cse_p505_t37_g42213;
  double cse_p505_t38_g42214;
  double cse_p505_t39_g42215;
  double cse_p505_t40_g42216;
  double cse_p505_t41_g42217;
  double cse_p505_t42_g42218;
  double cse_p505_t43_g42219;
  double cse_p505_t44_g42220;
  double cse_p505_t45_g42221;
  double cse_p505_t46_g42222;
  double cse_p505_t47_g42223;
  double cse_p505_t48_g42224;
  double cse_p505_t64_g42240;
  double cse_p506_t1_g42288;
  double cse_p506_t1_g42289;
  double cse_p506_t20_g42268;
  double cse_p506_t21_g42269;
  double cse_p506_t22_g42270;
  double cse_p506_t23_g42271;
  double cse_p506_t24_g42272;
  double cse_p506_t25_g42273;
  double cse_p506_t26_g42274;
  double cse_p506_t27_g42275;
  double cse_p506_t28_g42276;
  double cse_p507_t14_g42303;
  double cse_p507_t16_g42305;
  double cse_p507_t18_g42307;
  double cse_p507_t1_g42322;
  double cse_p507_t21_g42310;
  double cse_p507_t25_g42314;
  double cse_p508_t14_g42336;
  double cse_p508_t15_g42337;
  double cse_p50_t7_g29822;
  double cse_p53_t1_g29853;
  double cse_p53_t1_g29854;
  double cse_p53_t1_g29855;
  double cse_p53_t1_g29856;
  double cse_p552_t10_g43434;
  double cse_p552_t11_g43435;
  double cse_p552_t12_g43436;
  double cse_p552_t13_g43437;
  double cse_p552_t14_g43438;
  double cse_p552_t15_g43439;
  double cse_p552_t16_g43440;
  double cse_p552_t17_g43441;
  double cse_p552_t18_g43442;
  double cse_p552_t19_g43443;
  double cse_p552_t1_g43425;
  double cse_p552_t20_g43444;
  double cse_p552_t21_g43445;
  double cse_p552_t22_g43446;
  double cse_p552_t23_g43447;
  double cse_p552_t24_g43448;
  double cse_p552_t25_g43449;
  double cse_p552_t2_g43426;
  double cse_p552_t3_g43427;
  double cse_p552_t4_g43428;
  double cse_p552_t5_g43429;
  double cse_p552_t6_g43430;
  double cse_p552_t7_g43431;
  double cse_p552_t8_g43432;
  double cse_p552_t9_g43433;
  double d2e_base_dr2;
  double d2e_dr2;
  double d2s_dr2;
  double d2s_dt2;
  double de_base_dr;
  double de_dr;
  double drs;
  double ds_dr;
  double ds_dt;
  double dx;
  double dy;
  double dz;
  double energy;
  double e_base;
  double e_coul;
  double e_lj;
  double g_x1;
  double g_x2;
  double g_y1;
  double g_y2;
  double g_z1;
  double g_z2;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_z1;
  double h_x1_z2;
  double h_x2_x2;
  double h_x2_y2;
  double h_x2_z2;
  double h_y1_x2;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_z1;
  double h_y1_z2;
  double h_y2_y2;
  double h_y2_z2;
  double h_z1_x2;
  double h_z1_y2;
  double h_z1_z1;
  double h_z1_z2;
  double h_z2_z2;
  double invr2;
  double invr3;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  {
    /* !BASE */
    dx = (x1 + (-(x2)));
    cse_p503_t40_g42037 = (dx * dx);
    dy = (y1 + (-(y2)));
    cse_p503_t41_g42038 = (dy * dy);
    dz = (z1 + (-(z2)));
    cse_p503_t42_g42039 = (dz * dz);
    r2 = (cse_p503_t40_g42037 + cse_p503_t41_g42038 + cse_p503_t42_g42039);
    if ((r2 < r_cut2)) {
      /* !CUT */
      cse_p50_t7_g29822 = pow(r2, -0.50000000000000000    );
      r = (cse_p50_t7_g29822 * r2);
      invr2 = (cse_p50_t7_g29822 * cse_p50_t7_g29822);
      invr3 = (cse_p50_t7_g29822 * invr2);
      cse_p3_t1_g28510 = (invr2 * invr2);
      invr6 = (cse_p3_t1_g28510 * invr2);
      cse_p2_t1_g28460 = (a * invr6);
      e_lj = ((cse_p2_t1_g28460 * invr6) + (-((b * invr6))));
      cse_p3_t1_g28509 = (invdd * qq);
      e_coul = (cse_p3_t1_g28509 * invr2);
      e_base = (e_coul + e_lj);
      de_base_dr = ((-2.0000000000000000     * cse_p3_t1_g28509 * invr3) + (cse_p50_t7_g29822 * invr6 * ((-12.000000000000000     * cse_p2_t1_g28460) + (6.0000000000000000     * b))));
      d2e_base_dr2 = ((6.0000000000000000     * cse_p3_t1_g28509 * cse_p3_t1_g28510) + (invr2 * invr6 * ((-42.000000000000000     * b) + (156.00000000000000     * cse_p2_t1_g28460))));
      if ((r2 < r_switch2)) {
        /* !SWITCH */
        cse_p552_t4_g43428 = (cse_p3_t1_g28510 * cse_p50_t7_g29822);
        cse_p552_t14_g43438 = (cse_p50_t7_g29822 * pow(r2, -1));
        cse_p552_t15_g43439 = (r * r);
        cse_p552_t16_g43440 = (-(cse_p503_t40_g42037));
        cse_p552_t17_g43441 = (-(cse_p503_t41_g42038));
        cse_p552_t18_g43442 = (-(cse_p503_t42_g42039));
        cse_p552_t19_g43443 = (-(dx));
        cse_p552_t20_g43444 = (-(dy));
        cse_p552_t21_g43445 = (-(dz));
        cse_p552_t22_g43446 = pow((r * r * r), -1);
        cse_p552_t23_g43447 = pow(r, -1);
        cse_p552_t24_g43448 = (r * r * r);
        cse_p552_t25_g43449 = pow(r2, -1);
        cse_p507_t25_g42314 = (-(cse_p552_t15_g43439));
        cse_p506_t20_g42268 = (cse_p503_t40_g42037 + cse_p507_t25_g42314);
        cse_p506_t21_g42269 = (cse_p503_t41_g42038 + cse_p507_t25_g42314);
        cse_p506_t22_g42270 = (cse_p503_t42_g42039 + cse_p507_t25_g42314);
        cse_p506_t26_g42274 = (cse_p552_t15_g43439 + cse_p552_t16_g43440);
        cse_p506_t27_g42275 = (cse_p552_t15_g43439 + cse_p552_t17_g43441);
        cse_p506_t28_g42276 = (cse_p552_t15_g43439 + cse_p552_t18_g43442);
        cse_p503_t1_g42095 = (cse_p3_t1_g28509 * cse_p50_t7_g29822 * cse_p552_t14_g43438);
        cse_p552_t1_g43425 = (-2.0000000000000000     * cse_p503_t1_g42095);
        cse_p552_t2_g43426 = (2.0000000000000000     * cse_p503_t1_g42095);
        cse_p1_t1_g28398 = (cse_p2_t1_g28460 * cse_p50_t7_g29822 * cse_p552_t25_g43449 * cse_p552_t4_g43428);
        cse_p53_t1_g29853 = (-12.000000000000000     * cse_p1_t1_g28398);
        cse_p2_t2_g28406 = (cse_p53_t1_g29853 * dx);
        cse_p2_t3_g28407 = (cse_p53_t1_g29853 * dy);
        cse_p2_t4_g28408 = (cse_p53_t1_g29853 * dz);
        cse_p53_t1_g29855 = (12.000000000000000     * cse_p1_t1_g28398);
        cse_p2_t11_g28415 = (cse_p53_t1_g29855 * dx);
        cse_p2_t12_g28416 = (cse_p53_t1_g29855 * dy);
        cse_p2_t13_g28417 = (cse_p53_t1_g29855 * dz);
        cse_p3_t19_g28485 = (cse_p552_t1_g43425 * dx);
        cse_p3_t20_g28486 = (cse_p552_t1_g43425 * dy);
        cse_p3_t21_g28487 = (cse_p552_t1_g43425 * dz);
        cse_p2_t1_g28457 = (cse_p552_t14_g43438 * cse_p552_t4_g43428);
        cse_p552_t3_g43427 = (b * cse_p2_t1_g28457);
        cse_p3_t3_g28469 = (-6.0000000000000000     * cse_p552_t3_g43427);
        cse_p3_t5_g28471 = (6.0000000000000000     * cse_p552_t3_g43427);
        cse_p3_t22_g28488 = (cse_p3_t3_g28469 * dx);
        cse_p3_t23_g28489 = (cse_p3_t3_g28469 * dy);
        cse_p3_t24_g28490 = (cse_p3_t3_g28469 * dz);
        cse_p3_t25_g28491 = (cse_p552_t2_g43426 * dx);
        cse_p3_t26_g28492 = (cse_p552_t2_g43426 * dy);
        cse_p3_t27_g28493 = (cse_p552_t2_g43426 * dz);
        cse_p3_t28_g28494 = (cse_p3_t5_g28471 * dx);
        cse_p3_t29_g28495 = (cse_p3_t5_g28471 * dy);
        cse_p3_t30_g28496 = (cse_p3_t5_g28471 * dz);
        cse_p1_t46_g28378 = (cse_p2_t2_g28406 + cse_p3_t19_g28485 + cse_p3_t28_g28494);
        cse_p1_t47_g28379 = (cse_p2_t3_g28407 + cse_p3_t20_g28486 + cse_p3_t29_g28495);
        cse_p1_t48_g28380 = (cse_p2_t4_g28408 + cse_p3_t21_g28487 + cse_p3_t30_g28496);
        cse_p1_t49_g28381 = (cse_p2_t11_g28415 + cse_p3_t22_g28488 + cse_p3_t25_g28491);
        cse_p1_t50_g28382 = (cse_p2_t12_g28416 + cse_p3_t23_g28489 + cse_p3_t26_g28492);
        cse_p1_t51_g28383 = (cse_p2_t13_g28417 + cse_p3_t24_g28490 + cse_p3_t27_g28493);
        energy = e_base;
        *energy_accumulate += energy;
        g_x1 = cse_p1_t46_g28378;
        KernelGradientAcc(i3x1, 0, g_x1);
        g_y1 = cse_p1_t47_g28379;
        KernelGradientAcc(i3x1, 1, g_y1);
        g_z1 = cse_p1_t48_g28380;
        KernelGradientAcc(i3x1, 2, g_z1);
        g_x2 = cse_p1_t49_g28381;
        KernelGradientAcc(i3x2, 0, g_x2);
        g_y2 = cse_p1_t50_g28382;
        KernelGradientAcc(i3x2, 1, g_y2);
        g_z2 = cse_p1_t51_g28383;
        KernelGradientAcc(i3x2, 2, g_z2);
        de_dr = de_base_dr;
        cse_p503_t1_g42080 = (cse_p552_t22_g43446 * de_base_dr);
        cse_p552_t12_g43436 = (cse_p503_t1_g42080 * dy);
        cse_p552_t13_g43437 = (cse_p503_t1_g42080 * dz);
        cse_p507_t1_g42322 = (cse_p552_t12_g43436 * cse_p552_t19_g43443);
        cse_p507_t18_g42307 = (cse_p552_t12_g43436 * dx);
        cse_p505_t14_g42190 = (cse_p503_t1_g42080 * cse_p506_t20_g42268);
        cse_p505_t15_g42191 = (cse_p503_t1_g42080 * cse_p506_t21_g42269);
        cse_p505_t16_g42192 = (cse_p503_t1_g42080 * cse_p506_t22_g42270);
        cse_p505_t20_g42196 = (cse_p503_t1_g42080 * cse_p506_t26_g42274);
        cse_p505_t21_g42197 = (cse_p503_t1_g42080 * cse_p506_t27_g42275);
        cse_p505_t22_g42198 = (cse_p503_t1_g42080 * cse_p506_t28_g42276);
        cse_p505_t30_g42206 = (cse_p552_t13_g43437 * cse_p552_t19_g43443);
        cse_p505_t31_g42207 = (cse_p552_t13_g43437 * cse_p552_t20_g43444);
        cse_p505_t32_g42208 = (cse_p552_t13_g43437 * dx);
        cse_p505_t33_g42209 = (cse_p552_t13_g43437 * dy);
        d2e_dr2 = d2e_base_dr2;
        cse_p503_t1_g42079 = (cse_p552_t23_g43447 * cse_p552_t23_g43447 * d2e_base_dr2);
        cse_p552_t5_g43429 = (cse_p503_t1_g42079 * cse_p552_t19_g43443);
        cse_p552_t6_g43430 = (cse_p503_t1_g42079 * cse_p552_t20_g43444);
        cse_p552_t7_g43431 = (cse_p503_t1_g42079 * cse_p552_t21_g43445);
        cse_p552_t8_g43432 = (cse_p503_t1_g42079 * dx);
        cse_p552_t9_g43433 = (cse_p503_t1_g42079 * dy * dy);
        cse_p552_t10_g43434 = (cse_p503_t1_g42079 * dy * dz);
        cse_p552_t11_g43435 = (cse_p503_t1_g42079 * dz * dz);
        cse_p508_t15_g42337 = (cse_p552_t8_g43432 * dy);
        cse_p507_t14_g42303 = (cse_p552_t8_g43432 * dx);
        cse_p507_t16_g42305 = (cse_p552_t8_g43432 * dz);
        cse_p507_t21_g42310 = (cse_p507_t1_g42322 + cse_p508_t15_g42337);
        cse_p505_t34_g42210 = (cse_p552_t19_g43443 * cse_p552_t5_g43429);
        cse_p505_t35_g42211 = (cse_p552_t20_g43444 * cse_p552_t5_g43429);
        cse_p505_t36_g42212 = (cse_p552_t21_g43445 * cse_p552_t5_g43429);
        cse_p505_t37_g42213 = (cse_p552_t5_g43429 * dx);
        cse_p505_t38_g42214 = (cse_p552_t5_g43429 * dy);
        cse_p505_t39_g42215 = (cse_p552_t5_g43429 * dz);
        cse_p505_t40_g42216 = (cse_p552_t20_g43444 * cse_p552_t6_g43430);
        cse_p505_t41_g42217 = (cse_p552_t21_g43445 * cse_p552_t6_g43430);
        cse_p505_t42_g42218 = (cse_p552_t6_g43430 * dx);
        cse_p505_t43_g42219 = (cse_p552_t6_g43430 * dy);
        cse_p505_t44_g42220 = (cse_p552_t6_g43430 * dz);
        cse_p505_t45_g42221 = (cse_p552_t21_g43445 * cse_p552_t7_g43431);
        cse_p505_t46_g42222 = (cse_p552_t7_g43431 * dx);
        cse_p505_t47_g42223 = (cse_p552_t7_g43431 * dy);
        cse_p505_t48_g42224 = (cse_p552_t7_g43431 * dz);
        cse_p504_t50_g42145 = (cse_p505_t20_g42196 + cse_p507_t14_g42303);
        cse_p504_t52_g42147 = (cse_p505_t30_g42206 + cse_p507_t16_g42305);
        cse_p504_t53_g42148 = (cse_p505_t21_g42197 + cse_p552_t9_g43433);
        cse_p504_t54_g42149 = (cse_p505_t31_g42207 + cse_p552_t10_g43434);
        cse_p504_t55_g42150 = (cse_p505_t22_g42198 + cse_p552_t11_g43435);
        cse_p504_t44_g42139 = (cse_p505_t14_g42190 + cse_p505_t37_g42213);
        cse_p504_t47_g42142 = (cse_p505_t20_g42196 + cse_p505_t34_g42210);
        cse_p504_t56_g42151 = (cse_p505_t38_g42214 + cse_p507_t18_g42307);
        cse_p504_t58_g42153 = (cse_p505_t35_g42211 + cse_p507_t1_g42322);
        cse_p504_t59_g42154 = (cse_p505_t30_g42206 + cse_p505_t36_g42212);
        cse_p504_t60_g42155 = (cse_p505_t32_g42208 + cse_p505_t39_g42215);
        cse_p504_t45_g42140 = (cse_p505_t15_g42191 + cse_p505_t43_g42219);
        cse_p504_t48_g42143 = (cse_p505_t21_g42197 + cse_p505_t40_g42216);
        cse_p504_t57_g42152 = (cse_p505_t42_g42218 + cse_p507_t18_g42307);
        cse_p504_t61_g42156 = (cse_p505_t31_g42207 + cse_p505_t41_g42217);
        cse_p504_t62_g42157 = (cse_p505_t33_g42209 + cse_p505_t44_g42220);
        cse_p504_t46_g42141 = (cse_p505_t16_g42192 + cse_p505_t48_g42224);
        cse_p504_t49_g42144 = (cse_p505_t22_g42198 + cse_p505_t45_g42221);
        cse_p504_t63_g42158 = (cse_p505_t32_g42208 + cse_p505_t46_g42222);
        cse_p504_t64_g42159 = (cse_p505_t33_g42209 + cse_p505_t47_g42223);
        h_x1_x1 = cse_p504_t50_g42145;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
        h_x1_y1 = cse_p507_t21_g42310;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
        h_x1_z1 = cse_p504_t52_g42147;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
        h_x1_x2 = cse_p504_t44_g42139;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
        h_x1_y2 = cse_p504_t57_g42152;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
        h_x1_z2 = cse_p504_t63_g42158;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
        h_y1_y1 = cse_p504_t53_g42148;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
        h_y1_z1 = cse_p504_t54_g42149;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
        h_y1_x2 = cse_p504_t56_g42151;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
        h_y1_y2 = cse_p504_t45_g42140;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
        h_y1_z2 = cse_p504_t64_g42159;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
        h_z1_z1 = cse_p504_t55_g42150;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
        h_z1_x2 = cse_p504_t60_g42155;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
        h_z1_y2 = cse_p504_t62_g42157;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
        h_z1_z2 = cse_p504_t46_g42141;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
        h_x2_x2 = cse_p504_t47_g42142;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
        h_x2_y2 = cse_p504_t58_g42153;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
        h_x2_z2 = cse_p504_t59_g42154;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
        h_y2_y2 = cse_p504_t48_g42143;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
        h_y2_z2 = cse_p504_t61_g42156;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
        h_z2_z2 = cse_p504_t49_g42144;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
      } else {
        /* !SKIN */
        cse_p502_t1_g41985 = (cse_p50_t7_g29822 * pow(r2, -1));
        cse_p1_t1_g28397 = (cse_p502_t1_g41985 * r2);
        cse_p1_t1_g28400 = (-(cse_p1_t1_g28397));
        cse_p4_t5_g28520 = (cse_p1_t1_g28400 * dx);
        cse_p4_t6_g28521 = (cse_p1_t1_g28400 * dy);
        cse_p4_t7_g28522 = (cse_p1_t1_g28400 * dz);
        cse_p1_t1_g28401 = (-2.0000000000000000     * cse_p50_t7_g29822);
        cse_p4_t8_g28523 = (cse_p1_t1_g28401 * dx);
        cse_p4_t9_g28524 = (cse_p1_t1_g28401 * dy);
        cse_p4_t10_g28525 = (cse_p1_t1_g28401 * dz);
        cse_p4_t11_g28526 = (cse_p1_t1_g28397 * dx);
        cse_p4_t12_g28527 = (cse_p1_t1_g28397 * dy);
        cse_p4_t13_g28528 = (cse_p1_t1_g28397 * dz);
        cse_p3_t35_g28501 = (cse_p4_t11_g28526 + cse_p4_t8_g28523);
        cse_p3_t36_g28502 = (cse_p4_t12_g28527 + cse_p4_t9_g28524);
        cse_p3_t37_g28503 = (cse_p4_t10_g28525 + cse_p4_t13_g28528);
        cse_p1_t1_g28404 = (2.0000000000000000     * cse_p50_t7_g29822);
        cse_p4_t14_g28529 = (cse_p1_t1_g28404 * dx);
        cse_p4_t15_g28530 = (cse_p1_t1_g28404 * dy);
        cse_p4_t16_g28531 = (cse_p1_t1_g28404 * dz);
        cse_p3_t32_g28498 = (cse_p4_t14_g28529 + cse_p4_t5_g28520);
        cse_p3_t33_g28499 = (cse_p4_t15_g28530 + cse_p4_t6_g28521);
        cse_p3_t34_g28500 = (cse_p4_t16_g28531 + cse_p4_t7_g28522);
        drs = (r + (-(r_switch)));
        t1 = (drs * inv_range);
        cse_p1_t1_g28399 = (inv_range * t1);
        cse_p1_t1_g28403 = (2.0000000000000000     * cse_p1_t1_g28399);
        cse_p2_t1_g28466 = (cse_p1_t1_g28403 * t1);
        cse_p2_t29_g28433 = (cse_p2_t1_g28466 * cse_p3_t32_g28498);
        cse_p2_t30_g28434 = (cse_p2_t1_g28466 * cse_p3_t33_g28499);
        cse_p2_t31_g28435 = (cse_p2_t1_g28466 * cse_p3_t34_g28500);
        cse_p2_t32_g28436 = (cse_p2_t1_g28466 * cse_p3_t35_g28501);
        cse_p2_t33_g28437 = (cse_p2_t1_g28466 * cse_p3_t36_g28502);
        cse_p2_t34_g28438 = (cse_p2_t1_g28466 * cse_p3_t37_g28503);
        t2 = (t1 * t1);
        cse_p3_t1_g28508 = (inv_range * t2);
        cse_p2_t39_g28443 = (cse_p3_t1_g28508 * cse_p3_t32_g28498);
        cse_p2_t40_g28444 = (cse_p3_t1_g28508 * cse_p3_t33_g28499);
        cse_p2_t41_g28445 = (cse_p3_t1_g28508 * cse_p3_t34_g28500);
        cse_p2_t42_g28446 = (cse_p3_t1_g28508 * cse_p3_t35_g28501);
        cse_p2_t43_g28447 = (cse_p3_t1_g28508 * cse_p3_t36_g28502);
        cse_p2_t44_g28448 = (cse_p3_t1_g28508 * cse_p3_t37_g28503);
        cse_p1_t52_g28384 = (cse_p2_t29_g28433 + cse_p2_t39_g28443);
        cse_p1_t53_g28385 = (cse_p2_t30_g28434 + cse_p2_t40_g28444);
        cse_p1_t54_g28386 = (cse_p2_t31_g28435 + cse_p2_t41_g28445);
        cse_p1_t55_g28387 = (cse_p2_t32_g28436 + cse_p2_t42_g28446);
        cse_p1_t56_g28388 = (cse_p2_t33_g28437 + cse_p2_t43_g28447);
        cse_p1_t57_g28389 = (cse_p2_t34_g28438 + cse_p2_t44_g28448);
        t3 = (t1 * t2);
        t4 = (t2 * t2);
        t5 = (t2 * t3);
        s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
        ds_dt = ((-30.000000000000000     * t2) + (-30.000000000000000     * t4) + (60.000000000000000     * t3));
        d2s_dt2 = ((-120.00000000000000     * t3) + (-60.000000000000000     * t1) + (180.00000000000000     * t2));
        ds_dr = (ds_dt * inv_range);
        d2s_dr2 = (d2s_dt2 * inv_range * inv_range);
        energy = (e_base * s);
        *energy_accumulate += energy;
        cse_p1_t1_g28396 = (cse_p3_t1_g28510 * cse_p50_t7_g29822);
        cse_p2_t1_g28457 = (cse_p1_t1_g28396 * cse_p502_t1_g41985);
        cse_p503_t1_g42095 = (cse_p3_t1_g28509 * cse_p502_t1_g41985 * cse_p50_t7_g29822);
        cse_p2_t1_g28459 = (b * cse_p2_t1_g28457);
        cse_p2_t1_g28461 = (60.000000000000000     * cse_p1_t1_g28399 * t2);
        cse_p2_t1_g28462 = (-2.0000000000000000     * cse_p503_t1_g42095);
        cse_p2_t1_g28465 = (6.0000000000000000     * cse_p2_t1_g28459);
        cse_p3_t1_g28506 = (cse_p1_t1_g28403 * t3);
        cse_p3_t1_g28507 = (cse_p2_t1_g28457 * cse_p2_t1_g28460);
        cse_p53_t1_g29854 = (-12.000000000000000     * cse_p3_t1_g28507);
        g_x1 = ((e_base * ((-10.000000000000000     * cse_p1_t52_g28384) + (-6.0000000000000000     * ((cse_p1_t52_g28384 * t2) + (cse_p3_t1_g28506 * cse_p3_t32_g28498))) + (cse_p2_t1_g28461 * cse_p3_t32_g28498))) + (s * ((cse_p2_t1_g28462 * dx) + (cse_p2_t1_g28465 * dx) + (cse_p53_t1_g29854 * dx))));
        KernelGradientAcc(i3x1, 0, g_x1);
        g_y1 = ((e_base * ((-10.000000000000000     * cse_p1_t53_g28385) + (-6.0000000000000000     * ((cse_p1_t53_g28385 * t2) + (cse_p3_t1_g28506 * cse_p3_t33_g28499))) + (cse_p2_t1_g28461 * cse_p3_t33_g28499))) + (s * ((cse_p2_t1_g28462 * dy) + (cse_p2_t1_g28465 * dy) + (cse_p53_t1_g29854 * dy))));
        KernelGradientAcc(i3x1, 1, g_y1);
        g_z1 = ((e_base * ((-10.000000000000000     * cse_p1_t54_g28386) + (-6.0000000000000000     * ((cse_p1_t54_g28386 * t2) + (cse_p3_t1_g28506 * cse_p3_t34_g28500))) + (cse_p2_t1_g28461 * cse_p3_t34_g28500))) + (s * ((cse_p2_t1_g28462 * dz) + (cse_p2_t1_g28465 * dz) + (cse_p53_t1_g29854 * dz))));
        KernelGradientAcc(i3x1, 2, g_z1);
        cse_p2_t1_g28463 = (-6.0000000000000000     * cse_p2_t1_g28459);
        cse_p2_t1_g28464 = (2.0000000000000000     * cse_p503_t1_g42095);
        cse_p53_t1_g29856 = (12.000000000000000     * cse_p3_t1_g28507);
        g_x2 = ((e_base * ((-10.000000000000000     * cse_p1_t55_g28387) + (-6.0000000000000000     * ((cse_p1_t55_g28387 * t2) + (cse_p3_t1_g28506 * cse_p3_t35_g28501))) + (cse_p2_t1_g28461 * cse_p3_t35_g28501))) + (s * ((cse_p2_t1_g28463 * dx) + (cse_p2_t1_g28464 * dx) + (cse_p53_t1_g29856 * dx))));
        KernelGradientAcc(i3x2, 0, g_x2);
        g_y2 = ((e_base * ((-10.000000000000000     * cse_p1_t56_g28388) + (-6.0000000000000000     * ((cse_p1_t56_g28388 * t2) + (cse_p3_t1_g28506 * cse_p3_t36_g28502))) + (cse_p2_t1_g28461 * cse_p3_t36_g28502))) + (s * ((cse_p2_t1_g28463 * dy) + (cse_p2_t1_g28464 * dy) + (cse_p53_t1_g29856 * dy))));
        KernelGradientAcc(i3x2, 1, g_y2);
        g_z2 = ((e_base * ((-10.000000000000000     * cse_p1_t57_g28389) + (-6.0000000000000000     * ((cse_p1_t57_g28389 * t2) + (cse_p3_t1_g28506 * cse_p3_t37_g28503))) + (cse_p2_t1_g28461 * cse_p3_t37_g28503))) + (s * ((cse_p2_t1_g28463 * dz) + (cse_p2_t1_g28464 * dz) + (cse_p53_t1_g29856 * dz))));
        KernelGradientAcc(i3x2, 2, g_z2);
        de_dr = ((de_base_dr * s) + (ds_dr * e_base));
        d2e_dr2 = ((2.0000000000000000     * de_base_dr * ds_dr) + (d2e_base_dr2 * s) + (d2s_dr2 * e_base));
        cse_p503_t1_g42079 = (d2e_dr2 * pow(r, -1) * pow(r, -1));
        cse_p503_t1_g42080 = (de_dr * pow((r * r * r), -1));
        cse_p503_t1_g42081 = (r * r);
        cse_p506_t23_g42271 = (cse_p503_t1_g42081 + (-(cse_p503_t40_g42037)));
        cse_p506_t24_g42272 = (cse_p503_t1_g42081 + (-(cse_p503_t41_g42038)));
        cse_p506_t25_g42273 = (cse_p503_t1_g42081 + (-(cse_p503_t42_g42039)));
        cse_p505_t17_g42193 = (cse_p503_t1_g42080 * cse_p506_t23_g42271);
        cse_p505_t18_g42194 = (cse_p503_t1_g42080 * cse_p506_t24_g42272);
        cse_p505_t19_g42195 = (cse_p503_t1_g42080 * cse_p506_t25_g42273);
        cse_p505_t64_g42240 = (-(cse_p503_t1_g42081));
        cse_p506_t1_g42288 = (cse_p503_t1_g42079 * dx);
        h_x1_x1 = (cse_p505_t17_g42193 + (cse_p506_t1_g42288 * dx));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
        cse_p506_t1_g42289 = (cse_p503_t1_g42080 * dy);
        cse_p508_t14_g42336 = (cse_p506_t1_g42289 * dx);
        cse_p507_t1_g42322 = (cse_p506_t1_g42289 * (-(dx)));
        h_x1_y1 = (cse_p507_t1_g42322 + (cse_p506_t1_g42288 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
        cse_p503_t1_g42084 = (cse_p503_t1_g42080 * dz);
        cse_p505_t26_g42202 = (cse_p503_t1_g42084 * (-(dx)));
        cse_p505_t27_g42203 = (cse_p503_t1_g42084 * (-(dy)));
        cse_p505_t28_g42204 = (cse_p503_t1_g42084 * dx);
        cse_p505_t29_g42205 = (cse_p503_t1_g42084 * dy);
        h_x1_z1 = (cse_p505_t26_g42202 + (cse_p506_t1_g42288 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
        cse_p503_t1_g42082 = (cse_p503_t1_g42079 * (-(dx)));
        h_x1_x2 = ((cse_p503_t1_g42080 * (cse_p503_t40_g42037 + cse_p505_t64_g42240)) + (cse_p503_t1_g42082 * dx));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
        cse_p503_t1_g42083 = (cse_p503_t1_g42079 * (-(dy)));
        h_x1_y2 = (cse_p508_t14_g42336 + (cse_p503_t1_g42083 * dx));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
        cse_p503_t1_g42085 = (cse_p503_t1_g42079 * (-(dz)));
        h_x1_z2 = (cse_p505_t28_g42204 + (cse_p503_t1_g42085 * dx));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
        h_y1_y1 = (cse_p505_t18_g42194 + (cse_p503_t1_g42079 * dy * dy));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
        h_y1_z1 = (cse_p505_t27_g42203 + (cse_p503_t1_g42079 * dy * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
        h_y1_x2 = (cse_p508_t14_g42336 + (cse_p503_t1_g42082 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
        h_y1_y2 = ((cse_p503_t1_g42080 * (cse_p503_t41_g42038 + cse_p505_t64_g42240)) + (cse_p503_t1_g42083 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
        h_y1_z2 = (cse_p505_t29_g42205 + (cse_p503_t1_g42085 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
        h_z1_z1 = (cse_p505_t19_g42195 + (cse_p503_t1_g42079 * dz * dz));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
        h_z1_x2 = (cse_p505_t28_g42204 + (cse_p503_t1_g42082 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
        h_z1_y2 = (cse_p505_t29_g42205 + (cse_p503_t1_g42083 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
        h_z1_z2 = ((cse_p503_t1_g42080 * (cse_p503_t42_g42039 + cse_p505_t64_g42240)) + (cse_p503_t1_g42085 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
        h_x2_x2 = (cse_p505_t17_g42193 + (cse_p503_t1_g42082 * (-(dx))));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
        h_x2_y2 = (cse_p507_t1_g42322 + (cse_p503_t1_g42082 * (-(dy))));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
        h_x2_z2 = (cse_p505_t26_g42202 + (cse_p503_t1_g42082 * (-(dz))));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
        h_y2_y2 = (cse_p505_t18_g42194 + (cse_p503_t1_g42083 * (-(dy))));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
        h_y2_z2 = (cse_p505_t27_g42203 + (cse_p503_t1_g42083 * (-(dz))));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
        h_z2_z2 = (cse_p505_t19_g42195 + (cse_p503_t1_g42085 * (-(dz))));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
      }
    }
  }
}
template <typename HESSIAN>
void nonbond_dd_cutoff_hessian_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 6;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    nonbond_dd_cutoff_energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
}

