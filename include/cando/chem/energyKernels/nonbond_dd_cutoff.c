template <typename HESSIAN>
struct Nonbond_Dd_Cutoff {
  static constexpr size_t PositionSize = 6;
  static std::string description() { return "mathkernel-nonbond_dd_cutoff"; };
void gradient(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double cse_p11_t1_g1257;
  double cse_p11_t1_g1258;
  double cse_p11_t1_g1259;
  double cse_p11_t1_g1260;
  double cse_p11_t1_g1261;
  double cse_p11_t1_g1263;
  double cse_p11_t1_g1264;
  double cse_p11_t1_g1265;
  double cse_p11_t32_g1239;
  double cse_p11_t33_g1240;
  double cse_p11_t34_g1241;
  double cse_p11_t35_g1242;
  double cse_p11_t36_g1243;
  double cse_p11_t37_g1244;
  double cse_p12_t15_g1282;
  double cse_p12_t16_g1283;
  double cse_p12_t17_g1284;
  double cse_p12_t18_g1285;
  double cse_p12_t19_g1286;
  double cse_p12_t1_g1307;
  double cse_p12_t1_g1308;
  double cse_p12_t1_g1309;
  double cse_p12_t1_g1310;
  double cse_p12_t1_g1311;
  double cse_p12_t1_g1312;
  double cse_p12_t1_g1313;
  double cse_p12_t20_g1287;
  double cse_p12_t21_g1288;
  double cse_p12_t25_g1292;
  double cse_p12_t26_g1293;
  double cse_p12_t27_g1294;
  double cse_p12_t28_g1295;
  double cse_p12_t29_g1296;
  double cse_p12_t30_g1297;
  double cse_p13_t16_g1331;
  double cse_p13_t17_g1332;
  double cse_p13_t18_g1333;
  double cse_p13_t19_g1334;
  double cse_p13_t1_g1349;
  double cse_p13_t20_g1335;
  double cse_p13_t21_g1336;
  double cse_p13_t22_g1337;
  double cse_p14_t10_g1359;
  double cse_p14_t11_g1360;
  double cse_p14_t12_g1361;
  double cse_p14_t13_g1362;
  double cse_p14_t14_g1363;
  double cse_p14_t16_g1365;
  double cse_p14_t1_g1366;
  double cse_p14_t1_g1367;
  double cse_p14_t1_g1368;
  double cse_p14_t1_g1370;
  double cse_p14_t1_g1371;
  double cse_p14_t3_g1352;
  double cse_p14_t4_g1353;
  double cse_p14_t5_g1354;
  double cse_p14_t6_g1355;
  double cse_p14_t7_g1356;
  double cse_p14_t8_g1357;
  double cse_p14_t9_g1358;
  double cse_p1_t1_invsqrt1202;
  double cse_p519_t1_g7823;
  double cse_p519_t2_g7812;
  double cse_p519_t3_g7813;
  double de_base_dr;
  double de_dr;
  double drs;
  double ds_dr;
  double ds_dt;
  double dx;
  double dy;
  double dz;
  double energy;
  double e_base;
  double e_coul;
  double e_lj;
  double g_x1;
  double g_x2;
  double g_y1;
  double g_y2;
  double g_z1;
  double g_z2;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  {
    /* !BASE */
    dx = (x1 + (-(x2)));
    dy = (y1 + (-(y2)));
    dz = (z1 + (-(z2)));
    r2 = ((dx * dx) + (dy * dy) + (dz * dz));
    if ((r2 < r_cut2)) {
      /* !CUT */
      cse_p1_t1_invsqrt1202 = (1.0 / sqrt(r2));
      cse_p12_t21_g1288 = (cse_p1_t1_invsqrt1202 * cse_p1_t1_invsqrt1202);
      cse_p13_t16_g1331 = (cse_p12_t21_g1288 * cse_p1_t1_invsqrt1202);
      r = (cse_p1_t1_invsqrt1202 * r2);
      cse_p14_t1_g1366 = (cse_p12_t21_g1288 * cse_p12_t21_g1288);
      invr6 = (cse_p12_t21_g1288 * cse_p14_t1_g1366);
      cse_p12_t1_g1307 = (a * invr6);
      e_lj = ((cse_p12_t1_g1307 * invr6) + (-((b * invr6))));
      cse_p12_t1_g1313 = (invdd * qq);
      e_coul = (cse_p12_t1_g1313 * cse_p12_t21_g1288);
      e_base = (e_coul + e_lj);
      de_base_dr = ((-2.0000000000000000     * cse_p12_t1_g1313 * cse_p13_t16_g1331) + (cse_p1_t1_invsqrt1202 * invr6 * ((-12.000000000000000     * cse_p12_t1_g1307) + (6.0000000000000000     * b))));
      if ((r2 < r_switch2)) {
        /* !SWITCH */
        cse_p519_t1_g7823 = (-3.0000000000000000     * b);
        cse_p519_t2_g7812 = (3.0000000000000000     * cse_p12_t1_g1307);
        cse_p14_t16_g1365 = (cse_p519_t1_g7823 + cse_p519_t2_g7812 + cse_p519_t2_g7812);
        cse_p13_t1_g1349 = (cse_p14_t16_g1365 * cse_p14_t1_g1366);
        cse_p519_t3_g7813 = (cse_p12_t1_g1313 + cse_p13_t1_g1349);
        energy = e_base;
        *energy_accumulate += energy;
        cse_p12_t1_g1309 = (cse_p13_t16_g1331 * cse_p1_t1_invsqrt1202 * cse_p519_t3_g7813);
        cse_p14_t1_g1368 = (-2.0000000000000000     * cse_p12_t1_g1309);
        g_x1 = (cse_p14_t1_g1368 * dx);
        KernelGradientAcc(i3x1, 0, g_x1);
        g_y1 = (cse_p14_t1_g1368 * dy);
        KernelGradientAcc(i3x1, 1, g_y1);
        g_z1 = (cse_p14_t1_g1368 * dz);
        KernelGradientAcc(i3x1, 2, g_z1);
        cse_p14_t1_g1371 = (2.0000000000000000     * cse_p12_t1_g1309);
        g_x2 = (cse_p14_t1_g1371 * dx);
        KernelGradientAcc(i3x2, 0, g_x2);
        g_y2 = (cse_p14_t1_g1371 * dy);
        KernelGradientAcc(i3x2, 1, g_y2);
        g_z2 = (cse_p14_t1_g1371 * dz);
        KernelGradientAcc(i3x2, 2, g_z2);
        de_dr = de_base_dr;
      } else {
        /* !SKIN */
        cse_p11_t1_g1258 = (cse_p13_t16_g1331 * r2);
        cse_p11_t1_g1260 = (-(cse_p11_t1_g1258));
        cse_p14_t3_g1352 = (cse_p11_t1_g1260 * dx);
        cse_p14_t4_g1353 = (cse_p11_t1_g1260 * dy);
        cse_p14_t5_g1354 = (cse_p11_t1_g1260 * dz);
        cse_p11_t1_g1261 = (-2.0000000000000000     * cse_p1_t1_invsqrt1202);
        cse_p14_t6_g1355 = (cse_p11_t1_g1261 * dx);
        cse_p14_t7_g1356 = (cse_p11_t1_g1261 * dy);
        cse_p14_t8_g1357 = (cse_p11_t1_g1261 * dz);
        cse_p14_t9_g1358 = (cse_p11_t1_g1258 * dx);
        cse_p14_t10_g1359 = (cse_p11_t1_g1258 * dy);
        cse_p14_t11_g1360 = (cse_p11_t1_g1258 * dz);
        cse_p13_t20_g1335 = (cse_p14_t6_g1355 + cse_p14_t9_g1358);
        cse_p13_t21_g1336 = (cse_p14_t10_g1359 + cse_p14_t7_g1356);
        cse_p13_t22_g1337 = (cse_p14_t11_g1360 + cse_p14_t8_g1357);
        cse_p11_t1_g1264 = (2.0000000000000000     * cse_p1_t1_invsqrt1202);
        cse_p14_t12_g1361 = (cse_p11_t1_g1264 * dx);
        cse_p14_t13_g1362 = (cse_p11_t1_g1264 * dy);
        cse_p14_t14_g1363 = (cse_p11_t1_g1264 * dz);
        cse_p13_t17_g1332 = (cse_p14_t12_g1361 + cse_p14_t3_g1352);
        cse_p13_t18_g1333 = (cse_p14_t13_g1362 + cse_p14_t4_g1353);
        cse_p13_t19_g1334 = (cse_p14_t14_g1363 + cse_p14_t5_g1354);
        drs = (r + (-(r_switch)));
        t1 = (drs * inv_range);
        cse_p11_t1_g1259 = (inv_range * t1);
        cse_p11_t1_g1263 = (2.0000000000000000     * cse_p11_t1_g1259);
        cse_p11_t1_g1265 = (cse_p11_t1_g1263 * t1);
        cse_p12_t15_g1282 = (cse_p11_t1_g1265 * cse_p13_t17_g1332);
        cse_p12_t16_g1283 = (cse_p11_t1_g1265 * cse_p13_t18_g1333);
        cse_p12_t17_g1284 = (cse_p11_t1_g1265 * cse_p13_t19_g1334);
        cse_p12_t18_g1285 = (cse_p11_t1_g1265 * cse_p13_t20_g1335);
        cse_p12_t19_g1286 = (cse_p11_t1_g1265 * cse_p13_t21_g1336);
        cse_p12_t20_g1287 = (cse_p11_t1_g1265 * cse_p13_t22_g1337);
        t2 = (t1 * t1);
        cse_p12_t1_g1312 = (inv_range * t2);
        cse_p12_t25_g1292 = (cse_p12_t1_g1312 * cse_p13_t17_g1332);
        cse_p12_t26_g1293 = (cse_p12_t1_g1312 * cse_p13_t18_g1333);
        cse_p12_t27_g1294 = (cse_p12_t1_g1312 * cse_p13_t19_g1334);
        cse_p12_t28_g1295 = (cse_p12_t1_g1312 * cse_p13_t20_g1335);
        cse_p12_t29_g1296 = (cse_p12_t1_g1312 * cse_p13_t21_g1336);
        cse_p12_t30_g1297 = (cse_p12_t1_g1312 * cse_p13_t22_g1337);
        cse_p11_t32_g1239 = (cse_p12_t15_g1282 + cse_p12_t25_g1292);
        cse_p11_t33_g1240 = (cse_p12_t16_g1283 + cse_p12_t26_g1293);
        cse_p11_t34_g1241 = (cse_p12_t17_g1284 + cse_p12_t27_g1294);
        cse_p11_t35_g1242 = (cse_p12_t18_g1285 + cse_p12_t28_g1295);
        cse_p11_t36_g1243 = (cse_p12_t19_g1286 + cse_p12_t29_g1296);
        cse_p11_t37_g1244 = (cse_p12_t20_g1287 + cse_p12_t30_g1297);
        t3 = (t1 * t2);
        t4 = (t2 * t2);
        t5 = (t2 * t3);
        s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
        ds_dt = ((-30.000000000000000     * t2) + (-30.000000000000000     * t4) + (60.000000000000000     * t3));
        ds_dr = (ds_dt * inv_range);
        energy = (e_base * s);
        *energy_accumulate += energy;
        cse_p12_t1_g1310 = (3.0000000000000000     * cse_p12_t1_g1307);
        cse_p519_t1_g7823 = (-3.0000000000000000     * b);
        cse_p13_t1_g1349 = (cse_p14_t1_g1366 * (cse_p12_t1_g1310 + cse_p12_t1_g1310 + cse_p519_t1_g7823));
        cse_p11_t1_g1257 = (cse_p13_t16_g1331 * cse_p1_t1_invsqrt1202 * s * (cse_p12_t1_g1313 + cse_p13_t1_g1349));
        cse_p12_t1_g1308 = (60.000000000000000     * cse_p11_t1_g1259 * t2);
        cse_p12_t1_g1311 = (cse_p11_t1_g1263 * t3);
        cse_p14_t1_g1367 = (-2.0000000000000000     * cse_p11_t1_g1257);
        g_x1 = ((cse_p14_t1_g1367 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t32_g1239) + (-6.0000000000000000     * ((cse_p11_t32_g1239 * t2) + (cse_p12_t1_g1311 * cse_p13_t17_g1332))) + (cse_p12_t1_g1308 * cse_p13_t17_g1332))));
        KernelGradientAcc(i3x1, 0, g_x1);
        g_y1 = ((cse_p14_t1_g1367 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t33_g1240) + (-6.0000000000000000     * ((cse_p11_t33_g1240 * t2) + (cse_p12_t1_g1311 * cse_p13_t18_g1333))) + (cse_p12_t1_g1308 * cse_p13_t18_g1333))));
        KernelGradientAcc(i3x1, 1, g_y1);
        g_z1 = ((cse_p14_t1_g1367 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t34_g1241) + (-6.0000000000000000     * ((cse_p11_t34_g1241 * t2) + (cse_p12_t1_g1311 * cse_p13_t19_g1334))) + (cse_p12_t1_g1308 * cse_p13_t19_g1334))));
        KernelGradientAcc(i3x1, 2, g_z1);
        cse_p14_t1_g1370 = (2.0000000000000000     * cse_p11_t1_g1257);
        g_x2 = ((cse_p14_t1_g1370 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t35_g1242) + (-6.0000000000000000     * ((cse_p11_t35_g1242 * t2) + (cse_p12_t1_g1311 * cse_p13_t20_g1335))) + (cse_p12_t1_g1308 * cse_p13_t20_g1335))));
        KernelGradientAcc(i3x2, 0, g_x2);
        g_y2 = ((cse_p14_t1_g1370 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t36_g1243) + (-6.0000000000000000     * ((cse_p11_t36_g1243 * t2) + (cse_p12_t1_g1311 * cse_p13_t21_g1336))) + (cse_p12_t1_g1308 * cse_p13_t21_g1336))));
        KernelGradientAcc(i3x2, 1, g_y2);
        g_z2 = ((cse_p14_t1_g1370 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t37_g1244) + (-6.0000000000000000     * ((cse_p11_t37_g1244 * t2) + (cse_p12_t1_g1311 * cse_p13_t22_g1337))) + (cse_p12_t1_g1308 * cse_p13_t22_g1337))));
        KernelGradientAcc(i3x2, 2, g_z2);
        de_dr = ((de_base_dr * s) + (ds_dr * e_base));
      }
    }
  }
}
void gradient_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 6;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
}

void energy(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double cse_p11_t1_g7824;
  double drs;
  double dx;
  double dy;
  double dz;
  double energy;
  double e_base;
  double e_coul;
  double e_lj;
  double invr;
  double invr2;
  double invr3;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  {
    /* !BASE */
    dx = (x1 + (-(x2)));
    dy = (y1 + (-(y2)));
    dz = (z1 + (-(z2)));
    r2 = ((dx * dx) + (dy * dy) + (dz * dz));
    if ((r2 < r_cut2)) {
      /* !CUT */
      invr = (1.0 / sqrt(r2));
      r = (invr * r2);
      invr2 = (invr * invr);
      invr3 = (invr2 * invr);
      cse_p11_t1_g7824 = (invr2 * invr2);
      invr6 = (cse_p11_t1_g7824 * invr2);
      e_lj = ((a * invr6 * invr6) + (-((b * invr6))));
      e_coul = (invdd * invr2 * qq);
      e_base = (e_coul + e_lj);
      if ((r2 < r_switch2)) {
        /* !SWITCH */
        energy = e_base;
        *energy_accumulate += energy;
      } else {
        /* !SKIN */
        drs = (r + (-(r_switch)));
        t1 = (drs * inv_range);
        t2 = (t1 * t1);
        t3 = (t1 * t2);
        t4 = (t2 * t2);
        t5 = (t2 * t3);
        s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
        energy = (e_base * s);
        *energy_accumulate += energy;
      }
    }
  }
}
void energy_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, energy_accumulate, force, hessian, dvec, hdvec);
}

void hessian(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double cse_p11_t1_g7945;
  double cse_p11_t1_g7946;
  double cse_p11_t1_g7948;
  double cse_p11_t1_g7949;
  double cse_p11_t1_g7950;
  double cse_p11_t1_g7951;
  double cse_p11_t1_g7952;
  double cse_p11_t1_g7953;
  double cse_p11_t1_g7954;
  double cse_p11_t54_g7882;
  double cse_p11_t55_g7883;
  double cse_p11_t56_g7884;
  double cse_p11_t69_g7897;
  double cse_p11_t70_g7898;
  double cse_p11_t71_g7899;
  double cse_p11_t72_g7900;
  double cse_p11_t73_g7901;
  double cse_p11_t74_g7902;
  double cse_p12_t11_g7965;
  double cse_p12_t12_g7966;
  double cse_p12_t13_g7967;
  double cse_p12_t14_g7968;
  double cse_p12_t15_g7969;
  double cse_p12_t16_g7970;
  double cse_p12_t1_g8067;
  double cse_p12_t1_g8068;
  double cse_p12_t57_g8011;
  double cse_p12_t61_g8015;
  double cse_p12_t62_g8016;
  double cse_p12_t63_g8017;
  double cse_p12_t64_g8018;
  double cse_p12_t65_g8019;
  double cse_p12_t66_g8020;
  double cse_p12_t68_g8022;
  double cse_p12_t69_g8023;
  double cse_p12_t70_g8024;
  double cse_p12_t71_g8025;
  double cse_p12_t79_g8033;
  double cse_p12_t80_g8034;
  double cse_p12_t81_g8035;
  double cse_p12_t83_g8037;
  double cse_p12_t84_g8038;
  double cse_p12_t85_g8039;
  double cse_p12_t86_g8040;
  double cse_p12_t87_g8041;
  double cse_p12_t88_g8042;
  double cse_p12_t89_g8043;
  double cse_p12_t90_g8044;
  double cse_p12_t91_g8045;
  double cse_p12_t92_g8046;
  double cse_p12_t93_g8047;
  double cse_p12_t94_g8048;
  double cse_p12_t95_g8049;
  double cse_p13_t1_g8160;
  double cse_p13_t1_g8161;
  double cse_p13_t1_g8162;
  double cse_p13_t24_g8092;
  double cse_p13_t25_g8093;
  double cse_p13_t26_g8094;
  double cse_p13_t27_g8095;
  double cse_p13_t28_g8096;
  double cse_p13_t29_g8097;
  double cse_p13_t30_g8098;
  double cse_p13_t31_g8099;
  double cse_p13_t32_g8100;
  double cse_p13_t36_g8104;
  double cse_p13_t37_g8105;
  double cse_p13_t38_g8106;
  double cse_p13_t39_g8107;
  double cse_p13_t40_g8108;
  double cse_p13_t41_g8109;
  double cse_p13_t42_g8110;
  double cse_p13_t43_g8111;
  double cse_p13_t44_g8112;
  double cse_p13_t45_g8113;
  double cse_p13_t46_g8114;
  double cse_p13_t47_g8115;
  double cse_p13_t48_g8116;
  double cse_p13_t49_g8117;
  double cse_p13_t50_g8118;
  double cse_p13_t51_g8119;
  double cse_p13_t52_g8120;
  double cse_p13_t53_g8121;
  double cse_p13_t54_g8122;
  double cse_p13_t55_g8123;
  double cse_p13_t56_g8124;
  double cse_p13_t57_g8125;
  double cse_p13_t58_g8126;
  double cse_p13_t60_g8128;
  double cse_p13_t64_g8132;
  double cse_p13_t65_g8133;
  double cse_p13_t66_g8134;
  double cse_p13_t67_g8135;
  double cse_p13_t68_g8136;
  double cse_p13_t69_g8137;
  double cse_p13_t84_g8152;
  double cse_p14_t11_g8173;
  double cse_p14_t12_g8174;
  double cse_p14_t13_g8175;
  double cse_p14_t1_g8163;
  double cse_p14_t1_g8214;
  double cse_p14_t1_g8215;
  double cse_p14_t1_g8216;
  double cse_p14_t1_g8217;
  double cse_p14_t2_g8164;
  double cse_p14_t32_g8194;
  double cse_p14_t33_g8195;
  double cse_p14_t34_g8196;
  double cse_p14_t35_g8197;
  double cse_p14_t36_g8198;
  double cse_p14_t37_g8199;
  double cse_p14_t38_g8200;
  double cse_p14_t39_g8201;
  double cse_p14_t3_g8165;
  double cse_p14_t40_g8202;
  double cse_p14_t41_g8203;
  double cse_p14_t4_g8166;
  double cse_p14_t5_g8167;
  double cse_p14_t6_g8168;
  double cse_p15_t12_g8229;
  double cse_p15_t13_g8230;
  double cse_p15_t15_g8232;
  double cse_p15_t17_g8234;
  double cse_p15_t1_g8249;
  double cse_p15_t1_g8250;
  double cse_p15_t1_g8251;
  double cse_p15_t1_g8252;
  double cse_p15_t1_g8253;
  double cse_p15_t20_g8237;
  double cse_p15_t25_g8242;
  double cse_p16_t12_g8265;
  double cse_p16_t13_g8266;
  double cse_p16_t16_g8269;
  double cse_p1_t1_invsqrt7825;
  double cse_p522_t10_g16925;
  double cse_p522_t11_g16926;
  double cse_p522_t12_g16927;
  double cse_p522_t13_g16928;
  double cse_p522_t14_g16929;
  double cse_p522_t17_g16932;
  double cse_p522_t1_g16916;
  double cse_p522_t2_g16917;
  double cse_p522_t3_g16918;
  double cse_p522_t4_g16919;
  double cse_p522_t5_g16920;
  double cse_p522_t6_g16921;
  double cse_p522_t7_g16922;
  double cse_p522_t8_g16923;
  double cse_p522_t9_g16924;
  double cse_p523_t1_invr16933;
  double cse_p523_t2_invr16934;
  double cse_p60_t3_g9227;
  double cse_p60_t4_g9228;
  double cse_p60_t5_g9229;
  double cse_p65_t10_g9261;
  double cse_p65_t11_g9262;
  double cse_p65_t1_g9274;
  double cse_p65_t1_g9275;
  double cse_p65_t1_g9276;
  double cse_p65_t1_g9277;
  double cse_p65_t1_g9278;
  double cse_p65_t1_g9279;
  double cse_p65_t1_g9280;
  double cse_p65_t1_g9281;
  double cse_p65_t9_g9260;
  double cse_p66_t8_g9289;
  double cse_p66_t9_g9290;
  double d2e_base_dr2;
  double d2e_dr2;
  double d2s_dr2;
  double d2s_dt2;
  double de_base_dr;
  double de_dr;
  double drs;
  double ds_dr;
  double ds_dt;
  double dx;
  double dy;
  double dz;
  double energy;
  double e_base;
  double e_coul;
  double e_lj;
  double g_x1;
  double g_x2;
  double g_y1;
  double g_y2;
  double g_z1;
  double g_z2;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_z1;
  double h_x1_z2;
  double h_x2_x2;
  double h_x2_y2;
  double h_x2_z2;
  double h_y1_x2;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_z1;
  double h_y1_z2;
  double h_y2_y2;
  double h_y2_z2;
  double h_z1_x2;
  double h_z1_y2;
  double h_z1_z1;
  double h_z1_z2;
  double h_z2_z2;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  {
    /* !BASE */
    dx = (x1 + (-(x2)));
    cse_p11_t54_g7882 = (dx * dx);
    dy = (y1 + (-(y2)));
    cse_p11_t55_g7883 = (dy * dy);
    dz = (z1 + (-(z2)));
    cse_p11_t56_g7884 = (dz * dz);
    r2 = (cse_p11_t54_g7882 + cse_p11_t55_g7883 + cse_p11_t56_g7884);
    if ((r2 < r_cut2)) {
      /* !CUT */
      cse_p1_t1_invsqrt7825 = (1.0 / sqrt(r2));
      cse_p12_t57_g8011 = (cse_p1_t1_invsqrt7825 * cse_p1_t1_invsqrt7825);
      cse_p13_t60_g8128 = (cse_p12_t57_g8011 * cse_p1_t1_invsqrt7825);
      r = (cse_p1_t1_invsqrt7825 * r2);
      cse_p15_t1_g8253 = (cse_p12_t57_g8011 * cse_p12_t57_g8011);
      invr6 = (cse_p12_t57_g8011 * cse_p15_t1_g8253);
      cse_p13_t1_g8161 = (a * invr6);
      e_lj = ((cse_p13_t1_g8161 * invr6) + (-((b * invr6))));
      cse_p65_t1_g9274 = (invdd * qq);
      e_coul = (cse_p12_t57_g8011 * cse_p65_t1_g9274);
      e_base = (e_coul + e_lj);
      de_base_dr = ((-2.0000000000000000     * cse_p13_t60_g8128 * cse_p65_t1_g9274) + (cse_p1_t1_invsqrt7825 * invr6 * ((-12.000000000000000     * cse_p13_t1_g8161) + (6.0000000000000000     * b))));
      d2e_base_dr2 = ((6.0000000000000000     * cse_p15_t1_g8253 * cse_p65_t1_g9274) + (cse_p12_t57_g8011 * invr6 * ((-42.000000000000000     * b) + (156.00000000000000     * cse_p13_t1_g8161))));
      if ((r2 < r_switch2)) {
        /* !SWITCH */
        cse_p522_t1_g16916 = (-3.0000000000000000     * b);
        cse_p522_t2_g16917 = (3.0000000000000000     * cse_p13_t1_g8161);
        cse_p522_t8_g16923 = (r * r);
        cse_p522_t9_g16924 = (-(cse_p11_t54_g7882));
        cse_p522_t10_g16925 = (-(cse_p11_t55_g7883));
        cse_p522_t11_g16926 = (-(cse_p11_t56_g7884));
        cse_p522_t12_g16927 = (-(dx));
        cse_p522_t13_g16928 = (-(dy));
        cse_p522_t14_g16929 = (-(dz));
        cse_p523_t1_invr16933 = (1.0 / ((r * r * r)));
        cse_p523_t2_invr16934 = (1.0 / (r));
        cse_p522_t17_g16932 = (r * r * r);
        cse_p16_t16_g8269 = (cse_p522_t1_g16916 + cse_p522_t2_g16917 + cse_p522_t2_g16917);
        cse_p15_t12_g8229 = (cse_p15_t1_g8253 * cse_p16_t16_g8269);
        cse_p15_t25_g8242 = (-(cse_p522_t8_g16923));
        cse_p14_t38_g8200 = (cse_p15_t12_g8229 + cse_p65_t1_g9274);
        cse_p14_t32_g8194 = (cse_p11_t54_g7882 + cse_p15_t25_g8242);
        cse_p14_t33_g8195 = (cse_p11_t55_g7883 + cse_p15_t25_g8242);
        cse_p14_t34_g8196 = (cse_p11_t56_g7884 + cse_p15_t25_g8242);
        cse_p14_t39_g8201 = (cse_p522_t8_g16923 + cse_p522_t9_g16924);
        cse_p14_t40_g8202 = (cse_p522_t10_g16925 + cse_p522_t8_g16923);
        cse_p14_t41_g8203 = (cse_p522_t11_g16926 + cse_p522_t8_g16923);
        energy = e_base;
        *energy_accumulate += energy;
        cse_p12_t1_g8068 = (cse_p13_t60_g8128 * cse_p14_t38_g8200 * cse_p1_t1_invsqrt7825);
        cse_p65_t1_g9278 = (-2.0000000000000000     * cse_p12_t1_g8068);
        g_x1 = (cse_p65_t1_g9278 * dx);
        KernelGradientAcc(i3x1, 0, g_x1);
        g_y1 = (cse_p65_t1_g9278 * dy);
        KernelGradientAcc(i3x1, 1, g_y1);
        g_z1 = (cse_p65_t1_g9278 * dz);
        KernelGradientAcc(i3x1, 2, g_z1);
        cse_p65_t1_g9281 = (2.0000000000000000     * cse_p12_t1_g8068);
        g_x2 = (cse_p65_t1_g9281 * dx);
        KernelGradientAcc(i3x2, 0, g_x2);
        g_y2 = (cse_p65_t1_g9281 * dy);
        KernelGradientAcc(i3x2, 1, g_y2);
        g_z2 = (cse_p65_t1_g9281 * dz);
        KernelGradientAcc(i3x2, 2, g_z2);
        de_dr = de_base_dr;
        cse_p11_t1_g7946 = (cse_p523_t1_invr16933 * de_base_dr);
        cse_p522_t6_g16921 = (cse_p11_t1_g7946 * dy);
        cse_p522_t7_g16922 = (cse_p11_t1_g7946 * dz);
        cse_p15_t1_g8252 = (cse_p522_t12_g16927 * cse_p522_t6_g16921);
        cse_p15_t17_g8234 = (cse_p522_t6_g16921 * dx);
        cse_p13_t24_g8092 = (cse_p11_t1_g7946 * cse_p14_t32_g8194);
        cse_p13_t25_g8093 = (cse_p11_t1_g7946 * cse_p14_t33_g8195);
        cse_p13_t26_g8094 = (cse_p11_t1_g7946 * cse_p14_t34_g8196);
        cse_p13_t30_g8098 = (cse_p11_t1_g7946 * cse_p14_t39_g8201);
        cse_p13_t31_g8099 = (cse_p11_t1_g7946 * cse_p14_t40_g8202);
        cse_p13_t32_g8100 = (cse_p11_t1_g7946 * cse_p14_t41_g8203);
        cse_p13_t55_g8123 = (cse_p522_t12_g16927 * cse_p522_t7_g16922);
        cse_p13_t56_g8124 = (cse_p522_t13_g16928 * cse_p522_t7_g16922);
        cse_p13_t57_g8125 = (cse_p522_t7_g16922 * dx);
        cse_p13_t58_g8126 = (cse_p522_t7_g16922 * dy);
        d2e_dr2 = d2e_base_dr2;
        cse_p11_t1_g7945 = (cse_p523_t2_invr16934 * cse_p523_t2_invr16934 * d2e_base_dr2);
        cse_p522_t3_g16918 = (cse_p11_t1_g7945 * dx);
        cse_p522_t4_g16919 = (cse_p11_t1_g7945 * dy);
        cse_p522_t5_g16920 = (cse_p11_t1_g7945 * dz * dz);
        cse_p66_t8_g9289 = (cse_p522_t4_g16919 * dy);
        cse_p66_t9_g9290 = (cse_p522_t4_g16919 * dz);
        cse_p60_t3_g9227 = (cse_p11_t1_g7945 * cse_p522_t12_g16927);
        cse_p60_t4_g9228 = (cse_p11_t1_g7945 * cse_p522_t13_g16928);
        cse_p60_t5_g9229 = (cse_p11_t1_g7945 * cse_p522_t14_g16929);
        cse_p16_t13_g8266 = (cse_p522_t3_g16918 * dy);
        cse_p15_t13_g8230 = (cse_p522_t3_g16918 * dx);
        cse_p15_t15_g8232 = (cse_p522_t3_g16918 * dz);
        cse_p15_t20_g8237 = (cse_p15_t1_g8252 + cse_p16_t13_g8266);
        cse_p13_t44_g8112 = (cse_p522_t12_g16927 * cse_p60_t3_g9227);
        cse_p13_t45_g8113 = (cse_p522_t13_g16928 * cse_p60_t3_g9227);
        cse_p13_t46_g8114 = (cse_p522_t14_g16929 * cse_p60_t3_g9227);
        cse_p13_t47_g8115 = (cse_p60_t3_g9227 * dx);
        cse_p13_t48_g8116 = (cse_p60_t3_g9227 * dy);
        cse_p13_t49_g8117 = (cse_p60_t3_g9227 * dz);
        cse_p13_t50_g8118 = (cse_p522_t13_g16928 * cse_p60_t4_g9228);
        cse_p13_t51_g8119 = (cse_p522_t14_g16929 * cse_p60_t4_g9228);
        cse_p13_t52_g8120 = (cse_p60_t4_g9228 * dx);
        cse_p13_t53_g8121 = (cse_p60_t4_g9228 * dy);
        cse_p13_t54_g8122 = (cse_p60_t4_g9228 * dz);
        cse_p13_t40_g8108 = (cse_p522_t14_g16929 * cse_p60_t5_g9229);
        cse_p13_t41_g8109 = (cse_p60_t5_g9229 * dx);
        cse_p13_t42_g8110 = (cse_p60_t5_g9229 * dy);
        cse_p13_t43_g8111 = (cse_p60_t5_g9229 * dz);
        cse_p12_t79_g8033 = (cse_p13_t32_g8100 + cse_p13_t40_g8108);
        cse_p12_t80_g8034 = (cse_p13_t41_g8109 + cse_p13_t57_g8125);
        cse_p12_t81_g8035 = (cse_p13_t30_g8098 + cse_p15_t13_g8230);
        cse_p12_t83_g8037 = (cse_p13_t55_g8123 + cse_p15_t15_g8232);
        cse_p12_t84_g8038 = (cse_p13_t42_g8110 + cse_p13_t58_g8126);
        cse_p12_t85_g8039 = (cse_p13_t31_g8099 + cse_p66_t8_g9289);
        cse_p12_t86_g8040 = (cse_p13_t56_g8124 + cse_p66_t9_g9290);
        cse_p12_t87_g8041 = (cse_p13_t26_g8094 + cse_p13_t43_g8111);
        cse_p12_t88_g8042 = (cse_p13_t32_g8100 + cse_p522_t5_g16920);
        cse_p12_t68_g8022 = (cse_p13_t24_g8092 + cse_p13_t47_g8115);
        cse_p12_t70_g8024 = (cse_p13_t30_g8098 + cse_p13_t44_g8112);
        cse_p12_t89_g8043 = (cse_p13_t48_g8116 + cse_p15_t17_g8234);
        cse_p12_t91_g8045 = (cse_p13_t45_g8113 + cse_p15_t1_g8252);
        cse_p12_t92_g8046 = (cse_p13_t46_g8114 + cse_p13_t55_g8123);
        cse_p12_t93_g8047 = (cse_p13_t49_g8117 + cse_p13_t57_g8125);
        cse_p12_t69_g8023 = (cse_p13_t25_g8093 + cse_p13_t53_g8121);
        cse_p12_t71_g8025 = (cse_p13_t31_g8099 + cse_p13_t50_g8118);
        cse_p12_t90_g8044 = (cse_p13_t52_g8120 + cse_p15_t17_g8234);
        cse_p12_t94_g8048 = (cse_p13_t51_g8119 + cse_p13_t56_g8124);
        cse_p12_t95_g8049 = (cse_p13_t54_g8122 + cse_p13_t58_g8126);
        h_x1_x1 = cse_p12_t81_g8035;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
        h_x1_y1 = cse_p15_t20_g8237;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
        h_x1_z1 = cse_p12_t83_g8037;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
        h_x1_x2 = cse_p12_t68_g8022;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
        h_x1_y2 = cse_p12_t90_g8044;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
        h_x1_z2 = cse_p12_t80_g8034;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
        h_y1_y1 = cse_p12_t85_g8039;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
        h_y1_z1 = cse_p12_t86_g8040;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
        h_y1_x2 = cse_p12_t89_g8043;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
        h_y1_y2 = cse_p12_t69_g8023;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
        h_y1_z2 = cse_p12_t84_g8038;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
        h_z1_z1 = cse_p12_t88_g8042;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
        h_z1_x2 = cse_p12_t93_g8047;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
        h_z1_y2 = cse_p12_t95_g8049;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
        h_z1_z2 = cse_p12_t87_g8041;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
        h_x2_x2 = cse_p12_t70_g8024;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
        h_x2_y2 = cse_p12_t91_g8045;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
        h_x2_z2 = cse_p12_t92_g8046;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
        h_y2_y2 = cse_p12_t71_g8025;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
        h_y2_z2 = cse_p12_t94_g8048;
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
        h_z2_z2 = cse_p12_t79_g8033;
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
      } else {
        /* !SKIN */
        cse_p65_t1_g9276 = (-2.0000000000000000     * cse_p1_t1_invsqrt7825);
        cse_p14_t4_g8166 = (cse_p65_t1_g9276 * dx);
        cse_p14_t5_g8167 = (cse_p65_t1_g9276 * dy);
        cse_p14_t6_g8168 = (cse_p65_t1_g9276 * dz);
        cse_p65_t1_g9279 = (2.0000000000000000     * cse_p1_t1_invsqrt7825);
        cse_p14_t11_g8173 = (cse_p65_t1_g9279 * dx);
        cse_p14_t12_g8174 = (cse_p65_t1_g9279 * dy);
        cse_p14_t13_g8175 = (cse_p65_t1_g9279 * dz);
        cse_p11_t1_g7949 = (cse_p13_t60_g8128 * r2);
        cse_p65_t9_g9260 = (cse_p11_t1_g7949 * dx);
        cse_p65_t10_g9261 = (cse_p11_t1_g7949 * dy);
        cse_p65_t11_g9262 = (cse_p11_t1_g7949 * dz);
        cse_p14_t1_g8163 = (-(cse_p65_t9_g9260));
        cse_p14_t2_g8164 = (-(cse_p65_t10_g9261));
        cse_p14_t3_g8165 = (-(cse_p65_t11_g9262));
        cse_p13_t64_g8132 = (cse_p14_t11_g8173 + cse_p14_t1_g8163);
        cse_p13_t65_g8133 = (cse_p14_t12_g8174 + cse_p14_t2_g8164);
        cse_p13_t66_g8134 = (cse_p14_t13_g8175 + cse_p14_t3_g8165);
        cse_p13_t67_g8135 = (cse_p14_t4_g8166 + cse_p65_t9_g9260);
        cse_p13_t68_g8136 = (cse_p14_t5_g8167 + cse_p65_t10_g9261);
        cse_p13_t69_g8137 = (cse_p14_t6_g8168 + cse_p65_t11_g9262);
        drs = (r + (-(r_switch)));
        t1 = (drs * inv_range);
        cse_p11_t1_g7952 = (inv_range * t1);
        cse_p13_t1_g8160 = (2.0000000000000000     * cse_p11_t1_g7952);
        cse_p15_t1_g8249 = (cse_p13_t1_g8160 * t1);
        cse_p12_t11_g7965 = (cse_p13_t64_g8132 * cse_p15_t1_g8249);
        cse_p12_t12_g7966 = (cse_p13_t65_g8133 * cse_p15_t1_g8249);
        cse_p12_t13_g7967 = (cse_p13_t66_g8134 * cse_p15_t1_g8249);
        cse_p12_t14_g7968 = (cse_p13_t67_g8135 * cse_p15_t1_g8249);
        cse_p12_t15_g7969 = (cse_p13_t68_g8136 * cse_p15_t1_g8249);
        cse_p12_t16_g7970 = (cse_p13_t69_g8137 * cse_p15_t1_g8249);
        t2 = (t1 * t1);
        cse_p15_t1_g8251 = (inv_range * t2);
        cse_p12_t61_g8015 = (cse_p13_t64_g8132 * cse_p15_t1_g8251);
        cse_p12_t62_g8016 = (cse_p13_t65_g8133 * cse_p15_t1_g8251);
        cse_p12_t63_g8017 = (cse_p13_t66_g8134 * cse_p15_t1_g8251);
        cse_p12_t64_g8018 = (cse_p13_t67_g8135 * cse_p15_t1_g8251);
        cse_p12_t65_g8019 = (cse_p13_t68_g8136 * cse_p15_t1_g8251);
        cse_p12_t66_g8020 = (cse_p13_t69_g8137 * cse_p15_t1_g8251);
        cse_p11_t69_g7897 = (cse_p12_t11_g7965 + cse_p12_t61_g8015);
        cse_p11_t70_g7898 = (cse_p12_t12_g7966 + cse_p12_t62_g8016);
        cse_p11_t71_g7899 = (cse_p12_t13_g7967 + cse_p12_t63_g8017);
        cse_p11_t72_g7900 = (cse_p12_t14_g7968 + cse_p12_t64_g8018);
        cse_p11_t73_g7901 = (cse_p12_t15_g7969 + cse_p12_t65_g8019);
        cse_p11_t74_g7902 = (cse_p12_t16_g7970 + cse_p12_t66_g8020);
        t3 = (t1 * t2);
        t4 = (t2 * t2);
        t5 = (t2 * t3);
        s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
        ds_dt = ((-30.000000000000000     * t2) + (-30.000000000000000     * t4) + (60.000000000000000     * t3));
        d2s_dt2 = ((-120.00000000000000     * t3) + (-60.000000000000000     * t1) + (180.00000000000000     * t2));
        ds_dr = (ds_dt * inv_range);
        d2s_dr2 = (d2s_dt2 * inv_range * inv_range);
        energy = (e_base * s);
        *energy_accumulate += energy;
        cse_p14_t1_g8215 = (3.0000000000000000     * cse_p13_t1_g8161);
        cse_p13_t1_g8162 = (cse_p15_t1_g8253 * (cse_p14_t1_g8215 + cse_p14_t1_g8215 + (-3.0000000000000000     * b)));
        cse_p11_t1_g7948 = (cse_p13_t60_g8128 * cse_p1_t1_invsqrt7825 * s * (cse_p13_t1_g8162 + cse_p65_t1_g9274));
        cse_p14_t1_g8214 = (60.000000000000000     * cse_p11_t1_g7952 * t2);
        cse_p15_t1_g8250 = (cse_p13_t1_g8160 * t3);
        cse_p65_t1_g9277 = (-2.0000000000000000     * cse_p11_t1_g7948);
        g_x1 = ((cse_p65_t1_g9277 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t69_g7897) + (-6.0000000000000000     * ((cse_p11_t69_g7897 * t2) + (cse_p13_t64_g8132 * cse_p15_t1_g8250))) + (cse_p13_t64_g8132 * cse_p14_t1_g8214))));
        KernelGradientAcc(i3x1, 0, g_x1);
        g_y1 = ((cse_p65_t1_g9277 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t70_g7898) + (-6.0000000000000000     * ((cse_p11_t70_g7898 * t2) + (cse_p13_t65_g8133 * cse_p15_t1_g8250))) + (cse_p13_t65_g8133 * cse_p14_t1_g8214))));
        KernelGradientAcc(i3x1, 1, g_y1);
        g_z1 = ((cse_p65_t1_g9277 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t71_g7899) + (-6.0000000000000000     * ((cse_p11_t71_g7899 * t2) + (cse_p13_t66_g8134 * cse_p15_t1_g8250))) + (cse_p13_t66_g8134 * cse_p14_t1_g8214))));
        KernelGradientAcc(i3x1, 2, g_z1);
        cse_p65_t1_g9280 = (2.0000000000000000     * cse_p11_t1_g7948);
        g_x2 = ((cse_p65_t1_g9280 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t72_g7900) + (-6.0000000000000000     * ((cse_p11_t72_g7900 * t2) + (cse_p13_t67_g8135 * cse_p15_t1_g8250))) + (cse_p13_t67_g8135 * cse_p14_t1_g8214))));
        KernelGradientAcc(i3x2, 0, g_x2);
        g_y2 = ((cse_p65_t1_g9280 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t73_g7901) + (-6.0000000000000000     * ((cse_p11_t73_g7901 * t2) + (cse_p13_t68_g8136 * cse_p15_t1_g8250))) + (cse_p13_t68_g8136 * cse_p14_t1_g8214))));
        KernelGradientAcc(i3x2, 1, g_y2);
        g_z2 = ((cse_p65_t1_g9280 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t74_g7902) + (-6.0000000000000000     * ((cse_p11_t74_g7902 * t2) + (cse_p13_t69_g8137 * cse_p15_t1_g8250))) + (cse_p13_t69_g8137 * cse_p14_t1_g8214))));
        KernelGradientAcc(i3x2, 2, g_z2);
        de_dr = ((de_base_dr * s) + (ds_dr * e_base));
        d2e_dr2 = ((2.0000000000000000     * de_base_dr * ds_dr) + (d2e_base_dr2 * s) + (d2s_dr2 * e_base));
        cse_p523_t2_invr16934 = (1.0 / (r));
        cse_p11_t1_g7945 = (cse_p523_t2_invr16934 * cse_p523_t2_invr16934 * d2e_dr2);
        cse_p523_t1_invr16933 = (1.0 / ((r * r * r)));
        cse_p11_t1_g7946 = (cse_p523_t1_invr16933 * de_dr);
        cse_p11_t1_g7950 = (r * r);
        cse_p14_t35_g8197 = (cse_p11_t1_g7950 + (-(cse_p11_t54_g7882)));
        cse_p14_t36_g8198 = (cse_p11_t1_g7950 + (-(cse_p11_t55_g7883)));
        cse_p14_t37_g8199 = (cse_p11_t1_g7950 + (-(cse_p11_t56_g7884)));
        cse_p13_t27_g8095 = (cse_p11_t1_g7946 * cse_p14_t35_g8197);
        cse_p13_t28_g8096 = (cse_p11_t1_g7946 * cse_p14_t36_g8198);
        cse_p13_t29_g8097 = (cse_p11_t1_g7946 * cse_p14_t37_g8199);
        cse_p13_t84_g8152 = (-(cse_p11_t1_g7950));
        cse_p14_t1_g8216 = (cse_p11_t1_g7945 * dx);
        h_x1_x1 = (cse_p13_t27_g8095 + (cse_p14_t1_g8216 * dx));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
        cse_p14_t1_g8217 = (cse_p11_t1_g7946 * dy);
        cse_p16_t12_g8265 = (cse_p14_t1_g8217 * dx);
        cse_p15_t1_g8252 = (cse_p14_t1_g8217 * (-(dx)));
        h_x1_y1 = (cse_p15_t1_g8252 + (cse_p14_t1_g8216 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
        cse_p11_t1_g7954 = (cse_p11_t1_g7946 * dz);
        cse_p13_t36_g8104 = (cse_p11_t1_g7954 * (-(dx)));
        cse_p13_t37_g8105 = (cse_p11_t1_g7954 * (-(dy)));
        cse_p13_t38_g8106 = (cse_p11_t1_g7954 * dx);
        cse_p13_t39_g8107 = (cse_p11_t1_g7954 * dy);
        h_x1_z1 = (cse_p13_t36_g8104 + (cse_p14_t1_g8216 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
        cse_p11_t1_g7951 = (cse_p11_t1_g7945 * (-(dx)));
        h_x1_x2 = ((cse_p11_t1_g7946 * (cse_p11_t54_g7882 + cse_p13_t84_g8152)) + (cse_p11_t1_g7951 * dx));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
        cse_p11_t1_g7953 = (cse_p11_t1_g7945 * (-(dy)));
        h_x1_y2 = (cse_p16_t12_g8265 + (cse_p11_t1_g7953 * dx));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
        cse_p12_t1_g8067 = (cse_p11_t1_g7945 * (-(dz)));
        h_x1_z2 = (cse_p13_t38_g8106 + (cse_p12_t1_g8067 * dx));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
        cse_p65_t1_g9275 = (cse_p11_t1_g7945 * dy);
        h_y1_y1 = (cse_p13_t28_g8096 + (cse_p65_t1_g9275 * dy));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
        h_y1_z1 = (cse_p13_t37_g8105 + (cse_p65_t1_g9275 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
        h_y1_x2 = (cse_p16_t12_g8265 + (cse_p11_t1_g7951 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
        h_y1_y2 = ((cse_p11_t1_g7946 * (cse_p11_t55_g7883 + cse_p13_t84_g8152)) + (cse_p11_t1_g7953 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
        h_y1_z2 = (cse_p13_t39_g8107 + (cse_p12_t1_g8067 * dy));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
        h_z1_z1 = (cse_p13_t29_g8097 + (cse_p11_t1_g7945 * dz * dz));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
        h_z1_x2 = (cse_p13_t38_g8106 + (cse_p11_t1_g7951 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
        h_z1_y2 = (cse_p13_t39_g8107 + (cse_p11_t1_g7953 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
        h_z1_z2 = ((cse_p11_t1_g7946 * (cse_p11_t56_g7884 + cse_p13_t84_g8152)) + (cse_p12_t1_g8067 * dz));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
        h_x2_x2 = (cse_p13_t27_g8095 + (cse_p11_t1_g7951 * (-(dx))));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
        h_x2_y2 = (cse_p15_t1_g8252 + (cse_p11_t1_g7951 * (-(dy))));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
        h_x2_z2 = (cse_p13_t36_g8104 + (cse_p11_t1_g7951 * (-(dz))));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
        h_y2_y2 = (cse_p13_t28_g8096 + (cse_p11_t1_g7953 * (-(dy))));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
        h_y2_z2 = (cse_p13_t37_g8105 + (cse_p11_t1_g7953 * (-(dz))));
        KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
        h_z2_z2 = (cse_p13_t29_g8097 + (cse_p12_t1_g8067 * (-(dz))));
        KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
      }
    }
  }
}
void hessian_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 6;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
}

};
