template <typename HESSIAN>
struct Nonbond_Dd_Cutoff {
  static constexpr size_t PositionSize = 6;
  static std::string description() { return "mathkernel-nonbond_dd_cutoff"; };
double gradient(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double cse_p11_t1_g35621;
  double cse_p11_t1_g35622;
  double cse_p11_t1_g35623;
  double cse_p11_t1_g35624;
  double cse_p11_t1_g35625;
  double cse_p11_t1_g35627;
  double cse_p11_t1_g35628;
  double cse_p11_t1_g35629;
  double cse_p11_t32_g35603;
  double cse_p11_t33_g35604;
  double cse_p11_t34_g35605;
  double cse_p11_t35_g35606;
  double cse_p11_t36_g35607;
  double cse_p11_t37_g35608;
  double cse_p12_t15_g35646;
  double cse_p12_t16_g35647;
  double cse_p12_t17_g35648;
  double cse_p12_t18_g35649;
  double cse_p12_t19_g35650;
  double cse_p12_t1_g35671;
  double cse_p12_t1_g35672;
  double cse_p12_t1_g35673;
  double cse_p12_t1_g35674;
  double cse_p12_t1_g35675;
  double cse_p12_t1_g35676;
  double cse_p12_t1_g35677;
  double cse_p12_t20_g35651;
  double cse_p12_t21_g35652;
  double cse_p12_t25_g35656;
  double cse_p12_t26_g35657;
  double cse_p12_t27_g35658;
  double cse_p12_t28_g35659;
  double cse_p12_t29_g35660;
  double cse_p12_t30_g35661;
  double cse_p13_t16_g35695;
  double cse_p13_t17_g35696;
  double cse_p13_t18_g35697;
  double cse_p13_t19_g35698;
  double cse_p13_t1_g35713;
  double cse_p13_t20_g35699;
  double cse_p13_t21_g35700;
  double cse_p13_t22_g35701;
  double cse_p14_t10_g35723;
  double cse_p14_t11_g35724;
  double cse_p14_t12_g35725;
  double cse_p14_t13_g35726;
  double cse_p14_t14_g35727;
  double cse_p14_t16_g35729;
  double cse_p14_t1_g35730;
  double cse_p14_t1_g35731;
  double cse_p14_t1_g35732;
  double cse_p14_t1_g35734;
  double cse_p14_t1_g35735;
  double cse_p14_t3_g35716;
  double cse_p14_t4_g35717;
  double cse_p14_t5_g35718;
  double cse_p14_t6_g35719;
  double cse_p14_t7_g35720;
  double cse_p14_t8_g35721;
  double cse_p14_t9_g35722;
  double cse_p1_t1_invsqrt35566;
  double cse_p519_t1_g42187;
  double cse_p519_t2_g42176;
  double cse_p519_t3_g42177;
  double de_base_dr;
  double de_dr;
  double drs;
  double ds_dr;
  double ds_dt;
  double dx;
  double dy;
  double dz;
  double energy;
  double energy_added;
  double e_base;
  double e_coul;
  double e_lj;
  double g_x1;
  double g_x2;
  double g_y1;
  double g_y2;
  double g_z1;
  double g_z2;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    {
      /* !BASE */
      dx = (x1 + (-(x2)));
      dy = (y1 + (-(y2)));
      dz = (z1 + (-(z2)));
      r2 = ((dx * dx) + (dy * dy) + (dz * dz));
      if ((r2 < r_cut2)) {
        /* !CUT */
        cse_p1_t1_invsqrt35566 = (1.0 / sqrt(r2));
        cse_p12_t21_g35652 = (cse_p1_t1_invsqrt35566 * cse_p1_t1_invsqrt35566);
        cse_p13_t16_g35695 = (cse_p12_t21_g35652 * cse_p1_t1_invsqrt35566);
        r = (cse_p1_t1_invsqrt35566 * r2);
        cse_p14_t1_g35730 = (cse_p12_t21_g35652 * cse_p12_t21_g35652);
        invr6 = (cse_p12_t21_g35652 * cse_p14_t1_g35730);
        cse_p12_t1_g35671 = (a * invr6);
        e_lj = ((cse_p12_t1_g35671 * invr6) + (-((b * invr6))));
        cse_p12_t1_g35677 = (invdd * qq);
        e_coul = (cse_p12_t1_g35677 * cse_p12_t21_g35652);
        e_base = (e_coul + e_lj);
        de_base_dr = ((-2.0000000000000000     * cse_p12_t1_g35677 * cse_p13_t16_g35695) + (cse_p1_t1_invsqrt35566 * invr6 * ((-12.000000000000000     * cse_p12_t1_g35671) + (6.0000000000000000     * b))));
        if ((r2 < r_switch2)) {
          /* !SWITCH */
          cse_p519_t1_g42187 = (-3.0000000000000000     * b);
          cse_p519_t2_g42176 = (3.0000000000000000     * cse_p12_t1_g35671);
          cse_p14_t16_g35729 = (cse_p519_t1_g42187 + cse_p519_t2_g42176 + cse_p519_t2_g42176);
          cse_p13_t1_g35713 = (cse_p14_t16_g35729 * cse_p14_t1_g35730);
          cse_p519_t3_g42177 = (cse_p12_t1_g35677 + cse_p13_t1_g35713);
          energy = e_base;
          energy_added += energy;
          *energy_accumulate += energy;
          cse_p12_t1_g35673 = (cse_p13_t16_g35695 * cse_p1_t1_invsqrt35566 * cse_p519_t3_g42177);
          cse_p14_t1_g35732 = (-2.0000000000000000     * cse_p12_t1_g35673);
          g_x1 = (cse_p14_t1_g35732 * dx);
          KernelGradientAcc(i3x1, 0, g_x1);
          g_y1 = (cse_p14_t1_g35732 * dy);
          KernelGradientAcc(i3x1, 1, g_y1);
          g_z1 = (cse_p14_t1_g35732 * dz);
          KernelGradientAcc(i3x1, 2, g_z1);
          cse_p14_t1_g35735 = (2.0000000000000000     * cse_p12_t1_g35673);
          g_x2 = (cse_p14_t1_g35735 * dx);
          KernelGradientAcc(i3x2, 0, g_x2);
          g_y2 = (cse_p14_t1_g35735 * dy);
          KernelGradientAcc(i3x2, 1, g_y2);
          g_z2 = (cse_p14_t1_g35735 * dz);
          KernelGradientAcc(i3x2, 2, g_z2);
          de_dr = de_base_dr;
        } else {
          /* !SKIN */
          cse_p11_t1_g35622 = (cse_p13_t16_g35695 * r2);
          cse_p11_t1_g35624 = (-(cse_p11_t1_g35622));
          cse_p14_t3_g35716 = (cse_p11_t1_g35624 * dx);
          cse_p14_t4_g35717 = (cse_p11_t1_g35624 * dy);
          cse_p14_t5_g35718 = (cse_p11_t1_g35624 * dz);
          cse_p11_t1_g35625 = (-2.0000000000000000     * cse_p1_t1_invsqrt35566);
          cse_p14_t6_g35719 = (cse_p11_t1_g35625 * dx);
          cse_p14_t7_g35720 = (cse_p11_t1_g35625 * dy);
          cse_p14_t8_g35721 = (cse_p11_t1_g35625 * dz);
          cse_p14_t9_g35722 = (cse_p11_t1_g35622 * dx);
          cse_p14_t10_g35723 = (cse_p11_t1_g35622 * dy);
          cse_p14_t11_g35724 = (cse_p11_t1_g35622 * dz);
          cse_p13_t20_g35699 = (cse_p14_t6_g35719 + cse_p14_t9_g35722);
          cse_p13_t21_g35700 = (cse_p14_t10_g35723 + cse_p14_t7_g35720);
          cse_p13_t22_g35701 = (cse_p14_t11_g35724 + cse_p14_t8_g35721);
          cse_p11_t1_g35628 = (2.0000000000000000     * cse_p1_t1_invsqrt35566);
          cse_p14_t12_g35725 = (cse_p11_t1_g35628 * dx);
          cse_p14_t13_g35726 = (cse_p11_t1_g35628 * dy);
          cse_p14_t14_g35727 = (cse_p11_t1_g35628 * dz);
          cse_p13_t17_g35696 = (cse_p14_t12_g35725 + cse_p14_t3_g35716);
          cse_p13_t18_g35697 = (cse_p14_t13_g35726 + cse_p14_t4_g35717);
          cse_p13_t19_g35698 = (cse_p14_t14_g35727 + cse_p14_t5_g35718);
          drs = (r + (-(r_switch)));
          t1 = (drs * inv_range);
          cse_p11_t1_g35623 = (inv_range * t1);
          cse_p11_t1_g35627 = (2.0000000000000000     * cse_p11_t1_g35623);
          cse_p11_t1_g35629 = (cse_p11_t1_g35627 * t1);
          cse_p12_t15_g35646 = (cse_p11_t1_g35629 * cse_p13_t17_g35696);
          cse_p12_t16_g35647 = (cse_p11_t1_g35629 * cse_p13_t18_g35697);
          cse_p12_t17_g35648 = (cse_p11_t1_g35629 * cse_p13_t19_g35698);
          cse_p12_t18_g35649 = (cse_p11_t1_g35629 * cse_p13_t20_g35699);
          cse_p12_t19_g35650 = (cse_p11_t1_g35629 * cse_p13_t21_g35700);
          cse_p12_t20_g35651 = (cse_p11_t1_g35629 * cse_p13_t22_g35701);
          t2 = (t1 * t1);
          cse_p12_t1_g35676 = (inv_range * t2);
          cse_p12_t25_g35656 = (cse_p12_t1_g35676 * cse_p13_t17_g35696);
          cse_p12_t26_g35657 = (cse_p12_t1_g35676 * cse_p13_t18_g35697);
          cse_p12_t27_g35658 = (cse_p12_t1_g35676 * cse_p13_t19_g35698);
          cse_p12_t28_g35659 = (cse_p12_t1_g35676 * cse_p13_t20_g35699);
          cse_p12_t29_g35660 = (cse_p12_t1_g35676 * cse_p13_t21_g35700);
          cse_p12_t30_g35661 = (cse_p12_t1_g35676 * cse_p13_t22_g35701);
          cse_p11_t32_g35603 = (cse_p12_t15_g35646 + cse_p12_t25_g35656);
          cse_p11_t33_g35604 = (cse_p12_t16_g35647 + cse_p12_t26_g35657);
          cse_p11_t34_g35605 = (cse_p12_t17_g35648 + cse_p12_t27_g35658);
          cse_p11_t35_g35606 = (cse_p12_t18_g35649 + cse_p12_t28_g35659);
          cse_p11_t36_g35607 = (cse_p12_t19_g35650 + cse_p12_t29_g35660);
          cse_p11_t37_g35608 = (cse_p12_t20_g35651 + cse_p12_t30_g35661);
          t3 = (t1 * t2);
          t4 = (t2 * t2);
          t5 = (t2 * t3);
          s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
          ds_dt = ((-30.000000000000000     * t2) + (-30.000000000000000     * t4) + (60.000000000000000     * t3));
          ds_dr = (ds_dt * inv_range);
          energy = (e_base * s);
          energy_added += energy;
          *energy_accumulate += energy;
          cse_p12_t1_g35674 = (3.0000000000000000     * cse_p12_t1_g35671);
          cse_p519_t1_g42187 = (-3.0000000000000000     * b);
          cse_p13_t1_g35713 = (cse_p14_t1_g35730 * (cse_p12_t1_g35674 + cse_p12_t1_g35674 + cse_p519_t1_g42187));
          cse_p11_t1_g35621 = (cse_p13_t16_g35695 * cse_p1_t1_invsqrt35566 * s * (cse_p12_t1_g35677 + cse_p13_t1_g35713));
          cse_p12_t1_g35672 = (60.000000000000000     * cse_p11_t1_g35623 * t2);
          cse_p12_t1_g35675 = (cse_p11_t1_g35627 * t3);
          cse_p14_t1_g35731 = (-2.0000000000000000     * cse_p11_t1_g35621);
          g_x1 = ((cse_p14_t1_g35731 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t32_g35603) + (-6.0000000000000000     * ((cse_p11_t32_g35603 * t2) + (cse_p12_t1_g35675 * cse_p13_t17_g35696))) + (cse_p12_t1_g35672 * cse_p13_t17_g35696))));
          KernelGradientAcc(i3x1, 0, g_x1);
          g_y1 = ((cse_p14_t1_g35731 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t33_g35604) + (-6.0000000000000000     * ((cse_p11_t33_g35604 * t2) + (cse_p12_t1_g35675 * cse_p13_t18_g35697))) + (cse_p12_t1_g35672 * cse_p13_t18_g35697))));
          KernelGradientAcc(i3x1, 1, g_y1);
          g_z1 = ((cse_p14_t1_g35731 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t34_g35605) + (-6.0000000000000000     * ((cse_p11_t34_g35605 * t2) + (cse_p12_t1_g35675 * cse_p13_t19_g35698))) + (cse_p12_t1_g35672 * cse_p13_t19_g35698))));
          KernelGradientAcc(i3x1, 2, g_z1);
          cse_p14_t1_g35734 = (2.0000000000000000     * cse_p11_t1_g35621);
          g_x2 = ((cse_p14_t1_g35734 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t35_g35606) + (-6.0000000000000000     * ((cse_p11_t35_g35606 * t2) + (cse_p12_t1_g35675 * cse_p13_t20_g35699))) + (cse_p12_t1_g35672 * cse_p13_t20_g35699))));
          KernelGradientAcc(i3x2, 0, g_x2);
          g_y2 = ((cse_p14_t1_g35734 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t36_g35607) + (-6.0000000000000000     * ((cse_p11_t36_g35607 * t2) + (cse_p12_t1_g35675 * cse_p13_t21_g35700))) + (cse_p12_t1_g35672 * cse_p13_t21_g35700))));
          KernelGradientAcc(i3x2, 1, g_y2);
          g_z2 = ((cse_p14_t1_g35734 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t37_g35608) + (-6.0000000000000000     * ((cse_p11_t37_g35608 * t2) + (cse_p12_t1_g35675 * cse_p13_t22_g35701))) + (cse_p12_t1_g35672 * cse_p13_t22_g35701))));
          KernelGradientAcc(i3x2, 2, g_z2);
          de_dr = ((de_base_dr * s) + (ds_dr * e_base));
        }
      }
    }
  }
  return energy_added;
}
void gradient_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 6;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
}

double energy(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double cse_p11_t1_g42188;
  double drs;
  double dx;
  double dy;
  double dz;
  double energy;
  double energy_added;
  double e_base;
  double e_coul;
  double e_lj;
  double invr;
  double invr2;
  double invr3;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    {
      /* !BASE */
      dx = (x1 + (-(x2)));
      dy = (y1 + (-(y2)));
      dz = (z1 + (-(z2)));
      r2 = ((dx * dx) + (dy * dy) + (dz * dz));
      if ((r2 < r_cut2)) {
        /* !CUT */
        invr = (1.0 / sqrt(r2));
        r = (invr * r2);
        invr2 = (invr * invr);
        invr3 = (invr2 * invr);
        cse_p11_t1_g42188 = (invr2 * invr2);
        invr6 = (cse_p11_t1_g42188 * invr2);
        e_lj = ((a * invr6 * invr6) + (-((b * invr6))));
        e_coul = (invdd * invr2 * qq);
        e_base = (e_coul + e_lj);
        if ((r2 < r_switch2)) {
          /* !SWITCH */
          energy = e_base;
          energy_added += energy;
          *energy_accumulate += energy;
        } else {
          /* !SKIN */
          drs = (r + (-(r_switch)));
          t1 = (drs * inv_range);
          t2 = (t1 * t1);
          t3 = (t1 * t2);
          t4 = (t2 * t2);
          t5 = (t2 * t3);
          s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
          energy = (e_base * s);
          energy_added += energy;
          *energy_accumulate += energy;
        }
      }
    }
  }
  return energy_added;
}
void energy_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, energy_accumulate, force, hessian, dvec, hdvec);
}

double hessian(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double cse_p11_t1_g42309;
  double cse_p11_t1_g42310;
  double cse_p11_t1_g42312;
  double cse_p11_t1_g42313;
  double cse_p11_t1_g42314;
  double cse_p11_t1_g42315;
  double cse_p11_t1_g42316;
  double cse_p11_t1_g42317;
  double cse_p11_t1_g42318;
  double cse_p11_t54_g42246;
  double cse_p11_t55_g42247;
  double cse_p11_t56_g42248;
  double cse_p11_t69_g42261;
  double cse_p11_t70_g42262;
  double cse_p11_t71_g42263;
  double cse_p11_t72_g42264;
  double cse_p11_t73_g42265;
  double cse_p11_t74_g42266;
  double cse_p12_t11_g42329;
  double cse_p12_t12_g42330;
  double cse_p12_t13_g42331;
  double cse_p12_t14_g42332;
  double cse_p12_t15_g42333;
  double cse_p12_t16_g42334;
  double cse_p12_t1_g42431;
  double cse_p12_t1_g42432;
  double cse_p12_t57_g42375;
  double cse_p12_t61_g42379;
  double cse_p12_t62_g42380;
  double cse_p12_t63_g42381;
  double cse_p12_t64_g42382;
  double cse_p12_t65_g42383;
  double cse_p12_t66_g42384;
  double cse_p12_t68_g42386;
  double cse_p12_t69_g42387;
  double cse_p12_t70_g42388;
  double cse_p12_t71_g42389;
  double cse_p12_t79_g42397;
  double cse_p12_t80_g42398;
  double cse_p12_t81_g42399;
  double cse_p12_t83_g42401;
  double cse_p12_t84_g42402;
  double cse_p12_t85_g42403;
  double cse_p12_t86_g42404;
  double cse_p12_t87_g42405;
  double cse_p12_t88_g42406;
  double cse_p12_t89_g42407;
  double cse_p12_t90_g42408;
  double cse_p12_t91_g42409;
  double cse_p12_t92_g42410;
  double cse_p12_t93_g42411;
  double cse_p12_t94_g42412;
  double cse_p12_t95_g42413;
  double cse_p13_t1_g42524;
  double cse_p13_t1_g42525;
  double cse_p13_t1_g42526;
  double cse_p13_t24_g42456;
  double cse_p13_t25_g42457;
  double cse_p13_t26_g42458;
  double cse_p13_t27_g42459;
  double cse_p13_t28_g42460;
  double cse_p13_t29_g42461;
  double cse_p13_t30_g42462;
  double cse_p13_t31_g42463;
  double cse_p13_t32_g42464;
  double cse_p13_t36_g42468;
  double cse_p13_t37_g42469;
  double cse_p13_t38_g42470;
  double cse_p13_t39_g42471;
  double cse_p13_t40_g42472;
  double cse_p13_t41_g42473;
  double cse_p13_t42_g42474;
  double cse_p13_t43_g42475;
  double cse_p13_t44_g42476;
  double cse_p13_t45_g42477;
  double cse_p13_t46_g42478;
  double cse_p13_t47_g42479;
  double cse_p13_t48_g42480;
  double cse_p13_t49_g42481;
  double cse_p13_t50_g42482;
  double cse_p13_t51_g42483;
  double cse_p13_t52_g42484;
  double cse_p13_t53_g42485;
  double cse_p13_t54_g42486;
  double cse_p13_t55_g42487;
  double cse_p13_t56_g42488;
  double cse_p13_t57_g42489;
  double cse_p13_t58_g42490;
  double cse_p13_t60_g42492;
  double cse_p13_t64_g42496;
  double cse_p13_t65_g42497;
  double cse_p13_t66_g42498;
  double cse_p13_t67_g42499;
  double cse_p13_t68_g42500;
  double cse_p13_t69_g42501;
  double cse_p13_t84_g42516;
  double cse_p14_t11_g42537;
  double cse_p14_t12_g42538;
  double cse_p14_t13_g42539;
  double cse_p14_t1_g42527;
  double cse_p14_t1_g42578;
  double cse_p14_t1_g42579;
  double cse_p14_t1_g42580;
  double cse_p14_t1_g42581;
  double cse_p14_t2_g42528;
  double cse_p14_t32_g42558;
  double cse_p14_t33_g42559;
  double cse_p14_t34_g42560;
  double cse_p14_t35_g42561;
  double cse_p14_t36_g42562;
  double cse_p14_t37_g42563;
  double cse_p14_t38_g42564;
  double cse_p14_t39_g42565;
  double cse_p14_t3_g42529;
  double cse_p14_t40_g42566;
  double cse_p14_t41_g42567;
  double cse_p14_t4_g42530;
  double cse_p14_t5_g42531;
  double cse_p14_t6_g42532;
  double cse_p15_t12_g42593;
  double cse_p15_t13_g42594;
  double cse_p15_t15_g42596;
  double cse_p15_t17_g42598;
  double cse_p15_t1_g42613;
  double cse_p15_t1_g42614;
  double cse_p15_t1_g42615;
  double cse_p15_t1_g42616;
  double cse_p15_t1_g42617;
  double cse_p15_t20_g42601;
  double cse_p15_t25_g42606;
  double cse_p16_t12_g42629;
  double cse_p16_t13_g42630;
  double cse_p16_t16_g42633;
  double cse_p1_t1_invsqrt42189;
  double cse_p522_t10_g51289;
  double cse_p522_t11_g51290;
  double cse_p522_t12_g51291;
  double cse_p522_t13_g51292;
  double cse_p522_t14_g51293;
  double cse_p522_t17_g51296;
  double cse_p522_t1_g51280;
  double cse_p522_t2_g51281;
  double cse_p522_t3_g51282;
  double cse_p522_t4_g51283;
  double cse_p522_t5_g51284;
  double cse_p522_t6_g51285;
  double cse_p522_t7_g51286;
  double cse_p522_t8_g51287;
  double cse_p522_t9_g51288;
  double cse_p523_t1_invr51297;
  double cse_p523_t2_invr51298;
  double cse_p60_t3_g43591;
  double cse_p60_t4_g43592;
  double cse_p60_t5_g43593;
  double cse_p65_t10_g43625;
  double cse_p65_t11_g43626;
  double cse_p65_t1_g43638;
  double cse_p65_t1_g43639;
  double cse_p65_t1_g43640;
  double cse_p65_t1_g43641;
  double cse_p65_t1_g43642;
  double cse_p65_t1_g43643;
  double cse_p65_t1_g43644;
  double cse_p65_t1_g43645;
  double cse_p65_t9_g43624;
  double cse_p66_t8_g43653;
  double cse_p66_t9_g43654;
  double d2e_base_dr2;
  double d2e_dr2;
  double d2s_dr2;
  double d2s_dt2;
  double de_base_dr;
  double de_dr;
  double drs;
  double ds_dr;
  double ds_dt;
  double dx;
  double dy;
  double dz;
  double energy;
  double energy_added;
  double e_base;
  double e_coul;
  double e_lj;
  double g_x1;
  double g_x2;
  double g_y1;
  double g_y2;
  double g_z1;
  double g_z2;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_z1;
  double h_x1_z2;
  double h_x2_x2;
  double h_x2_y2;
  double h_x2_z2;
  double h_y1_x2;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_z1;
  double h_y1_z2;
  double h_y2_y2;
  double h_y2_z2;
  double h_z1_x2;
  double h_z1_y2;
  double h_z1_z1;
  double h_z1_z2;
  double h_z2_z2;
  double invr6;
  double r;
  double r2;
  double s;
  double t1;
  double t2;
  double t3;
  double t4;
  double t5;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    {
      /* !BASE */
      dx = (x1 + (-(x2)));
      cse_p11_t54_g42246 = (dx * dx);
      dy = (y1 + (-(y2)));
      cse_p11_t55_g42247 = (dy * dy);
      dz = (z1 + (-(z2)));
      cse_p11_t56_g42248 = (dz * dz);
      r2 = (cse_p11_t54_g42246 + cse_p11_t55_g42247 + cse_p11_t56_g42248);
      if ((r2 < r_cut2)) {
        /* !CUT */
        cse_p1_t1_invsqrt42189 = (1.0 / sqrt(r2));
        cse_p12_t57_g42375 = (cse_p1_t1_invsqrt42189 * cse_p1_t1_invsqrt42189);
        cse_p13_t60_g42492 = (cse_p12_t57_g42375 * cse_p1_t1_invsqrt42189);
        r = (cse_p1_t1_invsqrt42189 * r2);
        cse_p15_t1_g42617 = (cse_p12_t57_g42375 * cse_p12_t57_g42375);
        invr6 = (cse_p12_t57_g42375 * cse_p15_t1_g42617);
        cse_p13_t1_g42525 = (a * invr6);
        e_lj = ((cse_p13_t1_g42525 * invr6) + (-((b * invr6))));
        cse_p65_t1_g43638 = (invdd * qq);
        e_coul = (cse_p12_t57_g42375 * cse_p65_t1_g43638);
        e_base = (e_coul + e_lj);
        de_base_dr = ((-2.0000000000000000     * cse_p13_t60_g42492 * cse_p65_t1_g43638) + (cse_p1_t1_invsqrt42189 * invr6 * ((-12.000000000000000     * cse_p13_t1_g42525) + (6.0000000000000000     * b))));
        d2e_base_dr2 = ((6.0000000000000000     * cse_p15_t1_g42617 * cse_p65_t1_g43638) + (cse_p12_t57_g42375 * invr6 * ((-42.000000000000000     * b) + (156.00000000000000     * cse_p13_t1_g42525))));
        if ((r2 < r_switch2)) {
          /* !SWITCH */
          cse_p522_t1_g51280 = (-3.0000000000000000     * b);
          cse_p522_t2_g51281 = (3.0000000000000000     * cse_p13_t1_g42525);
          cse_p522_t8_g51287 = (r * r);
          cse_p522_t9_g51288 = (-(cse_p11_t54_g42246));
          cse_p522_t10_g51289 = (-(cse_p11_t55_g42247));
          cse_p522_t11_g51290 = (-(cse_p11_t56_g42248));
          cse_p522_t12_g51291 = (-(dx));
          cse_p522_t13_g51292 = (-(dy));
          cse_p522_t14_g51293 = (-(dz));
          cse_p523_t1_invr51297 = (1.0 / ((r * r * r)));
          cse_p523_t2_invr51298 = (1.0 / (r));
          cse_p522_t17_g51296 = (r * r * r);
          cse_p16_t16_g42633 = (cse_p522_t1_g51280 + cse_p522_t2_g51281 + cse_p522_t2_g51281);
          cse_p15_t12_g42593 = (cse_p15_t1_g42617 * cse_p16_t16_g42633);
          cse_p15_t25_g42606 = (-(cse_p522_t8_g51287));
          cse_p14_t38_g42564 = (cse_p15_t12_g42593 + cse_p65_t1_g43638);
          cse_p14_t32_g42558 = (cse_p11_t54_g42246 + cse_p15_t25_g42606);
          cse_p14_t33_g42559 = (cse_p11_t55_g42247 + cse_p15_t25_g42606);
          cse_p14_t34_g42560 = (cse_p11_t56_g42248 + cse_p15_t25_g42606);
          cse_p14_t39_g42565 = (cse_p522_t8_g51287 + cse_p522_t9_g51288);
          cse_p14_t40_g42566 = (cse_p522_t10_g51289 + cse_p522_t8_g51287);
          cse_p14_t41_g42567 = (cse_p522_t11_g51290 + cse_p522_t8_g51287);
          energy = e_base;
          energy_added += energy;
          *energy_accumulate += energy;
          cse_p12_t1_g42432 = (cse_p13_t60_g42492 * cse_p14_t38_g42564 * cse_p1_t1_invsqrt42189);
          cse_p65_t1_g43642 = (-2.0000000000000000     * cse_p12_t1_g42432);
          g_x1 = (cse_p65_t1_g43642 * dx);
          KernelGradientAcc(i3x1, 0, g_x1);
          g_y1 = (cse_p65_t1_g43642 * dy);
          KernelGradientAcc(i3x1, 1, g_y1);
          g_z1 = (cse_p65_t1_g43642 * dz);
          KernelGradientAcc(i3x1, 2, g_z1);
          cse_p65_t1_g43645 = (2.0000000000000000     * cse_p12_t1_g42432);
          g_x2 = (cse_p65_t1_g43645 * dx);
          KernelGradientAcc(i3x2, 0, g_x2);
          g_y2 = (cse_p65_t1_g43645 * dy);
          KernelGradientAcc(i3x2, 1, g_y2);
          g_z2 = (cse_p65_t1_g43645 * dz);
          KernelGradientAcc(i3x2, 2, g_z2);
          de_dr = de_base_dr;
          cse_p11_t1_g42310 = (cse_p523_t1_invr51297 * de_base_dr);
          cse_p522_t6_g51285 = (cse_p11_t1_g42310 * dy);
          cse_p522_t7_g51286 = (cse_p11_t1_g42310 * dz);
          cse_p15_t1_g42616 = (cse_p522_t12_g51291 * cse_p522_t6_g51285);
          cse_p15_t17_g42598 = (cse_p522_t6_g51285 * dx);
          cse_p13_t24_g42456 = (cse_p11_t1_g42310 * cse_p14_t32_g42558);
          cse_p13_t25_g42457 = (cse_p11_t1_g42310 * cse_p14_t33_g42559);
          cse_p13_t26_g42458 = (cse_p11_t1_g42310 * cse_p14_t34_g42560);
          cse_p13_t30_g42462 = (cse_p11_t1_g42310 * cse_p14_t39_g42565);
          cse_p13_t31_g42463 = (cse_p11_t1_g42310 * cse_p14_t40_g42566);
          cse_p13_t32_g42464 = (cse_p11_t1_g42310 * cse_p14_t41_g42567);
          cse_p13_t55_g42487 = (cse_p522_t12_g51291 * cse_p522_t7_g51286);
          cse_p13_t56_g42488 = (cse_p522_t13_g51292 * cse_p522_t7_g51286);
          cse_p13_t57_g42489 = (cse_p522_t7_g51286 * dx);
          cse_p13_t58_g42490 = (cse_p522_t7_g51286 * dy);
          d2e_dr2 = d2e_base_dr2;
          cse_p11_t1_g42309 = (cse_p523_t2_invr51298 * cse_p523_t2_invr51298 * d2e_base_dr2);
          cse_p522_t3_g51282 = (cse_p11_t1_g42309 * dx);
          cse_p522_t4_g51283 = (cse_p11_t1_g42309 * dy);
          cse_p522_t5_g51284 = (cse_p11_t1_g42309 * dz * dz);
          cse_p66_t8_g43653 = (cse_p522_t4_g51283 * dy);
          cse_p66_t9_g43654 = (cse_p522_t4_g51283 * dz);
          cse_p60_t3_g43591 = (cse_p11_t1_g42309 * cse_p522_t12_g51291);
          cse_p60_t4_g43592 = (cse_p11_t1_g42309 * cse_p522_t13_g51292);
          cse_p60_t5_g43593 = (cse_p11_t1_g42309 * cse_p522_t14_g51293);
          cse_p16_t13_g42630 = (cse_p522_t3_g51282 * dy);
          cse_p15_t13_g42594 = (cse_p522_t3_g51282 * dx);
          cse_p15_t15_g42596 = (cse_p522_t3_g51282 * dz);
          cse_p15_t20_g42601 = (cse_p15_t1_g42616 + cse_p16_t13_g42630);
          cse_p13_t44_g42476 = (cse_p522_t12_g51291 * cse_p60_t3_g43591);
          cse_p13_t45_g42477 = (cse_p522_t13_g51292 * cse_p60_t3_g43591);
          cse_p13_t46_g42478 = (cse_p522_t14_g51293 * cse_p60_t3_g43591);
          cse_p13_t47_g42479 = (cse_p60_t3_g43591 * dx);
          cse_p13_t48_g42480 = (cse_p60_t3_g43591 * dy);
          cse_p13_t49_g42481 = (cse_p60_t3_g43591 * dz);
          cse_p13_t50_g42482 = (cse_p522_t13_g51292 * cse_p60_t4_g43592);
          cse_p13_t51_g42483 = (cse_p522_t14_g51293 * cse_p60_t4_g43592);
          cse_p13_t52_g42484 = (cse_p60_t4_g43592 * dx);
          cse_p13_t53_g42485 = (cse_p60_t4_g43592 * dy);
          cse_p13_t54_g42486 = (cse_p60_t4_g43592 * dz);
          cse_p13_t40_g42472 = (cse_p522_t14_g51293 * cse_p60_t5_g43593);
          cse_p13_t41_g42473 = (cse_p60_t5_g43593 * dx);
          cse_p13_t42_g42474 = (cse_p60_t5_g43593 * dy);
          cse_p13_t43_g42475 = (cse_p60_t5_g43593 * dz);
          cse_p12_t79_g42397 = (cse_p13_t32_g42464 + cse_p13_t40_g42472);
          cse_p12_t80_g42398 = (cse_p13_t41_g42473 + cse_p13_t57_g42489);
          cse_p12_t81_g42399 = (cse_p13_t30_g42462 + cse_p15_t13_g42594);
          cse_p12_t83_g42401 = (cse_p13_t55_g42487 + cse_p15_t15_g42596);
          cse_p12_t84_g42402 = (cse_p13_t42_g42474 + cse_p13_t58_g42490);
          cse_p12_t85_g42403 = (cse_p13_t31_g42463 + cse_p66_t8_g43653);
          cse_p12_t86_g42404 = (cse_p13_t56_g42488 + cse_p66_t9_g43654);
          cse_p12_t87_g42405 = (cse_p13_t26_g42458 + cse_p13_t43_g42475);
          cse_p12_t88_g42406 = (cse_p13_t32_g42464 + cse_p522_t5_g51284);
          cse_p12_t68_g42386 = (cse_p13_t24_g42456 + cse_p13_t47_g42479);
          cse_p12_t70_g42388 = (cse_p13_t30_g42462 + cse_p13_t44_g42476);
          cse_p12_t89_g42407 = (cse_p13_t48_g42480 + cse_p15_t17_g42598);
          cse_p12_t91_g42409 = (cse_p13_t45_g42477 + cse_p15_t1_g42616);
          cse_p12_t92_g42410 = (cse_p13_t46_g42478 + cse_p13_t55_g42487);
          cse_p12_t93_g42411 = (cse_p13_t49_g42481 + cse_p13_t57_g42489);
          cse_p12_t69_g42387 = (cse_p13_t25_g42457 + cse_p13_t53_g42485);
          cse_p12_t71_g42389 = (cse_p13_t31_g42463 + cse_p13_t50_g42482);
          cse_p12_t90_g42408 = (cse_p13_t52_g42484 + cse_p15_t17_g42598);
          cse_p12_t94_g42412 = (cse_p13_t51_g42483 + cse_p13_t56_g42488);
          cse_p12_t95_g42413 = (cse_p13_t54_g42486 + cse_p13_t58_g42490);
          h_x1_x1 = cse_p12_t81_g42399;
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
          h_x1_y1 = cse_p15_t20_g42601;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
          h_x1_z1 = cse_p12_t83_g42401;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
          h_x1_x2 = cse_p12_t68_g42386;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
          h_x1_y2 = cse_p12_t90_g42408;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
          h_x1_z2 = cse_p12_t80_g42398;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
          h_y1_y1 = cse_p12_t85_g42403;
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
          h_y1_z1 = cse_p12_t86_g42404;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
          h_y1_x2 = cse_p12_t89_g42407;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
          h_y1_y2 = cse_p12_t69_g42387;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
          h_y1_z2 = cse_p12_t84_g42402;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
          h_z1_z1 = cse_p12_t88_g42406;
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
          h_z1_x2 = cse_p12_t93_g42411;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
          h_z1_y2 = cse_p12_t95_g42413;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
          h_z1_z2 = cse_p12_t87_g42405;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
          h_x2_x2 = cse_p12_t70_g42388;
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
          h_x2_y2 = cse_p12_t91_g42409;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
          h_x2_z2 = cse_p12_t92_g42410;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
          h_y2_y2 = cse_p12_t71_g42389;
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
          h_y2_z2 = cse_p12_t94_g42412;
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
          h_z2_z2 = cse_p12_t79_g42397;
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
        } else {
          /* !SKIN */
          cse_p65_t1_g43640 = (-2.0000000000000000     * cse_p1_t1_invsqrt42189);
          cse_p14_t4_g42530 = (cse_p65_t1_g43640 * dx);
          cse_p14_t5_g42531 = (cse_p65_t1_g43640 * dy);
          cse_p14_t6_g42532 = (cse_p65_t1_g43640 * dz);
          cse_p65_t1_g43643 = (2.0000000000000000     * cse_p1_t1_invsqrt42189);
          cse_p14_t11_g42537 = (cse_p65_t1_g43643 * dx);
          cse_p14_t12_g42538 = (cse_p65_t1_g43643 * dy);
          cse_p14_t13_g42539 = (cse_p65_t1_g43643 * dz);
          cse_p11_t1_g42313 = (cse_p13_t60_g42492 * r2);
          cse_p65_t9_g43624 = (cse_p11_t1_g42313 * dx);
          cse_p65_t10_g43625 = (cse_p11_t1_g42313 * dy);
          cse_p65_t11_g43626 = (cse_p11_t1_g42313 * dz);
          cse_p14_t1_g42527 = (-(cse_p65_t9_g43624));
          cse_p14_t2_g42528 = (-(cse_p65_t10_g43625));
          cse_p14_t3_g42529 = (-(cse_p65_t11_g43626));
          cse_p13_t64_g42496 = (cse_p14_t11_g42537 + cse_p14_t1_g42527);
          cse_p13_t65_g42497 = (cse_p14_t12_g42538 + cse_p14_t2_g42528);
          cse_p13_t66_g42498 = (cse_p14_t13_g42539 + cse_p14_t3_g42529);
          cse_p13_t67_g42499 = (cse_p14_t4_g42530 + cse_p65_t9_g43624);
          cse_p13_t68_g42500 = (cse_p14_t5_g42531 + cse_p65_t10_g43625);
          cse_p13_t69_g42501 = (cse_p14_t6_g42532 + cse_p65_t11_g43626);
          drs = (r + (-(r_switch)));
          t1 = (drs * inv_range);
          cse_p11_t1_g42316 = (inv_range * t1);
          cse_p13_t1_g42524 = (2.0000000000000000     * cse_p11_t1_g42316);
          cse_p15_t1_g42613 = (cse_p13_t1_g42524 * t1);
          cse_p12_t11_g42329 = (cse_p13_t64_g42496 * cse_p15_t1_g42613);
          cse_p12_t12_g42330 = (cse_p13_t65_g42497 * cse_p15_t1_g42613);
          cse_p12_t13_g42331 = (cse_p13_t66_g42498 * cse_p15_t1_g42613);
          cse_p12_t14_g42332 = (cse_p13_t67_g42499 * cse_p15_t1_g42613);
          cse_p12_t15_g42333 = (cse_p13_t68_g42500 * cse_p15_t1_g42613);
          cse_p12_t16_g42334 = (cse_p13_t69_g42501 * cse_p15_t1_g42613);
          t2 = (t1 * t1);
          cse_p15_t1_g42615 = (inv_range * t2);
          cse_p12_t61_g42379 = (cse_p13_t64_g42496 * cse_p15_t1_g42615);
          cse_p12_t62_g42380 = (cse_p13_t65_g42497 * cse_p15_t1_g42615);
          cse_p12_t63_g42381 = (cse_p13_t66_g42498 * cse_p15_t1_g42615);
          cse_p12_t64_g42382 = (cse_p13_t67_g42499 * cse_p15_t1_g42615);
          cse_p12_t65_g42383 = (cse_p13_t68_g42500 * cse_p15_t1_g42615);
          cse_p12_t66_g42384 = (cse_p13_t69_g42501 * cse_p15_t1_g42615);
          cse_p11_t69_g42261 = (cse_p12_t11_g42329 + cse_p12_t61_g42379);
          cse_p11_t70_g42262 = (cse_p12_t12_g42330 + cse_p12_t62_g42380);
          cse_p11_t71_g42263 = (cse_p12_t13_g42331 + cse_p12_t63_g42381);
          cse_p11_t72_g42264 = (cse_p12_t14_g42332 + cse_p12_t64_g42382);
          cse_p11_t73_g42265 = (cse_p12_t15_g42333 + cse_p12_t65_g42383);
          cse_p11_t74_g42266 = (cse_p12_t16_g42334 + cse_p12_t66_g42384);
          t3 = (t1 * t2);
          t4 = (t2 * t2);
          t5 = (t2 * t3);
          s = (1.0000000000000000     + (-10.000000000000000     * t3) + (-6.0000000000000000     * t5) + (15.000000000000000     * t4));
          ds_dt = ((-30.000000000000000     * t2) + (-30.000000000000000     * t4) + (60.000000000000000     * t3));
          d2s_dt2 = ((-120.00000000000000     * t3) + (-60.000000000000000     * t1) + (180.00000000000000     * t2));
          ds_dr = (ds_dt * inv_range);
          d2s_dr2 = (d2s_dt2 * inv_range * inv_range);
          energy = (e_base * s);
          energy_added += energy;
          *energy_accumulate += energy;
          cse_p14_t1_g42579 = (3.0000000000000000     * cse_p13_t1_g42525);
          cse_p13_t1_g42526 = (cse_p15_t1_g42617 * (cse_p14_t1_g42579 + cse_p14_t1_g42579 + (-3.0000000000000000     * b)));
          cse_p11_t1_g42312 = (cse_p13_t60_g42492 * cse_p1_t1_invsqrt42189 * s * (cse_p13_t1_g42526 + cse_p65_t1_g43638));
          cse_p14_t1_g42578 = (60.000000000000000     * cse_p11_t1_g42316 * t2);
          cse_p15_t1_g42614 = (cse_p13_t1_g42524 * t3);
          cse_p65_t1_g43641 = (-2.0000000000000000     * cse_p11_t1_g42312);
          g_x1 = ((cse_p65_t1_g43641 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t69_g42261) + (-6.0000000000000000     * ((cse_p11_t69_g42261 * t2) + (cse_p13_t64_g42496 * cse_p15_t1_g42614))) + (cse_p13_t64_g42496 * cse_p14_t1_g42578))));
          KernelGradientAcc(i3x1, 0, g_x1);
          g_y1 = ((cse_p65_t1_g43641 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t70_g42262) + (-6.0000000000000000     * ((cse_p11_t70_g42262 * t2) + (cse_p13_t65_g42497 * cse_p15_t1_g42614))) + (cse_p13_t65_g42497 * cse_p14_t1_g42578))));
          KernelGradientAcc(i3x1, 1, g_y1);
          g_z1 = ((cse_p65_t1_g43641 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t71_g42263) + (-6.0000000000000000     * ((cse_p11_t71_g42263 * t2) + (cse_p13_t66_g42498 * cse_p15_t1_g42614))) + (cse_p13_t66_g42498 * cse_p14_t1_g42578))));
          KernelGradientAcc(i3x1, 2, g_z1);
          cse_p65_t1_g43644 = (2.0000000000000000     * cse_p11_t1_g42312);
          g_x2 = ((cse_p65_t1_g43644 * dx) + (e_base * ((-10.000000000000000     * cse_p11_t72_g42264) + (-6.0000000000000000     * ((cse_p11_t72_g42264 * t2) + (cse_p13_t67_g42499 * cse_p15_t1_g42614))) + (cse_p13_t67_g42499 * cse_p14_t1_g42578))));
          KernelGradientAcc(i3x2, 0, g_x2);
          g_y2 = ((cse_p65_t1_g43644 * dy) + (e_base * ((-10.000000000000000     * cse_p11_t73_g42265) + (-6.0000000000000000     * ((cse_p11_t73_g42265 * t2) + (cse_p13_t68_g42500 * cse_p15_t1_g42614))) + (cse_p13_t68_g42500 * cse_p14_t1_g42578))));
          KernelGradientAcc(i3x2, 1, g_y2);
          g_z2 = ((cse_p65_t1_g43644 * dz) + (e_base * ((-10.000000000000000     * cse_p11_t74_g42266) + (-6.0000000000000000     * ((cse_p11_t74_g42266 * t2) + (cse_p13_t69_g42501 * cse_p15_t1_g42614))) + (cse_p13_t69_g42501 * cse_p14_t1_g42578))));
          KernelGradientAcc(i3x2, 2, g_z2);
          de_dr = ((de_base_dr * s) + (ds_dr * e_base));
          d2e_dr2 = ((2.0000000000000000     * de_base_dr * ds_dr) + (d2e_base_dr2 * s) + (d2s_dr2 * e_base));
          cse_p523_t2_invr51298 = (1.0 / (r));
          cse_p11_t1_g42309 = (cse_p523_t2_invr51298 * cse_p523_t2_invr51298 * d2e_dr2);
          cse_p523_t1_invr51297 = (1.0 / ((r * r * r)));
          cse_p11_t1_g42310 = (cse_p523_t1_invr51297 * de_dr);
          cse_p11_t1_g42314 = (r * r);
          cse_p14_t35_g42561 = (cse_p11_t1_g42314 + (-(cse_p11_t54_g42246)));
          cse_p14_t36_g42562 = (cse_p11_t1_g42314 + (-(cse_p11_t55_g42247)));
          cse_p14_t37_g42563 = (cse_p11_t1_g42314 + (-(cse_p11_t56_g42248)));
          cse_p13_t27_g42459 = (cse_p11_t1_g42310 * cse_p14_t35_g42561);
          cse_p13_t28_g42460 = (cse_p11_t1_g42310 * cse_p14_t36_g42562);
          cse_p13_t29_g42461 = (cse_p11_t1_g42310 * cse_p14_t37_g42563);
          cse_p13_t84_g42516 = (-(cse_p11_t1_g42314));
          cse_p14_t1_g42580 = (cse_p11_t1_g42309 * dx);
          h_x1_x1 = (cse_p13_t27_g42459 + (cse_p14_t1_g42580 * dx));
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
          cse_p14_t1_g42581 = (cse_p11_t1_g42310 * dy);
          cse_p16_t12_g42629 = (cse_p14_t1_g42581 * dx);
          cse_p15_t1_g42616 = (cse_p14_t1_g42581 * (-(dx)));
          h_x1_y1 = (cse_p15_t1_g42616 + (cse_p14_t1_g42580 * dy));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
          cse_p11_t1_g42318 = (cse_p11_t1_g42310 * dz);
          cse_p13_t36_g42468 = (cse_p11_t1_g42318 * (-(dx)));
          cse_p13_t37_g42469 = (cse_p11_t1_g42318 * (-(dy)));
          cse_p13_t38_g42470 = (cse_p11_t1_g42318 * dx);
          cse_p13_t39_g42471 = (cse_p11_t1_g42318 * dy);
          h_x1_z1 = (cse_p13_t36_g42468 + (cse_p14_t1_g42580 * dz));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
          cse_p11_t1_g42315 = (cse_p11_t1_g42309 * (-(dx)));
          h_x1_x2 = ((cse_p11_t1_g42310 * (cse_p11_t54_g42246 + cse_p13_t84_g42516)) + (cse_p11_t1_g42315 * dx));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
          cse_p11_t1_g42317 = (cse_p11_t1_g42309 * (-(dy)));
          h_x1_y2 = (cse_p16_t12_g42629 + (cse_p11_t1_g42317 * dx));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
          cse_p12_t1_g42431 = (cse_p11_t1_g42309 * (-(dz)));
          h_x1_z2 = (cse_p13_t38_g42470 + (cse_p12_t1_g42431 * dx));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
          cse_p65_t1_g43639 = (cse_p11_t1_g42309 * dy);
          h_y1_y1 = (cse_p13_t28_g42460 + (cse_p65_t1_g43639 * dy));
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
          h_y1_z1 = (cse_p13_t37_g42469 + (cse_p65_t1_g43639 * dz));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
          h_y1_x2 = (cse_p16_t12_g42629 + (cse_p11_t1_g42315 * dy));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
          h_y1_y2 = ((cse_p11_t1_g42310 * (cse_p11_t55_g42247 + cse_p13_t84_g42516)) + (cse_p11_t1_g42317 * dy));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
          h_y1_z2 = (cse_p13_t39_g42471 + (cse_p12_t1_g42431 * dy));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
          h_z1_z1 = (cse_p13_t29_g42461 + (cse_p11_t1_g42309 * dz * dz));
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
          h_z1_x2 = (cse_p13_t38_g42470 + (cse_p11_t1_g42315 * dz));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
          h_z1_y2 = (cse_p13_t39_g42471 + (cse_p11_t1_g42317 * dz));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
          h_z1_z2 = ((cse_p11_t1_g42310 * (cse_p11_t56_g42248 + cse_p13_t84_g42516)) + (cse_p12_t1_g42431 * dz));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
          h_x2_x2 = (cse_p13_t27_g42459 + (cse_p11_t1_g42315 * (-(dx))));
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
          h_x2_y2 = (cse_p15_t1_g42616 + (cse_p11_t1_g42315 * (-(dy))));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
          h_x2_z2 = (cse_p13_t36_g42468 + (cse_p11_t1_g42315 * (-(dz))));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
          h_y2_y2 = (cse_p13_t28_g42460 + (cse_p11_t1_g42317 * (-(dy))));
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
          h_y2_z2 = (cse_p13_t37_g42469 + (cse_p11_t1_g42317 * (-(dz))));
          KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
          h_z2_z2 = (cse_p13_t29_g42461 + (cse_p12_t1_g42431 * (-(dz))));
          KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
        }
      }
    }
  }
  return energy_added;
}
void hessian_fd(double a, double b, double qq, double invdd, double r_switch, double r_switch2, double r_cut, double r_cut2, double inv_range, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 6;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(a, b, qq, invdd, r_switch, r_switch2, r_cut, r_cut2, inv_range, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
}

};
