void angle_hessian(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, double* hessian, double* dvec, double* hdvec) {
  constexpr size_t PositionSize = 9;
  /* !BASE */
  double cos_theta;
  double cse_p1011_t1_g620;
  double cse_p1_t10_g363;
  double cse_p1_t11_g364;
  double cse_p1_t12_g365;
  double cse_p1_t1_g354;
  double cse_p1_t1_g370;
  double cse_p1_t1_g371;
  double cse_p1_t2_g355;
  double cse_p1_t3_g356;
  double cse_p1_t4_g357;
  double cse_p1_t5_g358;
  double cse_p1_t6_g359;
  double cse_p1_t7_g360;
  double cse_p1_t8_g361;
  double cse_p1_t9_g362;
  double cse_p2_t1_g372;
  double cse_p502_t100_g474;
  double cse_p502_t101_g475;
  double cse_p502_t102_g476;
  double cse_p502_t104_g478;
  double cse_p502_t107_g481;
  double cse_p502_t108_g482;
  double cse_p502_t10_g384;
  double cse_p502_t110_g484;
  double cse_p502_t112_g486;
  double cse_p502_t113_g487;
  double cse_p502_t114_g488;
  double cse_p502_t115_g489;
  double cse_p502_t116_g490;
  double cse_p502_t117_g491;
  double cse_p502_t118_g492;
  double cse_p502_t119_g493;
  double cse_p502_t11_g385;
  double cse_p502_t120_g494;
  double cse_p502_t121_g495;
  double cse_p502_t122_g496;
  double cse_p502_t123_g497;
  double cse_p502_t124_g498;
  double cse_p502_t125_g499;
  double cse_p502_t126_g500;
  double cse_p502_t127_g501;
  double cse_p502_t128_g502;
  double cse_p502_t129_g503;
  double cse_p502_t12_g386;
  double cse_p502_t130_g504;
  double cse_p502_t131_g505;
  double cse_p502_t132_g506;
  double cse_p502_t133_g507;
  double cse_p502_t134_g508;
  double cse_p502_t135_g509;
  double cse_p502_t136_g510;
  double cse_p502_t137_g511;
  double cse_p502_t138_g512;
  double cse_p502_t139_g513;
  double cse_p502_t13_g387;
  double cse_p502_t140_g514;
  double cse_p502_t141_g515;
  double cse_p502_t142_g516;
  double cse_p502_t143_g517;
  double cse_p502_t144_g518;
  double cse_p502_t145_g519;
  double cse_p502_t146_g520;
  double cse_p502_t147_g521;
  double cse_p502_t148_g522;
  double cse_p502_t149_g523;
  double cse_p502_t14_g388;
  double cse_p502_t150_g524;
  double cse_p502_t151_g525;
  double cse_p502_t152_g526;
  double cse_p502_t153_g527;
  double cse_p502_t154_g528;
  double cse_p502_t155_g529;
  double cse_p502_t156_g530;
  double cse_p502_t157_g531;
  double cse_p502_t158_g532;
  double cse_p502_t159_g533;
  double cse_p502_t15_g389;
  double cse_p502_t160_g534;
  double cse_p502_t161_g535;
  double cse_p502_t162_g536;
  double cse_p502_t163_g537;
  double cse_p502_t164_g538;
  double cse_p502_t165_g539;
  double cse_p502_t166_g540;
  double cse_p502_t167_g541;
  double cse_p502_t168_g542;
  double cse_p502_t169_g543;
  double cse_p502_t16_g390;
  double cse_p502_t170_g544;
  double cse_p502_t171_g545;
  double cse_p502_t172_g546;
  double cse_p502_t173_g547;
  double cse_p502_t174_g548;
  double cse_p502_t175_g549;
  double cse_p502_t176_g550;
  double cse_p502_t177_g551;
  double cse_p502_t178_g552;
  double cse_p502_t179_g553;
  double cse_p502_t17_g391;
  double cse_p502_t180_g554;
  double cse_p502_t181_g555;
  double cse_p502_t182_g556;
  double cse_p502_t183_g557;
  double cse_p502_t18_g392;
  double cse_p502_t19_g393;
  double cse_p502_t1_g375;
  double cse_p502_t20_g394;
  double cse_p502_t21_g395;
  double cse_p502_t22_g396;
  double cse_p502_t23_g397;
  double cse_p502_t24_g398;
  double cse_p502_t25_g399;
  double cse_p502_t26_g400;
  double cse_p502_t27_g401;
  double cse_p502_t28_g402;
  double cse_p502_t29_g403;
  double cse_p502_t2_g376;
  double cse_p502_t30_g404;
  double cse_p502_t31_g405;
  double cse_p502_t32_g406;
  double cse_p502_t33_g407;
  double cse_p502_t34_g408;
  double cse_p502_t35_g409;
  double cse_p502_t36_g410;
  double cse_p502_t37_g411;
  double cse_p502_t38_g412;
  double cse_p502_t39_g413;
  double cse_p502_t3_g377;
  double cse_p502_t40_g414;
  double cse_p502_t41_g415;
  double cse_p502_t42_g416;
  double cse_p502_t43_g417;
  double cse_p502_t44_g418;
  double cse_p502_t45_g419;
  double cse_p502_t46_g420;
  double cse_p502_t47_g421;
  double cse_p502_t48_g422;
  double cse_p502_t49_g423;
  double cse_p502_t4_g378;
  double cse_p502_t50_g424;
  double cse_p502_t51_g425;
  double cse_p502_t52_g426;
  double cse_p502_t53_g427;
  double cse_p502_t54_g428;
  double cse_p502_t55_g429;
  double cse_p502_t56_g430;
  double cse_p502_t57_g431;
  double cse_p502_t58_g432;
  double cse_p502_t59_g433;
  double cse_p502_t5_g379;
  double cse_p502_t60_g434;
  double cse_p502_t61_g435;
  double cse_p502_t62_g436;
  double cse_p502_t63_g437;
  double cse_p502_t64_g438;
  double cse_p502_t65_g439;
  double cse_p502_t66_g440;
  double cse_p502_t67_g441;
  double cse_p502_t68_g442;
  double cse_p502_t69_g443;
  double cse_p502_t6_g380;
  double cse_p502_t70_g444;
  double cse_p502_t71_g445;
  double cse_p502_t72_g446;
  double cse_p502_t73_g447;
  double cse_p502_t74_g448;
  double cse_p502_t75_g449;
  double cse_p502_t76_g450;
  double cse_p502_t77_g451;
  double cse_p502_t78_g452;
  double cse_p502_t79_g453;
  double cse_p502_t7_g381;
  double cse_p502_t80_g454;
  double cse_p502_t81_g455;
  double cse_p502_t82_g456;
  double cse_p502_t83_g457;
  double cse_p502_t84_g458;
  double cse_p502_t85_g459;
  double cse_p502_t86_g460;
  double cse_p502_t87_g461;
  double cse_p502_t88_g462;
  double cse_p502_t89_g463;
  double cse_p502_t8_g382;
  double cse_p502_t90_g464;
  double cse_p502_t91_g465;
  double cse_p502_t94_g468;
  double cse_p502_t95_g469;
  double cse_p502_t96_g470;
  double cse_p502_t97_g471;
  double cse_p502_t98_g472;
  double cse_p502_t9_g383;
  double cse_p503_t1_g561;
  double cse_p51_t1_g373;
  double cse_p552_t1_g562;
  double cse_p553_t10_g572;
  double cse_p553_t11_g573;
  double cse_p553_t12_g574;
  double cse_p553_t13_g575;
  double cse_p553_t14_g576;
  double cse_p553_t15_g577;
  double cse_p553_t1_g563;
  double cse_p553_t1_g578;
  double cse_p553_t1_g579;
  double cse_p553_t1_g580;
  double cse_p553_t2_g564;
  double cse_p553_t3_g565;
  double cse_p553_t4_g566;
  double cse_p553_t5_g567;
  double cse_p553_t6_g568;
  double cse_p553_t7_g569;
  double cse_p553_t8_g570;
  double cse_p553_t9_g571;
  double cse_p603_t1_g581;
  double cse_p604_t1_g582;
  double cse_p604_t1_g585;
  double cse_p604_t1_g586;
  double cse_p604_t2_g583;
  double cse_p604_t3_g584;
  double cse_p654_t1_g587;
  double cse_p705_t1_g588;
  double cse_p706_t1_g589;
  double cse_p706_t1_g590;
  double cse_p706_t1_g591;
  double cse_p706_t1_g592;
  double cse_p706_t1_g593;
  double cse_p706_t1_g594;
  double cse_p706_t1_g595;
  double cse_p706_t1_g596;
  double cse_p706_t1_g597;
  double cse_p756_t1_g598;
  double cse_p757_t1_g599;
  double cse_p807_t1_g600;
  double cse_p858_t1_g601;
  double cse_p859_t1_g602;
  double cse_p909_t1_g603;
  double cse_p960_t1_g604;
  double cse_p961_t1_g605;
  double cse_p961_t1_g606;
  double cse_p961_t1_g607;
  double cse_p961_t1_g608;
  double cse_p961_t1_g609;
  double cse_p961_t1_g610;
  double cse_p961_t1_g611;
  double cse_p961_t1_g612;
  double cse_p961_t1_g613;
  double cse_p961_t1_g614;
  double cse_p962_t1_g615;
  double cse_p962_t1_g616;
  double cse_p962_t1_g617;
  double cse_p962_t1_g618;
  double cse_p962_t1_g619;
  double dot;
  double dtheta;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_z1;
  double g_z2;
  double g_z3;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_z2;
  double h_x2_z3;
  double h_x3_x3;
  double h_x3_y3;
  double h_x3_z3;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y2_x3;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_z2;
  double h_y2_z3;
  double h_y3_y3;
  double h_y3_z3;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z2_x3;
  double h_z2_y3;
  double h_z2_z2;
  double h_z2_z3;
  double h_z3_z3;
  double n1;
  double n1_sq;
  double n2;
  double n2_sq;
  double sin_theta;
  double theta;
  double vx1;
  double vx2;
  double vy1;
  double vy2;
  double vz1;
  double vz2;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  {
    /* !BASE */
    cse_p1_t4_g357 = (-(x2));
    cse_p1_t5_g358 = (-(y2));
    cse_p1_t6_g359 = (-(z2));
    vx1 = (cse_p1_t4_g357 + x1);
    cse_p502_t173_g547 = (-(vx1));
    vy1 = (cse_p1_t5_g358 + y1);
    cse_p502_t175_g549 = (-(vy1));
    vz1 = (cse_p1_t6_g359 + z1);
    cse_p502_t177_g551 = (-(vz1));
    vx2 = (cse_p1_t4_g357 + x3);
    cse_p502_t132_g506 = (cse_p502_t173_g547 + (-(vx2)));
    cse_p502_t174_g548 = (-(vx2));
    vy2 = (cse_p1_t5_g358 + y3);
    cse_p502_t133_g507 = (cse_p502_t175_g549 + (-(vy2)));
    cse_p502_t176_g550 = (-(vy2));
    vz2 = (cse_p1_t6_g359 + z3);
    cse_p502_t134_g508 = (cse_p502_t177_g551 + (-(vz2)));
    cse_p502_t178_g552 = (-(vz2));
    dot = ((vx1 * vx2) + (vy1 * vy2) + (vz1 * vz2));
    n1_sq = ((vx1 * vx1) + (vy1 * vy1) + (vz1 * vz1));
    cse_p502_t182_g556 = pow(n1_sq, -1);
    cse_p1_t11_g364 = pow(n1_sq, -0.50000000000000000    );
    n2_sq = ((vx2 * vx2) + (vy2 * vy2) + (vz2 * vz2));
    cse_p502_t183_g557 = pow(n2_sq, -1);
    cse_p1_t12_g365 = pow(n2_sq, -0.50000000000000000    );
    n1 = sqrt(n1_sq);
    cse_p552_t1_g562 = (cse_p1_t12_g365 * n1);
    cse_p960_t1_g604 = (cse_p552_t1_g562 * vz2);
    cse_p858_t1_g601 = (cse_p552_t1_g562 * vy2);
    cse_p654_t1_g587 = (cse_p552_t1_g562 * vx2);
    cse_p502_t94_g468 = (cse_p502_t183_g557 * cse_p654_t1_g587 * vx2);
    cse_p502_t96_g470 = (cse_p502_t183_g557 * cse_p654_t1_g587 * vy2);
    cse_p502_t98_g472 = (cse_p502_t183_g557 * cse_p654_t1_g587 * vz2);
    cse_p502_t100_g474 = (cse_p502_t183_g557 * cse_p858_t1_g601 * vy2);
    cse_p502_t102_g476 = (cse_p502_t183_g557 * cse_p858_t1_g601 * vz2);
    cse_p502_t104_g478 = (cse_p502_t183_g557 * cse_p960_t1_g604 * vz2);
    cse_p502_t165_g539 = (-(cse_p552_t1_g562));
    cse_p502_t166_g540 = (-(cse_p654_t1_g587));
    cse_p502_t167_g541 = (-(cse_p858_t1_g601));
    cse_p502_t168_g542 = (-(cse_p960_t1_g604));
    n2 = sqrt(n2_sq);
    cse_p603_t1_g581 = (cse_p1_t11_g364 * n2);
    cse_p909_t1_g603 = (cse_p603_t1_g581 * vz1);
    cse_p756_t1_g598 = (cse_p603_t1_g581 * vy1);
    cse_p705_t1_g588 = (cse_p603_t1_g581 * vx1);
    cse_p502_t129_g503 = (cse_p502_t166_g540 + (-(cse_p705_t1_g588)));
    cse_p502_t130_g504 = (cse_p502_t167_g541 + (-(cse_p756_t1_g598)));
    cse_p502_t131_g505 = (cse_p502_t168_g542 + (-(cse_p909_t1_g603)));
    cse_p502_t169_g543 = (-(cse_p705_t1_g588));
    cse_p553_t7_g569 = (cse_p502_t166_g540 + cse_p502_t169_g543);
    cse_p502_t170_g544 = (-(cse_p756_t1_g598));
    cse_p553_t8_g570 = (cse_p502_t167_g541 + cse_p502_t170_g544);
    cse_p502_t171_g545 = (-(cse_p909_t1_g603));
    cse_p553_t9_g571 = (cse_p502_t168_g542 + cse_p502_t171_g545);
    cse_p1_t1_g354 = (n1 * n2);
    cse_p961_t1_g613 = (dot * pow(cse_p1_t1_g354, -2));
    cse_p553_t4_g566 = (cse_p553_t7_g569 * cse_p961_t1_g613);
    cse_p553_t5_g567 = (cse_p553_t8_g570 * cse_p961_t1_g613);
    cse_p553_t6_g568 = (cse_p553_t9_g571 * cse_p961_t1_g613);
    cse_p502_t10_g384 = (cse_p553_t7_g569 * pow(cse_p1_t1_g354, -2));
    cse_p502_t11_g385 = (cse_p553_t8_g570 * pow(cse_p1_t1_g354, -2));
    cse_p502_t12_g386 = (cse_p553_t9_g571 * pow(cse_p1_t1_g354, -2));
    cse_p502_t13_g387 = (cse_p502_t182_g556 * pow(cse_p1_t1_g354, -2));
    cse_p502_t14_g388 = (cse_p502_t183_g557 * pow(cse_p1_t1_g354, -2));
    cse_p961_t1_g608 = (2.0000000000000000     * pow(cse_p1_t1_g354, -3));
    cse_p502_t16_g390 = (cse_p552_t1_g562 * cse_p961_t1_g608);
    cse_p502_t17_g391 = (cse_p502_t129_g503 * cse_p961_t1_g608 * n2);
    cse_p502_t18_g392 = (cse_p502_t130_g504 * cse_p961_t1_g608 * n2);
    cse_p502_t19_g393 = (cse_p502_t131_g505 * cse_p961_t1_g608 * n2);
    cse_p502_t20_g394 = (cse_p603_t1_g581 * cse_p961_t1_g608);
    cse_p502_t30_g404 = (-(cse_p553_t4_g566));
    cse_p502_t31_g405 = (-(cse_p553_t5_g567));
    cse_p502_t32_g406 = (-(cse_p553_t6_g568));
    cse_p502_t33_g407 = (cse_p552_t1_g562 * cse_p961_t1_g613);
    cse_p502_t34_g408 = (cse_p654_t1_g587 * cse_p961_t1_g613);
    cse_p502_t35_g409 = (cse_p858_t1_g601 * cse_p961_t1_g613);
    cse_p502_t36_g410 = (cse_p960_t1_g604 * cse_p961_t1_g613);
    cse_p502_t37_g411 = (cse_p603_t1_g581 * cse_p961_t1_g613);
    cse_p502_t38_g412 = (cse_p705_t1_g588 * cse_p961_t1_g613);
    cse_p503_t1_g561 = (cse_p502_t182_g556 * cse_p603_t1_g581 * cse_p961_t1_g613);
    cse_p502_t39_g413 = (cse_p503_t1_g561 * vx1 * vx1);
    cse_p757_t1_g599 = (cse_p502_t182_g556 * cse_p705_t1_g588 * cse_p961_t1_g613);
    cse_p502_t40_g414 = (cse_p757_t1_g599 * vy1);
    cse_p502_t41_g415 = (cse_p757_t1_g599 * vz1);
    cse_p502_t42_g416 = (cse_p756_t1_g598 * cse_p961_t1_g613);
    cse_p502_t43_g417 = (cse_p503_t1_g561 * vy1 * vy1);
    cse_p502_t44_g418 = (cse_p502_t182_g556 * cse_p756_t1_g598 * cse_p961_t1_g613 * vz1);
    cse_p502_t45_g419 = (cse_p909_t1_g603 * cse_p961_t1_g613);
    cse_p502_t46_g420 = (cse_p503_t1_g561 * vz1 * vz1);
    cse_p502_t95_g469 = (cse_p654_t1_g587 * vy2 * pow(cse_p1_t1_g354, -2));
    cse_p502_t97_g471 = (cse_p654_t1_g587 * vz2 * pow(cse_p1_t1_g354, -2));
    cse_p502_t101_g475 = (cse_p858_t1_g601 * vz2 * pow(cse_p1_t1_g354, -2));
    cse_p502_t107_g481 = (cse_p705_t1_g588 * vy1 * pow(cse_p1_t1_g354, -2));
    cse_p502_t108_g482 = (cse_p705_t1_g588 * vz1 * pow(cse_p1_t1_g354, -2));
    cse_p502_t110_g484 = (cse_p756_t1_g598 * vz1 * pow(cse_p1_t1_g354, -2));
    cse_p502_t112_g486 = (cse_p1_t12_g365 * vx2 * pow(cse_p1_t1_g354, -2));
    cse_p502_t113_g487 = (cse_p1_t12_g365 * vy2 * pow(cse_p1_t1_g354, -2));
    cse_p502_t114_g488 = (cse_p1_t12_g365 * vz2 * pow(cse_p1_t1_g354, -2));
    cse_p502_t115_g489 = (cse_p502_t112_g486 + cse_p502_t17_g391);
    cse_p502_t116_g490 = (cse_p502_t113_g487 + cse_p502_t18_g392);
    cse_p502_t117_g491 = (cse_p502_t114_g488 + cse_p502_t19_g393);
    cse_p502_t118_g492 = (cse_p502_t13_g387 + cse_p502_t20_g394);
    cse_p502_t119_g493 = (cse_p502_t14_g388 + cse_p502_t16_g390);
    cse_p502_t145_g519 = (-(cse_p502_t10_g384));
    cse_p502_t146_g520 = (-(cse_p502_t11_g385));
    cse_p502_t147_g521 = (-(cse_p502_t12_g386));
    cse_p502_t148_g522 = (-(cse_p502_t33_g407));
    cse_p502_t149_g523 = (-(cse_p502_t34_g408));
    cse_p502_t150_g524 = (-(cse_p502_t35_g409));
    cse_p502_t151_g525 = (-(cse_p502_t36_g410));
    cse_p502_t152_g526 = (-(cse_p502_t37_g411));
    cse_p502_t153_g527 = (-(cse_p502_t38_g412));
    cse_p502_t154_g528 = (-(cse_p502_t40_g414));
    cse_p502_t155_g529 = (-(cse_p502_t41_g415));
    cse_p502_t156_g530 = (-(cse_p502_t42_g416));
    cse_p502_t157_g531 = (-(cse_p502_t44_g418));
    cse_p502_t158_g532 = (-(cse_p502_t45_g419));
    cse_p502_t159_g533 = (-(cse_p502_t95_g469));
    cse_p502_t160_g534 = (-(cse_p502_t97_g471));
    cse_p502_t161_g535 = (-(cse_p502_t101_g475));
    cse_p502_t162_g536 = (-(cse_p502_t107_g481));
    cse_p502_t163_g537 = (-(cse_p502_t108_g482));
    cse_p502_t164_g538 = (-(cse_p502_t110_g484));
    cse_p502_t181_g555 = pow(cse_p1_t1_g354, -3);
    cse_p604_t1_g585 = (2.0000000000000000     * cse_p502_t181_g555);
    cse_p604_t1_g582 = (cse_p1_t12_g365 * cse_p604_t1_g585 * n1);
    cse_p1_t7_g360 = pow(cse_p1_t1_g354, -1);
    cse_p502_t15_g389 = (2.0000000000000000     * cse_p1_t7_g360);
    cse_p502_t21_g395 = (cse_p1_t7_g360 * (cse_p502_t173_g547 + cse_p502_t174_g548));
    cse_p502_t22_g396 = (cse_p1_t7_g360 * (cse_p502_t175_g549 + cse_p502_t176_g550));
    cse_p502_t23_g397 = (cse_p1_t7_g360 * (cse_p502_t177_g551 + cse_p502_t178_g552));
    cse_p502_t24_g398 = (cse_p1_t7_g360 * vx1);
    cse_p502_t25_g399 = (cse_p1_t7_g360 * vx2);
    cse_p502_t26_g400 = (cse_p1_t7_g360 * vy1);
    cse_p502_t27_g401 = (cse_p1_t7_g360 * vy2);
    cse_p502_t28_g402 = (cse_p1_t7_g360 * vz1);
    cse_p502_t29_g403 = (cse_p1_t7_g360 * vz2);
    cse_p502_t120_g494 = (cse_p502_t21_g395 + cse_p502_t30_g404);
    cse_p502_t121_g495 = (cse_p502_t22_g396 + cse_p502_t31_g405);
    cse_p502_t122_g496 = (cse_p502_t23_g397 + cse_p502_t32_g406);
    cse_p502_t123_g497 = (cse_p502_t149_g523 + cse_p502_t24_g398);
    cse_p502_t124_g498 = (cse_p502_t153_g527 + cse_p502_t25_g399);
    cse_p502_t125_g499 = (cse_p502_t150_g524 + cse_p502_t26_g400);
    cse_p502_t126_g500 = (cse_p502_t156_g530 + cse_p502_t27_g401);
    cse_p502_t127_g501 = (cse_p502_t151_g525 + cse_p502_t28_g402);
    cse_p502_t128_g502 = (cse_p502_t158_g532 + cse_p502_t29_g403);
    cse_p502_t172_g546 = (-(cse_p1_t7_g360));
    cse_p1_t8_g361 = pow(cse_p1_t1_g354, -2);
    cse_p1011_t1_g620 = (cse_p1_t8_g361 * dot);
    cse_p604_t2_g583 = (cse_p1_t8_g361 * cse_p502_t183_g557);
    cse_p604_t3_g584 = (cse_p604_t1_g582 + cse_p604_t2_g583);
    cse_p553_t1_g563 = (cse_p1011_t1_g620 * cse_p553_t7_g569);
    cse_p553_t2_g564 = (cse_p1011_t1_g620 * cse_p553_t8_g570);
    cse_p553_t3_g565 = (cse_p1011_t1_g620 * cse_p553_t9_g571);
    cse_p553_t10_g572 = (cse_p502_t21_g395 + (-(cse_p553_t1_g563)));
    cse_p553_t11_g573 = (cse_p502_t22_g396 + (-(cse_p553_t2_g564)));
    cse_p553_t12_g574 = (cse_p502_t23_g397 + (-(cse_p553_t3_g565)));
    cse_p553_t13_g575 = (-(cse_p553_t1_g563));
    cse_p553_t14_g576 = (-(cse_p553_t2_g564));
    cse_p553_t15_g577 = (-(cse_p553_t3_g565));
    cos_theta = (cse_p1_t7_g360 * dot);
    cse_p502_t1_g375 = (cse_p553_t10_g572 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t2_g376 = (cse_p553_t11_g573 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t3_g377 = (cse_p553_t12_g574 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t4_g378 = (cse_p502_t123_g497 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t5_g379 = (cse_p502_t124_g498 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t6_g380 = (cse_p502_t125_g499 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t7_g381 = (cse_p502_t126_g500 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t8_g382 = (cse_p502_t127_g501 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t9_g383 = (cse_p502_t128_g502 * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p553_t1_g578 = (kt * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ) * pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    ));
    cse_p502_t47_g421 = (cse_p553_t10_g572 * cse_p553_t10_g572 * cse_p553_t1_g578);
    cse_p502_t48_g422 = (cse_p553_t10_g572 * cse_p553_t11_g573 * cse_p553_t1_g578);
    cse_p502_t49_g423 = (cse_p553_t10_g572 * cse_p553_t12_g574 * cse_p553_t1_g578);
    cse_p961_t1_g607 = (cse_p502_t123_g497 * cse_p553_t1_g578);
    cse_p502_t50_g424 = (cse_p553_t10_g572 * cse_p961_t1_g607);
    cse_p961_t1_g610 = (cse_p502_t124_g498 * cse_p553_t1_g578);
    cse_p502_t51_g425 = (cse_p553_t10_g572 * cse_p961_t1_g610);
    cse_p961_t1_g612 = (cse_p502_t125_g499 * cse_p553_t1_g578);
    cse_p502_t52_g426 = (cse_p553_t10_g572 * cse_p961_t1_g612);
    cse_p962_t1_g618 = (cse_p502_t126_g500 * cse_p553_t1_g578);
    cse_p502_t53_g427 = (cse_p553_t10_g572 * cse_p962_t1_g618);
    cse_p502_t54_g428 = (cse_p502_t127_g501 * cse_p553_t10_g572 * cse_p553_t1_g578);
    cse_p502_t55_g429 = (cse_p502_t128_g502 * cse_p553_t10_g572 * cse_p553_t1_g578);
    cse_p502_t56_g430 = (cse_p553_t11_g573 * cse_p553_t11_g573 * cse_p553_t1_g578);
    cse_p502_t57_g431 = (cse_p553_t11_g573 * cse_p553_t12_g574 * cse_p553_t1_g578);
    cse_p502_t58_g432 = (cse_p553_t11_g573 * cse_p961_t1_g607);
    cse_p502_t59_g433 = (cse_p553_t11_g573 * cse_p961_t1_g610);
    cse_p502_t60_g434 = (cse_p553_t11_g573 * cse_p961_t1_g612);
    cse_p502_t61_g435 = (cse_p553_t11_g573 * cse_p962_t1_g618);
    cse_p502_t62_g436 = (cse_p502_t127_g501 * cse_p553_t11_g573 * cse_p553_t1_g578);
    cse_p502_t63_g437 = (cse_p502_t128_g502 * cse_p553_t11_g573 * cse_p553_t1_g578);
    cse_p502_t64_g438 = (cse_p553_t12_g574 * cse_p553_t12_g574 * cse_p553_t1_g578);
    cse_p502_t65_g439 = (cse_p553_t12_g574 * cse_p961_t1_g607);
    cse_p502_t66_g440 = (cse_p553_t12_g574 * cse_p961_t1_g610);
    cse_p502_t67_g441 = (cse_p553_t12_g574 * cse_p961_t1_g612);
    cse_p502_t68_g442 = (cse_p553_t12_g574 * cse_p962_t1_g618);
    cse_p502_t69_g443 = (cse_p502_t127_g501 * cse_p553_t12_g574 * cse_p553_t1_g578);
    cse_p502_t70_g444 = (cse_p502_t128_g502 * cse_p553_t12_g574 * cse_p553_t1_g578);
    cse_p502_t71_g445 = (cse_p502_t123_g497 * cse_p961_t1_g607);
    cse_p502_t72_g446 = (cse_p502_t124_g498 * cse_p961_t1_g607);
    cse_p502_t73_g447 = (cse_p502_t125_g499 * cse_p961_t1_g607);
    cse_p502_t74_g448 = (cse_p502_t126_g500 * cse_p961_t1_g607);
    cse_p502_t75_g449 = (cse_p502_t127_g501 * cse_p961_t1_g607);
    cse_p502_t76_g450 = (cse_p502_t128_g502 * cse_p961_t1_g607);
    cse_p502_t77_g451 = (cse_p502_t124_g498 * cse_p961_t1_g610);
    cse_p502_t78_g452 = (cse_p502_t125_g499 * cse_p961_t1_g610);
    cse_p502_t79_g453 = (cse_p502_t126_g500 * cse_p961_t1_g610);
    cse_p502_t80_g454 = (cse_p502_t127_g501 * cse_p961_t1_g610);
    cse_p502_t81_g455 = (cse_p502_t128_g502 * cse_p961_t1_g610);
    cse_p502_t82_g456 = (cse_p502_t125_g499 * cse_p961_t1_g612);
    cse_p502_t83_g457 = (cse_p502_t126_g500 * cse_p961_t1_g612);
    cse_p502_t84_g458 = (cse_p502_t127_g501 * cse_p961_t1_g612);
    cse_p502_t85_g459 = (cse_p502_t128_g502 * cse_p961_t1_g612);
    cse_p502_t86_g460 = (cse_p502_t126_g500 * cse_p962_t1_g618);
    cse_p502_t87_g461 = (cse_p502_t127_g501 * cse_p962_t1_g618);
    cse_p502_t88_g462 = (cse_p502_t128_g502 * cse_p962_t1_g618);
    cse_p502_t89_g463 = (cse_p502_t127_g501 * cse_p502_t127_g501 * cse_p553_t1_g578);
    cse_p502_t90_g464 = (cse_p502_t127_g501 * cse_p502_t128_g502 * cse_p553_t1_g578);
    cse_p502_t91_g465 = (cse_p502_t128_g502 * cse_p502_t128_g502 * cse_p553_t1_g578);
    cse_p502_t136_g510 = (-(cse_p502_t1_g375));
    cse_p502_t137_g511 = (-(cse_p502_t2_g376));
    cse_p502_t138_g512 = (-(cse_p502_t3_g377));
    cse_p502_t139_g513 = (-(cse_p502_t4_g378));
    cse_p502_t140_g514 = (-(cse_p502_t5_g379));
    cse_p502_t141_g515 = (-(cse_p502_t6_g380));
    cse_p502_t142_g516 = (-(cse_p502_t7_g381));
    cse_p502_t143_g517 = (-(cse_p502_t8_g382));
    cse_p502_t144_g518 = (-(cse_p502_t9_g383));
    cse_p502_t179_g553 = pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -1);
    cse_p502_t180_g554 = pow((1.0000000000000000     + (-(((cos_theta) * (cos_theta))))), -0.50000000000000000    );
    cse_p1_t2_g355 = (1.0000000000000000     + (-(((cos_theta) * (cos_theta)))));
    cse_p1_t3_g356 = (-(((cos_theta) * (cos_theta))));
    cse_p1_t9_g362 = pow(cse_p1_t2_g355, -0.50000000000000000    );
    cse_p1_t10_g363 = ((cos_theta) * (cos_theta));
    if (fabs(cos_theta)>(1.0-VERYSMALL)) linear_angle_error();
    sin_theta = sqrt(cse_p1_t2_g355);
    theta = acos(cos_theta);
    dtheta = (theta + (-(t0)));
    cse_p2_t1_g372 = (dtheta * kt);
    cse_p502_t135_g509 = (2.0000000000000000     * cse_p2_t1_g372);
    energy = (cse_p2_t1_g372 * dtheta);
    *energy_accumulate += energy;
    cse_p1_t1_g370 = (cse_p1011_t1_g620 * cse_p603_t1_g581);
    cse_p51_t1_g373 = (cse_p1_t9_g362 * cse_p502_t135_g509);
    g_x1 = (-((cse_p51_t1_g373 * (cse_p502_t25_g399 + (-((cse_p1_t1_g370 * vx1)))))));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (-((cse_p51_t1_g373 * (cse_p502_t27_g401 + (-((cse_p1_t1_g370 * vy1)))))));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (-((cse_p51_t1_g373 * (cse_p502_t29_g403 + (-((cse_p1_t1_g370 * vz1)))))));
    KernelGradientAcc(i3x1, 2, g_z1);
    g_x2 = (-((cse_p51_t1_g373 * (cse_p502_t21_g395 + (-((cse_p1011_t1_g620 * cse_p502_t129_g503)))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (-((cse_p51_t1_g373 * (cse_p502_t22_g396 + (-((cse_p1011_t1_g620 * cse_p502_t130_g504)))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (-((cse_p51_t1_g373 * (cse_p502_t23_g397 + (-((cse_p1011_t1_g620 * cse_p502_t131_g505)))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    cse_p1_t1_g371 = (cse_p1011_t1_g620 * cse_p552_t1_g562);
    g_x3 = (-((cse_p51_t1_g373 * (cse_p502_t24_g398 + (-((cse_p1_t1_g371 * vx2)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (-((cse_p51_t1_g373 * (cse_p502_t26_g400 + (-((cse_p1_t1_g371 * vy2)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (-((cse_p51_t1_g373 * (cse_p502_t28_g402 + (-((cse_p1_t1_g371 * vz2)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    cse_p553_t1_g579 = (cos_theta * cse_p502_t179_g553);
    cse_p553_t1_g580 = (cse_p502_t135_g509 * cse_p502_t180_g554);
    cse_p859_t1_g602 = (cse_p604_t1_g585 * dot);
    cse_p961_t1_g614 = (-2.0000000000000000     * cse_p1_t8_g361);
    h_x1_x1 = (cse_p502_t77_g451 + cse_p502_t77_g451 + (-((cse_p553_t1_g580 * (cse_p502_t152_g526 + cse_p502_t39_g413 + (cse_p502_t124_g498 * cse_p502_t124_g498 * cse_p553_t1_g579) + (cse_p705_t1_g588 * ((cse_p705_t1_g588 * cse_p859_t1_g602) + (cse_p961_t1_g614 * vx2))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
    cse_p962_t1_g616 = (cse_p1_t8_g361 * cse_p705_t1_g588);
    h_x1_y1 = (cse_p502_t79_g453 + cse_p502_t79_g453 + (-((cse_p553_t1_g580 * ((cse_p502_t118_g492 * cse_p705_t1_g588 * dot * vy1) + (cse_p502_t124_g498 * cse_p502_t126_g500 * cse_p553_t1_g579) + (-((cse_p1_t8_g361 * cse_p756_t1_g598 * vx2))) + (-((cse_p962_t1_g616 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
    h_x1_z1 = (cse_p502_t81_g455 + cse_p502_t81_g455 + (-((cse_p553_t1_g580 * ((cse_p502_t118_g492 * cse_p705_t1_g588 * dot * vz1) + (cse_p502_t124_g498 * cse_p502_t128_g502 * cse_p553_t1_g579) + (-((cse_p1_t8_g361 * cse_p909_t1_g603 * vx2))) + (-((cse_p962_t1_g616 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
    cse_p961_t1_g605 = (cse_p1_t11_g364 * dot);
    cse_p961_t1_g606 = (cse_p502_t120_g494 * cse_p553_t1_g579);
    cse_p962_t1_g619 = (cse_p502_t129_g503 * cse_p604_t1_g585);
    h_x1_x2 = (cse_p502_t51_g425 + cse_p502_t51_g425 + (-((cse_p553_t1_g580 * (cse_p502_t172_g546 + (cse_p502_t124_g498 * cse_p961_t1_g606) + (cse_p502_t145_g519 * vx2) + (cse_p961_t1_g605 * ((cse_p1_t8_g361 * (n2 + (cse_p1_t12_g365 * vx1 * vx2))) + (cse_p962_t1_g619 * n2 * vx1))) + (-((cse_p502_t132_g506 * cse_p962_t1_g616))) + (-(cse_p502_t39_g413)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
    cse_p961_t1_g609 = (cse_p502_t121_g495 * cse_p553_t1_g579);
    h_x1_y2 = (cse_p502_t59_g433 + cse_p502_t59_g433 + (-((cse_p553_t1_g580 * (cse_p502_t154_g528 + (cse_p502_t116_g490 * cse_p961_t1_g605 * vx1) + (cse_p502_t124_g498 * cse_p961_t1_g609) + (cse_p502_t146_g520 * vx2) + (-((cse_p502_t133_g507 * cse_p962_t1_g616))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
    cse_p961_t1_g611 = (cse_p502_t122_g496 * cse_p553_t1_g579);
    h_x1_z2 = (cse_p502_t66_g440 + cse_p502_t66_g440 + (-((cse_p553_t1_g580 * (cse_p502_t155_g529 + (cse_p502_t117_g491 * cse_p961_t1_g605 * vx1) + (cse_p502_t124_g498 * cse_p961_t1_g611) + (cse_p502_t147_g521 * vx2) + (-((cse_p502_t134_g508 * cse_p962_t1_g616))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
    cse_p604_t1_g586 = (cse_p1_t11_g364 * cse_p1_t12_g365);
    cse_p807_t1_g600 = (cse_p1011_t1_g620 * cse_p604_t1_g586);
    cse_p962_t1_g615 = (cse_p1_t8_g361 * cse_p654_t1_g587);
    cse_p962_t1_g617 = (cse_p502_t123_g497 * cse_p553_t1_g579);
    h_x1_x3 = (cse_p502_t72_g446 + cse_p502_t72_g446 + (-((cse_p553_t1_g580 * (cse_p1_t7_g360 + (cse_p502_t124_g498 * cse_p962_t1_g617) + (cse_p654_t1_g587 * cse_p705_t1_g588 * cse_p859_t1_g602) + (-((cse_p807_t1_g600 * vx1 * vx2))) + (-((cse_p962_t1_g615 * vx2))) + (-((cse_p962_t1_g616 * vx1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
    h_x1_y3 = (cse_p502_t78_g452 + cse_p502_t78_g452 + (-((cse_p553_t1_g580 * (cse_p502_t159_g533 + cse_p502_t162_g536 + (cse_p502_t124_g498 * cse_p502_t125_g499 * cse_p553_t1_g579) + (cse_p705_t1_g588 * cse_p858_t1_g601 * cse_p859_t1_g602) + (-((cse_p807_t1_g600 * vx1 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
    h_x1_z3 = (cse_p502_t80_g454 + cse_p502_t80_g454 + (-((cse_p553_t1_g580 * (cse_p502_t160_g534 + cse_p502_t163_g537 + (cse_p502_t124_g498 * cse_p502_t127_g501 * cse_p553_t1_g579) + (cse_p705_t1_g588 * cse_p859_t1_g602 * cse_p960_t1_g604) + (-((cse_p807_t1_g600 * vx1 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
    h_y1_y1 = (cse_p502_t86_g460 + cse_p502_t86_g460 + (-((cse_p553_t1_g580 * (cse_p502_t152_g526 + cse_p502_t43_g417 + (cse_p502_t126_g500 * cse_p502_t126_g500 * cse_p553_t1_g579) + (cse_p756_t1_g598 * ((cse_p756_t1_g598 * cse_p859_t1_g602) + (cse_p961_t1_g614 * vy2))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
    h_y1_z1 = (cse_p502_t88_g462 + cse_p502_t88_g462 + (-((cse_p553_t1_g580 * ((cse_p502_t118_g492 * cse_p756_t1_g598 * dot * vz1) + (cse_p502_t126_g500 * cse_p502_t128_g502 * cse_p553_t1_g579) + (-((cse_p1_t8_g361 * cse_p756_t1_g598 * vz2))) + (-((cse_p1_t8_g361 * cse_p909_t1_g603 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
    cse_p706_t1_g590 = (cse_p1_t8_g361 * cse_p502_t132_g506 * cse_p603_t1_g581);
    h_y1_x2 = (cse_p502_t53_g427 + cse_p502_t53_g427 + (-((cse_p553_t1_g580 * (cse_p502_t154_g528 + (cse_p502_t115_g489 * cse_p961_t1_g605 * vy1) + (cse_p502_t126_g500 * cse_p961_t1_g606) + (cse_p502_t145_g519 * vy2) + (-((cse_p706_t1_g590 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
    cse_p706_t1_g592 = (cse_p1_t8_g361 * cse_p502_t133_g507 * cse_p603_t1_g581);
    h_y1_y2 = (cse_p502_t61_g435 + cse_p502_t61_g435 + (-((cse_p553_t1_g580 * (cse_p502_t172_g546 + (cse_p502_t126_g500 * cse_p961_t1_g609) + (cse_p502_t146_g520 * vy2) + (cse_p961_t1_g605 * ((cse_p1_t8_g361 * (n2 + (cse_p1_t12_g365 * vy1 * vy2))) + (cse_p502_t130_g504 * cse_p604_t1_g585 * n2 * vy1))) + (-((cse_p706_t1_g592 * vy1))) + (-(cse_p502_t43_g417)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
    cse_p706_t1_g594 = (cse_p1_t8_g361 * cse_p502_t134_g508 * cse_p603_t1_g581);
    h_y1_z2 = (cse_p502_t68_g442 + cse_p502_t68_g442 + (-((cse_p553_t1_g580 * (cse_p502_t157_g531 + (cse_p502_t117_g491 * cse_p961_t1_g605 * vy1) + (cse_p502_t126_g500 * cse_p961_t1_g611) + (cse_p502_t147_g521 * vy2) + (-((cse_p706_t1_g594 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
    h_y1_x3 = (cse_p502_t74_g448 + cse_p502_t74_g448 + (-((cse_p553_t1_g580 * (cse_p502_t159_g533 + cse_p502_t162_g536 + (cse_p502_t126_g500 * cse_p962_t1_g617) + (cse_p654_t1_g587 * cse_p756_t1_g598 * cse_p859_t1_g602) + (-((cse_p807_t1_g600 * vx2 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
    h_y1_y3 = (cse_p502_t83_g457 + cse_p502_t83_g457 + (-((cse_p553_t1_g580 * (cse_p1_t7_g360 + (cse_p502_t125_g499 * cse_p502_t126_g500 * cse_p553_t1_g579) + (cse_p756_t1_g598 * cse_p858_t1_g601 * cse_p859_t1_g602) + (-((cse_p1_t8_g361 * cse_p756_t1_g598 * vy1))) + (-((cse_p1_t8_g361 * cse_p858_t1_g601 * vy2))) + (-((cse_p807_t1_g600 * vy1 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
    h_y1_z3 = (cse_p502_t87_g461 + cse_p502_t87_g461 + (-((cse_p553_t1_g580 * (cse_p502_t161_g535 + cse_p502_t164_g538 + (cse_p502_t126_g500 * cse_p502_t127_g501 * cse_p553_t1_g579) + (cse_p756_t1_g598 * cse_p859_t1_g602 * cse_p960_t1_g604) + (-((cse_p807_t1_g600 * vy1 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
    h_z1_z1 = (cse_p502_t91_g465 + cse_p502_t91_g465 + (-((cse_p553_t1_g580 * (cse_p502_t152_g526 + cse_p502_t46_g420 + (cse_p502_t128_g502 * cse_p502_t128_g502 * cse_p553_t1_g579) + (cse_p909_t1_g603 * ((cse_p859_t1_g602 * cse_p909_t1_g603) + (cse_p961_t1_g614 * vz2))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
    h_z1_x2 = (cse_p502_t55_g429 + cse_p502_t55_g429 + (-((cse_p553_t1_g580 * (cse_p502_t155_g529 + (cse_p502_t115_g489 * cse_p961_t1_g605 * vz1) + (cse_p502_t128_g502 * cse_p961_t1_g606) + (cse_p502_t145_g519 * vz2) + (-((cse_p706_t1_g590 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
    h_z1_y2 = (cse_p502_t63_g437 + cse_p502_t63_g437 + (-((cse_p553_t1_g580 * (cse_p502_t157_g531 + (cse_p502_t116_g490 * cse_p961_t1_g605 * vz1) + (cse_p502_t128_g502 * cse_p961_t1_g609) + (cse_p502_t146_g520 * vz2) + (-((cse_p706_t1_g592 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
    h_z1_z2 = (cse_p502_t70_g444 + cse_p502_t70_g444 + (-((cse_p553_t1_g580 * (cse_p502_t172_g546 + (cse_p502_t128_g502 * cse_p961_t1_g611) + (cse_p502_t147_g521 * vz2) + (cse_p961_t1_g605 * ((cse_p1_t8_g361 * (n2 + (cse_p1_t12_g365 * vz1 * vz2))) + (cse_p502_t131_g505 * cse_p604_t1_g585 * n2 * vz1))) + (-((cse_p706_t1_g594 * vz1))) + (-(cse_p502_t46_g420)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
    h_z1_x3 = (cse_p502_t76_g450 + cse_p502_t76_g450 + (-((cse_p553_t1_g580 * (cse_p502_t160_g534 + cse_p502_t163_g537 + (cse_p502_t128_g502 * cse_p962_t1_g617) + (cse_p654_t1_g587 * cse_p859_t1_g602 * cse_p909_t1_g603) + (-((cse_p807_t1_g600 * vx2 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
    h_z1_y3 = (cse_p502_t85_g459 + cse_p502_t85_g459 + (-((cse_p553_t1_g580 * (cse_p502_t161_g535 + cse_p502_t164_g538 + (cse_p502_t125_g499 * cse_p502_t128_g502 * cse_p553_t1_g579) + (cse_p858_t1_g601 * cse_p859_t1_g602 * cse_p909_t1_g603) + (-((cse_p807_t1_g600 * vy2 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
    h_z1_z3 = (cse_p502_t90_g464 + cse_p502_t90_g464 + (-((cse_p553_t1_g580 * (cse_p1_t7_g360 + (cse_p502_t127_g501 * cse_p502_t128_g502 * cse_p553_t1_g579) + (cse_p859_t1_g602 * cse_p909_t1_g603 * cse_p960_t1_g604) + (-((cse_p1_t8_g361 * cse_p909_t1_g603 * vz1))) + (-((cse_p1_t8_g361 * cse_p960_t1_g604 * vz2))) + (-((cse_p807_t1_g600 * vz1 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
    h_x2_x2 = (cse_p502_t47_g421 + cse_p502_t47_g421 + (-((cse_p553_t1_g580 * (cse_p502_t15_g389 + (2.0000000000000000     * cse_p502_t132_g506 * cse_p502_t145_g519) + (cse_p502_t120_g494 * cse_p961_t1_g606) + (dot * ((cse_p502_t129_g503 * cse_p962_t1_g619) + (-((cse_p1_t8_g361 * (cse_p552_t1_g562 + cse_p603_t1_g581 + (2.0000000000000000     * cse_p604_t1_g586 * vx1 * vx2) + (-((cse_p502_t182_g556 * cse_p705_t1_g588 * vx1))) + (-(cse_p502_t94_g468)))))))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
    h_x2_y2 = (cse_p502_t48_g422 + cse_p502_t48_g422 + (-((cse_p553_t1_g580 * ((cse_p502_t121_g495 * cse_p961_t1_g606) + (cse_p502_t132_g506 * cse_p502_t146_g520) + (cse_p502_t133_g507 * cse_p502_t145_g519) + (dot * ((cse_p502_t130_g504 * cse_p962_t1_g619) + (-((cse_p1_t8_g361 * ((cse_p604_t1_g586 * ((vx1 * vy2) + (vx2 * vy1))) + (-((cse_p502_t182_g556 * cse_p705_t1_g588 * vy1))) + (-(cse_p502_t96_g470)))))))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
    h_x2_z2 = (cse_p502_t49_g423 + cse_p502_t49_g423 + (-((cse_p553_t1_g580 * ((cse_p502_t122_g496 * cse_p961_t1_g606) + (cse_p502_t132_g506 * cse_p502_t147_g521) + (cse_p502_t134_g508 * cse_p502_t145_g519) + (dot * ((cse_p502_t131_g505 * cse_p962_t1_g619) + (-((cse_p1_t8_g361 * ((cse_p604_t1_g586 * ((vx1 * vz2) + (vx2 * vz1))) + (-((cse_p502_t182_g556 * cse_p705_t1_g588 * vz1))) + (-(cse_p502_t98_g472)))))))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
    h_x2_x3 = (cse_p502_t50_g424 + cse_p502_t50_g424 + (-((cse_p553_t1_g580 * (cse_p502_t172_g546 + (cse_p502_t123_g497 * cse_p961_t1_g606) + (cse_p502_t145_g519 * vx1) + (dot * ((cse_p654_t1_g587 * cse_p962_t1_g619) + (-((cse_p1_t8_g361 * (cse_p502_t165_g539 + cse_p502_t94_g468 + (-((cse_p604_t1_g586 * vx1 * vx2))))))))) + (-((cse_p502_t132_g506 * cse_p962_t1_g615))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
    cse_p706_t1_g589 = (cse_p1_t8_g361 * cse_p502_t132_g506 * cse_p552_t1_g562);
    cse_p706_t1_g595 = (cse_p552_t1_g562 * cse_p962_t1_g619);
    h_x2_y3 = (cse_p502_t52_g426 + cse_p502_t52_g426 + (-((cse_p553_t1_g580 * ((cse_p502_t125_g499 * cse_p961_t1_g606) + (cse_p502_t145_g519 * vy1) + (dot * ((cse_p706_t1_g595 * vy2) + (-((cse_p1_t8_g361 * (cse_p502_t96_g470 + (-((cse_p604_t1_g586 * vx1 * vy2))))))))) + (-((cse_p706_t1_g589 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
    h_x2_z3 = (cse_p502_t54_g428 + cse_p502_t54_g428 + (-((cse_p553_t1_g580 * ((cse_p502_t127_g501 * cse_p961_t1_g606) + (cse_p502_t145_g519 * vz1) + (dot * ((cse_p706_t1_g595 * vz2) + (-((cse_p1_t8_g361 * (cse_p502_t98_g472 + (-((cse_p604_t1_g586 * vx1 * vz2))))))))) + (-((cse_p706_t1_g589 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
    h_y2_y2 = (cse_p502_t56_g430 + cse_p502_t56_g430 + (-((cse_p553_t1_g580 * (cse_p502_t15_g389 + (2.0000000000000000     * cse_p502_t133_g507 * cse_p502_t146_g520) + (cse_p502_t121_g495 * cse_p961_t1_g609) + (dot * ((cse_p502_t130_g504 * cse_p502_t130_g504 * cse_p604_t1_g585) + (-((cse_p1_t8_g361 * (cse_p552_t1_g562 + cse_p603_t1_g581 + (2.0000000000000000     * cse_p604_t1_g586 * vy1 * vy2) + (-((cse_p502_t182_g556 * cse_p756_t1_g598 * vy1))) + (-(cse_p502_t100_g474)))))))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
    h_y2_z2 = (cse_p502_t57_g431 + cse_p502_t57_g431 + (-((cse_p553_t1_g580 * ((cse_p502_t122_g496 * cse_p961_t1_g609) + (cse_p502_t133_g507 * cse_p502_t147_g521) + (cse_p502_t134_g508 * cse_p502_t146_g520) + (dot * ((cse_p502_t130_g504 * cse_p502_t131_g505 * cse_p604_t1_g585) + (-((cse_p1_t8_g361 * ((cse_p604_t1_g586 * ((vy1 * vz2) + (vy2 * vz1))) + (-((cse_p502_t182_g556 * cse_p756_t1_g598 * vz1))) + (-(cse_p502_t102_g476)))))))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
    h_y2_x3 = (cse_p502_t58_g432 + cse_p502_t58_g432 + (-((cse_p553_t1_g580 * ((cse_p502_t123_g497 * cse_p961_t1_g609) + (cse_p502_t146_g520 * vx1) + (dot * ((cse_p502_t130_g504 * cse_p604_t1_g585 * cse_p654_t1_g587) + (-((cse_p1_t8_g361 * (cse_p502_t96_g470 + (-((cse_p604_t1_g586 * vx2 * vy1))))))))) + (-((cse_p502_t133_g507 * cse_p962_t1_g615))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
    cse_p706_t1_g591 = (cse_p1_t8_g361 * cse_p502_t133_g507 * cse_p552_t1_g562);
    cse_p706_t1_g596 = (cse_p502_t130_g504 * cse_p552_t1_g562 * cse_p604_t1_g585);
    h_y2_y3 = (cse_p502_t60_g434 + cse_p502_t60_g434 + (-((cse_p553_t1_g580 * (cse_p502_t172_g546 + (cse_p502_t125_g499 * cse_p961_t1_g609) + (cse_p502_t146_g520 * vy1) + (dot * ((cse_p706_t1_g596 * vy2) + (-((cse_p1_t8_g361 * (cse_p502_t100_g474 + cse_p502_t165_g539 + (-((cse_p604_t1_g586 * vy1 * vy2))))))))) + (-((cse_p706_t1_g591 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
    h_y2_z3 = (cse_p502_t62_g436 + cse_p502_t62_g436 + (-((cse_p553_t1_g580 * ((cse_p502_t127_g501 * cse_p961_t1_g609) + (cse_p502_t146_g520 * vz1) + (dot * ((cse_p706_t1_g596 * vz2) + (-((cse_p1_t8_g361 * (cse_p502_t102_g476 + (-((cse_p604_t1_g586 * vy1 * vz2))))))))) + (-((cse_p706_t1_g591 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
    h_z2_z2 = (cse_p502_t64_g438 + cse_p502_t64_g438 + (-((cse_p553_t1_g580 * (cse_p502_t15_g389 + (2.0000000000000000     * cse_p502_t134_g508 * cse_p502_t147_g521) + (cse_p502_t122_g496 * cse_p961_t1_g611) + (dot * ((cse_p502_t131_g505 * cse_p502_t131_g505 * cse_p604_t1_g585) + (-((cse_p1_t8_g361 * (cse_p552_t1_g562 + cse_p603_t1_g581 + (2.0000000000000000     * cse_p604_t1_g586 * vz1 * vz2) + (-((cse_p502_t182_g556 * cse_p909_t1_g603 * vz1))) + (-(cse_p502_t104_g478)))))))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
    h_z2_x3 = (cse_p502_t65_g439 + cse_p502_t65_g439 + (-((cse_p553_t1_g580 * ((cse_p502_t123_g497 * cse_p961_t1_g611) + (cse_p502_t147_g521 * vx1) + (dot * ((cse_p502_t131_g505 * cse_p604_t1_g585 * cse_p654_t1_g587) + (-((cse_p1_t8_g361 * (cse_p502_t98_g472 + (-((cse_p604_t1_g586 * vx2 * vz1))))))))) + (-((cse_p502_t134_g508 * cse_p962_t1_g615))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
    cse_p706_t1_g593 = (cse_p1_t8_g361 * cse_p502_t134_g508 * cse_p552_t1_g562);
    cse_p706_t1_g597 = (cse_p502_t131_g505 * cse_p552_t1_g562 * cse_p604_t1_g585);
    h_z2_y3 = (cse_p502_t67_g441 + cse_p502_t67_g441 + (-((cse_p553_t1_g580 * ((cse_p502_t125_g499 * cse_p961_t1_g611) + (cse_p502_t147_g521 * vy1) + (dot * ((cse_p706_t1_g597 * vy2) + (-((cse_p1_t8_g361 * (cse_p502_t102_g476 + (-((cse_p604_t1_g586 * vy2 * vz1))))))))) + (-((cse_p706_t1_g593 * vy2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
    h_z2_z3 = (cse_p502_t69_g443 + cse_p502_t69_g443 + (-((cse_p553_t1_g580 * (cse_p502_t172_g546 + (cse_p502_t127_g501 * cse_p961_t1_g611) + (cse_p502_t147_g521 * vz1) + (dot * ((cse_p706_t1_g597 * vz2) + (-((cse_p1_t8_g361 * (cse_p502_t104_g478 + cse_p502_t165_g539 + (-((cse_p604_t1_g586 * vz1 * vz2))))))))) + (-((cse_p706_t1_g593 * vz2))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
    h_x3_x3 = (cse_p502_t71_g445 + cse_p502_t71_g445 + (-((cse_p553_t1_g580 * (cse_p502_t148_g522 + (cse_p502_t123_g497 * cse_p962_t1_g617) + (cse_p654_t1_g587 * ((cse_p604_t3_g584 * dot * vx2) + (cse_p961_t1_g614 * vx1))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
    h_x3_y3 = (cse_p502_t73_g447 + cse_p502_t73_g447 + (-((cse_p553_t1_g580 * ((cse_p502_t119_g493 * cse_p654_t1_g587 * dot * vy2) + (cse_p502_t125_g499 * cse_p962_t1_g617) + (-((cse_p1_t8_g361 * cse_p858_t1_g601 * vx1))) + (-((cse_p962_t1_g615 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
    h_x3_z3 = (cse_p502_t75_g449 + cse_p502_t75_g449 + (-((cse_p553_t1_g580 * ((cse_p502_t119_g493 * cse_p654_t1_g587 * dot * vz2) + (cse_p502_t127_g501 * cse_p962_t1_g617) + (-((cse_p1_t8_g361 * cse_p960_t1_g604 * vx1))) + (-((cse_p962_t1_g615 * vz1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
    h_y3_y3 = (cse_p502_t82_g456 + cse_p502_t82_g456 + (-((cse_p553_t1_g580 * (cse_p502_t148_g522 + (cse_p502_t125_g499 * cse_p502_t125_g499 * cse_p553_t1_g579) + (cse_p858_t1_g601 * ((cse_p604_t3_g584 * dot * vy2) + (cse_p961_t1_g614 * vy1))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
    h_y3_z3 = (cse_p502_t84_g458 + cse_p502_t84_g458 + (-((cse_p553_t1_g580 * ((cse_p502_t119_g493 * cse_p858_t1_g601 * dot * vz2) + (cse_p502_t125_g499 * cse_p502_t127_g501 * cse_p553_t1_g579) + (-((cse_p1_t8_g361 * cse_p858_t1_g601 * vz1))) + (-((cse_p1_t8_g361 * cse_p960_t1_g604 * vy1))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
    h_z3_z3 = (cse_p502_t89_g463 + cse_p502_t89_g463 + (-((cse_p553_t1_g580 * (cse_p502_t148_g522 + (cse_p502_t127_g501 * cse_p502_t127_g501 * cse_p553_t1_g579) + (cse_p960_t1_g604 * ((cse_p604_t3_g584 * dot * vz2) + (cse_p961_t1_g614 * vz1))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
  }
}
void angle_hessian_fd(double kt, double t0, size_t i3x1, size_t i3x2, size_t i3x3, double* position, double* energy_accumulate, double* force, double* hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 9;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    angle_energy(kt, t0, i3x1, i3x2, i3x3, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
}

