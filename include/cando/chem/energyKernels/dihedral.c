template <typename HESSIAN>
struct Dihedral {
  static constexpr size_t PositionSize = 12;
  static std::string description() { return "mathkernel-dihedral"; };
double energy(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c1_sq;
  double c2x;
  double c2y;
  double c2z;
  double c2_sq;
  double cos_angle;
  double cos_nphi;
  double dot12;
  double dot23;
  double energy;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_len;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    v1x = (x2 + (-(x1)));
    v1y = (y2 + (-(y1)));
    v1z = (z2 + (-(z1)));
    v2x = (x3 + (-(x2)));
    v2y = (y3 + (-(y2)));
    v2z = (z3 + (-(z2)));
    v3x = (x4 + (-(x3)));
    v3y = (y4 + (-(y3)));
    v3z = (z4 + (-(z3)));
    c1x = ((v1y * v2z) + (-((v1z * v2y))));
    c1y = ((v1z * v2x) + (-((v1x * v2z))));
    c1z = ((v1x * v2y) + (-((v1y * v2x))));
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    c1_sq = ((c1x * c1x) + (c1y * c1y) + (c1z * c1z));
    c2_sq = ((c2x * c2x) + (c2y * c2y) + (c2z * c2z));
    v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
    v2_len = sqrt(v2_sq);
    dot12 = ((v1x * v2x) + (v1y * v2y) + (v1z * v2z));
    dot23 = ((v2x * v3x) + (v2y * v3y) + (v2z * v3z));
    t1 = (v2_len * ((c2x * v1x) + (c2y * v1y) + (c2z * v1z)));
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    phi = atan2(t1, t2);
    nphi = (n * phi);
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
    return energy;
  }
}
void energy_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, energy_accumulate, force, hessian, dvec, hdvec);
}

double gradient(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c1_sq;
  double c2x;
  double c2y;
  double c2z;
  double c2_sq;
  double cos_angle;
  double cos_nphi;
  double cse_p1_t10_g45402;
  double cse_p1_t11_g45403;
  double cse_p1_t12_g45404;
  double cse_p1_t13_g45405;
  double cse_p1_t14_g45406;
  double cse_p1_t15_g45407;
  double cse_p1_t16_g45408;
  double cse_p1_t17_g45409;
  double cse_p1_t18_g45410;
  double cse_p1_t19_g45411;
  double cse_p1_t1_g45393;
  double cse_p1_t1_g45425;
  double cse_p1_t1_g45426;
  double cse_p1_t1_g45427;
  double cse_p1_t1_g45428;
  double cse_p1_t1_g45429;
  double cse_p1_t20_g45412;
  double cse_p1_t21_g45413;
  double cse_p1_t22_g45414;
  double cse_p1_t23_g45415;
  double cse_p1_t24_g45416;
  double cse_p1_t25_g45417;
  double cse_p1_t26_g45418;
  double cse_p1_t27_g45419;
  double cse_p1_t28_g45420;
  double cse_p1_t29_g45421;
  double cse_p1_t2_g45394;
  double cse_p1_t30_g45422;
  double cse_p1_t31_g45423;
  double cse_p1_t32_g45424;
  double cse_p1_t3_g45395;
  double cse_p1_t6_g45398;
  double cse_p1_t7_g45399;
  double cse_p1_t8_g45400;
  double cse_p1_t9_g45401;
  double dot12;
  double dot23;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_len;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    v1x = (x2 + (-(x1)));
    cse_p1_t20_g45412 = (-(v1x));
    v1y = (y2 + (-(y1)));
    cse_p1_t21_g45413 = (-(v1y));
    v1z = (z2 + (-(z1)));
    cse_p1_t22_g45414 = (-(v1z));
    v2x = (x3 + (-(x2)));
    cse_p1_t8_g45400 = (v1z * v2x);
    cse_p1_t23_g45415 = (-(v2x));
    v2y = (y3 + (-(y2)));
    cse_p1_t6_g45398 = (v1x * v2y);
    cse_p1_t24_g45416 = (-(v2y));
    v2z = (z3 + (-(z2)));
    cse_p1_t7_g45399 = (v1y * v2z);
    cse_p1_t25_g45417 = (-(v2z));
    v3x = (x4 + (-(x3)));
    cse_p1_t11_g45403 = (cse_p1_t23_g45415 + (-(v3x)));
    cse_p1_t15_g45407 = (v2x + v3x);
    cse_p1_t26_g45418 = (-(v3x));
    v3y = (y4 + (-(y3)));
    cse_p1_t12_g45404 = (cse_p1_t24_g45416 + (-(v3y)));
    cse_p1_t16_g45408 = (v2y + v3y);
    cse_p1_t27_g45419 = (-(v3y));
    v3z = (z4 + (-(z3)));
    cse_p1_t13_g45405 = (cse_p1_t25_g45417 + (-(v3z)));
    cse_p1_t17_g45409 = (v2z + v3z);
    cse_p1_t28_g45420 = (-(v3z));
    c1x = (cse_p1_t7_g45399 + (-((v1z * v2y))));
    c1y = (cse_p1_t8_g45400 + (-((v1x * v2z))));
    c1z = (cse_p1_t6_g45398 + (-((v1y * v2x))));
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    cse_p1_t1_g45393 = (c2x * v1x);
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    cse_p1_t2_g45394 = (c2y * v1y);
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    cse_p1_t3_g45395 = (c2z * v1z);
    cse_p1_t9_g45401 = (cse_p1_t1_g45393 + cse_p1_t2_g45394 + cse_p1_t3_g45395);
    c1_sq = ((c1x * c1x) + (c1y * c1y) + (c1z * c1z));
    c2_sq = ((c2x * c2x) + (c2y * c2y) + (c2z * c2z));
    v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
    cse_p1_t32_g45424 = (1.0 / sqrt(v2_sq));
    v2_len = sqrt(v2_sq);
    dot12 = ((v1x * v2x) + (v1y * v2y) + (v1z * v2z));
    dot23 = ((v2x * v3x) + (v2y * v3y) + (v2z * v3z));
    t1 = (cse_p1_t9_g45401 * v2_len);
    cse_p1_t19_g45411 = (-(t1));
    cse_p1_t30_g45422 = ((t1) * (t1));
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    cse_p1_t14_g45406 = (cse_p1_t30_g45422 + ((t2) * (t2)));
    cse_p1_t29_g45421 = (1.0 / (cse_p1_t14_g45406));
    cse_p1_t31_g45423 = ((t2) * (t2));
    phi = atan2(t1, t2);
    nphi = (n * phi);
    cse_p1_t1_g45428 = (cosphase * (-(sin(nphi))));
    cse_p1_t1_g45429 = (sinphase * cos(nphi));
    cse_p1_t10_g45402 = (cse_p1_t1_g45428 + cse_p1_t1_g45429);
    cse_p1_t18_g45410 = (-(sin(nphi)));
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
    cse_p1_t1_g45425 = (cse_p1_t10_g45402 * cse_p1_t29_g45421 * n * v);
    cse_p1_t1_g45427 = (t2 * v2_len);
    g_x1 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c2y * v2z) + (c2z * cse_p1_t24_g45416))) + (cse_p1_t1_g45427 * (-(c2x)))));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c2x * cse_p1_t25_g45417) + (c2z * v2x))) + (cse_p1_t1_g45427 * (-(c2y)))));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c2x * v2y) + (c2y * cse_p1_t23_g45415))) + (cse_p1_t1_g45427 * (-(c2z)))));
    KernelGradientAcc(i3x1, 2, g_z1);
    cse_p1_t1_g45426 = (cse_p1_t32_g45424 * cse_p1_t9_g45401);
    g_x2 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1y * v3z) + (c1z * cse_p1_t27_g45419) + (c2y * (cse_p1_t22_g45414 + cse_p1_t25_g45417)) + (c2z * (v1y + v2y)))) + (t2 * ((cse_p1_t1_g45426 * cse_p1_t23_g45415) + (v2_len * (c2x + (cse_p1_t27_g45419 * v1z) + (v1y * v3z)))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1x * cse_p1_t28_g45420) + (c1z * v3x) + (c2x * (v1z + v2z)) + (c2z * (cse_p1_t20_g45412 + cse_p1_t23_g45415)))) + (t2 * ((cse_p1_t1_g45426 * cse_p1_t24_g45416) + (v2_len * (c2y + (cse_p1_t28_g45420 * v1x) + (v1z * v3x)))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1x * v3y) + (c1y * cse_p1_t26_g45418) + (c2x * (cse_p1_t21_g45413 + cse_p1_t24_g45416)) + (c2y * (v1x + v2x)))) + (t2 * ((cse_p1_t1_g45426 * cse_p1_t25_g45417) + (v2_len * (c2z + (cse_p1_t26_g45418 * v1y) + (v1x * v3y)))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    g_x3 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1y * cse_p1_t13_g45405) + (c1z * cse_p1_t16_g45408) + (c2y * v1z) + (c2z * cse_p1_t21_g45413))) + (t2 * ((cse_p1_t1_g45426 * v2x) + (v2_len * ((cse_p1_t13_g45405 * v1y) + (cse_p1_t16_g45408 * v1z)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1x * cse_p1_t17_g45409) + (c1z * cse_p1_t11_g45403) + (c2x * cse_p1_t22_g45414) + (c2z * v1x))) + (t2 * ((cse_p1_t1_g45426 * v2y) + (v2_len * ((cse_p1_t11_g45403 * v1z) + (cse_p1_t17_g45409 * v1x)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1x * cse_p1_t12_g45404) + (c1y * cse_p1_t15_g45407) + (c2x * v1y) + (c2y * cse_p1_t20_g45412))) + (t2 * ((cse_p1_t1_g45426 * v2z) + (v2_len * ((cse_p1_t12_g45404 * v1x) + (cse_p1_t15_g45407 * v1y)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    g_x4 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1y * v2z) + (c1z * cse_p1_t24_g45416))) + (cse_p1_t1_g45427 * (cse_p1_t7_g45399 + (cse_p1_t24_g45416 * v1z)))));
    KernelGradientAcc(i3x4, 0, g_x4);
    g_y4 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1x * cse_p1_t25_g45417) + (c1z * v2x))) + (cse_p1_t1_g45427 * (cse_p1_t8_g45400 + (cse_p1_t25_g45417 * v1x)))));
    KernelGradientAcc(i3x4, 1, g_y4);
    g_z4 = (cse_p1_t1_g45425 * ((cse_p1_t19_g45411 * ((c1x * v2y) + (c1y * cse_p1_t23_g45415))) + (cse_p1_t1_g45427 * (cse_p1_t6_g45398 + (cse_p1_t23_g45415 * v1y)))));
    KernelGradientAcc(i3x4, 2, g_z4);
  }
  return energy;
}
void gradient_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
}

double hessian(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c1_sq;
  double c2x;
  double c2y;
  double c2z;
  double c2_sq;
  double cos_angle;
  double cos_nphi;
  double cse_p1030_t1_g45885;
  double cse_p1_t10_g45479;
  double cse_p1_t15_g45484;
  double cse_p1_t16_g45485;
  double cse_p1_t17_g45486;
  double cse_p1_t18_g45487;
  double cse_p1_t19_g45488;
  double cse_p1_t1_g45470;
  double cse_p1_t1_g45502;
  double cse_p1_t1_g45505;
  double cse_p1_t1_g45506;
  double cse_p1_t20_g45489;
  double cse_p1_t21_g45490;
  double cse_p1_t22_g45491;
  double cse_p1_t23_g45492;
  double cse_p1_t24_g45493;
  double cse_p1_t25_g45494;
  double cse_p1_t26_g45495;
  double cse_p1_t27_g45496;
  double cse_p1_t28_g45497;
  double cse_p1_t29_g45498;
  double cse_p1_t2_g45471;
  double cse_p1_t30_g45499;
  double cse_p1_t31_g45500;
  double cse_p1_t8_g45477;
  double cse_p511_t100_g45626;
  double cse_p511_t101_g45627;
  double cse_p511_t102_g45628;
  double cse_p511_t103_g45629;
  double cse_p511_t104_g45630;
  double cse_p511_t105_g45631;
  double cse_p511_t106_g45632;
  double cse_p511_t107_g45633;
  double cse_p511_t108_g45634;
  double cse_p511_t109_g45635;
  double cse_p511_t10_g45536;
  double cse_p511_t110_g45636;
  double cse_p511_t111_g45637;
  double cse_p511_t112_g45638;
  double cse_p511_t113_g45639;
  double cse_p511_t114_g45640;
  double cse_p511_t115_g45641;
  double cse_p511_t116_g45642;
  double cse_p511_t117_g45643;
  double cse_p511_t118_g45644;
  double cse_p511_t119_g45645;
  double cse_p511_t11_g45537;
  double cse_p511_t120_g45646;
  double cse_p511_t121_g45647;
  double cse_p511_t122_g45648;
  double cse_p511_t123_g45649;
  double cse_p511_t124_g45650;
  double cse_p511_t125_g45651;
  double cse_p511_t126_g45652;
  double cse_p511_t127_g45653;
  double cse_p511_t128_g45654;
  double cse_p511_t129_g45655;
  double cse_p511_t12_g45538;
  double cse_p511_t130_g45656;
  double cse_p511_t131_g45657;
  double cse_p511_t132_g45658;
  double cse_p511_t133_g45659;
  double cse_p511_t134_g45660;
  double cse_p511_t135_g45661;
  double cse_p511_t136_g45662;
  double cse_p511_t137_g45663;
  double cse_p511_t138_g45664;
  double cse_p511_t139_g45665;
  double cse_p511_t13_g45539;
  double cse_p511_t140_g45666;
  double cse_p511_t141_g45667;
  double cse_p511_t142_g45668;
  double cse_p511_t143_g45669;
  double cse_p511_t144_g45670;
  double cse_p511_t145_g45671;
  double cse_p511_t147_g45673;
  double cse_p511_t148_g45674;
  double cse_p511_t149_g45675;
  double cse_p511_t14_g45540;
  double cse_p511_t150_g45676;
  double cse_p511_t151_g45677;
  double cse_p511_t152_g45678;
  double cse_p511_t154_g45680;
  double cse_p511_t157_g45683;
  double cse_p511_t158_g45684;
  double cse_p511_t15_g45541;
  double cse_p511_t160_g45686;
  double cse_p511_t164_g45690;
  double cse_p511_t165_g45691;
  double cse_p511_t166_g45692;
  double cse_p511_t167_g45693;
  double cse_p511_t168_g45694;
  double cse_p511_t169_g45695;
  double cse_p511_t16_g45542;
  double cse_p511_t170_g45696;
  double cse_p511_t171_g45697;
  double cse_p511_t172_g45698;
  double cse_p511_t173_g45699;
  double cse_p511_t174_g45700;
  double cse_p511_t175_g45701;
  double cse_p511_t176_g45702;
  double cse_p511_t177_g45703;
  double cse_p511_t178_g45704;
  double cse_p511_t179_g45705;
  double cse_p511_t17_g45543;
  double cse_p511_t180_g45706;
  double cse_p511_t181_g45707;
  double cse_p511_t182_g45708;
  double cse_p511_t183_g45709;
  double cse_p511_t184_g45710;
  double cse_p511_t185_g45711;
  double cse_p511_t186_g45712;
  double cse_p511_t187_g45713;
  double cse_p511_t188_g45714;
  double cse_p511_t189_g45715;
  double cse_p511_t18_g45544;
  double cse_p511_t190_g45716;
  double cse_p511_t191_g45717;
  double cse_p511_t192_g45718;
  double cse_p511_t193_g45719;
  double cse_p511_t194_g45720;
  double cse_p511_t195_g45721;
  double cse_p511_t196_g45722;
  double cse_p511_t197_g45723;
  double cse_p511_t198_g45724;
  double cse_p511_t199_g45725;
  double cse_p511_t19_g45545;
  double cse_p511_t1_g45527;
  double cse_p511_t200_g45726;
  double cse_p511_t201_g45727;
  double cse_p511_t202_g45728;
  double cse_p511_t203_g45729;
  double cse_p511_t204_g45730;
  double cse_p511_t205_g45731;
  double cse_p511_t206_g45732;
  double cse_p511_t207_g45733;
  double cse_p511_t208_g45734;
  double cse_p511_t209_g45735;
  double cse_p511_t20_g45546;
  double cse_p511_t210_g45736;
  double cse_p511_t211_g45737;
  double cse_p511_t212_g45738;
  double cse_p511_t213_g45739;
  double cse_p511_t214_g45740;
  double cse_p511_t215_g45741;
  double cse_p511_t216_g45742;
  double cse_p511_t217_g45743;
  double cse_p511_t218_g45744;
  double cse_p511_t219_g45745;
  double cse_p511_t220_g45746;
  double cse_p511_t221_g45747;
  double cse_p511_t222_g45748;
  double cse_p511_t223_g45749;
  double cse_p511_t224_g45750;
  double cse_p511_t225_g45751;
  double cse_p511_t226_g45752;
  double cse_p511_t227_g45753;
  double cse_p511_t228_g45754;
  double cse_p511_t229_g45755;
  double cse_p511_t22_g45548;
  double cse_p511_t230_g45756;
  double cse_p511_t231_g45757;
  double cse_p511_t232_g45758;
  double cse_p511_t233_g45759;
  double cse_p511_t234_g45760;
  double cse_p511_t235_g45761;
  double cse_p511_t236_g45762;
  double cse_p511_t237_g45763;
  double cse_p511_t238_g45764;
  double cse_p511_t239_g45765;
  double cse_p511_t23_g45549;
  double cse_p511_t240_g45766;
  double cse_p511_t241_g45767;
  double cse_p511_t242_g45768;
  double cse_p511_t243_g45769;
  double cse_p511_t244_g45770;
  double cse_p511_t245_g45771;
  double cse_p511_t246_g45772;
  double cse_p511_t247_g45773;
  double cse_p511_t248_g45774;
  double cse_p511_t249_g45775;
  double cse_p511_t24_g45550;
  double cse_p511_t250_g45776;
  double cse_p511_t251_g45777;
  double cse_p511_t252_g45778;
  double cse_p511_t253_g45779;
  double cse_p511_t254_g45780;
  double cse_p511_t255_g45781;
  double cse_p511_t256_g45782;
  double cse_p511_t257_g45783;
  double cse_p511_t258_g45784;
  double cse_p511_t259_g45785;
  double cse_p511_t25_g45551;
  double cse_p511_t260_g45786;
  double cse_p511_t261_g45787;
  double cse_p511_t262_g45788;
  double cse_p511_t26_g45552;
  double cse_p511_t27_g45553;
  double cse_p511_t28_g45554;
  double cse_p511_t29_g45555;
  double cse_p511_t2_g45528;
  double cse_p511_t30_g45556;
  double cse_p511_t31_g45557;
  double cse_p511_t32_g45558;
  double cse_p511_t33_g45559;
  double cse_p511_t3_g45529;
  double cse_p511_t43_g45569;
  double cse_p511_t44_g45570;
  double cse_p511_t4_g45530;
  double cse_p511_t56_g45582;
  double cse_p511_t57_g45583;
  double cse_p511_t58_g45584;
  double cse_p511_t59_g45585;
  double cse_p511_t5_g45531;
  double cse_p511_t60_g45586;
  double cse_p511_t61_g45587;
  double cse_p511_t62_g45588;
  double cse_p511_t63_g45589;
  double cse_p511_t64_g45590;
  double cse_p511_t65_g45591;
  double cse_p511_t66_g45592;
  double cse_p511_t67_g45593;
  double cse_p511_t68_g45594;
  double cse_p511_t69_g45595;
  double cse_p511_t6_g45532;
  double cse_p511_t70_g45596;
  double cse_p511_t71_g45597;
  double cse_p511_t72_g45598;
  double cse_p511_t73_g45599;
  double cse_p511_t74_g45600;
  double cse_p511_t75_g45601;
  double cse_p511_t76_g45602;
  double cse_p511_t77_g45603;
  double cse_p511_t78_g45604;
  double cse_p511_t79_g45605;
  double cse_p511_t7_g45533;
  double cse_p511_t80_g45606;
  double cse_p511_t81_g45607;
  double cse_p511_t82_g45608;
  double cse_p511_t83_g45609;
  double cse_p511_t84_g45610;
  double cse_p511_t85_g45611;
  double cse_p511_t86_g45612;
  double cse_p511_t87_g45613;
  double cse_p511_t88_g45614;
  double cse_p511_t89_g45615;
  double cse_p511_t8_g45534;
  double cse_p511_t90_g45616;
  double cse_p511_t91_g45617;
  double cse_p511_t92_g45618;
  double cse_p511_t93_g45619;
  double cse_p511_t94_g45620;
  double cse_p511_t95_g45621;
  double cse_p511_t96_g45622;
  double cse_p511_t97_g45623;
  double cse_p511_t98_g45624;
  double cse_p511_t99_g45625;
  double cse_p511_t9_g45535;
  double cse_p513_t1_g45792;
  double cse_p513_t1_g45793;
  double cse_p513_t1_g45794;
  double cse_p513_t1_g45796;
  double cse_p513_t1_g45797;
  double cse_p513_t1_g45798;
  double cse_p513_t1_g45799;
  double cse_p513_t1_g45801;
  double cse_p514_t1_g45802;
  double cse_p514_t1_g45803;
  double cse_p514_t1_g45804;
  double cse_p514_t1_g45805;
  double cse_p514_t1_g45806;
  double cse_p514_t1_g45807;
  double cse_p514_t1_g45808;
  double cse_p514_t1_g45809;
  double cse_p514_t1_g45810;
  double cse_p514_t1_g45811;
  double cse_p515_t1_g45812;
  double cse_p515_t1_g45813;
  double cse_p515_t1_g45814;
  double cse_p515_t1_g45816;
  double cse_p515_t1_g45817;
  double cse_p515_t1_g45818;
  double cse_p515_t1_g45819;
  double cse_p515_t1_g45820;
  double cse_p515_t1_g45821;
  double cse_p516_t1_g45822;
  double cse_p516_t1_g45823;
  double cse_p516_t1_g45824;
  double cse_p516_t1_g45825;
  double cse_p516_t1_g45826;
  double cse_p516_t1_g45827;
  double cse_p516_t1_g45828;
  double cse_p516_t1_g45829;
  double cse_p516_t1_g45830;
  double cse_p516_t1_g45831;
  double cse_p517_t1_g45832;
  double cse_p517_t1_g45833;
  double cse_p517_t1_g45834;
  double cse_p517_t1_g45835;
  double cse_p517_t1_g45836;
  double cse_p517_t1_g45837;
  double cse_p517_t1_g45838;
  double cse_p517_t1_g45839;
  double cse_p517_t1_g45840;
  double cse_p517_t1_g45841;
  double cse_p518_t1_g45842;
  double cse_p518_t1_g45843;
  double cse_p518_t1_g45844;
  double cse_p518_t1_g45845;
  double cse_p518_t1_g45846;
  double cse_p518_t1_g45847;
  double cse_p518_t1_g45848;
  double cse_p518_t1_g45849;
  double cse_p561_t1_sqrt45850;
  double cse_p561_t2_invsqrt45851;
  double cse_p561_t3_invr45852;
  double cse_p561_t4_invr45853;
  double cse_p562_t1_g45855;
  double cse_p563_t1_g45856;
  double cse_p563_t1_g45857;
  double cse_p563_t1_g45858;
  double cse_p563_t1_g45859;
  double cse_p563_t1_g45860;
  double cse_p563_t1_g45861;
  double cse_p563_t1_g45862;
  double cse_p614_t1_g45863;
  double cse_p615_t1_g45864;
  double cse_p615_t1_g45865;
  double cse_p615_t1_g45866;
  double cse_p615_t1_g45867;
  double cse_p615_t1_g45868;
  double cse_p615_t1_g45869;
  double cse_p615_t1_g45870;
  double cse_p615_t1_g45871;
  double cse_p615_t1_g45872;
  double cse_p615_t1_g45873;
  double cse_p666_t1_g45874;
  double cse_p718_t1_g45875;
  double cse_p770_t1_g45876;
  double cse_p823_t1_g45880;
  double cse_p823_t1_g45881;
  double cse_p874_t1_g45882;
  double cse_p926_t1_g45883;
  double cse_p978_t1_g45884;
  double dot12;
  double dot23;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_x4;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_y4;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x1_z4;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_x4;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_y4;
  double h_x2_z2;
  double h_x2_z3;
  double h_x2_z4;
  double h_x3_x3;
  double h_x3_x4;
  double h_x3_y3;
  double h_x3_y4;
  double h_x3_z3;
  double h_x3_z4;
  double h_x4_x4;
  double h_x4_y4;
  double h_x4_z4;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_x4;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_y4;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y1_z4;
  double h_y2_x3;
  double h_y2_x4;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_y4;
  double h_y2_z2;
  double h_y2_z3;
  double h_y2_z4;
  double h_y3_x4;
  double h_y3_y3;
  double h_y3_y4;
  double h_y3_z3;
  double h_y3_z4;
  double h_y4_y4;
  double h_y4_z4;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_x4;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_y4;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z1_z4;
  double h_z2_x3;
  double h_z2_x4;
  double h_z2_y3;
  double h_z2_y4;
  double h_z2_z2;
  double h_z2_z3;
  double h_z2_z4;
  double h_z3_x4;
  double h_z3_y4;
  double h_z3_z3;
  double h_z3_z4;
  double h_z4_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    cse_p511_t262_g45788 = (-(v));
    v1x = (x2 + (-(x1)));
    cse_p1_t20_g45489 = (-(v1x));
    v1y = (y2 + (-(y1)));
    cse_p1_t21_g45490 = (-(v1y));
    v1z = (z2 + (-(z1)));
    cse_p1_t22_g45491 = (-(v1z));
    v2x = (x3 + (-(x2)));
    cse_p511_t120_g45646 = (v1x * v2x);
    cse_p511_t124_g45650 = (v1y * (-(v2x)));
    cse_p511_t137_g45663 = (v2x * v2x);
    cse_p511_t214_g45740 = (cse_p1_t20_g45489 + (-(v2x)));
    cse_p511_t224_g45750 = (v1x + v2x);
    cse_p1_t8_g45477 = (v1z * v2x);
    cse_p1_t23_g45492 = (-(v2x));
    v2y = (y3 + (-(y2)));
    cse_p978_t1_g45884 = (v1x * v2y);
    cse_p666_t1_g45874 = (v2y * v2y);
    cse_p511_t126_g45652 = (v1y * v2y);
    cse_p511_t130_g45656 = (v1z * (-(v2y)));
    cse_p511_t211_g45737 = (cse_p511_t124_g45650 + cse_p978_t1_g45884);
    cse_p511_t215_g45741 = (cse_p1_t21_g45490 + (-(v2y)));
    cse_p511_t225_g45751 = (v1y + v2y);
    cse_p1_t24_g45493 = (-(v2y));
    v2z = (z3 + (-(z2)));
    cse_p1030_t1_g45885 = (v1y * v2z);
    cse_p718_t1_g45875 = (v2z * v2z);
    cse_p511_t118_g45644 = (v1x * (-(v2z)));
    cse_p511_t132_g45658 = (v1z * v2z);
    cse_p511_t210_g45736 = (cse_p1_t8_g45477 + cse_p511_t118_g45644);
    cse_p511_t213_g45739 = (cse_p1030_t1_g45885 + cse_p511_t130_g45656);
    cse_p511_t216_g45742 = (cse_p1_t22_g45491 + (-(v2z)));
    cse_p511_t226_g45752 = (v1z + v2z);
    cse_p1_t25_g45494 = (-(v2z));
    v3x = (x4 + (-(x3)));
    cse_p511_t28_g45554 = (cse_p511_t224_g45750 * (-(v3x)));
    cse_p511_t31_g45557 = (cse_p1_t20_g45489 * (v2x + v3x));
    cse_p511_t123_g45649 = (v1y * (v2x + v3x));
    cse_p511_t125_g45651 = (v1y * (-(v3x)));
    cse_p511_t128_g45654 = (v1z * (cse_p1_t23_g45492 + (-(v3x))));
    cse_p511_t133_g45659 = (v1z * v3x);
    cse_p511_t142_g45668 = (v2x * v3x);
    cse_p511_t217_g45743 = (cse_p1_t23_g45492 + (-(v3x)));
    cse_p1_t15_g45484 = (v2x + v3x);
    cse_p1_t26_g45495 = (-(v3x));
    v3y = (y4 + (-(y3)));
    cse_p511_t29_g45555 = (cse_p511_t225_g45751 * (-(v3y)));
    cse_p511_t32_g45558 = (cse_p1_t21_g45490 * (v2y + v3y));
    cse_p511_t116_g45642 = (v1x * (cse_p1_t24_g45493 + (-(v3y))));
    cse_p511_t121_g45647 = (v1x * v3y);
    cse_p511_t129_g45655 = (v1z * (v2y + v3y));
    cse_p511_t131_g45657 = (v1z * (-(v3y)));
    cse_p511_t149_g45675 = (v2y * v3y);
    cse_p511_t208_g45734 = (cse_p511_t116_g45642 + cse_p511_t123_g45649);
    cse_p511_t218_g45744 = (cse_p1_t24_g45493 + (-(v3y)));
    cse_p1_t16_g45485 = (v2y + v3y);
    cse_p1_t27_g45496 = (-(v3y));
    v3z = (z4 + (-(z3)));
    cse_p511_t30_g45556 = (cse_p511_t226_g45752 * (-(v3z)));
    cse_p511_t33_g45559 = (cse_p1_t22_g45491 * (v2z + v3z));
    cse_p511_t117_g45643 = (v1x * (v2z + v3z));
    cse_p511_t119_g45645 = (v1x * (-(v3z)));
    cse_p511_t122_g45648 = (v1y * (cse_p1_t25_g45494 + (-(v3z))));
    cse_p511_t127_g45653 = (v1y * v3z);
    cse_p511_t154_g45680 = (v2z * v3z);
    cse_p511_t209_g45735 = (cse_p511_t117_g45643 + cse_p511_t128_g45654);
    cse_p511_t212_g45738 = (cse_p511_t122_g45648 + cse_p511_t129_g45655);
    cse_p511_t219_g45745 = (cse_p1_t25_g45494 + (-(v3z)));
    cse_p1_t17_g45486 = (v2z + v3z);
    cse_p1_t28_g45497 = (-(v3z));
    c1x = (cse_p1030_t1_g45885 + (-((v1z * v2y))));
    cse_p511_t56_g45582 = (c1x * cse_p511_t218_g45744);
    cse_p511_t57_g45583 = (c1x * cse_p1_t17_g45486);
    cse_p511_t58_g45584 = (c1x * cse_p1_t25_g45494);
    cse_p511_t59_g45585 = (c1x * cse_p1_t28_g45497);
    cse_p511_t60_g45586 = (c1x * v2y);
    cse_p511_t61_g45587 = (c1x * v3y);
    cse_p511_t256_g45782 = (-(c1x));
    c1y = (cse_p1_t8_g45477 + (-((v1x * v2z))));
    cse_p511_t62_g45588 = (c1y * cse_p511_t219_g45745);
    cse_p511_t63_g45589 = (c1y * cse_p1_t15_g45484);
    cse_p511_t64_g45590 = (c1y * cse_p1_t23_g45492);
    cse_p511_t65_g45591 = (c1y * cse_p1_t26_g45495);
    cse_p511_t66_g45592 = (c1y * v2z);
    cse_p511_t67_g45593 = (c1y * v3z);
    cse_p511_t199_g45725 = (cse_p511_t60_g45586 + cse_p511_t64_g45590);
    cse_p511_t257_g45783 = (-(c1y));
    c1z = (cse_p978_t1_g45884 + (-((v1y * v2x))));
    cse_p511_t68_g45594 = (c1z * cse_p511_t217_g45743);
    cse_p511_t69_g45595 = (c1z * cse_p1_t16_g45485);
    cse_p511_t70_g45596 = (c1z * cse_p1_t24_g45493);
    cse_p511_t71_g45597 = (c1z * cse_p1_t27_g45496);
    cse_p511_t72_g45598 = (c1z * v2x);
    cse_p511_t73_g45599 = (c1z * v3x);
    cse_p511_t197_g45723 = (cse_p511_t58_g45584 + cse_p511_t72_g45598);
    cse_p511_t202_g45728 = (cse_p511_t66_g45592 + cse_p511_t70_g45596);
    cse_p511_t258_g45784 = (-(c1z));
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    cse_p511_t74_g45600 = (c2x * cse_p511_t215_g45741);
    cse_p511_t75_g45601 = (c2x * cse_p511_t226_g45752);
    cse_p511_t76_g45602 = (c2x * cse_p1_t22_g45491);
    cse_p511_t77_g45603 = (c2x * cse_p1_t25_g45494);
    cse_p511_t78_g45604 = (c2x * v1y);
    cse_p511_t79_g45605 = (c2x * v2y);
    cse_p511_t221_g45747 = (c2x + cse_p511_t127_g45653 + cse_p511_t131_g45657);
    cse_p511_t259_g45785 = (-(c2x));
    cse_p1_t1_g45470 = (c2x * v1x);
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    cse_p511_t80_g45606 = (c2y * cse_p511_t216_g45742);
    cse_p511_t81_g45607 = (c2y * cse_p511_t224_g45750);
    cse_p511_t82_g45608 = (c2y * cse_p1_t20_g45489);
    cse_p511_t83_g45609 = (c2y * cse_p1_t23_g45492);
    cse_p511_t84_g45610 = (c2y * v1z);
    cse_p511_t85_g45611 = (c2y * v2z);
    cse_p511_t195_g45721 = (cse_p511_t56_g45582 + cse_p511_t63_g45589 + cse_p511_t78_g45604 + cse_p511_t82_g45608);
    cse_p511_t200_g45726 = (cse_p511_t61_g45587 + cse_p511_t65_g45591 + cse_p511_t74_g45600 + cse_p511_t81_g45607);
    cse_p511_t206_g45732 = (cse_p511_t79_g45605 + cse_p511_t83_g45609);
    cse_p511_t222_g45748 = (c2y + cse_p511_t119_g45645 + cse_p511_t133_g45659);
    cse_p511_t260_g45786 = (-(c2y));
    cse_p1_t2_g45471 = (c2y * v1y);
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    cse_p770_t1_g45876 = (c2z * v1z);
    cse_p511_t86_g45612 = (c2z * cse_p511_t214_g45740);
    cse_p511_t87_g45613 = (c2z * cse_p511_t225_g45751);
    cse_p511_t88_g45614 = (c2z * cse_p1_t21_g45490);
    cse_p511_t89_g45615 = (c2z * cse_p1_t24_g45493);
    cse_p511_t90_g45616 = (c2z * v1x);
    cse_p511_t91_g45617 = (c2z * v2x);
    cse_p511_t196_g45722 = (cse_p511_t57_g45583 + cse_p511_t68_g45594 + cse_p511_t76_g45602 + cse_p511_t90_g45616);
    cse_p511_t198_g45724 = (cse_p511_t59_g45585 + cse_p511_t73_g45599 + cse_p511_t75_g45601 + cse_p511_t86_g45612);
    cse_p511_t201_g45727 = (cse_p511_t62_g45588 + cse_p511_t69_g45595 + cse_p511_t84_g45610 + cse_p511_t88_g45614);
    cse_p511_t203_g45729 = (cse_p511_t67_g45593 + cse_p511_t71_g45597 + cse_p511_t80_g45606 + cse_p511_t87_g45613);
    cse_p511_t204_g45730 = (cse_p511_t77_g45603 + cse_p511_t91_g45617);
    cse_p511_t205_g45731 = (cse_p1_t1_g45470 + cse_p1_t2_g45471 + cse_p770_t1_g45876);
    cse_p511_t207_g45733 = (cse_p511_t85_g45611 + cse_p511_t89_g45615);
    cse_p511_t223_g45749 = (c2z + cse_p511_t121_g45647 + cse_p511_t125_g45651);
    cse_p511_t261_g45787 = (-(c2z));
    c1_sq = ((c1x * c1x) + (c1y * c1y) + (c1z * c1z));
    c2_sq = ((c2x * c2x) + (c2y * c2y) + (c2z * c2z));
    v2_sq = (cse_p511_t137_g45663 + cse_p666_t1_g45874 + cse_p718_t1_g45875);
    cse_p561_t1_sqrt45850 = sqrt(v2_sq);
    cse_p561_t2_invsqrt45851 = (1.0 / (cse_p561_t1_sqrt45850));
    cse_p561_t3_invr45852 = (cse_p561_t2_invsqrt45851 * cse_p561_t2_invsqrt45851);
    cse_p614_t1_g45863 = (cse_p511_t205_g45731 * cse_p561_t3_invr45852);
    cse_p513_t1_g45792 = (cse_p511_t205_g45731 * cse_p561_t2_invsqrt45851);
    cse_p511_t18_g45544 = (cse_p1_t23_g45492 * cse_p513_t1_g45792);
    cse_p511_t19_g45545 = (cse_p1_t24_g45493 * cse_p513_t1_g45792);
    cse_p511_t20_g45546 = (cse_p1_t25_g45494 * cse_p513_t1_g45792);
    cse_p511_t134_g45660 = (cse_p513_t1_g45792 * v2x);
    cse_p516_t1_g45831 = (cse_p561_t2_invsqrt45851 * cse_p614_t1_g45863);
    cse_p615_t1_g45872 = (cse_p516_t1_g45831 * v2x);
    cse_p511_t136_g45662 = (cse_p615_t1_g45872 * v2x);
    cse_p511_t138_g45664 = (cse_p615_t1_g45872 * v2y);
    cse_p615_t1_g45873 = (cse_p614_t1_g45863 * v2x);
    cse_p511_t139_g45665 = (cse_p615_t1_g45873 * v2y);
    cse_p511_t140_g45666 = (cse_p615_t1_g45872 * v2z);
    cse_p511_t141_g45667 = (cse_p615_t1_g45873 * v2z);
    cse_p511_t143_g45669 = (cse_p513_t1_g45792 * v2y);
    cse_p511_t145_g45671 = (cse_p516_t1_g45831 * cse_p666_t1_g45874);
    cse_p511_t147_g45673 = (cse_p516_t1_g45831 * v2y * v2z);
    cse_p511_t148_g45674 = (cse_p614_t1_g45863 * v2y * v2z);
    cse_p511_t150_g45676 = (cse_p513_t1_g45792 * v2z);
    cse_p511_t152_g45678 = (cse_p516_t1_g45831 * cse_p718_t1_g45875);
    cse_p511_t238_g45764 = (-(cse_p513_t1_g45792));
    cse_p511_t239_g45765 = (-(cse_p511_t136_g45662));
    cse_p511_t240_g45766 = (-(cse_p511_t138_g45664));
    cse_p511_t241_g45767 = (-(cse_p511_t140_g45666));
    cse_p511_t242_g45768 = (-(cse_p511_t145_g45671));
    cse_p511_t243_g45769 = (-(cse_p511_t147_g45673));
    cse_p511_t244_g45770 = (-(cse_p511_t152_g45678));
    cse_p513_t1_g45801 = (cse_p511_t208_g45734 * cse_p561_t1_sqrt45850);
    cse_p514_t1_g45802 = (cse_p511_t209_g45735 * cse_p561_t1_sqrt45850);
    cse_p511_t157_g45683 = (cse_p511_t210_g45736 * cse_p561_t1_sqrt45850);
    cse_p511_t158_g45684 = (cse_p511_t211_g45737 * cse_p561_t1_sqrt45850);
    cse_p514_t1_g45803 = (cse_p511_t212_g45738 * cse_p561_t1_sqrt45850);
    cse_p511_t160_g45686 = (cse_p511_t213_g45739 * cse_p561_t1_sqrt45850);
    cse_p514_t1_g45811 = (cse_p511_t221_g45747 * cse_p561_t1_sqrt45850);
    cse_p515_t1_g45812 = (cse_p511_t222_g45748 * cse_p561_t1_sqrt45850);
    cse_p515_t1_g45813 = (cse_p511_t223_g45749 * cse_p561_t1_sqrt45850);
    cse_p511_t164_g45690 = (cse_p511_t260_g45786 * cse_p561_t1_sqrt45850);
    cse_p511_t165_g45691 = (cse_p511_t261_g45787 * cse_p561_t1_sqrt45850);
    cse_p511_t172_g45698 = (cse_p511_t18_g45544 + cse_p514_t1_g45811);
    cse_p511_t173_g45699 = (cse_p511_t19_g45545 + cse_p515_t1_g45812);
    cse_p511_t174_g45700 = (cse_p511_t20_g45546 + cse_p515_t1_g45813);
    cse_p511_t190_g45716 = (cse_p511_t134_g45660 + cse_p514_t1_g45803);
    cse_p511_t191_g45717 = (cse_p511_t143_g45669 + cse_p514_t1_g45802);
    cse_p511_t192_g45718 = (cse_p511_t150_g45676 + cse_p513_t1_g45801);
    cse_p511_t245_g45771 = (-(cse_p511_t157_g45683));
    cse_p511_t246_g45772 = (-(cse_p511_t158_g45684));
    cse_p511_t247_g45773 = (-(cse_p511_t160_g45686));
    cse_p511_t248_g45774 = (-(cse_p511_t172_g45698));
    cse_p511_t249_g45775 = (-(cse_p511_t173_g45699));
    cse_p511_t250_g45776 = (-(cse_p511_t174_g45700));
    cse_p511_t251_g45777 = (-(cse_p511_t190_g45716));
    cse_p511_t252_g45778 = (-(cse_p511_t191_g45717));
    cse_p511_t253_g45779 = (-(cse_p511_t192_g45718));
    cse_p511_t254_g45780 = (-(cse_p511_t164_g45690));
    cse_p511_t255_g45781 = (-(cse_p511_t165_g45691));
    dot12 = (cse_p511_t120_g45646 + cse_p511_t126_g45652 + cse_p511_t132_g45658);
    dot23 = (cse_p511_t142_g45668 + cse_p511_t149_g45675 + cse_p511_t154_g45680);
    t1 = (cse_p511_t205_g45731 * cse_p561_t1_sqrt45850);
    cse_p511_t12_g45538 = (cse_p511_t195_g45721 * (-(t1)));
    cse_p511_t13_g45539 = (cse_p511_t196_g45722 * (-(t1)));
    cse_p511_t14_g45540 = (cse_p511_t198_g45724 * (-(t1)));
    cse_p511_t15_g45541 = (cse_p511_t200_g45726 * (-(t1)));
    cse_p511_t16_g45542 = (cse_p511_t201_g45727 * (-(t1)));
    cse_p511_t17_g45543 = (cse_p511_t203_g45729 * (-(t1)));
    cse_p511_t22_g45548 = (cse_p511_t197_g45723 * (-(t1)));
    cse_p511_t23_g45549 = (cse_p511_t199_g45725 * (-(t1)));
    cse_p511_t24_g45550 = (cse_p511_t202_g45728 * (-(t1)));
    cse_p511_t25_g45551 = (cse_p511_t204_g45730 * (-(t1)));
    cse_p511_t26_g45552 = (cse_p511_t206_g45732 * (-(t1)));
    cse_p511_t27_g45553 = (cse_p511_t207_g45733 * (-(t1)));
    cse_p513_t1_g45798 = (2.0000000000000000     * t1);
    cse_p518_t1_g45845 = (cse_p511_t172_g45698 * cse_p513_t1_g45798);
    cse_p518_t1_g45846 = (cse_p511_t173_g45699 * cse_p513_t1_g45798);
    cse_p518_t1_g45847 = (cse_p511_t174_g45700 * cse_p513_t1_g45798);
    cse_p563_t1_g45859 = (cse_p511_t190_g45716 * cse_p513_t1_g45798);
    cse_p563_t1_g45860 = (cse_p511_t191_g45717 * cse_p513_t1_g45798);
    cse_p563_t1_g45861 = (cse_p511_t192_g45718 * cse_p513_t1_g45798);
    cse_p515_t1_g45814 = (cse_p513_t1_g45798 * cse_p561_t1_sqrt45850);
    cse_p517_t1_g45840 = (cse_p511_t210_g45736 * cse_p515_t1_g45814);
    cse_p517_t1_g45841 = (cse_p511_t211_g45737 * cse_p515_t1_g45814);
    cse_p518_t1_g45842 = (cse_p511_t213_g45739 * cse_p515_t1_g45814);
    cse_p511_t43_g45569 = (cse_p511_t260_g45786 * cse_p515_t1_g45814);
    cse_p511_t44_g45570 = (cse_p511_t261_g45787 * cse_p515_t1_g45814);
    cse_p1_t19_g45488 = (-(t1));
    cse_p1_t30_g45499 = ((t1) * (t1));
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    cse_p562_t1_g45855 = (cse_p561_t1_sqrt45850 * t2);
    cse_p513_t1_g45799 = (2.0000000000000000     * t2);
    cse_p514_t1_g45810 = (cse_p511_t203_g45729 * cse_p513_t1_g45799);
    cse_p561_t4_invr45853 = (1.0 / ((cse_p1_t30_g45499 + ((t2) * (t2)))));
    cse_p926_t1_g45883 = (cse_p561_t4_invr45853 * t2);
    cse_p874_t1_g45882 = (cse_p561_t4_invr45853 * cse_p561_t4_invr45853);
    cse_p511_t1_g45527 = (cse_p874_t1_g45882 * (cse_p514_t1_g45810 + cse_p518_t1_g45845));
    cse_p514_t1_g45807 = (cse_p511_t198_g45724 * cse_p513_t1_g45799);
    cse_p511_t2_g45528 = (cse_p874_t1_g45882 * (cse_p514_t1_g45807 + cse_p518_t1_g45846));
    cse_p514_t1_g45808 = (cse_p511_t200_g45726 * cse_p513_t1_g45799);
    cse_p511_t3_g45529 = (cse_p874_t1_g45882 * (cse_p514_t1_g45808 + cse_p518_t1_g45847));
    cse_p514_t1_g45809 = (cse_p511_t201_g45727 * cse_p513_t1_g45799);
    cse_p511_t4_g45530 = (cse_p874_t1_g45882 * (cse_p514_t1_g45809 + cse_p563_t1_g45859));
    cse_p514_t1_g45806 = (cse_p511_t196_g45722 * cse_p513_t1_g45799);
    cse_p511_t5_g45531 = (cse_p874_t1_g45882 * (cse_p514_t1_g45806 + cse_p563_t1_g45860));
    cse_p514_t1_g45805 = (cse_p511_t195_g45721 * cse_p513_t1_g45799);
    cse_p511_t6_g45532 = (cse_p874_t1_g45882 * (cse_p514_t1_g45805 + cse_p563_t1_g45861));
    cse_p517_t1_g45835 = (cse_p511_t197_g45723 * cse_p513_t1_g45799);
    cse_p511_t7_g45533 = (cse_p874_t1_g45882 * (cse_p517_t1_g45835 + cse_p517_t1_g45840));
    cse_p517_t1_g45836 = (cse_p511_t199_g45725 * cse_p513_t1_g45799);
    cse_p511_t8_g45534 = (cse_p874_t1_g45882 * (cse_p517_t1_g45836 + cse_p517_t1_g45841));
    cse_p517_t1_g45837 = (cse_p511_t202_g45728 * cse_p513_t1_g45799);
    cse_p511_t9_g45535 = (cse_p874_t1_g45882 * (cse_p517_t1_g45837 + cse_p518_t1_g45842));
    cse_p517_t1_g45838 = (cse_p511_t204_g45730 * cse_p513_t1_g45799);
    cse_p511_t10_g45536 = (cse_p874_t1_g45882 * (cse_p511_t43_g45569 + cse_p517_t1_g45838));
    cse_p517_t1_g45839 = (cse_p511_t206_g45732 * cse_p513_t1_g45799);
    cse_p511_t11_g45537 = (cse_p874_t1_g45882 * (cse_p511_t44_g45570 + cse_p517_t1_g45839));
    cse_p511_t92_g45618 = (cse_p511_t172_g45698 * t2);
    cse_p511_t93_g45619 = (cse_p511_t173_g45699 * t2);
    cse_p511_t94_g45620 = (cse_p511_t174_g45700 * t2);
    cse_p511_t95_g45621 = (cse_p511_t190_g45716 * t2);
    cse_p511_t96_g45622 = (cse_p511_t191_g45717 * t2);
    cse_p511_t97_g45623 = (cse_p511_t192_g45718 * t2);
    cse_p513_t1_g45797 = (cse_p561_t2_invsqrt45851 * cse_p926_t1_g45883);
    cse_p615_t1_g45867 = (cse_p513_t1_g45797 * v2x);
    cse_p511_t98_g45624 = (cse_p511_t213_g45739 * cse_p615_t1_g45867);
    cse_p511_t99_g45625 = (cse_p511_t259_g45785 * cse_p615_t1_g45867);
    cse_p511_t100_g45626 = (cse_p511_t260_g45786 * cse_p615_t1_g45867);
    cse_p511_t101_g45627 = (cse_p511_t261_g45787 * cse_p615_t1_g45867);
    cse_p615_t1_g45868 = (cse_p513_t1_g45797 * v2y);
    cse_p511_t102_g45628 = (cse_p511_t210_g45736 * cse_p615_t1_g45868);
    cse_p511_t103_g45629 = (cse_p511_t259_g45785 * cse_p615_t1_g45868);
    cse_p511_t104_g45630 = (cse_p511_t260_g45786 * cse_p615_t1_g45868);
    cse_p511_t105_g45631 = (cse_p511_t261_g45787 * cse_p615_t1_g45868);
    cse_p615_t1_g45869 = (cse_p513_t1_g45797 * v2z);
    cse_p511_t106_g45632 = (cse_p511_t211_g45737 * cse_p615_t1_g45869);
    cse_p511_t107_g45633 = (cse_p511_t259_g45785 * cse_p615_t1_g45869);
    cse_p511_t108_g45634 = (cse_p511_t260_g45786 * cse_p615_t1_g45869);
    cse_p511_t109_g45635 = (cse_p511_t261_g45787 * cse_p615_t1_g45869);
    cse_p511_t110_g45636 = (cse_p511_t210_g45736 * cse_p562_t1_g45855);
    cse_p511_t111_g45637 = (cse_p511_t211_g45737 * cse_p562_t1_g45855);
    cse_p511_t112_g45638 = (cse_p511_t213_g45739 * cse_p562_t1_g45855);
    cse_p511_t113_g45639 = (cse_p511_t259_g45785 * cse_p562_t1_g45855);
    cse_p511_t114_g45640 = (cse_p511_t260_g45786 * cse_p562_t1_g45855);
    cse_p511_t115_g45641 = (cse_p511_t261_g45787 * cse_p562_t1_g45855);
    cse_p517_t1_g45832 = (cse_p1_t19_g45488 * cse_p561_t4_invr45853);
    cse_p511_t135_g45661 = (cse_p1_t24_g45493 * cse_p517_t1_g45832 * v2x);
    cse_p511_t144_g45670 = (cse_p1_t25_g45494 * cse_p517_t1_g45832 * v2y);
    cse_p511_t151_g45677 = (cse_p1_t23_g45492 * cse_p517_t1_g45832 * v2z);
    cse_p511_t166_g45692 = (cse_p511_t12_g45538 + cse_p511_t97_g45623);
    cse_p511_t167_g45693 = (cse_p511_t13_g45539 + cse_p511_t96_g45622);
    cse_p511_t168_g45694 = (cse_p511_t14_g45540 + cse_p511_t93_g45619);
    cse_p511_t169_g45695 = (cse_p511_t15_g45541 + cse_p511_t94_g45620);
    cse_p511_t170_g45696 = (cse_p511_t16_g45542 + cse_p511_t95_g45621);
    cse_p511_t171_g45697 = (cse_p511_t17_g45543 + cse_p511_t92_g45618);
    cse_p511_t175_g45701 = (cse_p511_t110_g45636 + cse_p511_t22_g45548);
    cse_p511_t176_g45702 = (cse_p511_t111_g45637 + cse_p511_t23_g45549);
    cse_p511_t177_g45703 = (cse_p511_t112_g45638 + cse_p511_t24_g45550);
    cse_p511_t178_g45704 = (cse_p511_t114_g45640 + cse_p511_t25_g45551);
    cse_p511_t179_g45705 = (cse_p511_t115_g45641 + cse_p511_t26_g45552);
    cse_p511_t180_g45706 = (cse_p511_t113_g45639 + cse_p511_t27_g45553);
    cse_p511_t181_g45707 = (cse_p514_t1_g45810 + cse_p518_t1_g45845);
    cse_p511_t182_g45708 = (cse_p514_t1_g45807 + cse_p518_t1_g45846);
    cse_p511_t183_g45709 = (cse_p514_t1_g45808 + cse_p518_t1_g45847);
    cse_p511_t184_g45710 = (cse_p514_t1_g45809 + cse_p563_t1_g45859);
    cse_p511_t185_g45711 = (cse_p514_t1_g45806 + cse_p563_t1_g45860);
    cse_p511_t186_g45712 = (cse_p514_t1_g45805 + cse_p563_t1_g45861);
    cse_p511_t187_g45713 = (cse_p517_t1_g45835 + cse_p517_t1_g45840);
    cse_p511_t188_g45714 = (cse_p517_t1_g45836 + cse_p517_t1_g45841);
    cse_p511_t189_g45715 = (cse_p517_t1_g45837 + cse_p518_t1_g45842);
    cse_p511_t193_g45719 = (cse_p511_t43_g45569 + cse_p517_t1_g45838);
    cse_p511_t194_g45720 = (cse_p511_t44_g45570 + cse_p517_t1_g45839);
    cse_p511_t220_g45746 = (cse_p1_t30_g45499 + ((t2) * (t2)));
    cse_p511_t227_g45753 = (-(cse_p511_t1_g45527));
    cse_p511_t228_g45754 = (-(cse_p511_t2_g45528));
    cse_p511_t229_g45755 = (-(cse_p511_t3_g45529));
    cse_p511_t230_g45756 = (-(cse_p511_t4_g45530));
    cse_p511_t231_g45757 = (-(cse_p511_t5_g45531));
    cse_p511_t232_g45758 = (-(cse_p511_t6_g45532));
    cse_p511_t233_g45759 = (-(cse_p511_t7_g45533));
    cse_p511_t234_g45760 = (-(cse_p511_t8_g45534));
    cse_p511_t235_g45761 = (-(cse_p511_t9_g45535));
    cse_p511_t236_g45762 = (-(cse_p511_t10_g45536));
    cse_p511_t237_g45763 = (-(cse_p511_t11_g45537));
    cse_p1_t29_g45498 = (1.0 / (cse_p511_t220_g45746));
    cse_p1_t31_g45500 = ((t2) * (t2));
    phi = atan2(t1, t2);
    nphi = (n * phi);
    cse_p1_t1_g45505 = (cosphase * (-(sin(nphi))));
    cse_p1_t1_g45506 = (sinphase * cos(nphi));
    cse_p1_t10_g45479 = (cse_p1_t1_g45505 + cse_p1_t1_g45506);
    cse_p1_t18_g45487 = (-(sin(nphi)));
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
    cse_p1_t1_g45502 = (cse_p1_t10_g45479 * cse_p1_t29_g45498 * n * v);
    g_x1 = (cse_p1_t1_g45502 * (cse_p511_t113_g45639 + (cse_p1_t19_g45488 * cse_p511_t207_g45733)));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (cse_p1_t1_g45502 * (cse_p511_t114_g45640 + (cse_p1_t19_g45488 * cse_p511_t204_g45730)));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (cse_p1_t1_g45502 * (cse_p511_t115_g45641 + (cse_p1_t19_g45488 * cse_p511_t206_g45732)));
    KernelGradientAcc(i3x1, 2, g_z1);
    g_x2 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * (cse_p511_t67_g45593 + cse_p511_t71_g45597 + cse_p511_t87_g45613 + (c2y * (cse_p1_t22_g45491 + cse_p1_t25_g45494)))) + (t2 * (cse_p511_t18_g45544 + (cse_p561_t1_sqrt45850 * (c2x + cse_p511_t127_g45653 + (cse_p1_t27_g45496 * v1z)))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * (cse_p511_t59_g45585 + cse_p511_t73_g45599 + cse_p511_t75_g45601 + (c2z * (cse_p1_t20_g45489 + cse_p1_t23_g45492)))) + (t2 * (cse_p511_t19_g45545 + (cse_p561_t1_sqrt45850 * (c2y + cse_p511_t133_g45659 + (cse_p1_t28_g45497 * v1x)))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * (cse_p511_t61_g45587 + cse_p511_t65_g45591 + cse_p511_t81_g45607 + (c2x * (cse_p1_t21_g45490 + cse_p1_t24_g45493)))) + (t2 * (cse_p511_t20_g45546 + (cse_p561_t1_sqrt45850 * (c2z + cse_p511_t121_g45647 + (cse_p1_t26_g45495 * v1y)))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    g_x3 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * cse_p511_t201_g45727) + (t2 * (cse_p511_t134_g45660 + (cse_p561_t1_sqrt45850 * ((cse_p1_t16_g45485 * v1z) + (cse_p511_t219_g45745 * v1y)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * cse_p511_t196_g45722) + (t2 * (cse_p511_t143_g45669 + (cse_p561_t1_sqrt45850 * ((cse_p1_t17_g45486 * v1x) + (cse_p511_t217_g45743 * v1z)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * cse_p511_t195_g45721) + (t2 * (cse_p511_t150_g45676 + (cse_p561_t1_sqrt45850 * ((cse_p1_t15_g45484 * v1y) + (cse_p511_t218_g45744 * v1x)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    g_x4 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * cse_p511_t202_g45728) + (cse_p562_t1_g45855 * (cse_p1030_t1_g45885 + (cse_p1_t24_g45493 * v1z)))));
    KernelGradientAcc(i3x4, 0, g_x4);
    g_y4 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * cse_p511_t197_g45723) + (cse_p562_t1_g45855 * (cse_p1_t8_g45477 + (cse_p1_t25_g45494 * v1x)))));
    KernelGradientAcc(i3x4, 1, g_y4);
    g_z4 = (cse_p1_t1_g45502 * ((cse_p1_t19_g45488 * cse_p511_t199_g45725) + (cse_p562_t1_g45855 * (cse_p978_t1_g45884 + (cse_p1_t23_g45492 * v1y)))));
    KernelGradientAcc(i3x4, 2, g_z4);
    cse_p513_t1_g45793 = (cos_angle * cse_p874_t1_g45882 * n);
    cse_p513_t1_g45794 = (cse_p511_t262_g45788 * n);
    cse_p513_t1_g45796 = (cse_p561_t1_sqrt45850 * cse_p561_t4_invr45853);
    cse_p515_t1_g45817 = (cse_p511_t207_g45733 * cse_p561_t4_invr45853);
    cse_p515_t1_g45818 = (cse_p511_t259_g45785 * cse_p513_t1_g45796);
    h_x1_x1 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p511_t180_g45706 * cse_p513_t1_g45793) + (sin_angle * ((cse_p511_t207_g45733 * cse_p515_t1_g45818) + (-((cse_p511_t180_g45706 * cse_p874_t1_g45882 * ((cse_p511_t207_g45733 * cse_p513_t1_g45799) + (cse_p511_t259_g45785 * cse_p515_t1_g45814))))) + (-((cse_p511_t259_g45785 * cse_p515_t1_g45817 * cse_p561_t1_sqrt45850)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
    cse_p615_t1_g45870 = (cse_p511_t178_g45704 * cse_p513_t1_g45793);
    h_x1_y1 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p615_t1_g45870) + (sin_angle * ((cse_p511_t180_g45706 * cse_p511_t236_g45762) + (cse_p511_t204_g45730 * cse_p515_t1_g45818) + (cse_p511_t254_g45780 * cse_p515_t1_g45817)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
    cse_p823_t1_g45880 = (cse_p511_t179_g45705 * cse_p513_t1_g45793);
    h_x1_z1 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p823_t1_g45880) + (sin_angle * ((cse_p511_t180_g45706 * cse_p511_t237_g45763) + (cse_p511_t206_g45732 * cse_p515_t1_g45818) + (cse_p511_t255_g45781 * cse_p515_t1_g45817)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
    cse_p518_t1_g45848 = (cse_p511_t171_g45697 * cse_p513_t1_g45793);
    h_x1_x2 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p518_t1_g45848) + (sin_angle * ((cse_p511_t180_g45706 * cse_p511_t227_g45753) + (cse_p511_t203_g45729 * cse_p515_t1_g45818) + (cse_p511_t248_g45774 * cse_p515_t1_g45817) + (cse_p517_t1_g45832 * (cse_p511_t154_g45680 + (cse_p1_t24_g45493 * cse_p1_t27_g45496))) + (-(cse_p511_t99_g45625))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
    cse_p514_t1_g45804 = (cse_p513_t1_g45796 * t2);
    cse_p516_t1_g45822 = (cse_p511_t168_g45694 * cse_p513_t1_g45793);
    h_x1_y2 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t180_g45706 * cse_p511_t228_g45754) + (cse_p511_t198_g45724 * cse_p515_t1_g45818) + (cse_p511_t249_g45775 * cse_p515_t1_g45817) + (cse_p514_t1_g45804 * v3z) + (cse_p517_t1_g45832 * (c2z + (cse_p1_t24_g45493 * v3x))) + (-(cse_p511_t103_g45629))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
    cse_p517_t1_g45833 = (cse_p511_t169_g45695 * cse_p513_t1_g45793);
    h_x1_z2 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p517_t1_g45833) + (sin_angle * ((cse_p1_t27_g45496 * cse_p514_t1_g45804) + (cse_p511_t180_g45706 * cse_p511_t229_g45755) + (cse_p511_t200_g45726 * cse_p515_t1_g45818) + (cse_p511_t250_g45776 * cse_p515_t1_g45817) + (cse_p517_t1_g45832 * (cse_p511_t260_g45786 + (cse_p1_t26_g45495 * v2z))) + (-(cse_p511_t107_g45633))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
    cse_p518_t1_g45843 = (cse_p511_t170_g45696 * cse_p513_t1_g45793);
    h_x1_x3 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p518_t1_g45843) + (sin_angle * (cse_p511_t99_g45625 + (cse_p511_t180_g45706 * cse_p511_t230_g45756) + (cse_p511_t201_g45727 * cse_p515_t1_g45818) + (cse_p511_t251_g45777 * cse_p515_t1_g45817) + (cse_p517_t1_g45832 * ((cse_p1_t16_g45485 * cse_p1_t24_g45493) + (cse_p511_t219_g45745 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
    cse_p515_t1_g45819 = (cse_p511_t167_g45693 * cse_p513_t1_g45793);
    h_x1_y3 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p515_t1_g45819) + (sin_angle * (cse_p511_t103_g45629 + (cse_p511_t180_g45706 * cse_p511_t231_g45757) + (cse_p511_t196_g45722 * cse_p515_t1_g45818) + (cse_p511_t219_g45745 * cse_p514_t1_g45804) + (cse_p511_t252_g45778 * cse_p515_t1_g45817) + (cse_p517_t1_g45832 * (cse_p511_t261_g45787 + (cse_p1_t24_g45493 * cse_p511_t217_g45743)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
    cse_p515_t1_g45816 = (cse_p511_t166_g45692 * cse_p513_t1_g45793);
    h_x1_z3 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p515_t1_g45816) + (sin_angle * (cse_p511_t107_g45633 + (cse_p1_t16_g45485 * cse_p514_t1_g45804) + (cse_p511_t180_g45706 * cse_p511_t232_g45758) + (cse_p511_t195_g45721 * cse_p515_t1_g45818) + (cse_p511_t253_g45779 * cse_p515_t1_g45817) + (cse_p517_t1_g45832 * (c2y + (cse_p1_t15_g45484 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
    cse_p563_t1_g45862 = (cse_p511_t177_g45703 * cse_p513_t1_g45793);
    h_x1_x4 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p563_t1_g45862) + (sin_angle * ((cse_p511_t180_g45706 * cse_p511_t235_g45761) + (cse_p511_t202_g45728 * cse_p515_t1_g45818) + (cse_p511_t247_g45773 * cse_p515_t1_g45817) + (cse_p517_t1_g45832 * (cse_p718_t1_g45875 + (cse_p1_t24_g45493 * cse_p1_t24_g45493)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 0, h_x1_x4);
    cse_p563_t1_g45857 = (cse_p511_t175_g45701 * cse_p513_t1_g45793);
    h_x1_y4 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p563_t1_g45857) + (sin_angle * (cse_p511_t135_g45661 + (cse_p511_t180_g45706 * cse_p511_t233_g45759) + (cse_p511_t197_g45723 * cse_p515_t1_g45818) + (cse_p511_t245_g45771 * cse_p515_t1_g45817) + (cse_p514_t1_g45804 * v2z)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 1, h_x1_y4);
    cse_p563_t1_g45858 = (cse_p511_t176_g45702 * cse_p513_t1_g45793);
    h_x1_z4 = (cse_p513_t1_g45794 * ((cse_p511_t180_g45706 * cse_p563_t1_g45858) + (sin_angle * (cse_p511_t151_g45677 + (cse_p1_t24_g45493 * cse_p514_t1_g45804) + (cse_p511_t180_g45706 * cse_p511_t234_g45760) + (cse_p511_t199_g45725 * cse_p515_t1_g45818) + (cse_p511_t246_g45772 * cse_p515_t1_g45817)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 2, h_x1_z4);
    cse_p515_t1_g45820 = (cse_p511_t204_g45730 * cse_p561_t4_invr45853);
    cse_p515_t1_g45821 = (cse_p511_t260_g45786 * cse_p513_t1_g45796);
    h_y1_y1 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p615_t1_g45870) + (sin_angle * ((cse_p511_t178_g45704 * cse_p511_t236_g45762) + (cse_p511_t204_g45730 * cse_p515_t1_g45821) + (cse_p511_t254_g45780 * cse_p515_t1_g45820)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
    h_y1_z1 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p615_t1_g45870) + (sin_angle * ((cse_p511_t178_g45704 * cse_p511_t237_g45763) + (cse_p511_t206_g45732 * cse_p515_t1_g45821) + (cse_p511_t255_g45781 * cse_p515_t1_g45820)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
    h_y1_x2 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p518_t1_g45848) + (sin_angle * ((cse_p1_t28_g45497 * cse_p514_t1_g45804) + (cse_p511_t178_g45704 * cse_p511_t227_g45753) + (cse_p511_t203_g45729 * cse_p515_t1_g45821) + (cse_p511_t248_g45774 * cse_p515_t1_g45820) + (cse_p517_t1_g45832 * (cse_p511_t261_g45787 + (cse_p1_t27_g45496 * v2x))) + (-(cse_p511_t100_g45626))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
    h_y1_y2 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t178_g45704 * cse_p511_t228_g45754) + (cse_p511_t198_g45724 * cse_p515_t1_g45821) + (cse_p511_t249_g45775 * cse_p515_t1_g45820) + (cse_p517_t1_g45832 * (cse_p511_t142_g45668 + (cse_p1_t25_g45494 * cse_p1_t28_g45497))) + (-(cse_p511_t104_g45630))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
    h_y1_z2 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t178_g45704 * cse_p511_t229_g45755) + (cse_p511_t200_g45726 * cse_p515_t1_g45821) + (cse_p511_t250_g45776 * cse_p515_t1_g45820) + (cse_p514_t1_g45804 * v3x) + (cse_p517_t1_g45832 * (c2x + (cse_p1_t25_g45494 * v3y))) + (-(cse_p511_t108_g45634))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
    h_y1_x3 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p518_t1_g45843) + (sin_angle * (cse_p511_t100_g45626 + (cse_p1_t17_g45486 * cse_p514_t1_g45804) + (cse_p511_t178_g45704 * cse_p511_t230_g45756) + (cse_p511_t201_g45727 * cse_p515_t1_g45821) + (cse_p511_t251_g45777 * cse_p515_t1_g45820) + (cse_p517_t1_g45832 * (c2z + (cse_p1_t16_g45485 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
    h_y1_y3 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p515_t1_g45819) + (sin_angle * (cse_p511_t104_g45630 + (cse_p511_t178_g45704 * cse_p511_t231_g45757) + (cse_p511_t196_g45722 * cse_p515_t1_g45821) + (cse_p511_t252_g45778 * cse_p515_t1_g45820) + (cse_p517_t1_g45832 * ((cse_p1_t17_g45486 * cse_p1_t25_g45494) + (cse_p511_t217_g45743 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
    h_y1_z3 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p515_t1_g45816) + (sin_angle * (cse_p511_t108_g45634 + (cse_p511_t178_g45704 * cse_p511_t232_g45758) + (cse_p511_t195_g45721 * cse_p515_t1_g45821) + (cse_p511_t217_g45743 * cse_p514_t1_g45804) + (cse_p511_t253_g45779 * cse_p515_t1_g45820) + (cse_p517_t1_g45832 * (cse_p511_t259_g45785 + (cse_p1_t25_g45494 * cse_p511_t218_g45744)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
    h_y1_x4 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p563_t1_g45862) + (sin_angle * (cse_p511_t135_g45661 + (cse_p1_t25_g45494 * cse_p514_t1_g45804) + (cse_p511_t178_g45704 * cse_p511_t235_g45761) + (cse_p511_t202_g45728 * cse_p515_t1_g45821) + (cse_p511_t247_g45773 * cse_p515_t1_g45820)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 0, h_y1_x4);
    h_y1_y4 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p563_t1_g45857) + (sin_angle * ((cse_p511_t178_g45704 * cse_p511_t233_g45759) + (cse_p511_t197_g45723 * cse_p515_t1_g45821) + (cse_p511_t245_g45771 * cse_p515_t1_g45820) + (cse_p517_t1_g45832 * (cse_p511_t137_g45663 + (cse_p1_t25_g45494 * cse_p1_t25_g45494)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 1, h_y1_y4);
    h_y1_z4 = (cse_p513_t1_g45794 * ((cse_p511_t178_g45704 * cse_p563_t1_g45858) + (sin_angle * (cse_p511_t144_g45670 + (cse_p511_t178_g45704 * cse_p511_t234_g45760) + (cse_p511_t199_g45725 * cse_p515_t1_g45821) + (cse_p511_t246_g45772 * cse_p515_t1_g45820) + (cse_p514_t1_g45804 * v2x)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 2, h_y1_z4);
    cse_p516_t1_g45829 = (cse_p511_t206_g45732 * cse_p561_t4_invr45853);
    cse_p516_t1_g45830 = (cse_p511_t261_g45787 * cse_p513_t1_g45796);
    h_z1_z1 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p823_t1_g45880) + (sin_angle * ((cse_p511_t179_g45705 * cse_p511_t237_g45763) + (cse_p511_t206_g45732 * cse_p516_t1_g45830) + (cse_p511_t255_g45781 * cse_p516_t1_g45829)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
    h_z1_x2 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p518_t1_g45848) + (sin_angle * ((cse_p511_t179_g45705 * cse_p511_t227_g45753) + (cse_p511_t203_g45729 * cse_p516_t1_g45830) + (cse_p511_t248_g45774 * cse_p516_t1_g45829) + (cse_p514_t1_g45804 * v3y) + (cse_p517_t1_g45832 * (c2y + (cse_p1_t23_g45492 * v3z))) + (-(cse_p511_t101_g45627))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
    h_z1_y2 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p516_t1_g45822) + (sin_angle * ((cse_p1_t26_g45495 * cse_p514_t1_g45804) + (cse_p511_t179_g45705 * cse_p511_t228_g45754) + (cse_p511_t198_g45724 * cse_p516_t1_g45830) + (cse_p511_t249_g45775 * cse_p516_t1_g45829) + (cse_p517_t1_g45832 * (cse_p511_t259_g45785 + (cse_p1_t28_g45497 * v2y))) + (-(cse_p511_t105_g45631))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
    h_z1_z2 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t179_g45705 * cse_p511_t229_g45755) + (cse_p511_t200_g45726 * cse_p516_t1_g45830) + (cse_p511_t250_g45776 * cse_p516_t1_g45829) + (cse_p517_t1_g45832 * (cse_p511_t149_g45675 + (cse_p1_t23_g45492 * cse_p1_t26_g45495))) + (-(cse_p511_t109_g45635))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
    h_z1_x3 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p518_t1_g45843) + (sin_angle * (cse_p511_t101_g45627 + (cse_p511_t179_g45705 * cse_p511_t230_g45756) + (cse_p511_t201_g45727 * cse_p516_t1_g45830) + (cse_p511_t218_g45744 * cse_p514_t1_g45804) + (cse_p511_t251_g45777 * cse_p516_t1_g45829) + (cse_p517_t1_g45832 * (cse_p511_t260_g45786 + (cse_p1_t23_g45492 * cse_p511_t219_g45745)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
    h_z1_y3 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p515_t1_g45819) + (sin_angle * (cse_p511_t105_g45631 + (cse_p1_t15_g45484 * cse_p514_t1_g45804) + (cse_p511_t179_g45705 * cse_p511_t231_g45757) + (cse_p511_t196_g45722 * cse_p516_t1_g45830) + (cse_p511_t252_g45778 * cse_p516_t1_g45829) + (cse_p517_t1_g45832 * (c2x + (cse_p1_t17_g45486 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
    h_z1_z3 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p515_t1_g45816) + (sin_angle * (cse_p511_t109_g45635 + (cse_p511_t179_g45705 * cse_p511_t232_g45758) + (cse_p511_t195_g45721 * cse_p516_t1_g45830) + (cse_p511_t253_g45779 * cse_p516_t1_g45829) + (cse_p517_t1_g45832 * ((cse_p1_t15_g45484 * cse_p1_t23_g45492) + (cse_p511_t218_g45744 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
    h_z1_x4 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p563_t1_g45862) + (sin_angle * (cse_p511_t151_g45677 + (cse_p511_t179_g45705 * cse_p511_t235_g45761) + (cse_p511_t202_g45728 * cse_p516_t1_g45830) + (cse_p511_t247_g45773 * cse_p516_t1_g45829) + (cse_p514_t1_g45804 * v2y)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 0, h_z1_x4);
    h_z1_y4 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p563_t1_g45857) + (sin_angle * (cse_p511_t144_g45670 + (cse_p1_t23_g45492 * cse_p514_t1_g45804) + (cse_p511_t179_g45705 * cse_p511_t233_g45759) + (cse_p511_t197_g45723 * cse_p516_t1_g45830) + (cse_p511_t245_g45771 * cse_p516_t1_g45829)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 1, h_z1_y4);
    h_z1_z4 = (cse_p513_t1_g45794 * ((cse_p511_t179_g45705 * cse_p563_t1_g45858) + (sin_angle * ((cse_p511_t179_g45705 * cse_p511_t234_g45760) + (cse_p511_t199_g45725 * cse_p516_t1_g45830) + (cse_p511_t246_g45772 * cse_p516_t1_g45829) + (cse_p517_t1_g45832 * (cse_p666_t1_g45874 + (cse_p1_t23_g45492 * cse_p1_t23_g45492)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 2, h_z1_z4);
    cse_p516_t1_g45828 = (cse_p511_t203_g45729 * cse_p561_t4_invr45853);
    cse_p563_t1_g45856 = (2.0000000000000000     * cse_p561_t2_invsqrt45851);
    h_x2_x2 = (cse_p513_t1_g45794 * ((cse_p511_t171_g45697 * cse_p518_t1_g45848) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t227_g45753) + (cse_p511_t172_g45698 * cse_p516_t1_g45828) + (cse_p511_t248_g45774 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * (cse_p511_t29_g45555 + cse_p511_t29_g45555 + (2.0000000000000000     * cse_p511_t216_g45742 * v3z))) + (cse_p926_t1_g45883 * (cse_p511_t239_g45765 + cse_p513_t1_g45792 + (cse_p1_t23_g45492 * cse_p511_t221_g45747 * cse_p563_t1_g45856)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
    cse_p516_t1_g45825 = (cse_p511_t198_g45724 * cse_p561_t4_invr45853);
    h_x2_y2 = (cse_p513_t1_g45794 * ((cse_p511_t171_g45697 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t228_g45754) + (cse_p511_t172_g45698 * cse_p516_t1_g45825) + (cse_p511_t249_g45775 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * ((cse_p1_t27_g45496 * cse_p511_t214_g45740) + (cse_p511_t225_g45751 * v3x))) + (cse_p926_t1_g45883 * (cse_p511_t240_g45766 + (cse_p561_t2_invsqrt45851 * ((cse_p1_t23_g45492 * cse_p511_t222_g45748) + (cse_p1_t24_g45493 * cse_p511_t221_g45747)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
    cse_p516_t1_g45826 = (cse_p511_t200_g45726 * cse_p561_t4_invr45853);
    h_x2_z2 = (cse_p513_t1_g45794 * ((cse_p511_t171_g45697 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t229_g45755) + (cse_p511_t172_g45698 * cse_p516_t1_g45826) + (cse_p511_t250_g45776 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * ((cse_p1_t26_g45495 * cse_p511_t216_g45742) + (cse_p511_t224_g45750 * v3z))) + (cse_p926_t1_g45883 * (cse_p511_t241_g45767 + (cse_p561_t2_invsqrt45851 * ((cse_p1_t23_g45492 * cse_p511_t223_g45749) + (cse_p1_t25_g45494 * cse_p511_t221_g45747)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
    cse_p516_t1_g45827 = (cse_p511_t201_g45727 * cse_p561_t4_invr45853);
    h_x2_x3 = (cse_p513_t1_g45794 * ((cse_p511_t171_g45697 * cse_p518_t1_g45843) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t230_g45756) + (cse_p511_t172_g45698 * cse_p516_t1_g45827) + (cse_p511_t251_g45777 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * ((cse_p1_t16_g45485 * cse_p511_t225_g45751) + (cse_p1_t21_g45490 * cse_p1_t27_g45496) + (cse_p511_t216_g45742 * cse_p511_t219_g45745) + (v1z * v3z))) + (cse_p926_t1_g45883 * (cse_p511_t238_g45764 + (cse_p561_t2_invsqrt45851 * ((cse_p1_t23_g45492 * cse_p511_t212_g45738) + (cse_p511_t221_g45747 * v2x) + (cse_p615_t1_g45873 * v2x)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
    cse_p516_t1_g45824 = (cse_p511_t196_g45722 * cse_p561_t4_invr45853);
    h_x2_y3 = (cse_p513_t1_g45794 * ((cse_p511_t171_g45697 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t231_g45757) + (cse_p511_t172_g45698 * cse_p516_t1_g45824) + (cse_p511_t252_g45778 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * (c1z + c2z + (cse_p1_t27_g45496 * v1x) + (cse_p511_t217_g45743 * cse_p511_t225_g45751))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * (v1z + v2z + v3z)) + (cse_p561_t2_invsqrt45851 * (cse_p511_t139_g45665 + (cse_p1_t23_g45492 * cse_p511_t209_g45735) + (cse_p511_t221_g45747 * v2y)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
    cse_p516_t1_g45823 = (cse_p511_t195_g45721 * cse_p561_t4_invr45853);
    h_x2_z3 = (cse_p513_t1_g45794 * ((cse_p511_t171_g45697 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t232_g45758) + (cse_p511_t172_g45698 * cse_p516_t1_g45823) + (cse_p511_t253_g45779 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * (cse_p511_t257_g45783 + cse_p511_t260_g45786 + (cse_p1_t15_g45484 * cse_p511_t216_g45742) + (cse_p1_t20_g45489 * v3z))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * (cse_p1_t21_g45490 + cse_p1_t24_g45493 + cse_p1_t27_g45496)) + (cse_p561_t2_invsqrt45851 * (cse_p511_t141_g45667 + (cse_p1_t23_g45492 * cse_p511_t208_g45734) + (cse_p511_t221_g45747 * v2z)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
    cse_p517_t1_g45834 = (cse_p511_t202_g45728 * cse_p561_t4_invr45853);
    h_x2_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p518_t1_g45848) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t235_g45761) + (cse_p511_t172_g45698 * cse_p517_t1_g45834) + (cse_p511_t247_g45773 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * ((cse_p1_t24_g45493 * cse_p511_t225_g45751) + (cse_p511_t216_g45742 * v2z))) + (-(cse_p511_t98_g45624))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 0, h_x2_x4);
    cse_p518_t1_g45844 = (cse_p511_t197_g45723 * cse_p561_t4_invr45853);
    cse_p615_t1_g45864 = (cse_p511_t210_g45736 * cse_p561_t2_invsqrt45851);
    h_x2_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p518_t1_g45848) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t233_g45759) + (cse_p511_t172_g45698 * cse_p518_t1_g45844) + (cse_p511_t245_g45771 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * (cse_p511_t258_g45784 + (cse_p511_t225_g45751 * v2x))) + (cse_p926_t1_g45883 * ((cse_p1_t23_g45492 * cse_p615_t1_g45864) + (cse_p511_t216_g45742 * cse_p561_t1_sqrt45850)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 1, h_x2_y4);
    cse_p518_t1_g45849 = (cse_p511_t199_g45725 * cse_p561_t4_invr45853);
    cse_p615_t1_g45865 = (cse_p511_t211_g45737 * cse_p561_t2_invsqrt45851);
    h_x2_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p518_t1_g45848) + (sin_angle * ((cse_p511_t171_g45697 * cse_p511_t234_g45760) + (cse_p511_t172_g45698 * cse_p518_t1_g45849) + (cse_p511_t246_g45772 * cse_p516_t1_g45828) + (cse_p517_t1_g45832 * (c1y + (cse_p1_t23_g45492 * cse_p511_t216_g45742))) + (cse_p926_t1_g45883 * ((cse_p1_t23_g45492 * cse_p615_t1_g45865) + (cse_p511_t225_g45751 * cse_p561_t1_sqrt45850)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 2, h_x2_z4);
    h_y2_y2 = (cse_p513_t1_g45794 * ((cse_p511_t168_g45694 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t228_g45754) + (cse_p511_t173_g45699 * cse_p516_t1_g45825) + (cse_p511_t249_g45775 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * (cse_p511_t30_g45556 + cse_p511_t30_g45556 + (2.0000000000000000     * cse_p511_t214_g45740 * v3x))) + (cse_p926_t1_g45883 * (cse_p511_t242_g45768 + cse_p513_t1_g45792 + (cse_p1_t24_g45493 * cse_p511_t222_g45748 * cse_p563_t1_g45856)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
    h_y2_z2 = (cse_p513_t1_g45794 * ((cse_p511_t169_g45695 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t229_g45755) + (cse_p511_t173_g45699 * cse_p516_t1_g45826) + (cse_p511_t250_g45776 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * ((cse_p1_t28_g45497 * cse_p511_t215_g45741) + (cse_p511_t226_g45752 * v3y))) + (cse_p926_t1_g45883 * (cse_p511_t243_g45769 + (cse_p561_t2_invsqrt45851 * ((cse_p1_t24_g45493 * cse_p511_t223_g45749) + (cse_p1_t25_g45494 * cse_p511_t222_g45748)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
    h_y2_x3 = (cse_p513_t1_g45794 * ((cse_p511_t170_g45696 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t230_g45756) + (cse_p511_t173_g45699 * cse_p516_t1_g45827) + (cse_p511_t251_g45777 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * (cse_p511_t258_g45784 + cse_p511_t261_g45787 + (cse_p1_t16_g45485 * cse_p511_t214_g45740) + (cse_p1_t21_g45490 * v3x))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * (cse_p1_t22_g45491 + cse_p1_t25_g45494 + cse_p1_t28_g45497)) + (cse_p561_t2_invsqrt45851 * (cse_p511_t139_g45665 + (cse_p1_t24_g45493 * cse_p511_t212_g45738) + (cse_p511_t222_g45748 * v2x)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
    h_y2_y3 = (cse_p513_t1_g45794 * ((cse_p511_t168_g45694 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t231_g45757) + (cse_p511_t173_g45699 * cse_p516_t1_g45824) + (cse_p511_t252_g45778 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * ((cse_p1_t17_g45486 * cse_p511_t226_g45752) + (cse_p1_t22_g45491 * cse_p1_t28_g45497) + (cse_p511_t214_g45740 * cse_p511_t217_g45743) + (v1x * v3x))) + (cse_p926_t1_g45883 * (cse_p511_t238_g45764 + (cse_p561_t2_invsqrt45851 * ((cse_p1_t24_g45493 * cse_p511_t209_g45735) + (cse_p511_t222_g45748 * v2y) + (cse_p614_t1_g45863 * cse_p666_t1_g45874)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
    h_y2_z3 = (cse_p513_t1_g45794 * ((cse_p511_t168_g45694 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t232_g45758) + (cse_p511_t173_g45699 * cse_p516_t1_g45823) + (cse_p511_t253_g45779 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * (c1x + c2x + (cse_p1_t28_g45497 * v1y) + (cse_p511_t218_g45744 * cse_p511_t226_g45752))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * (v1x + v2x + v3x)) + (cse_p561_t2_invsqrt45851 * (cse_p511_t148_g45674 + (cse_p1_t24_g45493 * cse_p511_t208_g45734) + (cse_p511_t222_g45748 * v2z)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
    cse_p615_t1_g45866 = (cse_p511_t213_g45739 * cse_p561_t2_invsqrt45851);
    h_y2_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t235_g45761) + (cse_p511_t173_g45699 * cse_p517_t1_g45834) + (cse_p511_t247_g45773 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * (c1z + (cse_p1_t24_g45493 * cse_p511_t214_g45740))) + (cse_p926_t1_g45883 * ((cse_p1_t24_g45493 * cse_p615_t1_g45866) + (cse_p511_t226_g45752 * cse_p561_t1_sqrt45850)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 0, h_y2_x4);
    h_y2_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t233_g45759) + (cse_p511_t173_g45699 * cse_p518_t1_g45844) + (cse_p511_t245_g45771 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * ((cse_p1_t25_g45494 * cse_p511_t226_g45752) + (cse_p511_t214_g45740 * v2x))) + (-(cse_p511_t102_g45628))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 1, h_y2_y4);
    h_y2_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p516_t1_g45822) + (sin_angle * ((cse_p511_t168_g45694 * cse_p511_t234_g45760) + (cse_p511_t173_g45699 * cse_p518_t1_g45849) + (cse_p511_t246_g45772 * cse_p516_t1_g45825) + (cse_p517_t1_g45832 * (cse_p511_t256_g45782 + (cse_p511_t226_g45752 * v2y))) + (cse_p926_t1_g45883 * ((cse_p1_t24_g45493 * cse_p615_t1_g45865) + (cse_p511_t214_g45740 * cse_p561_t1_sqrt45850)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 2, h_y2_z4);
    h_z2_z2 = (cse_p513_t1_g45794 * ((cse_p511_t169_g45695 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t229_g45755) + (cse_p511_t174_g45700 * cse_p516_t1_g45826) + (cse_p511_t250_g45776 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * (cse_p511_t28_g45554 + cse_p511_t28_g45554 + (2.0000000000000000     * cse_p511_t215_g45741 * v3y))) + (cse_p926_t1_g45883 * (cse_p511_t244_g45770 + cse_p513_t1_g45792 + (cse_p1_t25_g45494 * cse_p511_t223_g45749 * cse_p563_t1_g45856)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
    h_z2_x3 = (cse_p513_t1_g45794 * ((cse_p511_t170_g45696 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t230_g45756) + (cse_p511_t174_g45700 * cse_p516_t1_g45827) + (cse_p511_t251_g45777 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * (c1y + c2y + (cse_p1_t26_g45495 * v1z) + (cse_p511_t219_g45745 * cse_p511_t224_g45750))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * (v1y + v2y + v3y)) + (cse_p561_t2_invsqrt45851 * (cse_p511_t141_g45667 + (cse_p1_t25_g45494 * cse_p511_t212_g45738) + (cse_p511_t223_g45749 * v2x)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
    h_z2_y3 = (cse_p513_t1_g45794 * ((cse_p511_t169_g45695 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t231_g45757) + (cse_p511_t174_g45700 * cse_p516_t1_g45824) + (cse_p511_t252_g45778 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * (cse_p511_t256_g45782 + cse_p511_t259_g45785 + (cse_p1_t17_g45486 * cse_p511_t215_g45741) + (cse_p1_t22_g45491 * v3y))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * (cse_p1_t20_g45489 + cse_p1_t23_g45492 + cse_p1_t26_g45495)) + (cse_p561_t2_invsqrt45851 * (cse_p511_t148_g45674 + (cse_p1_t25_g45494 * cse_p511_t209_g45735) + (cse_p511_t223_g45749 * v2y)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
    h_z2_z3 = (cse_p513_t1_g45794 * ((cse_p511_t169_g45695 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t232_g45758) + (cse_p511_t174_g45700 * cse_p516_t1_g45823) + (cse_p511_t253_g45779 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * ((cse_p1_t15_g45484 * cse_p511_t224_g45750) + (cse_p1_t20_g45489 * cse_p1_t26_g45495) + (cse_p511_t215_g45741 * cse_p511_t218_g45744) + (v1y * v3y))) + (cse_p926_t1_g45883 * (cse_p511_t238_g45764 + (cse_p561_t2_invsqrt45851 * ((cse_p1_t25_g45494 * cse_p511_t208_g45734) + (cse_p511_t223_g45749 * v2z) + (cse_p614_t1_g45863 * cse_p718_t1_g45875)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
    h_z2_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t235_g45761) + (cse_p511_t174_g45700 * cse_p517_t1_g45834) + (cse_p511_t247_g45773 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * (cse_p511_t257_g45783 + (cse_p511_t224_g45750 * v2z))) + (cse_p926_t1_g45883 * ((cse_p1_t25_g45494 * cse_p615_t1_g45866) + (cse_p511_t215_g45741 * cse_p561_t1_sqrt45850)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 0, h_z2_x4);
    h_z2_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t233_g45759) + (cse_p511_t174_g45700 * cse_p518_t1_g45844) + (cse_p511_t245_g45771 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * (c1x + (cse_p1_t25_g45494 * cse_p511_t215_g45741))) + (cse_p926_t1_g45883 * ((cse_p1_t25_g45494 * cse_p615_t1_g45864) + (cse_p511_t224_g45750 * cse_p561_t1_sqrt45850)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 1, h_z2_y4);
    h_z2_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p517_t1_g45833) + (sin_angle * ((cse_p511_t169_g45695 * cse_p511_t234_g45760) + (cse_p511_t174_g45700 * cse_p518_t1_g45849) + (cse_p511_t246_g45772 * cse_p516_t1_g45826) + (cse_p517_t1_g45832 * ((cse_p1_t23_g45492 * cse_p511_t224_g45750) + (cse_p511_t215_g45741 * v2y))) + (-(cse_p511_t106_g45632))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 2, h_z2_z4);
    h_x3_x3 = (cse_p513_t1_g45794 * ((cse_p511_t170_g45696 * cse_p518_t1_g45843) + (sin_angle * ((cse_p511_t170_g45696 * cse_p511_t230_g45756) + (cse_p511_t190_g45716 * cse_p516_t1_g45827) + (cse_p511_t251_g45777 * cse_p516_t1_g45827) + (cse_p517_t1_g45832 * (cse_p511_t32_g45558 + cse_p511_t32_g45558 + (2.0000000000000000     * cse_p511_t219_g45745 * v1z))) + (cse_p926_t1_g45883 * (cse_p511_t239_g45765 + cse_p513_t1_g45792 + (cse_p511_t212_g45738 * cse_p563_t1_g45856 * v2x)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
    h_x3_y3 = (cse_p513_t1_g45794 * ((cse_p511_t170_g45696 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t170_g45696 * cse_p511_t231_g45757) + (cse_p511_t190_g45716 * cse_p516_t1_g45824) + (cse_p511_t252_g45778 * cse_p516_t1_g45827) + (cse_p517_t1_g45832 * ((cse_p1_t16_g45485 * v1x) + (cse_p1_t21_g45490 * cse_p511_t217_g45743))) + (cse_p926_t1_g45883 * (cse_p511_t240_g45766 + (cse_p561_t2_invsqrt45851 * ((cse_p511_t209_g45735 * v2x) + (cse_p511_t212_g45738 * v2y)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
    h_x3_z3 = (cse_p513_t1_g45794 * ((cse_p511_t170_g45696 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t170_g45696 * cse_p511_t232_g45758) + (cse_p511_t190_g45716 * cse_p516_t1_g45823) + (cse_p511_t253_g45779 * cse_p516_t1_g45827) + (cse_p517_t1_g45832 * ((cse_p1_t15_g45484 * v1z) + (cse_p1_t20_g45489 * cse_p511_t219_g45745))) + (cse_p926_t1_g45883 * (cse_p511_t241_g45767 + (cse_p561_t2_invsqrt45851 * ((cse_p511_t208_g45734 * v2x) + (cse_p511_t212_g45738 * v2z)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
    h_x3_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p518_t1_g45843) + (sin_angle * (cse_p511_t98_g45624 + (cse_p511_t170_g45696 * cse_p511_t235_g45761) + (cse_p511_t190_g45716 * cse_p517_t1_g45834) + (cse_p511_t247_g45773 * cse_p516_t1_g45827) + (cse_p517_t1_g45832 * (cse_p511_t132_g45658 + (cse_p1_t21_g45490 * cse_p1_t24_g45493)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 0, h_x3_x4);
    h_x3_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p518_t1_g45843) + (sin_angle * ((cse_p511_t170_g45696 * cse_p511_t233_g45759) + (cse_p511_t190_g45716 * cse_p518_t1_g45844) + (cse_p511_t245_g45771 * cse_p516_t1_g45827) + (cse_p517_t1_g45832 * (c1z + (cse_p1_t21_g45490 * v2x))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * v1z) + (cse_p615_t1_g45864 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 1, h_x3_y4);
    h_x3_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p518_t1_g45843) + (sin_angle * ((cse_p511_t170_g45696 * cse_p511_t234_g45760) + (cse_p511_t190_g45716 * cse_p518_t1_g45849) + (cse_p511_t246_g45772 * cse_p516_t1_g45827) + (cse_p517_t1_g45832 * (cse_p511_t257_g45783 + (cse_p1_t23_g45492 * v1z))) + (cse_p926_t1_g45883 * ((cse_p1_t21_g45490 * cse_p561_t1_sqrt45850) + (cse_p615_t1_g45865 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 2, h_x3_z4);
    h_y3_y3 = (cse_p513_t1_g45794 * ((cse_p511_t167_g45693 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t167_g45693 * cse_p511_t231_g45757) + (cse_p511_t191_g45717 * cse_p516_t1_g45824) + (cse_p511_t252_g45778 * cse_p516_t1_g45824) + (cse_p517_t1_g45832 * (cse_p511_t33_g45559 + cse_p511_t33_g45559 + (2.0000000000000000     * cse_p511_t217_g45743 * v1x))) + (cse_p926_t1_g45883 * (cse_p511_t242_g45768 + cse_p513_t1_g45792 + (cse_p511_t209_g45735 * cse_p563_t1_g45856 * v2y)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
    h_y3_z3 = (cse_p513_t1_g45794 * ((cse_p511_t167_g45693 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t167_g45693 * cse_p511_t232_g45758) + (cse_p511_t191_g45717 * cse_p516_t1_g45823) + (cse_p511_t253_g45779 * cse_p516_t1_g45824) + (cse_p517_t1_g45832 * ((cse_p1_t17_g45486 * v1y) + (cse_p1_t22_g45491 * cse_p511_t218_g45744))) + (cse_p926_t1_g45883 * (cse_p511_t243_g45769 + (cse_p561_t2_invsqrt45851 * ((cse_p511_t208_g45734 * v2y) + (cse_p511_t209_g45735 * v2z)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
    h_y3_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t167_g45693 * cse_p511_t235_g45761) + (cse_p511_t191_g45717 * cse_p517_t1_g45834) + (cse_p511_t247_g45773 * cse_p516_t1_g45824) + (cse_p517_t1_g45832 * (cse_p511_t258_g45784 + (cse_p1_t24_g45493 * v1x))) + (cse_p926_t1_g45883 * ((cse_p1_t22_g45491 * cse_p561_t1_sqrt45850) + (cse_p615_t1_g45866 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 0, h_y3_x4);
    h_y3_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p515_t1_g45819) + (sin_angle * (cse_p511_t102_g45628 + (cse_p511_t167_g45693 * cse_p511_t233_g45759) + (cse_p511_t191_g45717 * cse_p518_t1_g45844) + (cse_p511_t245_g45771 * cse_p516_t1_g45824) + (cse_p517_t1_g45832 * (cse_p511_t120_g45646 + (cse_p1_t22_g45491 * cse_p1_t25_g45494)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 1, h_y3_y4);
    h_y3_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p515_t1_g45819) + (sin_angle * ((cse_p511_t167_g45693 * cse_p511_t234_g45760) + (cse_p511_t191_g45717 * cse_p518_t1_g45849) + (cse_p511_t246_g45772 * cse_p516_t1_g45824) + (cse_p517_t1_g45832 * (c1x + (cse_p1_t22_g45491 * v2y))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * v1x) + (cse_p615_t1_g45865 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 2, h_y3_z4);
    h_z3_z3 = (cse_p513_t1_g45794 * ((cse_p511_t166_g45692 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t166_g45692 * cse_p511_t232_g45758) + (cse_p511_t192_g45718 * cse_p516_t1_g45823) + (cse_p511_t253_g45779 * cse_p516_t1_g45823) + (cse_p517_t1_g45832 * (cse_p511_t31_g45557 + cse_p511_t31_g45557 + (2.0000000000000000     * cse_p511_t218_g45744 * v1y))) + (cse_p926_t1_g45883 * (cse_p511_t244_g45770 + cse_p513_t1_g45792 + (cse_p511_t208_g45734 * cse_p563_t1_g45856 * v2z)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
    h_z3_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t166_g45692 * cse_p511_t235_g45761) + (cse_p511_t192_g45718 * cse_p517_t1_g45834) + (cse_p511_t247_g45773 * cse_p516_t1_g45823) + (cse_p517_t1_g45832 * (c1y + (cse_p1_t20_g45489 * v2z))) + (cse_p926_t1_g45883 * ((cse_p561_t1_sqrt45850 * v1y) + (cse_p615_t1_g45866 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 0, h_z3_x4);
    h_z3_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p515_t1_g45816) + (sin_angle * ((cse_p511_t166_g45692 * cse_p511_t233_g45759) + (cse_p511_t192_g45718 * cse_p518_t1_g45844) + (cse_p511_t245_g45771 * cse_p516_t1_g45823) + (cse_p517_t1_g45832 * (cse_p511_t256_g45782 + (cse_p1_t25_g45494 * v1y))) + (cse_p926_t1_g45883 * ((cse_p1_t20_g45489 * cse_p561_t1_sqrt45850) + (cse_p615_t1_g45864 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 1, h_z3_y4);
    h_z3_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p515_t1_g45816) + (sin_angle * (cse_p511_t106_g45632 + (cse_p511_t166_g45692 * cse_p511_t234_g45760) + (cse_p511_t192_g45718 * cse_p518_t1_g45849) + (cse_p511_t246_g45772 * cse_p516_t1_g45823) + (cse_p517_t1_g45832 * (cse_p511_t126_g45652 + (cse_p1_t20_g45489 * cse_p1_t23_g45492)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 2, h_z3_z4);
    h_x4_x4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p563_t1_g45862) + (sin_angle * ((cse_p511_t177_g45703 * cse_p511_t235_g45761) + (cse_p511_t202_g45728 * cse_p511_t213_g45739 * cse_p513_t1_g45796) + (cse_p511_t247_g45773 * cse_p517_t1_g45834)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 0, h_x4_x4);
    cse_p823_t1_g45881 = (cse_p511_t197_g45723 * cse_p513_t1_g45796);
    h_x4_y4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p563_t1_g45857) + (sin_angle * ((cse_p511_t177_g45703 * cse_p511_t233_g45759) + (cse_p511_t213_g45739 * cse_p823_t1_g45881) + (cse_p511_t245_g45771 * cse_p517_t1_g45834)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 1, h_x4_y4);
    cse_p615_t1_g45871 = (cse_p511_t199_g45725 * cse_p513_t1_g45796);
    h_x4_z4 = (cse_p513_t1_g45794 * ((cse_p511_t177_g45703 * cse_p563_t1_g45858) + (sin_angle * ((cse_p511_t177_g45703 * cse_p511_t234_g45760) + (cse_p511_t213_g45739 * cse_p615_t1_g45871) + (cse_p511_t246_g45772 * cse_p517_t1_g45834)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 2, h_x4_z4);
    h_y4_y4 = (cse_p513_t1_g45794 * ((cse_p511_t175_g45701 * cse_p563_t1_g45857) + (sin_angle * ((cse_p511_t175_g45701 * cse_p511_t233_g45759) + (cse_p511_t210_g45736 * cse_p823_t1_g45881) + (cse_p511_t245_g45771 * cse_p518_t1_g45844)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 1, h_y4_y4);
    h_y4_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p563_t1_g45857) + (sin_angle * ((cse_p511_t175_g45701 * cse_p511_t234_g45760) + (cse_p511_t210_g45736 * cse_p615_t1_g45871) + (cse_p511_t246_g45772 * cse_p518_t1_g45844)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 2, h_y4_z4);
    h_z4_z4 = (cse_p513_t1_g45794 * ((cse_p511_t176_g45702 * cse_p563_t1_g45858) + (sin_angle * ((cse_p511_t176_g45702 * cse_p511_t234_g45760) + (cse_p511_t211_g45737 * cse_p615_t1_g45871) + (cse_p511_t246_g45772 * cse_p518_t1_g45849)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 2, i3x4, 2, h_z4_z4);
  }
  return energy;
}

void hessian_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x4, 0, hval);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 1, hval);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 1, hval);
  }
}

};
