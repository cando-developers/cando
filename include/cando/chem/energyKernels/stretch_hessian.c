void stretch_hessian(double kb, double r0, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, double* hessian, double* dvec, double* hdvec) {
  constexpr size_t PositionSize = 6;
  /* !BASE */
  double cse_p1_t1_g223;
  double cse_p1_t1_g235;
  double cse_p501_t15_g260;
  double cse_p501_t16_g261;
  double cse_p501_t17_g262;
  double cse_p501_t18_g263;
  double cse_p501_t1_g246;
  double cse_p501_t1_g296;
  double cse_p501_t1_g297;
  double cse_p501_t1_g298;
  double cse_p501_t1_g299;
  double cse_p501_t1_g301;
  double cse_p501_t1_g302;
  double cse_p501_t1_g303;
  double cse_p501_t1_g304;
  double cse_p501_t20_g265;
  double cse_p501_t21_g266;
  double cse_p501_t24_g269;
  double cse_p501_t29_g274;
  double cse_p501_t2_g247;
  double cse_p501_t30_g275;
  double cse_p501_t31_g276;
  double cse_p501_t32_g277;
  double cse_p501_t39_g284;
  double cse_p501_t3_g248;
  double cse_p501_t40_g285;
  double cse_p501_t41_g286;
  double cse_p501_t42_g287;
  double cse_p501_t43_g288;
  double cse_p501_t44_g289;
  double cse_p501_t45_g290;
  double cse_p501_t46_g291;
  double cse_p501_t47_g292;
  double cse_p501_t48_g293;
  double cse_p501_t49_g294;
  double cse_p501_t4_g249;
  double cse_p501_t50_g295;
  double cse_p501_t5_g250;
  double cse_p501_t6_g251;
  double cse_p502_t1_g306;
  double cse_p502_t1_g307;
  double cse_p502_t1_g308;
  double cse_p502_t1_g309;
  double cse_p51_t1_g241;
  double cse_p551_t1_g310;
  double cse_p552_t1_g315;
  double cse_p552_t1_g316;
  double cse_p552_t1_g317;
  double cse_p552_t2_g312;
  double cse_p552_t3_g313;
  double cse_p552_t4_g314;
  double cse_p602_t1_g318;
  double cse_p653_t1_g319;
  double cse_p704_t1_g320;
  double cse_p755_t1_g321;
  double cse_p756_t1_g322;
  double cse_p806_t1_g323;
  double cse_p857_t1_g324;
  double dr;
  double dx;
  double dy;
  double dz;
  double energy;
  double g_x1;
  double g_x2;
  double g_y1;
  double g_y2;
  double g_z1;
  double g_z2;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_z1;
  double h_x1_z2;
  double h_x2_x2;
  double h_x2_y2;
  double h_x2_z2;
  double h_y1_x2;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_z1;
  double h_y1_z2;
  double h_y2_y2;
  double h_y2_z2;
  double h_z1_x2;
  double h_z1_y2;
  double h_z1_z1;
  double h_z1_z2;
  double h_z2_z2;
  double r;
  double r2;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  {
    /* !BASE */
    dx = (x2 + (-(x1)));
    dy = (y2 + (-(y1)));
    dz = (z2 + (-(z1)));
    cse_p501_t1_g302 = (dz * dz);
    cse_p502_t1_g309 = (dy * dy);
    cse_p756_t1_g322 = (dx * dx);
    r2 = (cse_p501_t1_g302 + cse_p502_t1_g309 + cse_p756_t1_g322);
    cse_p501_t1_g297 = (kb * pow(r2, -0.50000000000000000    ));
    cse_p501_t1_g298 = (dx * pow(r2, -0.50000000000000000    ));
    cse_p501_t1_g303 = (cse_p501_t1_g297 * cse_p501_t1_g298);
    cse_p704_t1_g320 = (cse_p501_t1_g303 * dz);
    cse_p653_t1_g319 = (cse_p501_t1_g303 * dy);
    cse_p501_t1_g246 = (-2.0000000000000000     * cse_p653_t1_g319);
    cse_p501_t2_g247 = (-2.0000000000000000     * cse_p704_t1_g320);
    cse_p501_t1_g301 = (dy * pow(r2, -0.50000000000000000    ));
    cse_p551_t1_g310 = (cse_p501_t1_g297 * cse_p501_t1_g301 * dz);
    cse_p501_t3_g248 = (2.0000000000000000     * (-(cse_p551_t1_g310)));
    cse_p501_t4_g249 = (2.0000000000000000     * cse_p653_t1_g319);
    cse_p501_t5_g250 = (2.0000000000000000     * cse_p704_t1_g320);
    cse_p501_t6_g251 = (2.0000000000000000     * cse_p551_t1_g310);
    cse_p501_t21_g266 = (cse_p501_t1_g298 * dx);
    cse_p501_t24_g269 = (cse_p501_t1_g301 * dy);
    cse_p502_t1_g306 = (cse_p501_t1_g302 * pow(r2, -0.50000000000000000    ));
    cse_p501_t45_g290 = (-(cse_p653_t1_g319));
    cse_p602_t1_g318 = (2.0000000000000000     * cse_p501_t45_g290);
    cse_p501_t46_g291 = (-(cse_p704_t1_g320));
    cse_p552_t2_g312 = (2.0000000000000000     * cse_p501_t46_g291);
    cse_p501_t47_g292 = (-(cse_p551_t1_g310));
    cse_p552_t3_g313 = (2.0000000000000000     * cse_p501_t47_g292);
    cse_p501_t50_g295 = pow(r2, -1);
    cse_p1_t1_g223 = pow(r2, -0.50000000000000000    );
    r = sqrt(r2);
    dr = (r + (-(r0)));
    cse_p755_t1_g321 = (dr * kb);
    cse_p501_t1_g296 = (cse_p1_t1_g223 * cse_p501_t50_g295);
    cse_p501_t1_g299 = (cse_p501_t1_g296 * cse_p755_t1_g321);
    cse_p806_t1_g323 = (cse_p501_t1_g299 * cse_p501_t1_g302);
    cse_p501_t1_g304 = (cse_p501_t1_g299 * dx);
    cse_p857_t1_g324 = (cse_p501_t1_g304 * dx);
    cse_p501_t15_g260 = (cse_p501_t1_g304 * dy);
    cse_p501_t16_g261 = (cse_p501_t1_g304 * dz);
    cse_p501_t17_g262 = (cse_p501_t1_g299 * cse_p502_t1_g309);
    cse_p502_t1_g307 = (dy * dz);
    cse_p501_t18_g263 = (cse_p501_t1_g299 * cse_p502_t1_g307);
    cse_p501_t20_g265 = (cse_p501_t1_g297 * dr);
    cse_p552_t1_g315 = (cse_p501_t1_g297 * (cse_p501_t21_g266 + cse_p501_t21_g266 + dr));
    cse_p552_t1_g316 = (cse_p501_t1_g297 * (cse_p501_t24_g269 + cse_p501_t24_g269 + dr));
    cse_p501_t29_g274 = (cse_p501_t1_g297 * (cse_p502_t1_g306 + cse_p502_t1_g306 + dr));
    cse_p501_t30_g275 = (cse_p501_t21_g266 + cse_p501_t21_g266 + dr);
    cse_p501_t31_g276 = (cse_p501_t24_g269 + cse_p501_t24_g269 + dr);
    cse_p501_t32_g277 = (cse_p502_t1_g306 + cse_p502_t1_g306 + dr);
    cse_p552_t4_g314 = (cse_p501_t1_g297 * cse_p501_t32_g277);
    cse_p501_t39_g284 = (-(cse_p857_t1_g324));
    cse_p501_t40_g285 = (-(cse_p501_t15_g260));
    cse_p501_t41_g286 = (-(cse_p501_t16_g261));
    cse_p501_t42_g287 = (-(cse_p501_t17_g262));
    cse_p501_t43_g288 = (-(cse_p501_t18_g263));
    cse_p501_t44_g289 = (-(cse_p806_t1_g323));
    cse_p501_t49_g294 = (-(cse_p501_t20_g265));
    cse_p502_t1_g308 = (cse_p1_t1_g223 * cse_p755_t1_g321);
    cse_p501_t48_g293 = (-(cse_p502_t1_g308));
    energy = (cse_p755_t1_g321 * dr);
    *energy_accumulate += energy;
    cse_p51_t1_g241 = (-2.0000000000000000     * cse_p502_t1_g308);
    g_x1 = (cse_p51_t1_g241 * dx);
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (cse_p51_t1_g241 * dy);
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (cse_p51_t1_g241 * dz);
    KernelGradientAcc(i3x1, 2, g_z1);
    cse_p1_t1_g235 = (2.0000000000000000     * cse_p502_t1_g308);
    g_x2 = (cse_p1_t1_g235 * dx);
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (cse_p1_t1_g235 * dy);
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (cse_p1_t1_g235 * dz);
    KernelGradientAcc(i3x2, 2, g_z2);
    h_x1_x1 = (cse_p501_t39_g284 + cse_p501_t39_g284 + cse_p502_t1_g308 + cse_p552_t1_g315);
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
    h_x1_y1 = (cse_p501_t40_g285 + cse_p501_t40_g285 + cse_p501_t4_g249);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
    h_x1_z1 = (cse_p501_t41_g286 + cse_p501_t41_g286 + cse_p501_t5_g250);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
    cse_p552_t1_g317 = (-2.0000000000000000     * cse_p1_t1_g223 * cse_p1_t1_g223 * kb);
    h_x1_x2 = (cse_p501_t48_g293 + cse_p501_t49_g294 + cse_p857_t1_g324 + cse_p857_t1_g324 + (cse_p552_t1_g317 * cse_p756_t1_g322));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
    h_x1_y2 = (cse_p501_t15_g260 + cse_p501_t15_g260 + cse_p602_t1_g318);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
    h_x1_z2 = (cse_p501_t16_g261 + cse_p501_t16_g261 + cse_p552_t2_g312);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
    h_y1_y1 = (cse_p501_t42_g287 + cse_p501_t42_g287 + cse_p502_t1_g308 + cse_p552_t1_g316);
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
    h_y1_z1 = (cse_p501_t43_g288 + cse_p501_t43_g288 + cse_p501_t6_g251);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
    h_y1_x2 = h_x1_y2;
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
    h_y1_y2 = (cse_p501_t17_g262 + cse_p501_t17_g262 + cse_p501_t48_g293 + cse_p501_t49_g294 + (cse_p502_t1_g309 * cse_p552_t1_g317));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
    h_y1_z2 = (cse_p501_t18_g263 + cse_p501_t18_g263 + cse_p552_t3_g313);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
    h_z1_z1 = (cse_p501_t44_g289 + cse_p501_t44_g289 + cse_p502_t1_g308 + cse_p552_t4_g314);
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
    h_z1_x2 = h_x1_z2;
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
    h_z1_y2 = h_y1_z2;
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
    h_z1_z2 = (cse_p501_t48_g293 + cse_p501_t49_g294 + cse_p806_t1_g323 + cse_p806_t1_g323 + (cse_p501_t1_g302 * cse_p552_t1_g317));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
    h_x2_x2 = h_x1_x1;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
    h_x2_y2 = h_x1_y1;
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
    h_x2_z2 = h_x1_z1;
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
    h_y2_y2 = h_y1_y1;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
    h_y2_z2 = h_y1_z1;
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
    h_z2_z2 = h_z1_z1;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
  }
}
void stretch_hessian_fd(double kb, double r0, size_t i3x1, size_t i3x2, double* position, double* energy_accumulate, double* force, double* hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 6;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  stretch_energy(kb, r0, i3x1, i3x2, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    stretch_energy(kb, r0, i3x1, i3x2, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
}

