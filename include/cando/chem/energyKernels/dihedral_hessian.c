void dihedral_hessian(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, double* hessian, double* dvec, double* hdvec) {
  constexpr size_t PositionSize = 12;
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c1_sq;
  double c2x;
  double c2y;
  double c2z;
  double c2_sq;
  double cos_angle;
  double cos_nphi;
  double cse_p1_t10_g667;
  double cse_p1_t15_g672;
  double cse_p1_t16_g673;
  double cse_p1_t17_g674;
  double cse_p1_t18_g675;
  double cse_p1_t19_g676;
  double cse_p1_t1_g658;
  double cse_p1_t1_g690;
  double cse_p1_t1_g691;
  double cse_p1_t1_g693;
  double cse_p1_t1_g694;
  double cse_p1_t20_g677;
  double cse_p1_t21_g678;
  double cse_p1_t22_g679;
  double cse_p1_t23_g680;
  double cse_p1_t24_g681;
  double cse_p1_t25_g682;
  double cse_p1_t26_g683;
  double cse_p1_t27_g684;
  double cse_p1_t28_g685;
  double cse_p1_t2_g659;
  double cse_p1_t30_g687;
  double cse_p1_t31_g688;
  double cse_p1_t32_g689;
  double cse_p1_t6_g663;
  double cse_p1_t7_g664;
  double cse_p1_t8_g665;
  double cse_p501_t100_g794;
  double cse_p501_t101_g795;
  double cse_p501_t102_g796;
  double cse_p501_t103_g797;
  double cse_p501_t104_g798;
  double cse_p501_t105_g799;
  double cse_p501_t106_g800;
  double cse_p501_t107_g801;
  double cse_p501_t108_g802;
  double cse_p501_t109_g803;
  double cse_p501_t10_g704;
  double cse_p501_t110_g804;
  double cse_p501_t111_g805;
  double cse_p501_t112_g806;
  double cse_p501_t113_g807;
  double cse_p501_t114_g808;
  double cse_p501_t115_g809;
  double cse_p501_t116_g810;
  double cse_p501_t117_g811;
  double cse_p501_t118_g812;
  double cse_p501_t119_g813;
  double cse_p501_t11_g705;
  double cse_p501_t120_g814;
  double cse_p501_t121_g815;
  double cse_p501_t122_g816;
  double cse_p501_t123_g817;
  double cse_p501_t124_g818;
  double cse_p501_t125_g819;
  double cse_p501_t126_g820;
  double cse_p501_t127_g821;
  double cse_p501_t128_g822;
  double cse_p501_t129_g823;
  double cse_p501_t12_g706;
  double cse_p501_t130_g824;
  double cse_p501_t131_g825;
  double cse_p501_t132_g826;
  double cse_p501_t133_g827;
  double cse_p501_t134_g828;
  double cse_p501_t135_g829;
  double cse_p501_t136_g830;
  double cse_p501_t137_g831;
  double cse_p501_t138_g832;
  double cse_p501_t139_g833;
  double cse_p501_t13_g707;
  double cse_p501_t140_g834;
  double cse_p501_t141_g835;
  double cse_p501_t142_g836;
  double cse_p501_t143_g837;
  double cse_p501_t144_g838;
  double cse_p501_t145_g839;
  double cse_p501_t147_g841;
  double cse_p501_t148_g842;
  double cse_p501_t149_g843;
  double cse_p501_t14_g708;
  double cse_p501_t150_g844;
  double cse_p501_t151_g845;
  double cse_p501_t152_g846;
  double cse_p501_t154_g848;
  double cse_p501_t157_g851;
  double cse_p501_t158_g852;
  double cse_p501_t15_g709;
  double cse_p501_t160_g854;
  double cse_p501_t164_g858;
  double cse_p501_t165_g859;
  double cse_p501_t166_g860;
  double cse_p501_t167_g861;
  double cse_p501_t168_g862;
  double cse_p501_t169_g863;
  double cse_p501_t16_g710;
  double cse_p501_t170_g864;
  double cse_p501_t171_g865;
  double cse_p501_t172_g866;
  double cse_p501_t173_g867;
  double cse_p501_t174_g868;
  double cse_p501_t175_g869;
  double cse_p501_t176_g870;
  double cse_p501_t177_g871;
  double cse_p501_t178_g872;
  double cse_p501_t179_g873;
  double cse_p501_t17_g711;
  double cse_p501_t180_g874;
  double cse_p501_t181_g875;
  double cse_p501_t182_g876;
  double cse_p501_t183_g877;
  double cse_p501_t184_g878;
  double cse_p501_t185_g879;
  double cse_p501_t186_g880;
  double cse_p501_t187_g881;
  double cse_p501_t188_g882;
  double cse_p501_t189_g883;
  double cse_p501_t18_g712;
  double cse_p501_t190_g884;
  double cse_p501_t191_g885;
  double cse_p501_t192_g886;
  double cse_p501_t193_g887;
  double cse_p501_t194_g888;
  double cse_p501_t195_g889;
  double cse_p501_t196_g890;
  double cse_p501_t197_g891;
  double cse_p501_t198_g892;
  double cse_p501_t199_g893;
  double cse_p501_t19_g713;
  double cse_p501_t1_g695;
  double cse_p501_t200_g894;
  double cse_p501_t201_g895;
  double cse_p501_t202_g896;
  double cse_p501_t203_g897;
  double cse_p501_t204_g898;
  double cse_p501_t205_g899;
  double cse_p501_t206_g900;
  double cse_p501_t207_g901;
  double cse_p501_t208_g902;
  double cse_p501_t209_g903;
  double cse_p501_t20_g714;
  double cse_p501_t210_g904;
  double cse_p501_t211_g905;
  double cse_p501_t212_g906;
  double cse_p501_t213_g907;
  double cse_p501_t214_g908;
  double cse_p501_t215_g909;
  double cse_p501_t216_g910;
  double cse_p501_t217_g911;
  double cse_p501_t218_g912;
  double cse_p501_t219_g913;
  double cse_p501_t220_g914;
  double cse_p501_t221_g915;
  double cse_p501_t222_g916;
  double cse_p501_t223_g917;
  double cse_p501_t224_g918;
  double cse_p501_t225_g919;
  double cse_p501_t226_g920;
  double cse_p501_t227_g921;
  double cse_p501_t228_g922;
  double cse_p501_t229_g923;
  double cse_p501_t22_g716;
  double cse_p501_t230_g924;
  double cse_p501_t231_g925;
  double cse_p501_t232_g926;
  double cse_p501_t233_g927;
  double cse_p501_t234_g928;
  double cse_p501_t235_g929;
  double cse_p501_t236_g930;
  double cse_p501_t237_g931;
  double cse_p501_t238_g932;
  double cse_p501_t239_g933;
  double cse_p501_t23_g717;
  double cse_p501_t240_g934;
  double cse_p501_t241_g935;
  double cse_p501_t242_g936;
  double cse_p501_t243_g937;
  double cse_p501_t244_g938;
  double cse_p501_t245_g939;
  double cse_p501_t246_g940;
  double cse_p501_t247_g941;
  double cse_p501_t248_g942;
  double cse_p501_t249_g943;
  double cse_p501_t24_g718;
  double cse_p501_t250_g944;
  double cse_p501_t251_g945;
  double cse_p501_t252_g946;
  double cse_p501_t253_g947;
  double cse_p501_t254_g948;
  double cse_p501_t255_g949;
  double cse_p501_t256_g950;
  double cse_p501_t257_g951;
  double cse_p501_t258_g952;
  double cse_p501_t259_g953;
  double cse_p501_t25_g719;
  double cse_p501_t260_g954;
  double cse_p501_t261_g955;
  double cse_p501_t262_g956;
  double cse_p501_t263_g957;
  double cse_p501_t264_g958;
  double cse_p501_t265_g959;
  double cse_p501_t26_g720;
  double cse_p501_t27_g721;
  double cse_p501_t28_g722;
  double cse_p501_t29_g723;
  double cse_p501_t2_g696;
  double cse_p501_t30_g724;
  double cse_p501_t31_g725;
  double cse_p501_t32_g726;
  double cse_p501_t33_g727;
  double cse_p501_t3_g697;
  double cse_p501_t44_g738;
  double cse_p501_t4_g698;
  double cse_p501_t56_g750;
  double cse_p501_t57_g751;
  double cse_p501_t58_g752;
  double cse_p501_t59_g753;
  double cse_p501_t5_g699;
  double cse_p501_t60_g754;
  double cse_p501_t61_g755;
  double cse_p501_t62_g756;
  double cse_p501_t63_g757;
  double cse_p501_t64_g758;
  double cse_p501_t65_g759;
  double cse_p501_t66_g760;
  double cse_p501_t67_g761;
  double cse_p501_t68_g762;
  double cse_p501_t69_g763;
  double cse_p501_t6_g700;
  double cse_p501_t70_g764;
  double cse_p501_t71_g765;
  double cse_p501_t72_g766;
  double cse_p501_t73_g767;
  double cse_p501_t74_g768;
  double cse_p501_t75_g769;
  double cse_p501_t76_g770;
  double cse_p501_t77_g771;
  double cse_p501_t78_g772;
  double cse_p501_t79_g773;
  double cse_p501_t7_g701;
  double cse_p501_t80_g774;
  double cse_p501_t81_g775;
  double cse_p501_t82_g776;
  double cse_p501_t83_g777;
  double cse_p501_t84_g778;
  double cse_p501_t85_g779;
  double cse_p501_t86_g780;
  double cse_p501_t87_g781;
  double cse_p501_t88_g782;
  double cse_p501_t89_g783;
  double cse_p501_t8_g702;
  double cse_p501_t90_g784;
  double cse_p501_t91_g785;
  double cse_p501_t92_g786;
  double cse_p501_t93_g787;
  double cse_p501_t94_g788;
  double cse_p501_t95_g789;
  double cse_p501_t96_g790;
  double cse_p501_t97_g791;
  double cse_p501_t98_g792;
  double cse_p501_t99_g793;
  double cse_p501_t9_g703;
  double cse_p503_t1_g960;
  double cse_p503_t1_g961;
  double cse_p503_t1_g962;
  double cse_p503_t1_g963;
  double cse_p503_t1_g964;
  double cse_p503_t1_g965;
  double cse_p503_t1_g966;
  double cse_p503_t1_g967;
  double cse_p503_t1_g968;
  double cse_p503_t1_g969;
  double cse_p504_t1_g970;
  double cse_p504_t1_g971;
  double cse_p504_t1_g972;
  double cse_p504_t1_g973;
  double cse_p504_t1_g974;
  double cse_p504_t1_g975;
  double cse_p504_t1_g976;
  double cse_p504_t1_g977;
  double cse_p504_t1_g978;
  double cse_p504_t1_g979;
  double cse_p505_t1_g980;
  double cse_p505_t1_g981;
  double cse_p505_t1_g982;
  double cse_p505_t1_g983;
  double cse_p505_t1_g984;
  double cse_p505_t1_g985;
  double cse_p505_t1_g986;
  double cse_p505_t1_g987;
  double cse_p505_t1_g988;
  double cse_p505_t1_g989;
  double cse_p506_t1_g990;
  double cse_p506_t1_g991;
  double cse_p506_t1_g992;
  double cse_p506_t1_g993;
  double cse_p506_t1_g994;
  double cse_p506_t1_g995;
  double cse_p506_t1_g996;
  double cse_p506_t1_g997;
  double cse_p506_t1_g998;
  double cse_p506_t1_g999;
  double cse_p507_t1_g1000;
  double cse_p507_t1_g1001;
  double cse_p507_t1_g1002;
  double cse_p507_t1_g1003;
  double cse_p507_t1_g1004;
  double cse_p507_t1_g1005;
  double cse_p507_t1_g1006;
  double cse_p507_t1_g1007;
  double cse_p507_t1_g1008;
  double cse_p507_t1_g1009;
  double cse_p508_t1_g1010;
  double cse_p508_t1_g1011;
  double cse_p508_t1_g1012;
  double cse_p508_t1_g1013;
  double cse_p508_t1_g1014;
  double cse_p508_t1_g1015;
  double cse_p508_t1_g1016;
  double cse_p508_t1_g1017;
  double cse_p551_t1_g1018;
  double cse_p552_t1_g1019;
  double cse_p552_t1_g1021;
  double cse_p552_t1_g1022;
  double cse_p552_t1_g1023;
  double cse_p552_t1_g1024;
  double cse_p552_t1_g1025;
  double cse_p552_t1_g1026;
  double cse_p552_t1_g1027;
  double cse_p552_t1_g1028;
  double cse_p552_t1_g1029;
  double cse_p552_t1_g1030;
  double cse_p552_t2_g1020;
  double cse_p553_t1_g1031;
  double cse_p553_t1_g1032;
  double cse_p553_t1_g1033;
  double cse_p553_t1_g1034;
  double cse_p553_t1_g1035;
  double cse_p553_t1_g1036;
  double cse_p602_t1_g1037;
  double cse_p603_t1_g1038;
  double cse_p653_t1_g1039;
  double cse_p704_t1_g1040;
  double cse_p755_t1_g1041;
  double dot12;
  double dot23;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_x4;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_y4;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x1_z4;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_x4;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_y4;
  double h_x2_z2;
  double h_x2_z3;
  double h_x2_z4;
  double h_x3_x3;
  double h_x3_x4;
  double h_x3_y3;
  double h_x3_y4;
  double h_x3_z3;
  double h_x3_z4;
  double h_x4_x4;
  double h_x4_y4;
  double h_x4_z4;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_x4;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_y4;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y1_z4;
  double h_y2_x3;
  double h_y2_x4;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_y4;
  double h_y2_z2;
  double h_y2_z3;
  double h_y2_z4;
  double h_y3_x4;
  double h_y3_y3;
  double h_y3_y4;
  double h_y3_z3;
  double h_y3_z4;
  double h_y4_y4;
  double h_y4_z4;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_x4;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_y4;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z1_z4;
  double h_z2_x3;
  double h_z2_x4;
  double h_z2_y3;
  double h_z2_y4;
  double h_z2_z2;
  double h_z2_z3;
  double h_z2_z4;
  double h_z3_x4;
  double h_z3_y4;
  double h_z3_z3;
  double h_z3_z4;
  double h_z4_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_len;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    cse_p501_t262_g956 = (-(v));
    v1x = (x2 + (-(x1)));
    cse_p1_t20_g677 = (-(v1x));
    v1y = (y2 + (-(y1)));
    cse_p1_t21_g678 = (-(v1y));
    v1z = (z2 + (-(z1)));
    cse_p1_t22_g679 = (-(v1z));
    v2x = (x3 + (-(x2)));
    cse_p501_t120_g814 = (v1x * v2x);
    cse_p501_t124_g818 = (v1y * (-(v2x)));
    cse_p501_t137_g831 = (v2x * v2x);
    cse_p501_t214_g908 = (cse_p1_t20_g677 + (-(v2x)));
    cse_p501_t224_g918 = (v1x + v2x);
    cse_p1_t8_g665 = (v1z * v2x);
    cse_p1_t23_g680 = (-(v2x));
    v2y = (y3 + (-(y2)));
    cse_p653_t1_g1039 = (v2y * v2y);
    cse_p501_t126_g820 = (v1y * v2y);
    cse_p501_t130_g824 = (v1z * (-(v2y)));
    cse_p501_t211_g905 = (cse_p501_t124_g818 + (v1x * v2y));
    cse_p501_t215_g909 = (cse_p1_t21_g678 + (-(v2y)));
    cse_p501_t225_g919 = (v1y + v2y);
    cse_p1_t6_g663 = (v1x * v2y);
    cse_p1_t24_g681 = (-(v2y));
    v2z = (z3 + (-(z2)));
    cse_p704_t1_g1040 = (v2z * v2z);
    cse_p501_t118_g812 = (v1x * (-(v2z)));
    cse_p501_t132_g826 = (v1z * v2z);
    cse_p501_t210_g904 = (cse_p1_t8_g665 + cse_p501_t118_g812);
    cse_p501_t213_g907 = (cse_p501_t130_g824 + (v1y * v2z));
    cse_p501_t216_g910 = (cse_p1_t22_g679 + (-(v2z)));
    cse_p501_t226_g920 = (v1z + v2z);
    cse_p1_t7_g664 = (v1y * v2z);
    cse_p1_t25_g682 = (-(v2z));
    v3x = (x4 + (-(x3)));
    cse_p501_t28_g722 = (cse_p501_t224_g918 * (-(v3x)));
    cse_p501_t31_g725 = (cse_p1_t20_g677 * (v2x + v3x));
    cse_p501_t123_g817 = (v1y * (v2x + v3x));
    cse_p501_t125_g819 = (v1y * (-(v3x)));
    cse_p501_t128_g822 = (v1z * (cse_p1_t23_g680 + (-(v3x))));
    cse_p501_t133_g827 = (v1z * v3x);
    cse_p501_t142_g836 = (v2x * v3x);
    cse_p501_t217_g911 = (cse_p1_t23_g680 + (-(v3x)));
    cse_p1_t15_g672 = (v2x + v3x);
    cse_p1_t26_g683 = (-(v3x));
    v3y = (y4 + (-(y3)));
    cse_p501_t29_g723 = (cse_p501_t225_g919 * (-(v3y)));
    cse_p501_t32_g726 = (cse_p1_t21_g678 * (v2y + v3y));
    cse_p501_t116_g810 = (v1x * (cse_p1_t24_g681 + (-(v3y))));
    cse_p501_t121_g815 = (v1x * v3y);
    cse_p501_t129_g823 = (v1z * (v2y + v3y));
    cse_p501_t131_g825 = (v1z * (-(v3y)));
    cse_p501_t149_g843 = (v2y * v3y);
    cse_p501_t208_g902 = (cse_p501_t116_g810 + cse_p501_t123_g817);
    cse_p501_t218_g912 = (cse_p1_t24_g681 + (-(v3y)));
    cse_p1_t16_g673 = (v2y + v3y);
    cse_p1_t27_g684 = (-(v3y));
    v3z = (z4 + (-(z3)));
    cse_p501_t30_g724 = (cse_p501_t226_g920 * (-(v3z)));
    cse_p501_t33_g727 = (cse_p1_t22_g679 * (v2z + v3z));
    cse_p501_t117_g811 = (v1x * (v2z + v3z));
    cse_p501_t119_g813 = (v1x * (-(v3z)));
    cse_p501_t122_g816 = (v1y * (cse_p1_t25_g682 + (-(v3z))));
    cse_p501_t127_g821 = (v1y * v3z);
    cse_p501_t154_g848 = (v2z * v3z);
    cse_p501_t209_g903 = (cse_p501_t117_g811 + cse_p501_t128_g822);
    cse_p501_t212_g906 = (cse_p501_t122_g816 + cse_p501_t129_g823);
    cse_p501_t219_g913 = (cse_p1_t25_g682 + (-(v3z)));
    cse_p1_t17_g674 = (v2z + v3z);
    cse_p1_t28_g685 = (-(v3z));
    c1x = (cse_p1_t7_g664 + (-((v1z * v2y))));
    cse_p501_t56_g750 = (c1x * cse_p501_t218_g912);
    cse_p501_t57_g751 = (c1x * cse_p1_t17_g674);
    cse_p501_t58_g752 = (c1x * cse_p1_t25_g682);
    cse_p501_t59_g753 = (c1x * cse_p1_t28_g685);
    cse_p501_t60_g754 = (c1x * v2y);
    cse_p501_t61_g755 = (c1x * v3y);
    cse_p501_t256_g950 = (-(c1x));
    c1y = (cse_p1_t8_g665 + (-((v1x * v2z))));
    cse_p501_t62_g756 = (c1y * cse_p501_t219_g913);
    cse_p501_t63_g757 = (c1y * cse_p1_t15_g672);
    cse_p501_t64_g758 = (c1y * cse_p1_t23_g680);
    cse_p501_t65_g759 = (c1y * cse_p1_t26_g683);
    cse_p501_t66_g760 = (c1y * v2z);
    cse_p501_t67_g761 = (c1y * v3z);
    cse_p501_t199_g893 = (cse_p501_t60_g754 + cse_p501_t64_g758);
    cse_p501_t257_g951 = (-(c1y));
    c1z = (cse_p1_t6_g663 + (-((v1y * v2x))));
    cse_p501_t68_g762 = (c1z * cse_p501_t217_g911);
    cse_p501_t69_g763 = (c1z * cse_p1_t16_g673);
    cse_p501_t70_g764 = (c1z * cse_p1_t24_g681);
    cse_p501_t71_g765 = (c1z * cse_p1_t27_g684);
    cse_p501_t72_g766 = (c1z * v2x);
    cse_p501_t73_g767 = (c1z * v3x);
    cse_p501_t197_g891 = (cse_p501_t58_g752 + cse_p501_t72_g766);
    cse_p501_t202_g896 = (cse_p501_t66_g760 + cse_p501_t70_g764);
    cse_p501_t258_g952 = (-(c1z));
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    cse_p501_t74_g768 = (c2x * cse_p501_t215_g909);
    cse_p501_t75_g769 = (c2x * cse_p501_t226_g920);
    cse_p501_t76_g770 = (c2x * cse_p1_t22_g679);
    cse_p501_t77_g771 = (c2x * cse_p1_t25_g682);
    cse_p501_t78_g772 = (c2x * v1y);
    cse_p501_t79_g773 = (c2x * v2y);
    cse_p501_t221_g915 = (c2x + cse_p501_t127_g821 + cse_p501_t131_g825);
    cse_p501_t259_g953 = (-(c2x));
    cse_p1_t1_g658 = (c2x * v1x);
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    cse_p501_t80_g774 = (c2y * cse_p501_t216_g910);
    cse_p501_t81_g775 = (c2y * cse_p501_t224_g918);
    cse_p501_t82_g776 = (c2y * cse_p1_t20_g677);
    cse_p501_t83_g777 = (c2y * cse_p1_t23_g680);
    cse_p501_t84_g778 = (c2y * v1z);
    cse_p501_t85_g779 = (c2y * v2z);
    cse_p501_t195_g889 = (cse_p501_t56_g750 + cse_p501_t63_g757 + cse_p501_t78_g772 + cse_p501_t82_g776);
    cse_p501_t200_g894 = (cse_p501_t61_g755 + cse_p501_t65_g759 + cse_p501_t74_g768 + cse_p501_t81_g775);
    cse_p501_t206_g900 = (cse_p501_t79_g773 + cse_p501_t83_g777);
    cse_p501_t222_g916 = (c2y + cse_p501_t119_g813 + cse_p501_t133_g827);
    cse_p501_t260_g954 = (-(c2y));
    cse_p1_t2_g659 = (c2y * v1y);
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    cse_p755_t1_g1041 = (c2z * v1z);
    cse_p501_t86_g780 = (c2z * cse_p501_t214_g908);
    cse_p501_t87_g781 = (c2z * cse_p501_t225_g919);
    cse_p501_t88_g782 = (c2z * cse_p1_t21_g678);
    cse_p501_t89_g783 = (c2z * cse_p1_t24_g681);
    cse_p501_t90_g784 = (c2z * v1x);
    cse_p501_t91_g785 = (c2z * v2x);
    cse_p501_t196_g890 = (cse_p501_t57_g751 + cse_p501_t68_g762 + cse_p501_t76_g770 + cse_p501_t90_g784);
    cse_p501_t198_g892 = (cse_p501_t59_g753 + cse_p501_t73_g767 + cse_p501_t75_g769 + cse_p501_t86_g780);
    cse_p501_t201_g895 = (cse_p501_t62_g756 + cse_p501_t69_g763 + cse_p501_t84_g778 + cse_p501_t88_g782);
    cse_p501_t203_g897 = (cse_p501_t67_g761 + cse_p501_t71_g765 + cse_p501_t80_g774 + cse_p501_t87_g781);
    cse_p501_t204_g898 = (cse_p501_t77_g771 + cse_p501_t91_g785);
    cse_p501_t205_g899 = (cse_p1_t1_g658 + cse_p1_t2_g659 + cse_p755_t1_g1041);
    cse_p501_t207_g901 = (cse_p501_t85_g779 + cse_p501_t89_g783);
    cse_p501_t223_g917 = (c2z + cse_p501_t121_g815 + cse_p501_t125_g819);
    cse_p501_t261_g955 = (-(c2z));
    c1_sq = ((c1x * c1x) + (c1y * c1y) + (c1z * c1z));
    c2_sq = ((c2x * c2x) + (c2y * c2y) + (c2z * c2z));
    v2_sq = (cse_p501_t137_g831 + cse_p653_t1_g1039 + cse_p704_t1_g1040);
    cse_p503_t1_g960 = (cse_p501_t205_g899 * pow(v2_sq, -0.50000000000000000    ));
    cse_p501_t18_g712 = (cse_p1_t23_g680 * cse_p503_t1_g960);
    cse_p501_t19_g713 = (cse_p1_t24_g681 * cse_p503_t1_g960);
    cse_p501_t20_g714 = (cse_p1_t25_g682 * cse_p503_t1_g960);
    cse_p501_t134_g828 = (cse_p503_t1_g960 * v2x);
    cse_p505_t1_g983 = (cse_p501_t205_g899 * pow(v2_sq, -1));
    cse_p506_t1_g999 = (cse_p505_t1_g983 * pow(v2_sq, -0.50000000000000000    ));
    cse_p603_t1_g1038 = (cse_p506_t1_g999 * v2x);
    cse_p501_t136_g830 = (cse_p603_t1_g1038 * v2x);
    cse_p501_t138_g832 = (cse_p603_t1_g1038 * v2y);
    cse_p501_t139_g833 = (cse_p505_t1_g983 * v2x * v2y);
    cse_p501_t140_g834 = (cse_p603_t1_g1038 * v2z);
    cse_p501_t141_g835 = (cse_p505_t1_g983 * v2x * v2z);
    cse_p501_t143_g837 = (cse_p503_t1_g960 * v2y);
    cse_p501_t145_g839 = (cse_p506_t1_g999 * cse_p653_t1_g1039);
    cse_p501_t147_g841 = (cse_p506_t1_g999 * v2y * v2z);
    cse_p501_t148_g842 = (cse_p505_t1_g983 * v2y * v2z);
    cse_p501_t150_g844 = (cse_p503_t1_g960 * v2z);
    cse_p501_t152_g846 = (cse_p506_t1_g999 * cse_p704_t1_g1040);
    cse_p501_t238_g932 = (-(cse_p503_t1_g960));
    cse_p501_t239_g933 = (-(cse_p501_t136_g830));
    cse_p501_t240_g934 = (-(cse_p501_t138_g832));
    cse_p501_t241_g935 = (-(cse_p501_t140_g834));
    cse_p501_t242_g936 = (-(cse_p501_t145_g839));
    cse_p501_t243_g937 = (-(cse_p501_t147_g841));
    cse_p501_t244_g938 = (-(cse_p501_t152_g846));
    cse_p501_t265_g959 = pow(v2_sq, -1);
    cse_p1_t32_g689 = pow(v2_sq, -0.50000000000000000    );
    v2_len = sqrt(v2_sq);
    cse_p503_t1_g969 = (cse_p501_t208_g902 * v2_len);
    cse_p504_t1_g970 = (cse_p501_t209_g903 * v2_len);
    cse_p501_t157_g851 = (cse_p501_t210_g904 * v2_len);
    cse_p501_t158_g852 = (cse_p501_t211_g905 * v2_len);
    cse_p504_t1_g971 = (cse_p501_t212_g906 * v2_len);
    cse_p501_t160_g854 = (cse_p501_t213_g907 * v2_len);
    cse_p504_t1_g979 = (cse_p501_t221_g915 * v2_len);
    cse_p505_t1_g980 = (cse_p501_t222_g916 * v2_len);
    cse_p505_t1_g981 = (cse_p501_t223_g917 * v2_len);
    cse_p501_t164_g858 = (cse_p501_t260_g954 * v2_len);
    cse_p501_t165_g859 = (cse_p501_t261_g955 * v2_len);
    cse_p501_t172_g866 = (cse_p501_t18_g712 + cse_p504_t1_g979);
    cse_p501_t173_g867 = (cse_p501_t19_g713 + cse_p505_t1_g980);
    cse_p501_t174_g868 = (cse_p501_t20_g714 + cse_p505_t1_g981);
    cse_p501_t190_g884 = (cse_p501_t134_g828 + cse_p504_t1_g971);
    cse_p501_t191_g885 = (cse_p501_t143_g837 + cse_p504_t1_g970);
    cse_p501_t192_g886 = (cse_p501_t150_g844 + cse_p503_t1_g969);
    cse_p501_t245_g939 = (-(cse_p501_t157_g851));
    cse_p501_t246_g940 = (-(cse_p501_t158_g852));
    cse_p501_t247_g941 = (-(cse_p501_t160_g854));
    cse_p501_t248_g942 = (-(cse_p501_t172_g866));
    cse_p501_t249_g943 = (-(cse_p501_t173_g867));
    cse_p501_t250_g944 = (-(cse_p501_t174_g868));
    cse_p501_t251_g945 = (-(cse_p501_t190_g884));
    cse_p501_t252_g946 = (-(cse_p501_t191_g885));
    cse_p501_t253_g947 = (-(cse_p501_t192_g886));
    cse_p501_t254_g948 = (-(cse_p501_t164_g858));
    cse_p501_t255_g949 = (-(cse_p501_t165_g859));
    dot12 = (cse_p501_t120_g814 + cse_p501_t126_g820 + cse_p501_t132_g826);
    dot23 = (cse_p501_t142_g836 + cse_p501_t149_g843 + cse_p501_t154_g848);
    t1 = (cse_p501_t205_g899 * v2_len);
    cse_p501_t12_g706 = (cse_p501_t195_g889 * (-(t1)));
    cse_p501_t13_g707 = (cse_p501_t196_g890 * (-(t1)));
    cse_p501_t14_g708 = (cse_p501_t198_g892 * (-(t1)));
    cse_p501_t15_g709 = (cse_p501_t200_g894 * (-(t1)));
    cse_p501_t16_g710 = (cse_p501_t201_g895 * (-(t1)));
    cse_p501_t17_g711 = (cse_p501_t203_g897 * (-(t1)));
    cse_p501_t22_g716 = (cse_p501_t197_g891 * (-(t1)));
    cse_p501_t23_g717 = (cse_p501_t199_g893 * (-(t1)));
    cse_p501_t24_g718 = (cse_p501_t202_g896 * (-(t1)));
    cse_p501_t25_g719 = (cse_p501_t204_g898 * (-(t1)));
    cse_p501_t26_g720 = (cse_p501_t206_g900 * (-(t1)));
    cse_p501_t27_g721 = (cse_p501_t207_g901 * (-(t1)));
    cse_p503_t1_g966 = (2.0000000000000000     * t1);
    cse_p508_t1_g1013 = (cse_p501_t172_g866 * cse_p503_t1_g966);
    cse_p508_t1_g1014 = (cse_p501_t173_g867 * cse_p503_t1_g966);
    cse_p508_t1_g1015 = (cse_p501_t174_g868 * cse_p503_t1_g966);
    cse_p552_t1_g1024 = (cse_p501_t190_g884 * cse_p503_t1_g966);
    cse_p552_t1_g1025 = (cse_p501_t191_g885 * cse_p503_t1_g966);
    cse_p552_t1_g1026 = (cse_p501_t192_g886 * cse_p503_t1_g966);
    cse_p505_t1_g982 = (cse_p503_t1_g966 * v2_len);
    cse_p602_t1_g1037 = (cse_p501_t260_g954 * cse_p505_t1_g982);
    cse_p507_t1_g1008 = (cse_p501_t210_g904 * cse_p505_t1_g982);
    cse_p507_t1_g1009 = (cse_p501_t211_g905 * cse_p505_t1_g982);
    cse_p508_t1_g1010 = (cse_p501_t213_g907 * cse_p505_t1_g982);
    cse_p501_t44_g738 = (cse_p501_t261_g955 * cse_p505_t1_g982);
    cse_p1_t19_g676 = (-(t1));
    cse_p1_t30_g687 = ((t1) * (t1));
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    cse_p552_t1_g1019 = pow((cse_p1_t30_g687 + ((t2) * (t2))), -1);
    cse_p552_t2_g1020 = pow((cse_p1_t30_g687 + ((t2) * (t2))), -2);
    cse_p551_t1_g1018 = (t2 * v2_len);
    cse_p503_t1_g967 = (2.0000000000000000     * t2);
    cse_p504_t1_g978 = (cse_p501_t203_g897 * cse_p503_t1_g967);
    cse_p501_t1_g695 = (cse_p552_t2_g1020 * (cse_p504_t1_g978 + cse_p508_t1_g1013));
    cse_p504_t1_g975 = (cse_p501_t198_g892 * cse_p503_t1_g967);
    cse_p501_t2_g696 = (cse_p552_t2_g1020 * (cse_p504_t1_g975 + cse_p508_t1_g1014));
    cse_p504_t1_g976 = (cse_p501_t200_g894 * cse_p503_t1_g967);
    cse_p501_t3_g697 = (cse_p552_t2_g1020 * (cse_p504_t1_g976 + cse_p508_t1_g1015));
    cse_p504_t1_g977 = (cse_p501_t201_g895 * cse_p503_t1_g967);
    cse_p501_t4_g698 = (cse_p552_t2_g1020 * (cse_p504_t1_g977 + cse_p552_t1_g1024));
    cse_p504_t1_g974 = (cse_p501_t196_g890 * cse_p503_t1_g967);
    cse_p501_t5_g699 = (cse_p552_t2_g1020 * (cse_p504_t1_g974 + cse_p552_t1_g1025));
    cse_p504_t1_g973 = (cse_p501_t195_g889 * cse_p503_t1_g967);
    cse_p501_t6_g700 = (cse_p552_t2_g1020 * (cse_p504_t1_g973 + cse_p552_t1_g1026));
    cse_p507_t1_g1003 = (cse_p501_t197_g891 * cse_p503_t1_g967);
    cse_p501_t7_g701 = (cse_p552_t2_g1020 * (cse_p507_t1_g1003 + cse_p507_t1_g1008));
    cse_p507_t1_g1004 = (cse_p501_t199_g893 * cse_p503_t1_g967);
    cse_p501_t8_g702 = (cse_p552_t2_g1020 * (cse_p507_t1_g1004 + cse_p507_t1_g1009));
    cse_p507_t1_g1005 = (cse_p501_t202_g896 * cse_p503_t1_g967);
    cse_p501_t9_g703 = (cse_p552_t2_g1020 * (cse_p507_t1_g1005 + cse_p508_t1_g1010));
    cse_p507_t1_g1006 = (cse_p501_t204_g898 * cse_p503_t1_g967);
    cse_p501_t10_g704 = (cse_p552_t2_g1020 * (cse_p507_t1_g1006 + cse_p602_t1_g1037));
    cse_p507_t1_g1007 = (cse_p501_t206_g900 * cse_p503_t1_g967);
    cse_p501_t11_g705 = (cse_p552_t2_g1020 * (cse_p501_t44_g738 + cse_p507_t1_g1007));
    cse_p501_t92_g786 = (cse_p501_t172_g866 * t2);
    cse_p501_t93_g787 = (cse_p501_t173_g867 * t2);
    cse_p501_t94_g788 = (cse_p501_t174_g868 * t2);
    cse_p501_t95_g789 = (cse_p501_t190_g884 * t2);
    cse_p501_t96_g790 = (cse_p501_t191_g885 * t2);
    cse_p501_t97_g791 = (cse_p501_t192_g886 * t2);
    cse_p503_t1_g965 = (cse_p1_t32_g689 * cse_p552_t1_g1019 * t2);
    cse_p553_t1_g1031 = (cse_p503_t1_g965 * v2x);
    cse_p501_t98_g792 = (cse_p501_t213_g907 * cse_p553_t1_g1031);
    cse_p501_t99_g793 = (cse_p501_t259_g953 * cse_p553_t1_g1031);
    cse_p501_t100_g794 = (cse_p501_t260_g954 * cse_p553_t1_g1031);
    cse_p501_t101_g795 = (cse_p501_t261_g955 * cse_p553_t1_g1031);
    cse_p553_t1_g1032 = (cse_p503_t1_g965 * v2y);
    cse_p501_t102_g796 = (cse_p501_t210_g904 * cse_p553_t1_g1032);
    cse_p501_t103_g797 = (cse_p501_t259_g953 * cse_p553_t1_g1032);
    cse_p501_t104_g798 = (cse_p501_t260_g954 * cse_p553_t1_g1032);
    cse_p501_t105_g799 = (cse_p501_t261_g955 * cse_p553_t1_g1032);
    cse_p553_t1_g1033 = (cse_p503_t1_g965 * v2z);
    cse_p501_t106_g800 = (cse_p501_t211_g905 * cse_p553_t1_g1033);
    cse_p501_t107_g801 = (cse_p501_t259_g953 * cse_p553_t1_g1033);
    cse_p501_t108_g802 = (cse_p501_t260_g954 * cse_p553_t1_g1033);
    cse_p501_t109_g803 = (cse_p501_t261_g955 * cse_p553_t1_g1033);
    cse_p501_t110_g804 = (cse_p501_t210_g904 * cse_p551_t1_g1018);
    cse_p501_t111_g805 = (cse_p501_t211_g905 * cse_p551_t1_g1018);
    cse_p501_t112_g806 = (cse_p501_t213_g907 * cse_p551_t1_g1018);
    cse_p501_t113_g807 = (cse_p501_t259_g953 * cse_p551_t1_g1018);
    cse_p501_t114_g808 = (cse_p501_t260_g954 * cse_p551_t1_g1018);
    cse_p501_t115_g809 = (cse_p501_t261_g955 * cse_p551_t1_g1018);
    cse_p507_t1_g1000 = (cse_p1_t19_g676 * cse_p552_t1_g1019);
    cse_p501_t135_g829 = (cse_p1_t24_g681 * cse_p507_t1_g1000 * v2x);
    cse_p501_t144_g838 = (cse_p1_t25_g682 * cse_p507_t1_g1000 * v2y);
    cse_p501_t151_g845 = (cse_p1_t23_g680 * cse_p507_t1_g1000 * v2z);
    cse_p501_t166_g860 = (cse_p501_t12_g706 + cse_p501_t97_g791);
    cse_p501_t167_g861 = (cse_p501_t13_g707 + cse_p501_t96_g790);
    cse_p501_t168_g862 = (cse_p501_t14_g708 + cse_p501_t93_g787);
    cse_p501_t169_g863 = (cse_p501_t15_g709 + cse_p501_t94_g788);
    cse_p501_t170_g864 = (cse_p501_t16_g710 + cse_p501_t95_g789);
    cse_p501_t171_g865 = (cse_p501_t17_g711 + cse_p501_t92_g786);
    cse_p501_t175_g869 = (cse_p501_t110_g804 + cse_p501_t22_g716);
    cse_p501_t176_g870 = (cse_p501_t111_g805 + cse_p501_t23_g717);
    cse_p501_t177_g871 = (cse_p501_t112_g806 + cse_p501_t24_g718);
    cse_p501_t178_g872 = (cse_p501_t114_g808 + cse_p501_t25_g719);
    cse_p501_t179_g873 = (cse_p501_t115_g809 + cse_p501_t26_g720);
    cse_p501_t180_g874 = (cse_p501_t113_g807 + cse_p501_t27_g721);
    cse_p501_t181_g875 = (cse_p504_t1_g978 + cse_p508_t1_g1013);
    cse_p501_t182_g876 = (cse_p504_t1_g975 + cse_p508_t1_g1014);
    cse_p501_t183_g877 = (cse_p504_t1_g976 + cse_p508_t1_g1015);
    cse_p501_t184_g878 = (cse_p504_t1_g977 + cse_p552_t1_g1024);
    cse_p501_t185_g879 = (cse_p504_t1_g974 + cse_p552_t1_g1025);
    cse_p501_t186_g880 = (cse_p504_t1_g973 + cse_p552_t1_g1026);
    cse_p501_t187_g881 = (cse_p507_t1_g1003 + cse_p507_t1_g1008);
    cse_p501_t188_g882 = (cse_p507_t1_g1004 + cse_p507_t1_g1009);
    cse_p501_t189_g883 = (cse_p507_t1_g1005 + cse_p508_t1_g1010);
    cse_p501_t193_g887 = (cse_p507_t1_g1006 + cse_p602_t1_g1037);
    cse_p501_t194_g888 = (cse_p501_t44_g738 + cse_p507_t1_g1007);
    cse_p501_t220_g914 = (cse_p1_t30_g687 + ((t2) * (t2)));
    cse_p501_t227_g921 = (-(cse_p501_t1_g695));
    cse_p501_t228_g922 = (-(cse_p501_t2_g696));
    cse_p501_t229_g923 = (-(cse_p501_t3_g697));
    cse_p501_t230_g924 = (-(cse_p501_t4_g698));
    cse_p501_t231_g925 = (-(cse_p501_t5_g699));
    cse_p501_t232_g926 = (-(cse_p501_t6_g700));
    cse_p501_t233_g927 = (-(cse_p501_t7_g701));
    cse_p501_t234_g928 = (-(cse_p501_t8_g702));
    cse_p501_t235_g929 = (-(cse_p501_t9_g703));
    cse_p501_t236_g930 = (-(cse_p501_t10_g704));
    cse_p501_t237_g931 = (-(cse_p501_t11_g705));
    cse_p501_t263_g957 = pow(cse_p501_t220_g914, -1);
    cse_p501_t264_g958 = pow(cse_p501_t220_g914, -2);
    cse_p1_t31_g688 = ((t2) * (t2));
    phi = atan2(t1, t2);
    nphi = (n * phi);
    cse_p1_t1_g693 = (cosphase * (-(sin(nphi))));
    cse_p1_t1_g694 = (sinphase * cos(nphi));
    cse_p1_t10_g667 = (cse_p1_t1_g693 + cse_p1_t1_g694);
    cse_p1_t18_g675 = (-(sin(nphi)));
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
    cse_p1_t1_g690 = (cse_p1_t10_g667 * cse_p501_t263_g957 * n * v);
    g_x1 = (cse_p1_t1_g690 * (cse_p501_t113_g807 + (cse_p1_t19_g676 * cse_p501_t207_g901)));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (cse_p1_t1_g690 * (cse_p501_t114_g808 + (cse_p1_t19_g676 * cse_p501_t204_g898)));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (cse_p1_t1_g690 * (cse_p501_t115_g809 + (cse_p1_t19_g676 * cse_p501_t206_g900)));
    KernelGradientAcc(i3x1, 2, g_z1);
    cse_p1_t1_g691 = (cse_p1_t32_g689 * cse_p501_t205_g899);
    g_x2 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * (cse_p501_t67_g761 + cse_p501_t71_g765 + cse_p501_t87_g781 + (c2y * (cse_p1_t22_g679 + cse_p1_t25_g682)))) + (t2 * ((cse_p1_t1_g691 * cse_p1_t23_g680) + (v2_len * (c2x + cse_p501_t127_g821 + (cse_p1_t27_g684 * v1z)))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * (cse_p501_t59_g753 + cse_p501_t73_g767 + cse_p501_t75_g769 + (c2z * (cse_p1_t20_g677 + cse_p1_t23_g680)))) + (t2 * ((cse_p1_t1_g691 * cse_p1_t24_g681) + (v2_len * (c2y + cse_p501_t133_g827 + (cse_p1_t28_g685 * v1x)))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * (cse_p501_t61_g755 + cse_p501_t65_g759 + cse_p501_t81_g775 + (c2x * (cse_p1_t21_g678 + cse_p1_t24_g681)))) + (t2 * ((cse_p1_t1_g691 * cse_p1_t25_g682) + (v2_len * (c2z + cse_p501_t121_g815 + (cse_p1_t26_g683 * v1y)))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    g_x3 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * cse_p501_t201_g895) + (t2 * ((cse_p1_t1_g691 * v2x) + (v2_len * ((cse_p1_t16_g673 * v1z) + (cse_p501_t219_g913 * v1y)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * cse_p501_t196_g890) + (t2 * ((cse_p1_t1_g691 * v2y) + (v2_len * ((cse_p1_t17_g674 * v1x) + (cse_p501_t217_g911 * v1z)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * cse_p501_t195_g889) + (t2 * ((cse_p1_t1_g691 * v2z) + (v2_len * ((cse_p1_t15_g672 * v1y) + (cse_p501_t218_g912 * v1x)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    g_x4 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * cse_p501_t202_g896) + (cse_p551_t1_g1018 * (cse_p1_t7_g664 + (cse_p1_t24_g681 * v1z)))));
    KernelGradientAcc(i3x4, 0, g_x4);
    g_y4 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * cse_p501_t197_g891) + (cse_p551_t1_g1018 * (cse_p1_t8_g665 + (cse_p1_t25_g682 * v1x)))));
    KernelGradientAcc(i3x4, 1, g_y4);
    g_z4 = (cse_p1_t1_g690 * ((cse_p1_t19_g676 * cse_p501_t199_g893) + (cse_p551_t1_g1018 * (cse_p1_t6_g663 + (cse_p1_t23_g680 * v1y)))));
    KernelGradientAcc(i3x4, 2, g_z4);
    cse_p503_t1_g961 = (cos_angle * cse_p501_t263_g957 * cse_p501_t263_g957 * n);
    cse_p503_t1_g962 = (cse_p501_t262_g956 * n);
    cse_p503_t1_g964 = (cse_p501_t263_g957 * v2_len);
    cse_p505_t1_g985 = (cse_p501_t207_g901 * cse_p501_t263_g957);
    cse_p505_t1_g986 = (cse_p501_t259_g953 * cse_p503_t1_g964);
    h_x1_x1 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p501_t180_g874 * cse_p503_t1_g961) + (sin_angle * ((cse_p501_t207_g901 * cse_p505_t1_g986) + (-((cse_p501_t180_g874 * cse_p501_t264_g958 * ((cse_p501_t207_g901 * cse_p503_t1_g967) + (cse_p501_t259_g953 * cse_p505_t1_g982))))) + (-((cse_p501_t259_g953 * cse_p505_t1_g985 * v2_len)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
    cse_p553_t1_g1034 = (cse_p501_t178_g872 * cse_p503_t1_g961);
    h_x1_y1 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p553_t1_g1034) + (sin_angle * ((cse_p501_t180_g874 * cse_p501_t236_g930) + (cse_p501_t204_g898 * cse_p505_t1_g986) + (cse_p501_t254_g948 * cse_p505_t1_g985)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
    h_x1_z1 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p501_t180_g874 * cse_p503_t1_g961) + (sin_angle * ((cse_p501_t180_g874 * cse_p501_t237_g931) + (cse_p501_t206_g900 * cse_p505_t1_g986) + (cse_p501_t255_g949 * cse_p505_t1_g985)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
    cse_p503_t1_g963 = (cse_p1_t19_g676 * cse_p501_t263_g957);
    cse_p508_t1_g1016 = (cse_p501_t171_g865 * cse_p503_t1_g961);
    h_x1_x2 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p508_t1_g1016) + (sin_angle * ((cse_p501_t180_g874 * cse_p501_t227_g921) + (cse_p501_t203_g897 * cse_p505_t1_g986) + (cse_p501_t248_g942 * cse_p505_t1_g985) + (cse_p503_t1_g963 * (cse_p501_t154_g848 + (cse_p1_t24_g681 * cse_p1_t27_g684))) + (-(cse_p501_t99_g793))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
    cse_p504_t1_g972 = (cse_p503_t1_g964 * t2);
    cse_p506_t1_g990 = (cse_p501_t168_g862 * cse_p503_t1_g961);
    h_x1_y2 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t180_g874 * cse_p501_t228_g922) + (cse_p501_t198_g892 * cse_p505_t1_g986) + (cse_p501_t249_g943 * cse_p505_t1_g985) + (cse_p503_t1_g963 * (c2z + (cse_p1_t24_g681 * v3x))) + (cse_p504_t1_g972 * v3z) + (-(cse_p501_t103_g797))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
    cse_p507_t1_g1001 = (cse_p501_t169_g863 * cse_p503_t1_g961);
    h_x1_z2 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p507_t1_g1001) + (sin_angle * ((cse_p1_t27_g684 * cse_p504_t1_g972) + (cse_p501_t180_g874 * cse_p501_t229_g923) + (cse_p501_t200_g894 * cse_p505_t1_g986) + (cse_p501_t250_g944 * cse_p505_t1_g985) + (cse_p503_t1_g963 * (cse_p501_t260_g954 + (cse_p1_t26_g683 * v2z))) + (-(cse_p501_t107_g801))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
    cse_p508_t1_g1011 = (cse_p501_t170_g864 * cse_p503_t1_g961);
    h_x1_x3 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p508_t1_g1011) + (sin_angle * (cse_p501_t99_g793 + (cse_p501_t180_g874 * cse_p501_t230_g924) + (cse_p501_t201_g895 * cse_p505_t1_g986) + (cse_p501_t251_g945 * cse_p505_t1_g985) + (cse_p503_t1_g963 * ((cse_p1_t16_g673 * cse_p1_t24_g681) + (cse_p501_t219_g913 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
    cse_p505_t1_g987 = (cse_p501_t167_g861 * cse_p503_t1_g961);
    h_x1_y3 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p505_t1_g987) + (sin_angle * (cse_p501_t103_g797 + (cse_p501_t180_g874 * cse_p501_t231_g925) + (cse_p501_t196_g890 * cse_p505_t1_g986) + (cse_p501_t219_g913 * cse_p504_t1_g972) + (cse_p501_t252_g946 * cse_p505_t1_g985) + (cse_p503_t1_g963 * (cse_p501_t261_g955 + (cse_p1_t24_g681 * cse_p501_t217_g911)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
    cse_p505_t1_g984 = (cse_p501_t166_g860 * cse_p503_t1_g961);
    h_x1_z3 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p505_t1_g984) + (sin_angle * (cse_p501_t107_g801 + (cse_p1_t16_g673 * cse_p504_t1_g972) + (cse_p501_t180_g874 * cse_p501_t232_g926) + (cse_p501_t195_g889 * cse_p505_t1_g986) + (cse_p501_t253_g947 * cse_p505_t1_g985) + (cse_p503_t1_g963 * (c2y + (cse_p1_t15_g672 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
    cse_p552_t1_g1030 = (cse_p501_t177_g871 * cse_p503_t1_g961);
    h_x1_x4 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p552_t1_g1030) + (sin_angle * ((cse_p501_t180_g874 * cse_p501_t235_g929) + (cse_p501_t202_g896 * cse_p505_t1_g986) + (cse_p501_t247_g941 * cse_p505_t1_g985) + (cse_p503_t1_g963 * (cse_p704_t1_g1040 + (cse_p1_t24_g681 * cse_p1_t24_g681)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 0, h_x1_x4);
    cse_p552_t1_g1022 = (cse_p501_t175_g869 * cse_p503_t1_g961);
    h_x1_y4 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p552_t1_g1022) + (sin_angle * (cse_p501_t135_g829 + (cse_p501_t180_g874 * cse_p501_t233_g927) + (cse_p501_t197_g891 * cse_p505_t1_g986) + (cse_p501_t245_g939 * cse_p505_t1_g985) + (cse_p504_t1_g972 * v2z)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 1, h_x1_y4);
    cse_p552_t1_g1023 = (cse_p501_t176_g870 * cse_p503_t1_g961);
    h_x1_z4 = (cse_p503_t1_g962 * ((cse_p501_t180_g874 * cse_p552_t1_g1023) + (sin_angle * (cse_p501_t151_g845 + (cse_p1_t24_g681 * cse_p504_t1_g972) + (cse_p501_t180_g874 * cse_p501_t234_g928) + (cse_p501_t199_g893 * cse_p505_t1_g986) + (cse_p501_t246_g940 * cse_p505_t1_g985)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 2, h_x1_z4);
    cse_p505_t1_g988 = (cse_p501_t204_g898 * cse_p501_t263_g957);
    cse_p505_t1_g989 = (cse_p501_t260_g954 * cse_p503_t1_g964);
    h_y1_y1 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p553_t1_g1034) + (sin_angle * ((cse_p501_t178_g872 * cse_p501_t236_g930) + (cse_p501_t204_g898 * cse_p505_t1_g989) + (cse_p501_t254_g948 * cse_p505_t1_g988)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
    h_y1_z1 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p553_t1_g1034) + (sin_angle * ((cse_p501_t178_g872 * cse_p501_t237_g931) + (cse_p501_t206_g900 * cse_p505_t1_g989) + (cse_p501_t255_g949 * cse_p505_t1_g988)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
    h_y1_x2 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p508_t1_g1016) + (sin_angle * ((cse_p1_t28_g685 * cse_p504_t1_g972) + (cse_p501_t178_g872 * cse_p501_t227_g921) + (cse_p501_t203_g897 * cse_p505_t1_g989) + (cse_p501_t248_g942 * cse_p505_t1_g988) + (cse_p503_t1_g963 * (cse_p501_t261_g955 + (cse_p1_t27_g684 * v2x))) + (-(cse_p501_t100_g794))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
    h_y1_y2 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t178_g872 * cse_p501_t228_g922) + (cse_p501_t198_g892 * cse_p505_t1_g989) + (cse_p501_t249_g943 * cse_p505_t1_g988) + (cse_p503_t1_g963 * (cse_p501_t142_g836 + (cse_p1_t25_g682 * cse_p1_t28_g685))) + (-(cse_p501_t104_g798))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
    h_y1_z2 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t178_g872 * cse_p501_t229_g923) + (cse_p501_t200_g894 * cse_p505_t1_g989) + (cse_p501_t250_g944 * cse_p505_t1_g988) + (cse_p503_t1_g963 * (c2x + (cse_p1_t25_g682 * v3y))) + (cse_p504_t1_g972 * v3x) + (-(cse_p501_t108_g802))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
    h_y1_x3 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p508_t1_g1011) + (sin_angle * (cse_p501_t100_g794 + (cse_p1_t17_g674 * cse_p504_t1_g972) + (cse_p501_t178_g872 * cse_p501_t230_g924) + (cse_p501_t201_g895 * cse_p505_t1_g989) + (cse_p501_t251_g945 * cse_p505_t1_g988) + (cse_p503_t1_g963 * (c2z + (cse_p1_t16_g673 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
    h_y1_y3 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p505_t1_g987) + (sin_angle * (cse_p501_t104_g798 + (cse_p501_t178_g872 * cse_p501_t231_g925) + (cse_p501_t196_g890 * cse_p505_t1_g989) + (cse_p501_t252_g946 * cse_p505_t1_g988) + (cse_p503_t1_g963 * ((cse_p1_t17_g674 * cse_p1_t25_g682) + (cse_p501_t217_g911 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
    h_y1_z3 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p505_t1_g984) + (sin_angle * (cse_p501_t108_g802 + (cse_p501_t178_g872 * cse_p501_t232_g926) + (cse_p501_t195_g889 * cse_p505_t1_g989) + (cse_p501_t217_g911 * cse_p504_t1_g972) + (cse_p501_t253_g947 * cse_p505_t1_g988) + (cse_p503_t1_g963 * (cse_p501_t259_g953 + (cse_p1_t25_g682 * cse_p501_t218_g912)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
    h_y1_x4 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p552_t1_g1030) + (sin_angle * (cse_p501_t135_g829 + (cse_p1_t25_g682 * cse_p504_t1_g972) + (cse_p501_t178_g872 * cse_p501_t235_g929) + (cse_p501_t202_g896 * cse_p505_t1_g989) + (cse_p501_t247_g941 * cse_p505_t1_g988)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 0, h_y1_x4);
    h_y1_y4 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p552_t1_g1022) + (sin_angle * ((cse_p501_t178_g872 * cse_p501_t233_g927) + (cse_p501_t197_g891 * cse_p505_t1_g989) + (cse_p501_t245_g939 * cse_p505_t1_g988) + (cse_p503_t1_g963 * (cse_p501_t137_g831 + (cse_p1_t25_g682 * cse_p1_t25_g682)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 1, h_y1_y4);
    h_y1_z4 = (cse_p503_t1_g962 * ((cse_p501_t178_g872 * cse_p552_t1_g1023) + (sin_angle * (cse_p501_t144_g838 + (cse_p501_t178_g872 * cse_p501_t234_g928) + (cse_p501_t199_g893 * cse_p505_t1_g989) + (cse_p501_t246_g940 * cse_p505_t1_g988) + (cse_p504_t1_g972 * v2x)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 2, h_y1_z4);
    cse_p506_t1_g997 = (cse_p501_t206_g900 * cse_p501_t263_g957);
    cse_p506_t1_g998 = (cse_p501_t261_g955 * cse_p503_t1_g964);
    h_z1_z1 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p501_t179_g873 * cse_p503_t1_g961) + (sin_angle * ((cse_p501_t179_g873 * cse_p501_t237_g931) + (cse_p501_t206_g900 * cse_p506_t1_g998) + (cse_p501_t255_g949 * cse_p506_t1_g997)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
    h_z1_x2 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p508_t1_g1016) + (sin_angle * ((cse_p501_t179_g873 * cse_p501_t227_g921) + (cse_p501_t203_g897 * cse_p506_t1_g998) + (cse_p501_t248_g942 * cse_p506_t1_g997) + (cse_p503_t1_g963 * (c2y + (cse_p1_t23_g680 * v3z))) + (cse_p504_t1_g972 * v3y) + (-(cse_p501_t101_g795))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
    h_z1_y2 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p506_t1_g990) + (sin_angle * ((cse_p1_t26_g683 * cse_p504_t1_g972) + (cse_p501_t179_g873 * cse_p501_t228_g922) + (cse_p501_t198_g892 * cse_p506_t1_g998) + (cse_p501_t249_g943 * cse_p506_t1_g997) + (cse_p503_t1_g963 * (cse_p501_t259_g953 + (cse_p1_t28_g685 * v2y))) + (-(cse_p501_t105_g799))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
    h_z1_z2 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t179_g873 * cse_p501_t229_g923) + (cse_p501_t200_g894 * cse_p506_t1_g998) + (cse_p501_t250_g944 * cse_p506_t1_g997) + (cse_p503_t1_g963 * (cse_p501_t149_g843 + (cse_p1_t23_g680 * cse_p1_t26_g683))) + (-(cse_p501_t109_g803))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
    h_z1_x3 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p508_t1_g1011) + (sin_angle * (cse_p501_t101_g795 + (cse_p501_t179_g873 * cse_p501_t230_g924) + (cse_p501_t201_g895 * cse_p506_t1_g998) + (cse_p501_t218_g912 * cse_p504_t1_g972) + (cse_p501_t251_g945 * cse_p506_t1_g997) + (cse_p503_t1_g963 * (cse_p501_t260_g954 + (cse_p1_t23_g680 * cse_p501_t219_g913)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
    h_z1_y3 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p505_t1_g987) + (sin_angle * (cse_p501_t105_g799 + (cse_p1_t15_g672 * cse_p504_t1_g972) + (cse_p501_t179_g873 * cse_p501_t231_g925) + (cse_p501_t196_g890 * cse_p506_t1_g998) + (cse_p501_t252_g946 * cse_p506_t1_g997) + (cse_p503_t1_g963 * (c2x + (cse_p1_t17_g674 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
    h_z1_z3 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p505_t1_g984) + (sin_angle * (cse_p501_t109_g803 + (cse_p501_t179_g873 * cse_p501_t232_g926) + (cse_p501_t195_g889 * cse_p506_t1_g998) + (cse_p501_t253_g947 * cse_p506_t1_g997) + (cse_p503_t1_g963 * ((cse_p1_t15_g672 * cse_p1_t23_g680) + (cse_p501_t218_g912 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
    h_z1_x4 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p552_t1_g1030) + (sin_angle * (cse_p501_t151_g845 + (cse_p501_t179_g873 * cse_p501_t235_g929) + (cse_p501_t202_g896 * cse_p506_t1_g998) + (cse_p501_t247_g941 * cse_p506_t1_g997) + (cse_p504_t1_g972 * v2y)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 0, h_z1_x4);
    h_z1_y4 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p552_t1_g1022) + (sin_angle * (cse_p501_t144_g838 + (cse_p1_t23_g680 * cse_p504_t1_g972) + (cse_p501_t179_g873 * cse_p501_t233_g927) + (cse_p501_t197_g891 * cse_p506_t1_g998) + (cse_p501_t245_g939 * cse_p506_t1_g997)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 1, h_z1_y4);
    h_z1_z4 = (cse_p503_t1_g962 * ((cse_p501_t179_g873 * cse_p552_t1_g1023) + (sin_angle * ((cse_p501_t179_g873 * cse_p501_t234_g928) + (cse_p501_t199_g893 * cse_p506_t1_g998) + (cse_p501_t246_g940 * cse_p506_t1_g997) + (cse_p503_t1_g963 * (cse_p653_t1_g1039 + (cse_p1_t23_g680 * cse_p1_t23_g680)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 2, h_z1_z4);
    cse_p503_t1_g968 = (cse_p501_t263_g957 * t2);
    cse_p506_t1_g996 = (cse_p501_t203_g897 * cse_p501_t263_g957);
    cse_p552_t1_g1021 = (2.0000000000000000     * cse_p1_t32_g689);
    h_x2_x2 = (cse_p503_t1_g962 * ((cse_p501_t171_g865 * cse_p508_t1_g1016) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t227_g921) + (cse_p501_t172_g866 * cse_p506_t1_g996) + (cse_p501_t248_g942 * cse_p506_t1_g996) + (cse_p503_t1_g963 * (cse_p501_t29_g723 + cse_p501_t29_g723 + (2.0000000000000000     * cse_p501_t216_g910 * v3z))) + (cse_p503_t1_g968 * (cse_p501_t239_g933 + cse_p503_t1_g960 + (cse_p1_t23_g680 * cse_p501_t221_g915 * cse_p552_t1_g1021)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
    cse_p506_t1_g993 = (cse_p501_t198_g892 * cse_p501_t263_g957);
    h_x2_y2 = (cse_p503_t1_g962 * ((cse_p501_t171_g865 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t228_g922) + (cse_p501_t172_g866 * cse_p506_t1_g993) + (cse_p501_t249_g943 * cse_p506_t1_g996) + (cse_p503_t1_g963 * ((cse_p1_t27_g684 * cse_p501_t214_g908) + (cse_p501_t225_g919 * v3x))) + (cse_p503_t1_g968 * (cse_p501_t240_g934 + (cse_p1_t32_g689 * ((cse_p1_t23_g680 * cse_p501_t222_g916) + (cse_p1_t24_g681 * cse_p501_t221_g915)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
    cse_p506_t1_g994 = (cse_p501_t200_g894 * cse_p501_t263_g957);
    h_x2_z2 = (cse_p503_t1_g962 * ((cse_p501_t171_g865 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t229_g923) + (cse_p501_t172_g866 * cse_p506_t1_g994) + (cse_p501_t250_g944 * cse_p506_t1_g996) + (cse_p503_t1_g963 * ((cse_p1_t26_g683 * cse_p501_t216_g910) + (cse_p501_t224_g918 * v3z))) + (cse_p503_t1_g968 * (cse_p501_t241_g935 + (cse_p1_t32_g689 * ((cse_p1_t23_g680 * cse_p501_t223_g917) + (cse_p1_t25_g682 * cse_p501_t221_g915)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
    cse_p506_t1_g995 = (cse_p501_t201_g895 * cse_p501_t263_g957);
    cse_p553_t1_g1036 = (cse_p501_t205_g899 * cse_p501_t265_g959);
    h_x2_x3 = (cse_p503_t1_g962 * ((cse_p501_t171_g865 * cse_p508_t1_g1011) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t230_g924) + (cse_p501_t172_g866 * cse_p506_t1_g995) + (cse_p501_t251_g945 * cse_p506_t1_g996) + (cse_p503_t1_g963 * ((cse_p1_t16_g673 * cse_p501_t225_g919) + (cse_p1_t21_g678 * cse_p1_t27_g684) + (cse_p501_t216_g910 * cse_p501_t219_g913) + (v1z * v3z))) + (cse_p503_t1_g968 * (cse_p501_t238_g932 + (cse_p1_t32_g689 * ((cse_p1_t23_g680 * cse_p501_t212_g906) + (cse_p501_t221_g915 * v2x) + (cse_p553_t1_g1036 * v2x * v2x)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
    cse_p506_t1_g992 = (cse_p501_t196_g890 * cse_p501_t263_g957);
    h_x2_y3 = (cse_p503_t1_g962 * ((cse_p501_t171_g865 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t231_g925) + (cse_p501_t172_g866 * cse_p506_t1_g992) + (cse_p501_t252_g946 * cse_p506_t1_g996) + (cse_p503_t1_g963 * (c1z + c2z + (cse_p1_t27_g684 * v1x) + (cse_p501_t217_g911 * cse_p501_t225_g919))) + (cse_p503_t1_g968 * ((cse_p1_t32_g689 * (cse_p501_t139_g833 + (cse_p1_t23_g680 * cse_p501_t209_g903) + (cse_p501_t221_g915 * v2y))) + (v2_len * (v1z + v2z + v3z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
    cse_p506_t1_g991 = (cse_p501_t195_g889 * cse_p501_t263_g957);
    h_x2_z3 = (cse_p503_t1_g962 * ((cse_p501_t171_g865 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t232_g926) + (cse_p501_t172_g866 * cse_p506_t1_g991) + (cse_p501_t253_g947 * cse_p506_t1_g996) + (cse_p503_t1_g963 * (cse_p501_t257_g951 + cse_p501_t260_g954 + (cse_p1_t15_g672 * cse_p501_t216_g910) + (cse_p1_t20_g677 * v3z))) + (cse_p503_t1_g968 * ((cse_p1_t32_g689 * (cse_p501_t141_g835 + (cse_p1_t23_g680 * cse_p501_t208_g902) + (cse_p501_t221_g915 * v2z))) + (v2_len * (cse_p1_t21_g678 + cse_p1_t24_g681 + cse_p1_t27_g684))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
    cse_p507_t1_g1002 = (cse_p501_t202_g896 * cse_p501_t263_g957);
    h_x2_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p508_t1_g1016) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t235_g929) + (cse_p501_t172_g866 * cse_p507_t1_g1002) + (cse_p501_t247_g941 * cse_p506_t1_g996) + (cse_p503_t1_g963 * ((cse_p1_t24_g681 * cse_p501_t225_g919) + (cse_p501_t216_g910 * v2z))) + (-(cse_p501_t98_g792))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 0, h_x2_x4);
    cse_p508_t1_g1012 = (cse_p501_t197_g891 * cse_p501_t263_g957);
    cse_p552_t1_g1027 = (cse_p1_t32_g689 * cse_p501_t210_g904);
    h_x2_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p508_t1_g1016) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t233_g927) + (cse_p501_t172_g866 * cse_p508_t1_g1012) + (cse_p501_t245_g939 * cse_p506_t1_g996) + (cse_p503_t1_g963 * (cse_p501_t258_g952 + (cse_p501_t225_g919 * v2x))) + (cse_p503_t1_g968 * ((cse_p1_t23_g680 * cse_p552_t1_g1027) + (cse_p501_t216_g910 * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 1, h_x2_y4);
    cse_p508_t1_g1017 = (cse_p501_t199_g893 * cse_p501_t263_g957);
    cse_p552_t1_g1028 = (cse_p1_t32_g689 * cse_p501_t211_g905);
    h_x2_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p508_t1_g1016) + (sin_angle * ((cse_p501_t171_g865 * cse_p501_t234_g928) + (cse_p501_t172_g866 * cse_p508_t1_g1017) + (cse_p501_t246_g940 * cse_p506_t1_g996) + (cse_p503_t1_g963 * (c1y + (cse_p1_t23_g680 * cse_p501_t216_g910))) + (cse_p503_t1_g968 * ((cse_p1_t23_g680 * cse_p552_t1_g1028) + (cse_p501_t225_g919 * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 2, h_x2_z4);
    h_y2_y2 = (cse_p503_t1_g962 * ((cse_p501_t168_g862 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t228_g922) + (cse_p501_t173_g867 * cse_p506_t1_g993) + (cse_p501_t249_g943 * cse_p506_t1_g993) + (cse_p503_t1_g963 * (cse_p501_t30_g724 + cse_p501_t30_g724 + (2.0000000000000000     * cse_p501_t214_g908 * v3x))) + (cse_p503_t1_g968 * (cse_p501_t242_g936 + cse_p503_t1_g960 + (cse_p1_t24_g681 * cse_p501_t222_g916 * cse_p552_t1_g1021)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
    h_y2_z2 = (cse_p503_t1_g962 * ((cse_p501_t169_g863 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t229_g923) + (cse_p501_t173_g867 * cse_p506_t1_g994) + (cse_p501_t250_g944 * cse_p506_t1_g993) + (cse_p503_t1_g963 * ((cse_p1_t28_g685 * cse_p501_t215_g909) + (cse_p501_t226_g920 * v3y))) + (cse_p503_t1_g968 * (cse_p501_t243_g937 + (cse_p1_t32_g689 * ((cse_p1_t24_g681 * cse_p501_t223_g917) + (cse_p1_t25_g682 * cse_p501_t222_g916)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
    h_y2_x3 = (cse_p503_t1_g962 * ((cse_p501_t170_g864 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t230_g924) + (cse_p501_t173_g867 * cse_p506_t1_g995) + (cse_p501_t251_g945 * cse_p506_t1_g993) + (cse_p503_t1_g963 * (cse_p501_t258_g952 + cse_p501_t261_g955 + (cse_p1_t16_g673 * cse_p501_t214_g908) + (cse_p1_t21_g678 * v3x))) + (cse_p503_t1_g968 * ((cse_p1_t32_g689 * (cse_p501_t139_g833 + (cse_p1_t24_g681 * cse_p501_t212_g906) + (cse_p501_t222_g916 * v2x))) + (v2_len * (cse_p1_t22_g679 + cse_p1_t25_g682 + cse_p1_t28_g685))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
    h_y2_y3 = (cse_p503_t1_g962 * ((cse_p501_t168_g862 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t231_g925) + (cse_p501_t173_g867 * cse_p506_t1_g992) + (cse_p501_t252_g946 * cse_p506_t1_g993) + (cse_p503_t1_g963 * ((cse_p1_t17_g674 * cse_p501_t226_g920) + (cse_p1_t22_g679 * cse_p1_t28_g685) + (cse_p501_t214_g908 * cse_p501_t217_g911) + (v1x * v3x))) + (cse_p503_t1_g968 * (cse_p501_t238_g932 + (cse_p1_t32_g689 * ((cse_p1_t24_g681 * cse_p501_t209_g903) + (cse_p501_t222_g916 * v2y) + (cse_p553_t1_g1036 * cse_p653_t1_g1039)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
    h_y2_z3 = (cse_p503_t1_g962 * ((cse_p501_t168_g862 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t232_g926) + (cse_p501_t173_g867 * cse_p506_t1_g991) + (cse_p501_t253_g947 * cse_p506_t1_g993) + (cse_p503_t1_g963 * (c1x + c2x + (cse_p1_t28_g685 * v1y) + (cse_p501_t218_g912 * cse_p501_t226_g920))) + (cse_p503_t1_g968 * ((cse_p1_t32_g689 * (cse_p501_t148_g842 + (cse_p1_t24_g681 * cse_p501_t208_g902) + (cse_p501_t222_g916 * v2z))) + (v2_len * (v1x + v2x + v3x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
    cse_p552_t1_g1029 = (cse_p1_t32_g689 * cse_p501_t213_g907);
    h_y2_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t235_g929) + (cse_p501_t173_g867 * cse_p507_t1_g1002) + (cse_p501_t247_g941 * cse_p506_t1_g993) + (cse_p503_t1_g963 * (c1z + (cse_p1_t24_g681 * cse_p501_t214_g908))) + (cse_p503_t1_g968 * ((cse_p1_t24_g681 * cse_p552_t1_g1029) + (cse_p501_t226_g920 * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 0, h_y2_x4);
    h_y2_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t233_g927) + (cse_p501_t173_g867 * cse_p508_t1_g1012) + (cse_p501_t245_g939 * cse_p506_t1_g993) + (cse_p503_t1_g963 * ((cse_p1_t25_g682 * cse_p501_t226_g920) + (cse_p501_t214_g908 * v2x))) + (-(cse_p501_t102_g796))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 1, h_y2_y4);
    h_y2_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p506_t1_g990) + (sin_angle * ((cse_p501_t168_g862 * cse_p501_t234_g928) + (cse_p501_t173_g867 * cse_p508_t1_g1017) + (cse_p501_t246_g940 * cse_p506_t1_g993) + (cse_p503_t1_g963 * (cse_p501_t256_g950 + (cse_p501_t226_g920 * v2y))) + (cse_p503_t1_g968 * ((cse_p1_t24_g681 * cse_p552_t1_g1028) + (cse_p501_t214_g908 * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 2, h_y2_z4);
    h_z2_z2 = (cse_p503_t1_g962 * ((cse_p501_t169_g863 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t229_g923) + (cse_p501_t174_g868 * cse_p506_t1_g994) + (cse_p501_t250_g944 * cse_p506_t1_g994) + (cse_p503_t1_g963 * (cse_p501_t28_g722 + cse_p501_t28_g722 + (2.0000000000000000     * cse_p501_t215_g909 * v3y))) + (cse_p503_t1_g968 * (cse_p501_t244_g938 + cse_p503_t1_g960 + (cse_p1_t25_g682 * cse_p501_t223_g917 * cse_p552_t1_g1021)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
    h_z2_x3 = (cse_p503_t1_g962 * ((cse_p501_t170_g864 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t230_g924) + (cse_p501_t174_g868 * cse_p506_t1_g995) + (cse_p501_t251_g945 * cse_p506_t1_g994) + (cse_p503_t1_g963 * (c1y + c2y + (cse_p1_t26_g683 * v1z) + (cse_p501_t219_g913 * cse_p501_t224_g918))) + (cse_p503_t1_g968 * ((cse_p1_t32_g689 * (cse_p501_t141_g835 + (cse_p1_t25_g682 * cse_p501_t212_g906) + (cse_p501_t223_g917 * v2x))) + (v2_len * (v1y + v2y + v3y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
    h_z2_y3 = (cse_p503_t1_g962 * ((cse_p501_t169_g863 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t231_g925) + (cse_p501_t174_g868 * cse_p506_t1_g992) + (cse_p501_t252_g946 * cse_p506_t1_g994) + (cse_p503_t1_g963 * (cse_p501_t256_g950 + cse_p501_t259_g953 + (cse_p1_t17_g674 * cse_p501_t215_g909) + (cse_p1_t22_g679 * v3y))) + (cse_p503_t1_g968 * ((cse_p1_t32_g689 * (cse_p501_t148_g842 + (cse_p1_t25_g682 * cse_p501_t209_g903) + (cse_p501_t223_g917 * v2y))) + (v2_len * (cse_p1_t20_g677 + cse_p1_t23_g680 + cse_p1_t26_g683))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
    h_z2_z3 = (cse_p503_t1_g962 * ((cse_p501_t169_g863 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t232_g926) + (cse_p501_t174_g868 * cse_p506_t1_g991) + (cse_p501_t253_g947 * cse_p506_t1_g994) + (cse_p503_t1_g963 * ((cse_p1_t15_g672 * cse_p501_t224_g918) + (cse_p1_t20_g677 * cse_p1_t26_g683) + (cse_p501_t215_g909 * cse_p501_t218_g912) + (v1y * v3y))) + (cse_p503_t1_g968 * (cse_p501_t238_g932 + (cse_p1_t32_g689 * ((cse_p1_t25_g682 * cse_p501_t208_g902) + (cse_p501_t223_g917 * v2z) + (cse_p553_t1_g1036 * cse_p704_t1_g1040)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
    h_z2_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t235_g929) + (cse_p501_t174_g868 * cse_p507_t1_g1002) + (cse_p501_t247_g941 * cse_p506_t1_g994) + (cse_p503_t1_g963 * (cse_p501_t257_g951 + (cse_p501_t224_g918 * v2z))) + (cse_p503_t1_g968 * ((cse_p1_t25_g682 * cse_p552_t1_g1029) + (cse_p501_t215_g909 * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 0, h_z2_x4);
    h_z2_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t233_g927) + (cse_p501_t174_g868 * cse_p508_t1_g1012) + (cse_p501_t245_g939 * cse_p506_t1_g994) + (cse_p503_t1_g963 * (c1x + (cse_p1_t25_g682 * cse_p501_t215_g909))) + (cse_p503_t1_g968 * ((cse_p1_t25_g682 * cse_p552_t1_g1027) + (cse_p501_t224_g918 * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 1, h_z2_y4);
    h_z2_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p507_t1_g1001) + (sin_angle * ((cse_p501_t169_g863 * cse_p501_t234_g928) + (cse_p501_t174_g868 * cse_p508_t1_g1017) + (cse_p501_t246_g940 * cse_p506_t1_g994) + (cse_p503_t1_g963 * ((cse_p1_t23_g680 * cse_p501_t224_g918) + (cse_p501_t215_g909 * v2y))) + (-(cse_p501_t106_g800))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 2, h_z2_z4);
    h_x3_x3 = (cse_p503_t1_g962 * ((cse_p501_t170_g864 * cse_p508_t1_g1011) + (sin_angle * ((cse_p501_t170_g864 * cse_p501_t230_g924) + (cse_p501_t190_g884 * cse_p506_t1_g995) + (cse_p501_t251_g945 * cse_p506_t1_g995) + (cse_p503_t1_g963 * (cse_p501_t32_g726 + cse_p501_t32_g726 + (2.0000000000000000     * cse_p501_t219_g913 * v1z))) + (cse_p503_t1_g968 * (cse_p501_t239_g933 + cse_p503_t1_g960 + (cse_p501_t212_g906 * cse_p552_t1_g1021 * v2x)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
    h_x3_y3 = (cse_p503_t1_g962 * ((cse_p501_t170_g864 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t170_g864 * cse_p501_t231_g925) + (cse_p501_t190_g884 * cse_p506_t1_g992) + (cse_p501_t252_g946 * cse_p506_t1_g995) + (cse_p503_t1_g963 * ((cse_p1_t16_g673 * v1x) + (cse_p1_t21_g678 * cse_p501_t217_g911))) + (cse_p503_t1_g968 * (cse_p501_t240_g934 + (cse_p1_t32_g689 * ((cse_p501_t209_g903 * v2x) + (cse_p501_t212_g906 * v2y)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
    h_x3_z3 = (cse_p503_t1_g962 * ((cse_p501_t170_g864 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t170_g864 * cse_p501_t232_g926) + (cse_p501_t190_g884 * cse_p506_t1_g991) + (cse_p501_t253_g947 * cse_p506_t1_g995) + (cse_p503_t1_g963 * ((cse_p1_t15_g672 * v1z) + (cse_p1_t20_g677 * cse_p501_t219_g913))) + (cse_p503_t1_g968 * (cse_p501_t241_g935 + (cse_p1_t32_g689 * ((cse_p501_t208_g902 * v2x) + (cse_p501_t212_g906 * v2z)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
    h_x3_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p508_t1_g1011) + (sin_angle * (cse_p501_t98_g792 + (cse_p501_t170_g864 * cse_p501_t235_g929) + (cse_p501_t190_g884 * cse_p507_t1_g1002) + (cse_p501_t247_g941 * cse_p506_t1_g995) + (cse_p503_t1_g963 * (cse_p501_t132_g826 + (cse_p1_t21_g678 * cse_p1_t24_g681)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 0, h_x3_x4);
    h_x3_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p508_t1_g1011) + (sin_angle * ((cse_p501_t170_g864 * cse_p501_t233_g927) + (cse_p501_t190_g884 * cse_p508_t1_g1012) + (cse_p501_t245_g939 * cse_p506_t1_g995) + (cse_p503_t1_g963 * (c1z + (cse_p1_t21_g678 * v2x))) + (cse_p503_t1_g968 * ((cse_p552_t1_g1027 * v2x) + (v1z * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 1, h_x3_y4);
    h_x3_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p508_t1_g1011) + (sin_angle * ((cse_p501_t170_g864 * cse_p501_t234_g928) + (cse_p501_t190_g884 * cse_p508_t1_g1017) + (cse_p501_t246_g940 * cse_p506_t1_g995) + (cse_p503_t1_g963 * (cse_p501_t257_g951 + (cse_p1_t23_g680 * v1z))) + (cse_p503_t1_g968 * ((cse_p1_t21_g678 * v2_len) + (cse_p552_t1_g1028 * v2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 2, h_x3_z4);
    h_y3_y3 = (cse_p503_t1_g962 * ((cse_p501_t167_g861 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t167_g861 * cse_p501_t231_g925) + (cse_p501_t191_g885 * cse_p506_t1_g992) + (cse_p501_t252_g946 * cse_p506_t1_g992) + (cse_p503_t1_g963 * (cse_p501_t33_g727 + cse_p501_t33_g727 + (2.0000000000000000     * cse_p501_t217_g911 * v1x))) + (cse_p503_t1_g968 * (cse_p501_t242_g936 + cse_p503_t1_g960 + (cse_p501_t209_g903 * cse_p552_t1_g1021 * v2y)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
    h_y3_z3 = (cse_p503_t1_g962 * ((cse_p501_t167_g861 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t167_g861 * cse_p501_t232_g926) + (cse_p501_t191_g885 * cse_p506_t1_g991) + (cse_p501_t253_g947 * cse_p506_t1_g992) + (cse_p503_t1_g963 * ((cse_p1_t17_g674 * v1y) + (cse_p1_t22_g679 * cse_p501_t218_g912))) + (cse_p503_t1_g968 * (cse_p501_t243_g937 + (cse_p1_t32_g689 * ((cse_p501_t208_g902 * v2y) + (cse_p501_t209_g903 * v2z)))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
    h_y3_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t167_g861 * cse_p501_t235_g929) + (cse_p501_t191_g885 * cse_p507_t1_g1002) + (cse_p501_t247_g941 * cse_p506_t1_g992) + (cse_p503_t1_g963 * (cse_p501_t258_g952 + (cse_p1_t24_g681 * v1x))) + (cse_p503_t1_g968 * ((cse_p1_t22_g679 * v2_len) + (cse_p552_t1_g1029 * v2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 0, h_y3_x4);
    h_y3_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p505_t1_g987) + (sin_angle * (cse_p501_t102_g796 + (cse_p501_t167_g861 * cse_p501_t233_g927) + (cse_p501_t191_g885 * cse_p508_t1_g1012) + (cse_p501_t245_g939 * cse_p506_t1_g992) + (cse_p503_t1_g963 * (cse_p501_t120_g814 + (cse_p1_t22_g679 * cse_p1_t25_g682)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 1, h_y3_y4);
    h_y3_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p505_t1_g987) + (sin_angle * ((cse_p501_t167_g861 * cse_p501_t234_g928) + (cse_p501_t191_g885 * cse_p508_t1_g1017) + (cse_p501_t246_g940 * cse_p506_t1_g992) + (cse_p503_t1_g963 * (c1x + (cse_p1_t22_g679 * v2y))) + (cse_p503_t1_g968 * ((cse_p552_t1_g1028 * v2y) + (v1x * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 2, h_y3_z4);
    h_z3_z3 = (cse_p503_t1_g962 * ((cse_p501_t166_g860 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t166_g860 * cse_p501_t232_g926) + (cse_p501_t192_g886 * cse_p506_t1_g991) + (cse_p501_t253_g947 * cse_p506_t1_g991) + (cse_p503_t1_g963 * (cse_p501_t31_g725 + cse_p501_t31_g725 + (2.0000000000000000     * cse_p501_t218_g912 * v1y))) + (cse_p503_t1_g968 * (cse_p501_t244_g938 + cse_p503_t1_g960 + (cse_p501_t208_g902 * cse_p552_t1_g1021 * v2z)))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
    h_z3_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t166_g860 * cse_p501_t235_g929) + (cse_p501_t192_g886 * cse_p507_t1_g1002) + (cse_p501_t247_g941 * cse_p506_t1_g991) + (cse_p503_t1_g963 * (c1y + (cse_p1_t20_g677 * v2z))) + (cse_p503_t1_g968 * ((cse_p552_t1_g1029 * v2z) + (v1y * v2_len)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 0, h_z3_x4);
    h_z3_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p505_t1_g984) + (sin_angle * ((cse_p501_t166_g860 * cse_p501_t233_g927) + (cse_p501_t192_g886 * cse_p508_t1_g1012) + (cse_p501_t245_g939 * cse_p506_t1_g991) + (cse_p503_t1_g963 * (cse_p501_t256_g950 + (cse_p1_t25_g682 * v1y))) + (cse_p503_t1_g968 * ((cse_p1_t20_g677 * v2_len) + (cse_p552_t1_g1027 * v2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 1, h_z3_y4);
    h_z3_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p505_t1_g984) + (sin_angle * (cse_p501_t106_g800 + (cse_p501_t166_g860 * cse_p501_t234_g928) + (cse_p501_t192_g886 * cse_p508_t1_g1017) + (cse_p501_t246_g940 * cse_p506_t1_g991) + (cse_p503_t1_g963 * (cse_p501_t126_g820 + (cse_p1_t20_g677 * cse_p1_t23_g680)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 2, h_z3_z4);
    h_x4_x4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p552_t1_g1030) + (sin_angle * ((cse_p501_t177_g871 * cse_p501_t235_g929) + (cse_p501_t202_g896 * cse_p501_t213_g907 * cse_p503_t1_g964) + (cse_p501_t247_g941 * cse_p507_t1_g1002)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 0, h_x4_x4);
    h_x4_y4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p552_t1_g1022) + (sin_angle * ((cse_p501_t177_g871 * cse_p501_t233_g927) + (cse_p501_t197_g891 * cse_p501_t213_g907 * cse_p503_t1_g964) + (cse_p501_t245_g939 * cse_p507_t1_g1002)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 1, h_x4_y4);
    cse_p553_t1_g1035 = (cse_p501_t199_g893 * cse_p503_t1_g964);
    h_x4_z4 = (cse_p503_t1_g962 * ((cse_p501_t177_g871 * cse_p552_t1_g1023) + (sin_angle * ((cse_p501_t177_g871 * cse_p501_t234_g928) + (cse_p501_t213_g907 * cse_p553_t1_g1035) + (cse_p501_t246_g940 * cse_p507_t1_g1002)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 2, h_x4_z4);
    h_y4_y4 = (cse_p503_t1_g962 * ((cse_p501_t175_g869 * cse_p552_t1_g1022) + (sin_angle * ((cse_p501_t175_g869 * cse_p501_t233_g927) + (cse_p501_t197_g891 * cse_p501_t210_g904 * cse_p503_t1_g964) + (cse_p501_t245_g939 * cse_p508_t1_g1012)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 1, h_y4_y4);
    h_y4_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p552_t1_g1022) + (sin_angle * ((cse_p501_t175_g869 * cse_p501_t234_g928) + (cse_p501_t210_g904 * cse_p553_t1_g1035) + (cse_p501_t246_g940 * cse_p508_t1_g1012)))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 2, h_y4_z4);
    h_z4_z4 = (cse_p503_t1_g962 * ((cse_p501_t176_g870 * cse_p552_t1_g1023) + (sin_angle * ((cse_p501_t176_g870 * cse_p501_t234_g928) + (cse_p501_t211_g905 * cse_p553_t1_g1035) + (cse_p501_t246_g940 * cse_p508_t1_g1017)))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 2, i3x4, 2, h_z4_z4);
  }
}
void dihedral_hessian_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, double* hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x4, 0, hval);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 1, hval);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 1] = saved_j + h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    dihedral_energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 1, hval);
  }
}

