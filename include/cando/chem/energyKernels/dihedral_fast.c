template <typename HESSIAN>
struct Dihedral {
  static constexpr size_t PositionSize = 12;
  static std::string description() { return "mathkernel-dihedral_fast"; };
void energy(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c2x;
  double c2y;
  double c2z;
  double cos_angle;
  double cos_nphi;
  double energy;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_len;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    v1x = (x2 + (-(x1)));
    v1y = (y2 + (-(y1)));
    v1z = (z2 + (-(z1)));
    v2x = (x3 + (-(x2)));
    v2y = (y3 + (-(y2)));
    v2z = (z3 + (-(z2)));
    v3x = (x4 + (-(x3)));
    v3y = (y4 + (-(y3)));
    v3z = (z4 + (-(z3)));
    c1x = ((v1y * v2z) + (-((v1z * v2y))));
    c1y = ((v1z * v2x) + (-((v1x * v2z))));
    c1z = ((v1x * v2y) + (-((v1y * v2x))));
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
    v2_len = sqrt(v2_sq);
    t1 = (v2_len * ((c2x * v1x) + (c2y * v1y) + (c2z * v1z)));
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    phi = atan2(t1, t2);
    nphi = (n * phi);
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
  }
}
void energy_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, energy_accumulate, force, hessian, dvec, hdvec);
}

void gradient(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c2x;
  double c2y;
  double c2z;
  double cos_angle;
  double cos_nphi;
  double cse_p12_t10_g795;
  double cse_p12_t11_g796;
  double cse_p12_t12_g797;
  double cse_p12_t13_g798;
  double cse_p12_t14_g799;
  double cse_p12_t1_g786;
  double cse_p12_t1_g800;
  double cse_p12_t1_g801;
  double cse_p12_t1_g802;
  double cse_p12_t1_g803;
  double cse_p12_t1_g804;
  double cse_p12_t1_g805;
  double cse_p12_t2_g787;
  double cse_p12_t3_g788;
  double cse_p12_t4_g789;
  double cse_p12_t5_g790;
  double cse_p12_t6_g791;
  double cse_p12_t7_g792;
  double cse_p12_t8_g793;
  double cse_p12_t9_g794;
  double cse_p1_t1_sqrt783;
  double cse_p1_t2_invsqrt784;
  double cse_p1_t3_invr785;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    v1x = (x2 + (-(x1)));
    v1y = (y2 + (-(y1)));
    v1z = (z2 + (-(z1)));
    v2x = (x3 + (-(x2)));
    cse_p12_t6_g791 = (v1z * v2x);
    v2y = (y3 + (-(y2)));
    cse_p12_t4_g789 = (v1x * v2y);
    v2z = (z3 + (-(z2)));
    cse_p12_t5_g790 = (v1y * v2z);
    v3x = (x4 + (-(x3)));
    cse_p12_t8_g793 = ((-(v2x)) + (-(v3x)));
    cse_p12_t11_g796 = (v2x + v3x);
    v3y = (y4 + (-(y3)));
    cse_p12_t9_g794 = ((-(v2y)) + (-(v3y)));
    cse_p12_t12_g797 = (v2y + v3y);
    v3z = (z4 + (-(z3)));
    cse_p12_t10_g795 = ((-(v2z)) + (-(v3z)));
    cse_p12_t13_g798 = (v2z + v3z);
    c1x = (cse_p12_t5_g790 + (-((v1z * v2y))));
    c1y = (cse_p12_t6_g791 + (-((v1x * v2z))));
    c1z = (cse_p12_t4_g789 + (-((v1y * v2x))));
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    cse_p12_t1_g786 = (c2x * v1x);
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    cse_p12_t2_g787 = (c2y * v1y);
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    cse_p12_t3_g788 = (c2z * v1z);
    cse_p12_t7_g792 = (cse_p12_t1_g786 + cse_p12_t2_g787 + cse_p12_t3_g788);
    v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
    cse_p1_t1_sqrt783 = sqrt(v2_sq);
    cse_p1_t2_invsqrt784 = (1.0 / (cse_p1_t1_sqrt783));
    t1 = (cse_p12_t7_g792 * cse_p1_t1_sqrt783);
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    phi = atan2(t1, t2);
    nphi = (n * phi);
    cse_p12_t14_g799 = (-(sin(nphi)));
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
    cse_p1_t3_invr785 = (1.0 / ((((t1) * (t1)) + ((t2) * (t2)))));
    cse_p12_t1_g800 = (cse_p1_t3_invr785 * (-(t1)));
    cse_p12_t1_g801 = (cse_p1_t3_invr785 * t2);
    cse_p12_t1_g802 = (cos_nphi * n * sinphase);
    cse_p12_t1_g803 = (cosphase * cse_p12_t14_g799 * n);
    cse_p12_t1_g804 = (cse_p12_t1_g801 * cse_p1_t1_sqrt783);
    g_x1 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c2y * v2z) + (c2z * (-(v2y))))) + (cse_p12_t1_g804 * (-(c2x))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c2y * v2z) + (c2z * (-(v2y))))) + (cse_p12_t1_g804 * (-(c2x)))))));
    KernelGradientAcc(i3x1, 0, g_x1);
    g_y1 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c2x * (-(v2z))) + (c2z * v2x))) + (cse_p12_t1_g804 * (-(c2y))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c2x * (-(v2z))) + (c2z * v2x))) + (cse_p12_t1_g804 * (-(c2y)))))));
    KernelGradientAcc(i3x1, 1, g_y1);
    g_z1 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c2x * v2y) + (c2y * (-(v2x))))) + (cse_p12_t1_g804 * (-(c2z))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c2x * v2y) + (c2y * (-(v2x))))) + (cse_p12_t1_g804 * (-(c2z)))))));
    KernelGradientAcc(i3x1, 2, g_z1);
    cse_p12_t1_g805 = (cse_p12_t7_g792 * cse_p1_t2_invsqrt784);
    g_x2 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1y * v3z) + (c1z * (-(v3y))) + (c2y * ((-(v1z)) + (-(v2z)))) + (c2z * (v1y + v2y)))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * (-(v2x))) + (cse_p1_t1_sqrt783 * (c2x + (v1y * v3z) + (v1z * (-(v3y))))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1y * v3z) + (c1z * (-(v3y))) + (c2y * ((-(v1z)) + (-(v2z)))) + (c2z * (v1y + v2y)))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * (-(v2x))) + (cse_p1_t1_sqrt783 * (c2x + (v1y * v3z) + (v1z * (-(v3y)))))))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1x * (-(v3z))) + (c1z * v3x) + (c2x * (v1z + v2z)) + (c2z * ((-(v1x)) + (-(v2x)))))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * (-(v2y))) + (cse_p1_t1_sqrt783 * (c2y + (v1x * (-(v3z))) + (v1z * v3x))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1x * (-(v3z))) + (c1z * v3x) + (c2x * (v1z + v2z)) + (c2z * ((-(v1x)) + (-(v2x)))))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * (-(v2y))) + (cse_p1_t1_sqrt783 * (c2y + (v1x * (-(v3z))) + (v1z * v3x)))))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1x * v3y) + (c1y * (-(v3x))) + (c2x * ((-(v1y)) + (-(v2y)))) + (c2y * (v1x + v2x)))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * (-(v2z))) + (cse_p1_t1_sqrt783 * (c2z + (v1x * v3y) + (v1y * (-(v3x))))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1x * v3y) + (c1y * (-(v3x))) + (c2x * ((-(v1y)) + (-(v2y)))) + (c2y * (v1x + v2x)))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * (-(v2z))) + (cse_p1_t1_sqrt783 * (c2z + (v1x * v3y) + (v1y * (-(v3x)))))))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    g_x3 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1y * cse_p12_t10_g795) + (c1z * cse_p12_t12_g797) + (c2y * v1z) + (c2z * (-(v1y))))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * v2x) + (cse_p1_t1_sqrt783 * ((cse_p12_t10_g795 * v1y) + (cse_p12_t12_g797 * v1z))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1y * cse_p12_t10_g795) + (c1z * cse_p12_t12_g797) + (c2y * v1z) + (c2z * (-(v1y))))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * v2x) + (cse_p1_t1_sqrt783 * ((cse_p12_t10_g795 * v1y) + (cse_p12_t12_g797 * v1z)))))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1x * cse_p12_t13_g798) + (c1z * cse_p12_t8_g793) + (c2x * (-(v1z))) + (c2z * v1x))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * v2y) + (cse_p1_t1_sqrt783 * ((cse_p12_t13_g798 * v1x) + (cse_p12_t8_g793 * v1z))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1x * cse_p12_t13_g798) + (c1z * cse_p12_t8_g793) + (c2x * (-(v1z))) + (c2z * v1x))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * v2y) + (cse_p1_t1_sqrt783 * ((cse_p12_t13_g798 * v1x) + (cse_p12_t8_g793 * v1z)))))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1x * cse_p12_t9_g794) + (c1y * cse_p12_t11_g796) + (c2x * v1y) + (c2y * (-(v1x))))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * v2z) + (cse_p1_t1_sqrt783 * ((cse_p12_t11_g796 * v1y) + (cse_p12_t9_g794 * v1x))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1x * cse_p12_t9_g794) + (c1y * cse_p12_t11_g796) + (c2x * v1y) + (c2y * (-(v1x))))) + (cse_p12_t1_g801 * ((cse_p12_t1_g805 * v2z) + (cse_p1_t1_sqrt783 * ((cse_p12_t11_g796 * v1y) + (cse_p12_t9_g794 * v1x)))))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    g_x4 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1y * v2z) + (c1z * (-(v2y))))) + (cse_p12_t1_g804 * (cse_p12_t5_g790 + (v1z * (-(v2y))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1y * v2z) + (c1z * (-(v2y))))) + (cse_p12_t1_g804 * (cse_p12_t5_g790 + (v1z * (-(v2y)))))))));
    KernelGradientAcc(i3x4, 0, g_x4);
    g_y4 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1x * (-(v2z))) + (c1z * v2x))) + (cse_p12_t1_g804 * (cse_p12_t6_g791 + (v1x * (-(v2z))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1x * (-(v2z))) + (c1z * v2x))) + (cse_p12_t1_g804 * (cse_p12_t6_g791 + (v1x * (-(v2z)))))))));
    KernelGradientAcc(i3x4, 1, g_y4);
    g_z4 = (v * ((cse_p12_t1_g802 * ((cse_p12_t1_g800 * ((c1x * v2y) + (c1y * (-(v2x))))) + (cse_p12_t1_g804 * (cse_p12_t4_g789 + (v1y * (-(v2x))))))) + (cse_p12_t1_g803 * ((cse_p12_t1_g800 * ((c1x * v2y) + (c1y * (-(v2x))))) + (cse_p12_t1_g804 * (cse_p12_t4_g789 + (v1y * (-(v2x)))))))));
    KernelGradientAcc(i3x4, 2, g_z4);
  }
}
void gradient_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
}

void hessian(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  /* !BASE */
  double c1x;
  double c1y;
  double c1z;
  double c2x;
  double c2y;
  double c2z;
  double cos_angle;
  double cos_nphi;
  double cse_p11_t1_sqrt809;
  double cse_p11_t2_invsqrt810;
  double cse_p11_t3_invr811;
  double cse_p11_t4_invr812;
  double cse_p11_t5_invr2813;
  double cse_p12_t100_g913;
  double cse_p12_t101_g914;
  double cse_p12_t102_g915;
  double cse_p12_t103_g916;
  double cse_p12_t104_g917;
  double cse_p12_t105_g918;
  double cse_p12_t106_g919;
  double cse_p12_t107_g920;
  double cse_p12_t108_g921;
  double cse_p12_t109_g922;
  double cse_p12_t10_g823;
  double cse_p12_t110_g923;
  double cse_p12_t111_g924;
  double cse_p12_t112_g925;
  double cse_p12_t113_g926;
  double cse_p12_t114_g927;
  double cse_p12_t115_g928;
  double cse_p12_t116_g929;
  double cse_p12_t117_g930;
  double cse_p12_t118_g931;
  double cse_p12_t119_g932;
  double cse_p12_t11_g824;
  double cse_p12_t120_g933;
  double cse_p12_t121_g934;
  double cse_p12_t122_g935;
  double cse_p12_t123_g936;
  double cse_p12_t124_g937;
  double cse_p12_t125_g938;
  double cse_p12_t126_g939;
  double cse_p12_t127_g940;
  double cse_p12_t12_g825;
  double cse_p12_t130_g943;
  double cse_p12_t131_g944;
  double cse_p12_t133_g946;
  double cse_p12_t134_g947;
  double cse_p12_t135_g948;
  double cse_p12_t136_g949;
  double cse_p12_t137_g950;
  double cse_p12_t138_g951;
  double cse_p12_t139_g952;
  double cse_p12_t13_g826;
  double cse_p12_t140_g953;
  double cse_p12_t141_g954;
  double cse_p12_t142_g955;
  double cse_p12_t143_g956;
  double cse_p12_t144_g957;
  double cse_p12_t145_g958;
  double cse_p12_t146_g959;
  double cse_p12_t147_g960;
  double cse_p12_t148_g961;
  double cse_p12_t149_g962;
  double cse_p12_t14_g827;
  double cse_p12_t150_g963;
  double cse_p12_t151_g964;
  double cse_p12_t152_g965;
  double cse_p12_t153_g966;
  double cse_p12_t154_g967;
  double cse_p12_t155_g968;
  double cse_p12_t156_g969;
  double cse_p12_t157_g970;
  double cse_p12_t158_g971;
  double cse_p12_t159_g972;
  double cse_p12_t15_g828;
  double cse_p12_t160_g973;
  double cse_p12_t161_g974;
  double cse_p12_t162_g975;
  double cse_p12_t163_g976;
  double cse_p12_t164_g977;
  double cse_p12_t165_g978;
  double cse_p12_t166_g979;
  double cse_p12_t167_g980;
  double cse_p12_t168_g981;
  double cse_p12_t169_g982;
  double cse_p12_t16_g829;
  double cse_p12_t170_g983;
  double cse_p12_t171_g984;
  double cse_p12_t172_g985;
  double cse_p12_t173_g986;
  double cse_p12_t174_g987;
  double cse_p12_t175_g988;
  double cse_p12_t176_g989;
  double cse_p12_t177_g990;
  double cse_p12_t178_g991;
  double cse_p12_t179_g992;
  double cse_p12_t17_g830;
  double cse_p12_t180_g993;
  double cse_p12_t181_g994;
  double cse_p12_t182_g995;
  double cse_p12_t183_g996;
  double cse_p12_t184_g997;
  double cse_p12_t185_g998;
  double cse_p12_t186_g999;
  double cse_p12_t187_g1000;
  double cse_p12_t188_g1001;
  double cse_p12_t189_g1002;
  double cse_p12_t18_g831;
  double cse_p12_t190_g1003;
  double cse_p12_t191_g1004;
  double cse_p12_t192_g1005;
  double cse_p12_t193_g1006;
  double cse_p12_t194_g1007;
  double cse_p12_t195_g1008;
  double cse_p12_t196_g1009;
  double cse_p12_t197_g1010;
  double cse_p12_t198_g1011;
  double cse_p12_t199_g1012;
  double cse_p12_t19_g832;
  double cse_p12_t1_g1037;
  double cse_p12_t1_g1038;
  double cse_p12_t1_g1040;
  double cse_p12_t1_g1041;
  double cse_p12_t1_g1042;
  double cse_p12_t1_g1043;
  double cse_p12_t1_g1044;
  double cse_p12_t1_g1045;
  double cse_p12_t1_g1046;
  double cse_p12_t1_g1047;
  double cse_p12_t1_g1048;
  double cse_p12_t1_g1049;
  double cse_p12_t1_g814;
  double cse_p12_t200_g1013;
  double cse_p12_t201_g1014;
  double cse_p12_t202_g1015;
  double cse_p12_t203_g1016;
  double cse_p12_t204_g1017;
  double cse_p12_t205_g1018;
  double cse_p12_t206_g1019;
  double cse_p12_t207_g1020;
  double cse_p12_t208_g1021;
  double cse_p12_t209_g1022;
  double cse_p12_t20_g833;
  double cse_p12_t210_g1023;
  double cse_p12_t211_g1024;
  double cse_p12_t212_g1025;
  double cse_p12_t213_g1026;
  double cse_p12_t214_g1027;
  double cse_p12_t215_g1028;
  double cse_p12_t216_g1029;
  double cse_p12_t217_g1030;
  double cse_p12_t218_g1031;
  double cse_p12_t219_g1032;
  double cse_p12_t21_g834;
  double cse_p12_t220_g1033;
  double cse_p12_t221_g1034;
  double cse_p12_t222_g1035;
  double cse_p12_t223_g1036;
  double cse_p12_t22_g835;
  double cse_p12_t23_g836;
  double cse_p12_t24_g837;
  double cse_p12_t25_g838;
  double cse_p12_t26_g839;
  double cse_p12_t27_g840;
  double cse_p12_t28_g841;
  double cse_p12_t29_g842;
  double cse_p12_t2_g815;
  double cse_p12_t30_g843;
  double cse_p12_t31_g844;
  double cse_p12_t32_g845;
  double cse_p12_t33_g846;
  double cse_p12_t34_g847;
  double cse_p12_t35_g848;
  double cse_p12_t36_g849;
  double cse_p12_t37_g850;
  double cse_p12_t38_g851;
  double cse_p12_t39_g852;
  double cse_p12_t3_g816;
  double cse_p12_t40_g853;
  double cse_p12_t41_g854;
  double cse_p12_t42_g855;
  double cse_p12_t43_g856;
  double cse_p12_t44_g857;
  double cse_p12_t45_g858;
  double cse_p12_t46_g859;
  double cse_p12_t47_g860;
  double cse_p12_t48_g861;
  double cse_p12_t49_g862;
  double cse_p12_t4_g817;
  double cse_p12_t50_g863;
  double cse_p12_t51_g864;
  double cse_p12_t52_g865;
  double cse_p12_t53_g866;
  double cse_p12_t54_g867;
  double cse_p12_t55_g868;
  double cse_p12_t56_g869;
  double cse_p12_t57_g870;
  double cse_p12_t58_g871;
  double cse_p12_t59_g872;
  double cse_p12_t5_g818;
  double cse_p12_t60_g873;
  double cse_p12_t61_g874;
  double cse_p12_t62_g875;
  double cse_p12_t63_g876;
  double cse_p12_t64_g877;
  double cse_p12_t66_g879;
  double cse_p12_t67_g880;
  double cse_p12_t68_g881;
  double cse_p12_t69_g882;
  double cse_p12_t6_g819;
  double cse_p12_t70_g883;
  double cse_p12_t71_g884;
  double cse_p12_t72_g885;
  double cse_p12_t73_g886;
  double cse_p12_t74_g887;
  double cse_p12_t75_g888;
  double cse_p12_t76_g889;
  double cse_p12_t77_g890;
  double cse_p12_t78_g891;
  double cse_p12_t79_g892;
  double cse_p12_t7_g820;
  double cse_p12_t80_g893;
  double cse_p12_t81_g894;
  double cse_p12_t82_g895;
  double cse_p12_t83_g896;
  double cse_p12_t84_g897;
  double cse_p12_t85_g898;
  double cse_p12_t86_g899;
  double cse_p12_t87_g900;
  double cse_p12_t88_g901;
  double cse_p12_t89_g902;
  double cse_p12_t8_g821;
  double cse_p12_t90_g903;
  double cse_p12_t91_g904;
  double cse_p12_t92_g905;
  double cse_p12_t93_g906;
  double cse_p12_t94_g907;
  double cse_p12_t95_g908;
  double cse_p12_t96_g909;
  double cse_p12_t97_g910;
  double cse_p12_t98_g911;
  double cse_p12_t99_g912;
  double cse_p12_t9_g822;
  double cse_p13_t1_g1050;
  double cse_p13_t1_g1051;
  double cse_p13_t1_g1052;
  double cse_p13_t1_g1053;
  double cse_p13_t1_g1054;
  double cse_p13_t1_g1055;
  double cse_p13_t1_g1056;
  double cse_p13_t1_g1057;
  double cse_p13_t1_g1058;
  double cse_p13_t1_g1059;
  double cse_p14_t1_g1060;
  double cse_p14_t1_g1061;
  double cse_p14_t1_g1062;
  double cse_p14_t1_g1063;
  double cse_p14_t1_g1064;
  double cse_p14_t1_g1065;
  double cse_p14_t1_g1066;
  double cse_p14_t1_g1067;
  double cse_p14_t1_g1068;
  double cse_p14_t1_g1069;
  double cse_p15_t1_g1070;
  double energy;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_x4;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_y4;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x1_z4;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_x4;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_y4;
  double h_x2_z2;
  double h_x2_z3;
  double h_x2_z4;
  double h_x3_x3;
  double h_x3_x4;
  double h_x3_y3;
  double h_x3_y4;
  double h_x3_z3;
  double h_x3_z4;
  double h_x4_x4;
  double h_x4_y4;
  double h_x4_z4;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_x4;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_y4;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y1_z4;
  double h_y2_x3;
  double h_y2_x4;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_y4;
  double h_y2_z2;
  double h_y2_z3;
  double h_y2_z4;
  double h_y3_x4;
  double h_y3_y3;
  double h_y3_y4;
  double h_y3_z3;
  double h_y3_z4;
  double h_y4_y4;
  double h_y4_z4;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_x4;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_y4;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z1_z4;
  double h_z2_x3;
  double h_z2_x4;
  double h_z2_y3;
  double h_z2_y4;
  double h_z2_z2;
  double h_z2_z3;
  double h_z2_z4;
  double h_z3_x4;
  double h_z3_y4;
  double h_z3_z3;
  double h_z3_z4;
  double h_z4_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  DOUBLE x1 = position[i3x1 + 0];
  DOUBLE y1 = position[i3x1 + 1];
  DOUBLE z1 = position[i3x1 + 2];
  DOUBLE x2 = position[i3x2 + 0];
  DOUBLE y2 = position[i3x2 + 1];
  DOUBLE z2 = position[i3x2 + 2];
  DOUBLE x3 = position[i3x3 + 0];
  DOUBLE y3 = position[i3x3 + 1];
  DOUBLE z3 = position[i3x3 + 2];
  DOUBLE x4 = position[i3x4 + 0];
  DOUBLE y4 = position[i3x4 + 1];
  DOUBLE z4 = position[i3x4 + 2];
  {
    /* !BASE */
    v1x = (x2 + (-(x1)));
    v1y = (y2 + (-(y1)));
    v1z = (z2 + (-(z1)));
    v2x = (x3 + (-(x2)));
    cse_p12_t118_g931 = (v1y * (-(v2x)));
    cse_p12_t126_g939 = (v1z * v2x);
    cse_p12_t186_g999 = ((-(v1x)) + (-(v2x)));
    cse_p12_t195_g1008 = (v1x + v2x);
    v2y = (y3 + (-(y2)));
    cse_p12_t114_g927 = (v1x * v2y);
    cse_p12_t124_g937 = (v1z * (-(v2y)));
    cse_p12_t183_g996 = (cse_p12_t114_g927 + cse_p12_t118_g931);
    cse_p12_t187_g1000 = ((-(v1y)) + (-(v2y)));
    cse_p12_t196_g1009 = (v1y + v2y);
    v2z = (z3 + (-(z2)));
    cse_p12_t112_g925 = (v1x * (-(v2z)));
    cse_p12_t120_g933 = (v1y * v2z);
    cse_p12_t182_g995 = (cse_p12_t112_g925 + cse_p12_t126_g939);
    cse_p12_t185_g998 = (cse_p12_t120_g933 + cse_p12_t124_g937);
    cse_p12_t188_g1001 = ((-(v1z)) + (-(v2z)));
    cse_p12_t197_g1010 = (v1z + v2z);
    v3x = (x4 + (-(x3)));
    cse_p12_t117_g930 = (v1y * (v2x + v3x));
    cse_p12_t119_g932 = (v1y * (-(v3x)));
    cse_p12_t122_g935 = (v1z * ((-(v2x)) + (-(v3x))));
    cse_p12_t127_g940 = (v1z * v3x);
    cse_p12_t189_g1002 = ((-(v2x)) + (-(v3x)));
    cse_p12_t198_g1011 = (v2x + v3x);
    v3y = (y4 + (-(y3)));
    cse_p12_t110_g923 = (v1x * ((-(v2y)) + (-(v3y))));
    cse_p12_t115_g928 = (v1x * v3y);
    cse_p12_t123_g936 = (v1z * (v2y + v3y));
    cse_p12_t125_g938 = (v1z * (-(v3y)));
    cse_p12_t180_g993 = (cse_p12_t110_g923 + cse_p12_t117_g930);
    cse_p12_t190_g1003 = ((-(v2y)) + (-(v3y)));
    cse_p12_t199_g1012 = (v2y + v3y);
    v3z = (z4 + (-(z3)));
    cse_p12_t111_g924 = (v1x * (v2z + v3z));
    cse_p12_t113_g926 = (v1x * (-(v3z)));
    cse_p12_t116_g929 = (v1y * ((-(v2z)) + (-(v3z))));
    cse_p12_t121_g934 = (v1y * v3z);
    cse_p12_t181_g994 = (cse_p12_t111_g924 + cse_p12_t122_g935);
    cse_p12_t184_g997 = (cse_p12_t116_g929 + cse_p12_t123_g936);
    cse_p12_t191_g1004 = ((-(v2z)) + (-(v3z)));
    cse_p12_t200_g1013 = (v2z + v3z);
    c1x = (cse_p12_t120_g933 + (-((v1z * v2y))));
    cse_p12_t23_g836 = (c1x * cse_p12_t190_g1003);
    cse_p12_t24_g837 = (c1x * cse_p12_t200_g1013);
    cse_p12_t25_g838 = (c1x * (-(v2z)));
    cse_p12_t26_g839 = (c1x * (-(v3z)));
    cse_p12_t27_g840 = (c1x * v2y);
    cse_p12_t28_g841 = (c1x * v3y);
    c1y = (cse_p12_t126_g939 + (-((v1x * v2z))));
    cse_p12_t29_g842 = (c1y * cse_p12_t191_g1004);
    cse_p12_t30_g843 = (c1y * cse_p12_t198_g1011);
    cse_p12_t31_g844 = (c1y * (-(v2x)));
    cse_p12_t32_g845 = (c1y * (-(v3x)));
    cse_p12_t33_g846 = (c1y * v2z);
    cse_p12_t34_g847 = (c1y * v3z);
    cse_p12_t171_g984 = (cse_p12_t27_g840 + cse_p12_t31_g844);
    c1z = (cse_p12_t114_g927 + (-((v1y * v2x))));
    cse_p12_t35_g848 = (c1z * cse_p12_t189_g1002);
    cse_p12_t36_g849 = (c1z * cse_p12_t199_g1012);
    cse_p12_t37_g850 = (c1z * (-(v2y)));
    cse_p12_t38_g851 = (c1z * (-(v3y)));
    cse_p12_t39_g852 = (c1z * v2x);
    cse_p12_t40_g853 = (c1z * v3x);
    cse_p12_t169_g982 = (cse_p12_t25_g838 + cse_p12_t39_g852);
    cse_p12_t174_g987 = (cse_p12_t33_g846 + cse_p12_t37_g850);
    c2x = ((v2y * v3z) + (-((v2z * v3y))));
    cse_p12_t41_g854 = (c2x * cse_p12_t187_g1000);
    cse_p12_t42_g855 = (c2x * cse_p12_t197_g1010);
    cse_p12_t43_g856 = (c2x * (-(v1z)));
    cse_p12_t44_g857 = (c2x * (-(v2z)));
    cse_p12_t45_g858 = (c2x * v1x);
    cse_p12_t46_g859 = (c2x * v1y);
    cse_p12_t47_g860 = (c2x * v2y);
    cse_p12_t192_g1005 = (c2x + cse_p12_t121_g934 + cse_p12_t125_g938);
    c2y = ((v2z * v3x) + (-((v2x * v3z))));
    cse_p12_t48_g861 = (c2y * cse_p12_t188_g1001);
    cse_p12_t49_g862 = (c2y * cse_p12_t195_g1008);
    cse_p12_t50_g863 = (c2y * (-(v1x)));
    cse_p12_t51_g864 = (c2y * (-(v2x)));
    cse_p12_t52_g865 = (c2y * v1y);
    cse_p12_t53_g866 = (c2y * v1z);
    cse_p12_t54_g867 = (c2y * v2z);
    cse_p12_t167_g980 = (cse_p12_t23_g836 + cse_p12_t30_g843 + cse_p12_t46_g859 + cse_p12_t50_g863);
    cse_p12_t172_g985 = (cse_p12_t28_g841 + cse_p12_t32_g845 + cse_p12_t41_g854 + cse_p12_t49_g862);
    cse_p12_t178_g991 = (cse_p12_t47_g860 + cse_p12_t51_g864);
    cse_p12_t193_g1006 = (c2y + cse_p12_t113_g926 + cse_p12_t127_g940);
    c2z = ((v2x * v3y) + (-((v2y * v3x))));
    cse_p12_t55_g868 = (c2z * cse_p12_t186_g999);
    cse_p12_t56_g869 = (c2z * cse_p12_t196_g1009);
    cse_p12_t57_g870 = (c2z * (-(v1y)));
    cse_p12_t58_g871 = (c2z * (-(v2y)));
    cse_p12_t59_g872 = (c2z * v1x);
    cse_p12_t60_g873 = (c2z * v1z);
    cse_p12_t61_g874 = (c2z * v2x);
    cse_p12_t168_g981 = (cse_p12_t24_g837 + cse_p12_t35_g848 + cse_p12_t43_g856 + cse_p12_t59_g872);
    cse_p12_t170_g983 = (cse_p12_t26_g839 + cse_p12_t40_g853 + cse_p12_t42_g855 + cse_p12_t55_g868);
    cse_p12_t173_g986 = (cse_p12_t29_g842 + cse_p12_t36_g849 + cse_p12_t53_g866 + cse_p12_t57_g870);
    cse_p12_t175_g988 = (cse_p12_t34_g847 + cse_p12_t38_g851 + cse_p12_t48_g861 + cse_p12_t56_g869);
    cse_p12_t176_g989 = (cse_p12_t44_g857 + cse_p12_t61_g874);
    cse_p12_t177_g990 = (cse_p12_t45_g858 + cse_p12_t52_g865 + cse_p12_t60_g873);
    cse_p12_t179_g992 = (cse_p12_t54_g867 + cse_p12_t58_g871);
    cse_p12_t194_g1007 = (c2z + cse_p12_t115_g928 + cse_p12_t119_g932);
    v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
    cse_p11_t1_sqrt809 = sqrt(v2_sq);
    cse_p11_t2_invsqrt810 = (1.0 / (cse_p11_t1_sqrt809));
    cse_p12_t1_g1037 = (cse_p11_t2_invsqrt810 * cse_p12_t177_g990);
    cse_p12_t62_g875 = (cse_p12_t1_g1037 * (-(v2x)));
    cse_p12_t63_g876 = (cse_p12_t1_g1037 * (-(v2y)));
    cse_p12_t64_g877 = (cse_p12_t1_g1037 * (-(v2z)));
    cse_p12_t72_g885 = (cse_p12_t1_g1037 * v2x);
    cse_p12_t73_g886 = (cse_p12_t1_g1037 * v2y);
    cse_p12_t74_g887 = (cse_p12_t1_g1037 * v2z);
    cse_p12_t201_g1014 = (-(cse_p12_t1_g1037));
    cse_p11_t3_invr811 = (cse_p11_t2_invsqrt810 * cse_p11_t2_invsqrt810);
    cse_p12_t66_g879 = (cse_p11_t3_invr811 * cse_p12_t1_g1037 * v2x * v2x);
    cse_p12_t67_g880 = (cse_p11_t3_invr811 * cse_p12_t1_g1037 * v2x * v2y);
    cse_p12_t68_g881 = (cse_p11_t3_invr811 * cse_p12_t1_g1037 * v2x * v2z);
    cse_p12_t69_g882 = (cse_p11_t3_invr811 * cse_p12_t1_g1037 * v2y * v2y);
    cse_p12_t70_g883 = (cse_p11_t3_invr811 * cse_p12_t1_g1037 * v2y * v2z);
    cse_p12_t71_g884 = (cse_p11_t3_invr811 * cse_p12_t1_g1037 * v2z * v2z);
    cse_p12_t1_g1044 = (cse_p11_t1_sqrt809 * cse_p12_t180_g993);
    cse_p12_t1_g1045 = (cse_p11_t1_sqrt809 * cse_p12_t181_g994);
    cse_p12_t130_g943 = (cse_p11_t1_sqrt809 * cse_p12_t182_g995);
    cse_p12_t131_g944 = (cse_p11_t1_sqrt809 * cse_p12_t183_g996);
    cse_p12_t1_g1046 = (cse_p11_t1_sqrt809 * cse_p12_t184_g997);
    cse_p12_t133_g946 = (cse_p11_t1_sqrt809 * cse_p12_t185_g998);
    cse_p12_t134_g947 = (cse_p11_t1_sqrt809 * cse_p12_t192_g1005);
    cse_p12_t135_g948 = (cse_p11_t1_sqrt809 * cse_p12_t193_g1006);
    cse_p12_t136_g949 = (cse_p11_t1_sqrt809 * cse_p12_t194_g1007);
    cse_p12_t137_g950 = (cse_p11_t1_sqrt809 * (-(c2z)));
    cse_p12_t147_g960 = (cse_p12_t134_g947 + cse_p12_t62_g875);
    cse_p12_t148_g961 = (cse_p12_t135_g948 + cse_p12_t63_g876);
    cse_p12_t149_g962 = (cse_p12_t136_g949 + cse_p12_t64_g877);
    cse_p12_t150_g963 = (cse_p12_t1_g1046 + cse_p12_t72_g885);
    cse_p12_t151_g964 = (cse_p12_t1_g1045 + cse_p12_t73_g886);
    cse_p12_t152_g965 = (cse_p12_t1_g1044 + cse_p12_t74_g887);
    cse_p12_t213_g1026 = (-(cse_p12_t130_g943));
    cse_p12_t214_g1027 = (-(cse_p12_t131_g944));
    cse_p12_t215_g1028 = (-(cse_p12_t133_g946));
    cse_p12_t216_g1029 = (-(cse_p12_t147_g960));
    cse_p12_t217_g1030 = (-(cse_p12_t148_g961));
    cse_p12_t218_g1031 = (-(cse_p12_t149_g962));
    cse_p12_t219_g1032 = (-(cse_p12_t150_g963));
    cse_p12_t220_g1033 = (-(cse_p12_t151_g964));
    cse_p12_t221_g1034 = (-(cse_p12_t152_g965));
    cse_p12_t222_g1035 = (-(cse_p12_t137_g950));
    t1 = (cse_p11_t1_sqrt809 * cse_p12_t177_g990);
    cse_p13_t1_g1053 = (2.0000000000000000     * t1);
    cse_p12_t1_g814 = (cse_p12_t147_g960 * cse_p13_t1_g1053);
    cse_p12_t2_g815 = (cse_p12_t148_g961 * cse_p13_t1_g1053);
    cse_p12_t3_g816 = (cse_p12_t149_g962 * cse_p13_t1_g1053);
    cse_p12_t4_g817 = (cse_p12_t150_g963 * cse_p13_t1_g1053);
    cse_p12_t5_g818 = (cse_p12_t151_g964 * cse_p13_t1_g1053);
    cse_p12_t6_g819 = (cse_p12_t152_g965 * cse_p13_t1_g1053);
    cse_p12_t7_g820 = (cse_p11_t1_sqrt809 * cse_p12_t182_g995 * cse_p13_t1_g1053);
    cse_p12_t8_g821 = (cse_p11_t1_sqrt809 * cse_p12_t183_g996 * cse_p13_t1_g1053);
    cse_p12_t9_g822 = (cse_p11_t1_sqrt809 * cse_p12_t185_g998 * cse_p13_t1_g1053);
    cse_p12_t10_g823 = (cse_p11_t1_sqrt809 * cse_p13_t1_g1053 * (-(c2y)));
    cse_p12_t11_g824 = (cse_p11_t1_sqrt809 * cse_p13_t1_g1053 * (-(c2z)));
    t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
    cse_p13_t1_g1054 = (2.0000000000000000     * t2);
    cse_p12_t12_g825 = (cse_p12_t167_g980 * cse_p13_t1_g1054);
    cse_p12_t13_g826 = (cse_p12_t168_g981 * cse_p13_t1_g1054);
    cse_p12_t14_g827 = (cse_p12_t169_g982 * cse_p13_t1_g1054);
    cse_p12_t15_g828 = (cse_p12_t170_g983 * cse_p13_t1_g1054);
    cse_p12_t16_g829 = (cse_p12_t171_g984 * cse_p13_t1_g1054);
    cse_p12_t17_g830 = (cse_p12_t172_g985 * cse_p13_t1_g1054);
    cse_p12_t18_g831 = (cse_p12_t173_g986 * cse_p13_t1_g1054);
    cse_p12_t19_g832 = (cse_p12_t174_g987 * cse_p13_t1_g1054);
    cse_p12_t20_g833 = (cse_p12_t175_g988 * cse_p13_t1_g1054);
    cse_p12_t21_g834 = (cse_p12_t176_g989 * cse_p13_t1_g1054);
    cse_p12_t22_g835 = (cse_p12_t178_g991 * cse_p13_t1_g1054);
    cse_p12_t138_g951 = (cse_p12_t1_g814 + cse_p12_t20_g833);
    cse_p12_t139_g952 = (cse_p12_t15_g828 + cse_p12_t2_g815);
    cse_p12_t140_g953 = (cse_p12_t17_g830 + cse_p12_t3_g816);
    cse_p12_t141_g954 = (cse_p12_t18_g831 + cse_p12_t4_g817);
    cse_p12_t142_g955 = (cse_p12_t13_g826 + cse_p12_t5_g818);
    cse_p12_t143_g956 = (cse_p12_t12_g825 + cse_p12_t6_g819);
    cse_p12_t144_g957 = (cse_p12_t14_g827 + cse_p12_t7_g820);
    cse_p12_t145_g958 = (cse_p12_t16_g829 + cse_p12_t8_g821);
    cse_p12_t146_g959 = (cse_p12_t19_g832 + cse_p12_t9_g822);
    cse_p12_t165_g978 = (cse_p12_t10_g823 + cse_p12_t21_g834);
    cse_p12_t166_g979 = (cse_p12_t11_g824 + cse_p12_t22_g835);
    phi = atan2(t1, t2);
    nphi = (n * phi);
    cse_p12_t223_g1036 = (-(sin(nphi)));
    sin_nphi = sin(nphi);
    cos_nphi = cos(nphi);
    cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
    sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
    energy = (v * (1.0000000000000000     + cos_angle));
    *energy_accumulate += energy;
    cse_p11_t4_invr812 = (1.0 / ((((t1) * (t1)) + ((t2) * (t2)))));
    cse_p13_t1_g1051 = (cse_p11_t4_invr812 * (-(t1)));
    cse_p12_t75_g888 = (cse_p12_t167_g980 * cse_p13_t1_g1051);
    cse_p12_t76_g889 = (cse_p12_t168_g981 * cse_p13_t1_g1051);
    cse_p12_t77_g890 = (cse_p12_t169_g982 * cse_p13_t1_g1051);
    cse_p12_t78_g891 = (cse_p12_t170_g983 * cse_p13_t1_g1051);
    cse_p12_t79_g892 = (cse_p12_t171_g984 * cse_p13_t1_g1051);
    cse_p12_t80_g893 = (cse_p12_t172_g985 * cse_p13_t1_g1051);
    cse_p12_t81_g894 = (cse_p12_t173_g986 * cse_p13_t1_g1051);
    cse_p12_t82_g895 = (cse_p12_t174_g987 * cse_p13_t1_g1051);
    cse_p12_t83_g896 = (cse_p12_t175_g988 * cse_p13_t1_g1051);
    cse_p12_t84_g897 = (cse_p12_t176_g989 * cse_p13_t1_g1051);
    cse_p12_t85_g898 = (cse_p12_t178_g991 * cse_p13_t1_g1051);
    cse_p12_t86_g899 = (cse_p12_t179_g992 * cse_p13_t1_g1051);
    cse_p12_t1_g1040 = (cse_p11_t4_invr812 * t2);
    cse_p12_t87_g900 = (cse_p12_t147_g960 * cse_p12_t1_g1040);
    cse_p12_t88_g901 = (cse_p12_t148_g961 * cse_p12_t1_g1040);
    cse_p12_t89_g902 = (cse_p12_t149_g962 * cse_p12_t1_g1040);
    cse_p12_t90_g903 = (cse_p12_t150_g963 * cse_p12_t1_g1040);
    cse_p12_t91_g904 = (cse_p12_t151_g964 * cse_p12_t1_g1040);
    cse_p12_t92_g905 = (cse_p12_t152_g965 * cse_p12_t1_g1040);
    cse_p13_t1_g1052 = (cse_p11_t1_sqrt809 * cse_p12_t1_g1040);
    cse_p12_t93_g906 = (cse_p12_t182_g995 * cse_p13_t1_g1052);
    cse_p12_t94_g907 = (cse_p12_t183_g996 * cse_p13_t1_g1052);
    cse_p12_t95_g908 = (cse_p12_t185_g998 * cse_p13_t1_g1052);
    cse_p12_t96_g909 = (cse_p13_t1_g1052 * (-(c2x)));
    cse_p12_t97_g910 = (cse_p13_t1_g1052 * (-(c2y)));
    cse_p12_t98_g911 = (cse_p13_t1_g1052 * (-(c2z)));
    cse_p12_t153_g966 = (cse_p12_t75_g888 + cse_p12_t92_g905);
    cse_p12_t154_g967 = (cse_p12_t76_g889 + cse_p12_t91_g904);
    cse_p12_t155_g968 = (cse_p12_t77_g890 + cse_p12_t93_g906);
    cse_p12_t156_g969 = (cse_p12_t78_g891 + cse_p12_t88_g901);
    cse_p12_t157_g970 = (cse_p12_t79_g892 + cse_p12_t94_g907);
    cse_p12_t158_g971 = (cse_p12_t80_g893 + cse_p12_t89_g902);
    cse_p12_t159_g972 = (cse_p12_t81_g894 + cse_p12_t90_g903);
    cse_p12_t160_g973 = (cse_p12_t82_g895 + cse_p12_t95_g908);
    cse_p12_t161_g974 = (cse_p12_t83_g896 + cse_p12_t87_g900);
    cse_p12_t162_g975 = (cse_p12_t84_g897 + cse_p12_t97_g910);
    cse_p12_t163_g976 = (cse_p12_t85_g898 + cse_p12_t98_g911);
    cse_p12_t164_g977 = (cse_p12_t86_g899 + cse_p12_t96_g909);
    cse_p11_t5_invr2813 = (cse_p11_t4_invr812 * cse_p11_t4_invr812);
    cse_p12_t99_g912 = (cse_p11_t5_invr2813 * cse_p12_t138_g951);
    cse_p12_t100_g913 = (cse_p11_t5_invr2813 * cse_p12_t139_g952);
    cse_p12_t101_g914 = (cse_p11_t5_invr2813 * cse_p12_t140_g953);
    cse_p12_t102_g915 = (cse_p11_t5_invr2813 * cse_p12_t141_g954);
    cse_p12_t103_g916 = (cse_p11_t5_invr2813 * cse_p12_t142_g955);
    cse_p12_t104_g917 = (cse_p11_t5_invr2813 * cse_p12_t143_g956);
    cse_p12_t105_g918 = (cse_p11_t5_invr2813 * cse_p12_t144_g957);
    cse_p12_t106_g919 = (cse_p11_t5_invr2813 * cse_p12_t145_g958);
    cse_p12_t107_g920 = (cse_p11_t5_invr2813 * cse_p12_t146_g959);
    cse_p12_t108_g921 = (cse_p11_t5_invr2813 * cse_p12_t165_g978);
    cse_p12_t109_g922 = (cse_p11_t5_invr2813 * cse_p12_t166_g979);
    cse_p12_t202_g1015 = (-(cse_p12_t99_g912));
    cse_p12_t203_g1016 = (-(cse_p12_t100_g913));
    cse_p12_t204_g1017 = (-(cse_p12_t101_g914));
    cse_p12_t205_g1018 = (-(cse_p12_t102_g915));
    cse_p12_t206_g1019 = (-(cse_p12_t103_g916));
    cse_p12_t207_g1020 = (-(cse_p12_t104_g917));
    cse_p12_t208_g1021 = (-(cse_p12_t105_g918));
    cse_p12_t209_g1022 = (-(cse_p12_t106_g919));
    cse_p12_t210_g1023 = (-(cse_p12_t107_g920));
    cse_p12_t211_g1024 = (-(cse_p12_t108_g921));
    cse_p12_t212_g1025 = (-(cse_p12_t109_g922));
    cse_p12_t1_g1043 = (cse_p11_t1_sqrt809 * t2);
    cse_p13_t1_g1056 = (cse_p12_t1_g1043 * (-(c2x)));
    cse_p13_t1_g1057 = (cos_nphi * n * sinphase);
    cse_p14_t1_g1064 = (cosphase * cse_p12_t223_g1036 * n);
    g_x1 = (v * ((cse_p13_t1_g1057 * (cse_p12_t86_g899 + (cse_p11_t4_invr812 * cse_p13_t1_g1056))) + (cse_p14_t1_g1064 * (cse_p12_t86_g899 + (cse_p11_t4_invr812 * cse_p13_t1_g1056)))));
    KernelGradientAcc(i3x1, 0, g_x1);
    cse_p13_t1_g1058 = (cse_p12_t1_g1043 * (-(c2y)));
    g_y1 = (v * ((cse_p13_t1_g1057 * (cse_p12_t84_g897 + (cse_p11_t4_invr812 * cse_p13_t1_g1058))) + (cse_p14_t1_g1064 * (cse_p12_t84_g897 + (cse_p11_t4_invr812 * cse_p13_t1_g1058)))));
    KernelGradientAcc(i3x1, 1, g_y1);
    cse_p14_t1_g1060 = (cse_p12_t1_g1043 * (-(c2z)));
    g_z1 = (v * ((cse_p13_t1_g1057 * (cse_p12_t85_g898 + (cse_p11_t4_invr812 * cse_p14_t1_g1060))) + (cse_p14_t1_g1064 * (cse_p12_t85_g898 + (cse_p11_t4_invr812 * cse_p14_t1_g1060)))));
    KernelGradientAcc(i3x1, 2, g_z1);
    g_x2 = (v * ((cse_p13_t1_g1057 * (cse_p12_t83_g896 + (cse_p11_t4_invr812 * t2 * (cse_p12_t134_g947 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * (-(v2x))))))) + (cse_p14_t1_g1064 * (cse_p12_t83_g896 + (cse_p11_t4_invr812 * t2 * (cse_p12_t134_g947 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * (-(v2x)))))))));
    KernelGradientAcc(i3x2, 0, g_x2);
    g_y2 = (v * ((cse_p13_t1_g1057 * (cse_p12_t78_g891 + (cse_p11_t4_invr812 * t2 * (cse_p12_t135_g948 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * (-(v2y))))))) + (cse_p14_t1_g1064 * (cse_p12_t78_g891 + (cse_p11_t4_invr812 * t2 * (cse_p12_t135_g948 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * (-(v2y)))))))));
    KernelGradientAcc(i3x2, 1, g_y2);
    g_z2 = (v * ((cse_p13_t1_g1057 * (cse_p12_t80_g893 + (cse_p11_t4_invr812 * t2 * (cse_p12_t136_g949 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * (-(v2z))))))) + (cse_p14_t1_g1064 * (cse_p12_t80_g893 + (cse_p11_t4_invr812 * t2 * (cse_p12_t136_g949 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * (-(v2z)))))))));
    KernelGradientAcc(i3x2, 2, g_z2);
    g_x3 = (v * ((cse_p13_t1_g1057 * (cse_p12_t81_g894 + (cse_p11_t4_invr812 * t2 * (cse_p12_t1_g1046 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * v2x))))) + (cse_p14_t1_g1064 * (cse_p12_t81_g894 + (cse_p11_t4_invr812 * t2 * (cse_p12_t1_g1046 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * v2x)))))));
    KernelGradientAcc(i3x3, 0, g_x3);
    g_y3 = (v * ((cse_p13_t1_g1057 * (cse_p12_t76_g889 + (cse_p11_t4_invr812 * t2 * (cse_p12_t1_g1045 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * v2y))))) + (cse_p14_t1_g1064 * (cse_p12_t76_g889 + (cse_p11_t4_invr812 * t2 * (cse_p12_t1_g1045 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * v2y)))))));
    KernelGradientAcc(i3x3, 1, g_y3);
    g_z3 = (v * ((cse_p13_t1_g1057 * (cse_p12_t75_g888 + (cse_p11_t4_invr812 * t2 * (cse_p12_t1_g1044 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * v2z))))) + (cse_p14_t1_g1064 * (cse_p12_t75_g888 + (cse_p11_t4_invr812 * t2 * (cse_p12_t1_g1044 + (cse_p11_t2_invsqrt810 * cse_p12_t177_g990 * v2z)))))));
    KernelGradientAcc(i3x3, 2, g_z3);
    cse_p12_t1_g1049 = (cse_p11_t4_invr812 * cse_p12_t185_g998 * cse_p12_t1_g1043);
    g_x4 = (v * ((cse_p13_t1_g1057 * (cse_p12_t1_g1049 + cse_p12_t82_g895)) + (cse_p14_t1_g1064 * (cse_p12_t1_g1049 + cse_p12_t82_g895))));
    KernelGradientAcc(i3x4, 0, g_x4);
    cse_p12_t1_g1047 = (cse_p11_t4_invr812 * cse_p12_t182_g995 * cse_p12_t1_g1043);
    g_y4 = (v * ((cse_p13_t1_g1057 * (cse_p12_t1_g1047 + cse_p12_t77_g890)) + (cse_p14_t1_g1064 * (cse_p12_t1_g1047 + cse_p12_t77_g890))));
    KernelGradientAcc(i3x4, 1, g_y4);
    cse_p12_t1_g1048 = (cse_p11_t4_invr812 * cse_p12_t183_g996 * cse_p12_t1_g1043);
    g_z4 = (v * ((cse_p13_t1_g1057 * (cse_p12_t1_g1048 + cse_p12_t79_g892)) + (cse_p14_t1_g1064 * (cse_p12_t1_g1048 + cse_p12_t79_g892))));
    KernelGradientAcc(i3x4, 2, g_z4);
    cse_p12_t1_g1038 = (n * (-(v)));
    cse_p12_t1_g1041 = (cos_angle * cse_p12_t1_g1038 * n);
    cse_p12_t1_g1042 = (cse_p12_t1_g1038 * sin_angle);
    cse_p13_t1_g1050 = (cse_p11_t1_sqrt809 * cse_p11_t4_invr812);
    cse_p13_t1_g1059 = (cse_p13_t1_g1050 * (-(c2x)));
    h_x1_x1 = ((cse_p12_t164_g977 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t179_g992 * (cse_p13_t1_g1059 + (-((cse_p11_t1_sqrt809 * cse_p11_t4_invr812 * (-(c2x))))) + (-((cse_p11_t5_invr2813 * ((cse_p11_t1_sqrt809 * cse_p13_t1_g1053 * (-(c2x))) + (cse_p12_t179_g992 * cse_p13_t1_g1054)) * (-(t1))))))) + (-((cse_p11_t5_invr2813 * cse_p13_t1_g1056 * ((cse_p11_t1_sqrt809 * cse_p13_t1_g1053 * (-(c2x))) + (cse_p12_t179_g992 * cse_p13_t1_g1054))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
    h_x1_y1 = ((cse_p12_t162_g975 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t176_g989 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t211_g1024 * (-(t1))) + (cse_p12_t211_g1024 * cse_p13_t1_g1056) + (-((cse_p11_t1_sqrt809 * cse_p11_t4_invr812 * cse_p12_t179_g992 * (-(c2y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
    h_x1_z1 = ((cse_p12_t163_g976 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t222_g1035) + (cse_p12_t178_g991 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t212_g1025 * (-(t1))) + (cse_p12_t212_g1025 * cse_p13_t1_g1056))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
    cse_p13_t1_g1055 = (cse_p11_t2_invsqrt810 * cse_p12_t1_g1040);
    h_x1_x2 = ((cse_p12_t161_g974 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t216_g1029) + (cse_p12_t175_g988 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t202_g1015 * (-(t1))) + (cse_p12_t202_g1015 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * (((-(v2y)) * (-(v3y))) + (v2z * v3z))) + (-((cse_p13_t1_g1055 * v2x * (-(c2x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
    h_x1_y2 = ((cse_p12_t156_g969 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t217_g1030) + (cse_p12_t170_g983 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t203_g1016 * (-(t1))) + (cse_p12_t203_g1016 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * (c2z + (v3x * (-(v2y))))) + (cse_p13_t1_g1052 * v3z) + (-((cse_p13_t1_g1055 * v2y * (-(c2x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
    h_x1_z2 = ((cse_p12_t158_g971 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t218_g1031) + (cse_p12_t172_g985 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t204_g1017 * (-(t1))) + (cse_p12_t204_g1017 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * ((v2z * (-(v3x))) + (-(c2y)))) + (cse_p13_t1_g1052 * (-(v3y))) + (-((cse_p13_t1_g1055 * v2z * (-(c2x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
    h_x1_x3 = ((cse_p12_t159_g972 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t219_g1032) + (cse_p12_t173_g986 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t205_g1018 * (-(t1))) + (cse_p12_t205_g1018 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * ((cse_p12_t191_g1004 * v2z) + (cse_p12_t199_g1012 * (-(v2y))))) + (cse_p13_t1_g1055 * v2x * (-(c2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
    h_x1_y3 = ((cse_p12_t154_g967 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t220_g1033) + (cse_p12_t168_g981 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t191_g1004 * cse_p13_t1_g1052) + (cse_p12_t206_g1019 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * ((cse_p12_t189_g1002 * (-(v2y))) + (-(c2z)))) + (cse_p13_t1_g1055 * v2y * (-(c2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
    cse_p14_t1_g1067 = (cse_p12_t207_g1020 * (-(t1)));
    h_x1_z3 = ((cse_p12_t153_g966 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t221_g1034) + (cse_p12_t167_g980 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p14_t1_g1067) + (cse_p12_t199_g1012 * cse_p13_t1_g1052) + (cse_p12_t207_g1020 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * (c2y + (cse_p12_t198_g1011 * v2z))) + (cse_p13_t1_g1055 * v2z * (-(c2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
    cse_p14_t1_g1066 = (cse_p12_t210_g1023 * (-(t1)));
    h_x1_x4 = ((cse_p12_t160_g973 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t215_g1028) + (cse_p12_t174_g987 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p14_t1_g1066) + (cse_p12_t210_g1023 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * (((-(v2y)) * (-(v2y))) + (v2z * v2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 0, h_x1_x4);
    cse_p14_t1_g1063 = (cse_p12_t208_g1021 * (-(t1)));
    h_x1_y4 = ((cse_p12_t155_g968 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t213_g1026) + (cse_p12_t169_g982 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p14_t1_g1063) + (cse_p12_t208_g1021 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * v2x * (-(v2y))) + (cse_p13_t1_g1052 * v2z))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 1, h_x1_y4);
    cse_p14_t1_g1061 = (cse_p12_t209_g1022 * (-(t1)));
    h_x1_z4 = ((cse_p12_t157_g970 * cse_p12_t164_g977 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t179_g992 * cse_p12_t214_g1027) + (cse_p12_t171_g984 * cse_p13_t1_g1059) + (cse_p12_t179_g992 * cse_p14_t1_g1061) + (cse_p12_t209_g1022 * cse_p13_t1_g1056) + (cse_p13_t1_g1051 * v2z * (-(v2x))) + (cse_p13_t1_g1052 * (-(v2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 2, h_x1_z4);
    cse_p14_t1_g1062 = (cse_p13_t1_g1050 * (-(c2y)));
    h_y1_y1 = ((cse_p12_t162_g975 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t176_g989 * (cse_p14_t1_g1062 + (cse_p12_t211_g1024 * (-(t1))) + (-((cse_p11_t1_sqrt809 * cse_p11_t4_invr812 * (-(c2y))))))) + (cse_p12_t211_g1024 * cse_p13_t1_g1058))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
    h_y1_z1 = ((cse_p12_t162_g975 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t222_g1035) + (cse_p12_t176_g989 * cse_p12_t212_g1025 * (-(t1))) + (cse_p12_t178_g991 * cse_p14_t1_g1062) + (cse_p12_t212_g1025 * cse_p13_t1_g1058))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
    h_y1_x2 = ((cse_p12_t161_g974 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t216_g1029) + (cse_p12_t175_g988 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p12_t202_g1015 * (-(t1))) + (cse_p12_t202_g1015 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * ((v2x * (-(v3y))) + (-(c2z)))) + (cse_p13_t1_g1052 * (-(v3z))) + (-((cse_p13_t1_g1055 * v2x * (-(c2y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
    h_y1_y2 = ((cse_p12_t156_g969 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t217_g1030) + (cse_p12_t170_g983 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p12_t203_g1016 * (-(t1))) + (cse_p12_t203_g1016 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * (((-(v2z)) * (-(v3z))) + (v2x * v3x))) + (-((cse_p13_t1_g1055 * v2y * (-(c2y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
    h_y1_z2 = ((cse_p12_t158_g971 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t218_g1031) + (cse_p12_t172_g985 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p12_t204_g1017 * (-(t1))) + (cse_p12_t204_g1017 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * (c2x + (v3y * (-(v2z))))) + (cse_p13_t1_g1052 * v3x) + (-((cse_p13_t1_g1055 * v2z * (-(c2y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
    h_y1_x3 = ((cse_p12_t159_g972 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t219_g1032) + (cse_p12_t173_g986 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p12_t205_g1018 * (-(t1))) + (cse_p12_t200_g1013 * cse_p13_t1_g1052) + (cse_p12_t205_g1018 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * (c2z + (cse_p12_t199_g1012 * v2x))) + (cse_p13_t1_g1055 * v2x * (-(c2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
    h_y1_y3 = ((cse_p12_t154_g967 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t220_g1033) + (cse_p12_t168_g981 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t206_g1019 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * ((cse_p12_t189_g1002 * v2x) + (cse_p12_t200_g1013 * (-(v2z))))) + (cse_p13_t1_g1055 * v2y * (-(c2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
    h_y1_z3 = ((cse_p12_t153_g966 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t221_g1034) + (cse_p12_t167_g980 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p14_t1_g1067) + (cse_p12_t189_g1002 * cse_p13_t1_g1052) + (cse_p12_t207_g1020 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * ((cse_p12_t190_g1003 * (-(v2z))) + (-(c2x)))) + (cse_p13_t1_g1055 * v2z * (-(c2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
    h_y1_x4 = ((cse_p12_t160_g973 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t215_g1028) + (cse_p12_t174_g987 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p14_t1_g1066) + (cse_p12_t210_g1023 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * v2x * (-(v2y))) + (cse_p13_t1_g1052 * (-(v2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 0, h_y1_x4);
    h_y1_y4 = ((cse_p12_t155_g968 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t213_g1026) + (cse_p12_t169_g982 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p14_t1_g1063) + (cse_p12_t208_g1021 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * (((-(v2z)) * (-(v2z))) + (v2x * v2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 1, h_y1_y4);
    h_y1_z4 = ((cse_p12_t157_g970 * cse_p12_t162_g975 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t176_g989 * cse_p12_t214_g1027) + (cse_p12_t171_g984 * cse_p14_t1_g1062) + (cse_p12_t176_g989 * cse_p14_t1_g1061) + (cse_p12_t209_g1022 * cse_p13_t1_g1058) + (cse_p13_t1_g1051 * v2y * (-(v2z))) + (cse_p13_t1_g1052 * v2x))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 2, h_y1_z4);
    cse_p14_t1_g1065 = (cse_p13_t1_g1050 * (-(c2z)));
    h_z1_z1 = ((cse_p12_t163_g976 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t178_g991 * (cse_p14_t1_g1065 + (cse_p11_t4_invr812 * cse_p12_t222_g1035) + (cse_p12_t212_g1025 * (-(t1))))) + (cse_p12_t212_g1025 * cse_p14_t1_g1060))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
    h_z1_x2 = ((cse_p12_t161_g974 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t216_g1029) + (cse_p12_t175_g988 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p12_t202_g1015 * (-(t1))) + (cse_p12_t202_g1015 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * (c2y + (v3z * (-(v2x))))) + (cse_p13_t1_g1052 * v3y) + (-((cse_p13_t1_g1055 * v2x * (-(c2z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
    h_z1_y2 = ((cse_p12_t156_g969 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t217_g1030) + (cse_p12_t170_g983 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p12_t203_g1016 * (-(t1))) + (cse_p12_t203_g1016 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * ((v2y * (-(v3z))) + (-(c2x)))) + (cse_p13_t1_g1052 * (-(v3x))) + (-((cse_p13_t1_g1055 * v2y * (-(c2z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
    h_z1_z2 = ((cse_p12_t158_g971 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t218_g1031) + (cse_p12_t172_g985 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p12_t204_g1017 * (-(t1))) + (cse_p12_t204_g1017 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * (((-(v2x)) * (-(v3x))) + (v2y * v3y))) + (-((cse_p13_t1_g1055 * v2z * (-(c2z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
    h_z1_x3 = ((cse_p12_t159_g972 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t219_g1032) + (cse_p12_t173_g986 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p12_t205_g1018 * (-(t1))) + (cse_p12_t190_g1003 * cse_p13_t1_g1052) + (cse_p12_t205_g1018 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * ((cse_p12_t191_g1004 * (-(v2x))) + (-(c2y)))) + (cse_p13_t1_g1055 * v2x * (-(c2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
    h_z1_y3 = ((cse_p12_t154_g967 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t220_g1033) + (cse_p12_t168_g981 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t198_g1011 * cse_p13_t1_g1052) + (cse_p12_t206_g1019 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * (c2x + (cse_p12_t200_g1013 * v2y))) + (cse_p13_t1_g1055 * v2y * (-(c2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
    h_z1_z3 = ((cse_p12_t153_g966 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t221_g1034) + (cse_p12_t167_g980 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p14_t1_g1067) + (cse_p12_t207_g1020 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * ((cse_p12_t190_g1003 * v2y) + (cse_p12_t198_g1011 * (-(v2x))))) + (cse_p13_t1_g1055 * v2z * (-(c2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
    h_z1_x4 = ((cse_p12_t160_g973 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t215_g1028) + (cse_p12_t174_g987 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p14_t1_g1066) + (cse_p12_t210_g1023 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * v2z * (-(v2x))) + (cse_p13_t1_g1052 * v2y))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 0, h_z1_x4);
    h_z1_y4 = ((cse_p12_t155_g968 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t213_g1026) + (cse_p12_t169_g982 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p14_t1_g1063) + (cse_p12_t208_g1021 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * v2y * (-(v2z))) + (cse_p13_t1_g1052 * (-(v2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 1, h_z1_y4);
    h_z1_z4 = ((cse_p12_t157_g970 * cse_p12_t163_g976 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t178_g991 * cse_p12_t214_g1027) + (cse_p12_t171_g984 * cse_p14_t1_g1065) + (cse_p12_t178_g991 * cse_p14_t1_g1061) + (cse_p12_t209_g1022 * cse_p14_t1_g1060) + (cse_p13_t1_g1051 * (((-(v2x)) * (-(v2x))) + (v2y * v2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 2, h_z1_z4);
    cse_p14_t1_g1068 = (cse_p11_t2_invsqrt810 * (-(v2x)));
    h_x2_x2 = ((cse_p12_t161_g974 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t147_g960 * cse_p12_t202_g1015 * t2) + (cse_p12_t175_g988 * ((cse_p11_t4_invr812 * cse_p12_t147_g960) + (cse_p11_t4_invr812 * cse_p12_t216_g1029) + (cse_p12_t202_g1015 * (-(t1))))) + (cse_p12_t1_g1040 * (cse_p12_t1_g1037 + (cse_p12_t192_g1005 * cse_p14_t1_g1068) + (cse_p12_t192_g1005 * cse_p14_t1_g1068) + (-(cse_p12_t66_g879)))) + (cse_p13_t1_g1051 * ((cse_p12_t188_g1001 * v3z) + (cse_p12_t188_g1001 * v3z) + (cse_p12_t196_g1009 * (-(v3y))) + (cse_p12_t196_g1009 * (-(v3y))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
    cse_p14_t1_g1069 = (cse_p11_t2_invsqrt810 * (-(v2y)));
    h_x2_y2 = ((cse_p12_t156_g969 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t170_g983) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t217_g1030) + (cse_p12_t147_g960 * cse_p12_t203_g1016 * t2) + (cse_p12_t175_g988 * cse_p12_t203_g1016 * (-(t1))) + (cse_p12_t1_g1040 * ((cse_p12_t192_g1005 * cse_p14_t1_g1069) + (cse_p12_t193_g1006 * cse_p14_t1_g1068) + (-(cse_p12_t67_g880)))) + (cse_p13_t1_g1051 * ((cse_p12_t186_g999 * (-(v3y))) + (cse_p12_t196_g1009 * v3x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
    cse_p15_t1_g1070 = (cse_p11_t2_invsqrt810 * (-(v2z)));
    h_x2_z2 = ((cse_p12_t158_g971 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t172_g985) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t218_g1031) + (cse_p12_t147_g960 * cse_p12_t204_g1017 * t2) + (cse_p12_t175_g988 * cse_p12_t204_g1017 * (-(t1))) + (cse_p12_t1_g1040 * ((cse_p12_t192_g1005 * cse_p15_t1_g1070) + (cse_p12_t194_g1007 * cse_p14_t1_g1068) + (-(cse_p12_t68_g881)))) + (cse_p13_t1_g1051 * ((cse_p12_t188_g1001 * (-(v3x))) + (cse_p12_t195_g1008 * v3z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
    h_x2_x3 = ((cse_p12_t159_g972 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t173_g986) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t219_g1032) + (cse_p12_t147_g960 * cse_p12_t205_g1018 * t2) + (cse_p12_t175_g988 * cse_p12_t205_g1018 * (-(t1))) + (cse_p12_t1_g1040 * (cse_p12_t201_g1014 + cse_p12_t66_g879 + (cse_p11_t2_invsqrt810 * cse_p12_t192_g1005 * v2x) + (cse_p12_t184_g997 * cse_p14_t1_g1068))) + (cse_p13_t1_g1051 * (((-(v1y)) * (-(v3y))) + (cse_p12_t188_g1001 * cse_p12_t191_g1004) + (cse_p12_t196_g1009 * cse_p12_t199_g1012) + (v1z * v3z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
    h_x2_y3 = ((cse_p12_t154_g967 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t168_g981) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t220_g1033) + (cse_p12_t147_g960 * cse_p12_t206_g1019 * t2) + (cse_p12_t175_g988 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t1_g1040 * (cse_p12_t67_g880 + (cse_p11_t1_sqrt809 * (v1z + v2z + v3z)) + (cse_p11_t2_invsqrt810 * cse_p12_t192_g1005 * v2y) + (cse_p12_t181_g994 * cse_p14_t1_g1068))) + (cse_p13_t1_g1051 * (c1z + c2z + (cse_p12_t189_g1002 * cse_p12_t196_g1009) + (v1x * (-(v3y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
    h_x2_z3 = ((cse_p12_t153_g966 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t167_g980) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t221_g1034) + (cse_p12_t147_g960 * cse_p12_t207_g1020 * t2) + (cse_p12_t175_g988 * cse_p14_t1_g1067) + (cse_p12_t1_g1040 * (cse_p12_t68_g881 + (cse_p11_t1_sqrt809 * ((-(v1y)) + (-(v2y)) + (-(v3y)))) + (cse_p11_t2_invsqrt810 * cse_p12_t192_g1005 * v2z) + (cse_p12_t180_g993 * cse_p14_t1_g1068))) + (cse_p13_t1_g1051 * ((cse_p12_t188_g1001 * cse_p12_t198_g1011) + (v3z * (-(v1x))) + (-(c1y)) + (-(c2y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
    h_x2_x4 = ((cse_p12_t160_g973 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t174_g987) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t215_g1028) + (cse_p12_t147_g960 * cse_p12_t210_g1023 * t2) + (cse_p12_t175_g988 * cse_p14_t1_g1066) + (cse_p13_t1_g1051 * ((cse_p12_t188_g1001 * v2z) + (cse_p12_t196_g1009 * (-(v2y))))) + (-((cse_p12_t185_g998 * cse_p13_t1_g1055 * v2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 0, h_x2_x4);
    h_x2_y4 = ((cse_p12_t155_g968 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t169_g982) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t213_g1026) + (cse_p12_t147_g960 * cse_p12_t208_g1021 * t2) + (cse_p12_t175_g988 * cse_p14_t1_g1063) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * cse_p12_t188_g1001) + (cse_p12_t182_g995 * cse_p14_t1_g1068))) + (cse_p13_t1_g1051 * ((cse_p12_t196_g1009 * v2x) + (-(c1z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 1, h_x2_y4);
    h_x2_z4 = ((cse_p12_t157_g970 * cse_p12_t161_g974 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t147_g960 * cse_p12_t171_g984) + (cse_p11_t4_invr812 * cse_p12_t175_g988 * cse_p12_t214_g1027) + (cse_p12_t147_g960 * cse_p12_t209_g1022 * t2) + (cse_p12_t175_g988 * cse_p14_t1_g1061) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * cse_p12_t196_g1009) + (cse_p12_t183_g996 * cse_p14_t1_g1068))) + (cse_p13_t1_g1051 * (c1y + (cse_p12_t188_g1001 * (-(v2x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 2, h_x2_z4);
    h_y2_y2 = ((cse_p12_t156_g969 * cse_p12_t156_g969 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t148_g961 * cse_p12_t203_g1016 * t2) + (cse_p12_t170_g983 * ((cse_p11_t4_invr812 * cse_p12_t148_g961) + (cse_p11_t4_invr812 * cse_p12_t217_g1030) + (cse_p12_t203_g1016 * (-(t1))))) + (cse_p12_t1_g1040 * (cse_p12_t1_g1037 + (cse_p12_t193_g1006 * cse_p14_t1_g1069) + (cse_p12_t193_g1006 * cse_p14_t1_g1069) + (-(cse_p12_t69_g882)))) + (cse_p13_t1_g1051 * ((cse_p12_t186_g999 * v3x) + (cse_p12_t186_g999 * v3x) + (cse_p12_t197_g1010 * (-(v3z))) + (cse_p12_t197_g1010 * (-(v3z))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
    h_y2_z2 = ((cse_p12_t156_g969 * cse_p12_t158_g971 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t172_g985) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t218_g1031) + (cse_p12_t148_g961 * cse_p12_t204_g1017 * t2) + (cse_p12_t170_g983 * cse_p12_t204_g1017 * (-(t1))) + (cse_p12_t1_g1040 * ((cse_p12_t193_g1006 * cse_p15_t1_g1070) + (cse_p12_t194_g1007 * cse_p14_t1_g1069) + (-(cse_p12_t70_g883)))) + (cse_p13_t1_g1051 * ((cse_p12_t187_g1000 * (-(v3z))) + (cse_p12_t197_g1010 * v3y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
    h_y2_x3 = ((cse_p12_t156_g969 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t173_g986) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t219_g1032) + (cse_p12_t148_g961 * cse_p12_t205_g1018 * t2) + (cse_p12_t170_g983 * cse_p12_t205_g1018 * (-(t1))) + (cse_p12_t1_g1040 * (cse_p12_t67_g880 + (cse_p11_t1_sqrt809 * ((-(v1z)) + (-(v2z)) + (-(v3z)))) + (cse_p11_t2_invsqrt810 * cse_p12_t193_g1006 * v2x) + (cse_p12_t184_g997 * cse_p14_t1_g1069))) + (cse_p13_t1_g1051 * ((cse_p12_t186_g999 * cse_p12_t199_g1012) + (v3x * (-(v1y))) + (-(c1z)) + (-(c2z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
    h_y2_y3 = ((cse_p12_t154_g967 * cse_p12_t156_g969 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t168_g981) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t220_g1033) + (cse_p12_t148_g961 * cse_p12_t206_g1019 * t2) + (cse_p12_t170_g983 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t1_g1040 * (cse_p12_t201_g1014 + cse_p12_t69_g882 + (cse_p11_t2_invsqrt810 * cse_p12_t193_g1006 * v2y) + (cse_p12_t181_g994 * cse_p14_t1_g1069))) + (cse_p13_t1_g1051 * (((-(v1z)) * (-(v3z))) + (cse_p12_t186_g999 * cse_p12_t189_g1002) + (cse_p12_t197_g1010 * cse_p12_t200_g1013) + (v1x * v3x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
    h_y2_z3 = ((cse_p12_t153_g966 * cse_p12_t156_g969 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t167_g980) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t221_g1034) + (cse_p12_t148_g961 * cse_p12_t207_g1020 * t2) + (cse_p12_t170_g983 * cse_p14_t1_g1067) + (cse_p12_t1_g1040 * (cse_p12_t70_g883 + (cse_p11_t1_sqrt809 * (v1x + v2x + v3x)) + (cse_p11_t2_invsqrt810 * cse_p12_t193_g1006 * v2z) + (cse_p12_t180_g993 * cse_p14_t1_g1069))) + (cse_p13_t1_g1051 * (c1x + c2x + (cse_p12_t190_g1003 * cse_p12_t197_g1010) + (v1y * (-(v3z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
    h_y2_x4 = ((cse_p12_t156_g969 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t174_g987) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t215_g1028) + (cse_p12_t148_g961 * cse_p12_t210_g1023 * t2) + (cse_p12_t170_g983 * cse_p14_t1_g1066) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * cse_p12_t197_g1010) + (cse_p12_t185_g998 * cse_p14_t1_g1069))) + (cse_p13_t1_g1051 * (c1z + (cse_p12_t186_g999 * (-(v2y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 0, h_y2_x4);
    h_y2_y4 = ((cse_p12_t155_g968 * cse_p12_t156_g969 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t169_g982) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t213_g1026) + (cse_p12_t148_g961 * cse_p12_t208_g1021 * t2) + (cse_p12_t170_g983 * cse_p14_t1_g1063) + (cse_p13_t1_g1051 * ((cse_p12_t186_g999 * v2x) + (cse_p12_t197_g1010 * (-(v2z))))) + (-((cse_p12_t182_g995 * cse_p13_t1_g1055 * v2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 1, h_y2_y4);
    h_y2_z4 = ((cse_p12_t156_g969 * cse_p12_t157_g970 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t148_g961 * cse_p12_t171_g984) + (cse_p11_t4_invr812 * cse_p12_t170_g983 * cse_p12_t214_g1027) + (cse_p12_t148_g961 * cse_p12_t209_g1022 * t2) + (cse_p12_t170_g983 * cse_p14_t1_g1061) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * cse_p12_t186_g999) + (cse_p12_t183_g996 * cse_p14_t1_g1069))) + (cse_p13_t1_g1051 * ((cse_p12_t197_g1010 * v2y) + (-(c1x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 2, h_y2_z4);
    h_z2_z2 = ((cse_p12_t158_g971 * cse_p12_t158_g971 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t149_g962 * cse_p12_t204_g1017 * t2) + (cse_p12_t172_g985 * ((cse_p11_t4_invr812 * cse_p12_t149_g962) + (cse_p11_t4_invr812 * cse_p12_t218_g1031) + (cse_p12_t204_g1017 * (-(t1))))) + (cse_p12_t1_g1040 * (cse_p12_t1_g1037 + (cse_p12_t194_g1007 * cse_p15_t1_g1070) + (cse_p12_t194_g1007 * cse_p15_t1_g1070) + (-(cse_p12_t71_g884)))) + (cse_p13_t1_g1051 * ((cse_p12_t187_g1000 * v3y) + (cse_p12_t187_g1000 * v3y) + (cse_p12_t195_g1008 * (-(v3x))) + (cse_p12_t195_g1008 * (-(v3x))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
    h_z2_x3 = ((cse_p12_t158_g971 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t149_g962 * cse_p12_t173_g986) + (cse_p11_t4_invr812 * cse_p12_t172_g985 * cse_p12_t219_g1032) + (cse_p12_t149_g962 * cse_p12_t205_g1018 * t2) + (cse_p12_t172_g985 * cse_p12_t205_g1018 * (-(t1))) + (cse_p12_t1_g1040 * (cse_p12_t68_g881 + (cse_p11_t1_sqrt809 * (v1y + v2y + v3y)) + (cse_p11_t2_invsqrt810 * cse_p12_t194_g1007 * v2x) + (cse_p12_t184_g997 * cse_p15_t1_g1070))) + (cse_p13_t1_g1051 * (c1y + c2y + (cse_p12_t191_g1004 * cse_p12_t195_g1008) + (v1z * (-(v3x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
    h_z2_y3 = ((cse_p12_t154_g967 * cse_p12_t158_g971 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t149_g962 * cse_p12_t168_g981) + (cse_p11_t4_invr812 * cse_p12_t172_g985 * cse_p12_t220_g1033) + (cse_p12_t149_g962 * cse_p12_t206_g1019 * t2) + (cse_p12_t172_g985 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t1_g1040 * (cse_p12_t70_g883 + (cse_p11_t1_sqrt809 * ((-(v1x)) + (-(v2x)) + (-(v3x)))) + (cse_p11_t2_invsqrt810 * cse_p12_t194_g1007 * v2y) + (cse_p12_t181_g994 * cse_p15_t1_g1070))) + (cse_p13_t1_g1051 * ((cse_p12_t187_g1000 * cse_p12_t200_g1013) + (v3y * (-(v1z))) + (-(c1x)) + (-(c2x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
    h_z2_z3 = ((cse_p12_t153_g966 * cse_p12_t158_g971 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t149_g962 * cse_p12_t167_g980) + (cse_p11_t4_invr812 * cse_p12_t172_g985 * cse_p12_t221_g1034) + (cse_p12_t149_g962 * cse_p12_t207_g1020 * t2) + (cse_p12_t172_g985 * cse_p14_t1_g1067) + (cse_p12_t1_g1040 * (cse_p12_t201_g1014 + cse_p12_t71_g884 + (cse_p11_t2_invsqrt810 * cse_p12_t194_g1007 * v2z) + (cse_p12_t180_g993 * cse_p15_t1_g1070))) + (cse_p13_t1_g1051 * (((-(v1x)) * (-(v3x))) + (cse_p12_t187_g1000 * cse_p12_t190_g1003) + (cse_p12_t195_g1008 * cse_p12_t198_g1011) + (v1y * v3y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
    h_z2_x4 = ((cse_p12_t158_g971 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t149_g962 * cse_p12_t174_g987) + (cse_p11_t4_invr812 * cse_p12_t172_g985 * cse_p12_t215_g1028) + (cse_p12_t149_g962 * cse_p12_t210_g1023 * t2) + (cse_p12_t172_g985 * cse_p14_t1_g1066) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * cse_p12_t187_g1000) + (cse_p12_t185_g998 * cse_p15_t1_g1070))) + (cse_p13_t1_g1051 * ((cse_p12_t195_g1008 * v2z) + (-(c1y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 0, h_z2_x4);
    h_z2_y4 = ((cse_p12_t155_g968 * cse_p12_t158_g971 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t149_g962 * cse_p12_t169_g982) + (cse_p11_t4_invr812 * cse_p12_t172_g985 * cse_p12_t213_g1026) + (cse_p12_t149_g962 * cse_p12_t208_g1021 * t2) + (cse_p12_t172_g985 * cse_p14_t1_g1063) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * cse_p12_t195_g1008) + (cse_p12_t182_g995 * cse_p15_t1_g1070))) + (cse_p13_t1_g1051 * (c1x + (cse_p12_t187_g1000 * (-(v2z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 1, h_z2_y4);
    h_z2_z4 = ((cse_p12_t157_g970 * cse_p12_t158_g971 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t149_g962 * cse_p12_t171_g984) + (cse_p11_t4_invr812 * cse_p12_t172_g985 * cse_p12_t214_g1027) + (cse_p12_t149_g962 * cse_p12_t209_g1022 * t2) + (cse_p12_t172_g985 * cse_p14_t1_g1061) + (cse_p13_t1_g1051 * ((cse_p12_t187_g1000 * v2y) + (cse_p12_t195_g1008 * (-(v2x))))) + (-((cse_p12_t183_g996 * cse_p13_t1_g1055 * v2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 2, h_z2_z4);
    h_x3_x3 = ((cse_p12_t159_g972 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t150_g963 * cse_p12_t205_g1018 * t2) + (cse_p12_t173_g986 * ((cse_p11_t4_invr812 * cse_p12_t150_g963) + (cse_p11_t4_invr812 * cse_p12_t219_g1032) + (cse_p12_t205_g1018 * (-(t1))))) + (cse_p12_t1_g1040 * (cse_p12_t1_g1037 + (cse_p11_t2_invsqrt810 * cse_p12_t184_g997 * v2x) + (cse_p11_t2_invsqrt810 * cse_p12_t184_g997 * v2x) + (-(cse_p12_t66_g879)))) + (cse_p13_t1_g1051 * ((cse_p12_t191_g1004 * v1z) + (cse_p12_t191_g1004 * v1z) + (cse_p12_t199_g1012 * (-(v1y))) + (cse_p12_t199_g1012 * (-(v1y))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
    h_x3_y3 = ((cse_p12_t154_g967 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t150_g963 * cse_p12_t168_g981) + (cse_p11_t4_invr812 * cse_p12_t173_g986 * cse_p12_t220_g1033) + (cse_p12_t150_g963 * cse_p12_t206_g1019 * t2) + (cse_p12_t173_g986 * cse_p12_t206_g1019 * (-(t1))) + (cse_p12_t1_g1040 * ((cse_p11_t2_invsqrt810 * cse_p12_t181_g994 * v2x) + (cse_p11_t2_invsqrt810 * cse_p12_t184_g997 * v2y) + (-(cse_p12_t67_g880)))) + (cse_p13_t1_g1051 * ((cse_p12_t189_g1002 * (-(v1y))) + (cse_p12_t199_g1012 * v1x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
    h_x3_z3 = ((cse_p12_t153_g966 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t150_g963 * cse_p12_t167_g980) + (cse_p11_t4_invr812 * cse_p12_t173_g986 * cse_p12_t221_g1034) + (cse_p12_t150_g963 * cse_p12_t207_g1020 * t2) + (cse_p12_t173_g986 * cse_p14_t1_g1067) + (cse_p12_t1_g1040 * ((cse_p11_t2_invsqrt810 * cse_p12_t180_g993 * v2x) + (cse_p11_t2_invsqrt810 * cse_p12_t184_g997 * v2z) + (-(cse_p12_t68_g881)))) + (cse_p13_t1_g1051 * ((cse_p12_t191_g1004 * (-(v1x))) + (cse_p12_t198_g1011 * v1z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
    h_x3_x4 = ((cse_p12_t159_g972 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t150_g963 * cse_p12_t174_g987) + (cse_p11_t4_invr812 * cse_p12_t173_g986 * cse_p12_t215_g1028) + (cse_p12_t150_g963 * cse_p12_t210_g1023 * t2) + (cse_p12_t173_g986 * cse_p14_t1_g1066) + (cse_p12_t185_g998 * cse_p13_t1_g1055 * v2x) + (cse_p13_t1_g1051 * (((-(v1y)) * (-(v2y))) + (v1z * v2z))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 0, h_x3_x4);
    h_x3_y4 = ((cse_p12_t155_g968 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t150_g963 * cse_p12_t169_g982) + (cse_p11_t4_invr812 * cse_p12_t173_g986 * cse_p12_t213_g1026) + (cse_p12_t150_g963 * cse_p12_t208_g1021 * t2) + (cse_p12_t173_g986 * cse_p14_t1_g1063) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * v1z) + (cse_p11_t2_invsqrt810 * cse_p12_t182_g995 * v2x))) + (cse_p13_t1_g1051 * (c1z + (v2x * (-(v1y))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 1, h_x3_y4);
    h_x3_z4 = ((cse_p12_t157_g970 * cse_p12_t159_g972 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t150_g963 * cse_p12_t171_g984) + (cse_p11_t4_invr812 * cse_p12_t173_g986 * cse_p12_t214_g1027) + (cse_p12_t150_g963 * cse_p12_t209_g1022 * t2) + (cse_p12_t173_g986 * cse_p14_t1_g1061) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * (-(v1y))) + (cse_p11_t2_invsqrt810 * cse_p12_t183_g996 * v2x))) + (cse_p13_t1_g1051 * ((v1z * (-(v2x))) + (-(c1y)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 2, h_x3_z4);
    h_y3_y3 = ((cse_p12_t154_g967 * cse_p12_t154_g967 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t151_g964 * cse_p12_t206_g1019 * t2) + (cse_p12_t168_g981 * ((cse_p11_t4_invr812 * cse_p12_t151_g964) + (cse_p11_t4_invr812 * cse_p12_t220_g1033) + (cse_p12_t206_g1019 * (-(t1))))) + (cse_p12_t1_g1040 * (cse_p12_t1_g1037 + (cse_p11_t2_invsqrt810 * cse_p12_t181_g994 * v2y) + (cse_p11_t2_invsqrt810 * cse_p12_t181_g994 * v2y) + (-(cse_p12_t69_g882)))) + (cse_p13_t1_g1051 * ((cse_p12_t189_g1002 * v1x) + (cse_p12_t189_g1002 * v1x) + (cse_p12_t200_g1013 * (-(v1z))) + (cse_p12_t200_g1013 * (-(v1z))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
    h_y3_z3 = ((cse_p12_t153_g966 * cse_p12_t154_g967 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t151_g964 * cse_p12_t167_g980) + (cse_p11_t4_invr812 * cse_p12_t168_g981 * cse_p12_t221_g1034) + (cse_p12_t151_g964 * cse_p12_t207_g1020 * t2) + (cse_p12_t168_g981 * cse_p14_t1_g1067) + (cse_p12_t1_g1040 * ((cse_p11_t2_invsqrt810 * cse_p12_t180_g993 * v2y) + (cse_p11_t2_invsqrt810 * cse_p12_t181_g994 * v2z) + (-(cse_p12_t70_g883)))) + (cse_p13_t1_g1051 * ((cse_p12_t190_g1003 * (-(v1z))) + (cse_p12_t200_g1013 * v1y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
    h_y3_x4 = ((cse_p12_t154_g967 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t151_g964 * cse_p12_t174_g987) + (cse_p11_t4_invr812 * cse_p12_t168_g981 * cse_p12_t215_g1028) + (cse_p12_t151_g964 * cse_p12_t210_g1023 * t2) + (cse_p12_t168_g981 * cse_p14_t1_g1066) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * (-(v1z))) + (cse_p11_t2_invsqrt810 * cse_p12_t185_g998 * v2y))) + (cse_p13_t1_g1051 * ((v1x * (-(v2y))) + (-(c1z)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 0, h_y3_x4);
    h_y3_y4 = ((cse_p12_t154_g967 * cse_p12_t155_g968 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t151_g964 * cse_p12_t169_g982) + (cse_p11_t4_invr812 * cse_p12_t168_g981 * cse_p12_t213_g1026) + (cse_p12_t151_g964 * cse_p12_t208_g1021 * t2) + (cse_p12_t168_g981 * cse_p14_t1_g1063) + (cse_p12_t182_g995 * cse_p13_t1_g1055 * v2y) + (cse_p13_t1_g1051 * (((-(v1z)) * (-(v2z))) + (v1x * v2x))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 1, h_y3_y4);
    h_y3_z4 = ((cse_p12_t154_g967 * cse_p12_t157_g970 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t151_g964 * cse_p12_t171_g984) + (cse_p11_t4_invr812 * cse_p12_t168_g981 * cse_p12_t214_g1027) + (cse_p12_t151_g964 * cse_p12_t209_g1022 * t2) + (cse_p12_t168_g981 * cse_p14_t1_g1061) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * v1x) + (cse_p11_t2_invsqrt810 * cse_p12_t183_g996 * v2y))) + (cse_p13_t1_g1051 * (c1x + (v2y * (-(v1z))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 2, h_y3_z4);
    h_z3_z3 = ((cse_p12_t153_g966 * cse_p12_t153_g966 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t152_g965 * cse_p12_t207_g1020 * t2) + (cse_p12_t167_g980 * (cse_p14_t1_g1067 + (cse_p11_t4_invr812 * cse_p12_t152_g965) + (cse_p11_t4_invr812 * cse_p12_t221_g1034))) + (cse_p12_t1_g1040 * (cse_p12_t1_g1037 + (cse_p11_t2_invsqrt810 * cse_p12_t180_g993 * v2z) + (cse_p11_t2_invsqrt810 * cse_p12_t180_g993 * v2z) + (-(cse_p12_t71_g884)))) + (cse_p13_t1_g1051 * ((cse_p12_t190_g1003 * v1y) + (cse_p12_t190_g1003 * v1y) + (cse_p12_t198_g1011 * (-(v1x))) + (cse_p12_t198_g1011 * (-(v1x))))))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
    h_z3_x4 = ((cse_p12_t153_g966 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t152_g965 * cse_p12_t174_g987) + (cse_p11_t4_invr812 * cse_p12_t167_g980 * cse_p12_t215_g1028) + (cse_p12_t152_g965 * cse_p12_t210_g1023 * t2) + (cse_p12_t167_g980 * cse_p14_t1_g1066) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * v1y) + (cse_p11_t2_invsqrt810 * cse_p12_t185_g998 * v2z))) + (cse_p13_t1_g1051 * (c1y + (v2z * (-(v1x))))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 0, h_z3_x4);
    h_z3_y4 = ((cse_p12_t153_g966 * cse_p12_t155_g968 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t152_g965 * cse_p12_t169_g982) + (cse_p11_t4_invr812 * cse_p12_t167_g980 * cse_p12_t213_g1026) + (cse_p12_t152_g965 * cse_p12_t208_g1021 * t2) + (cse_p12_t167_g980 * cse_p14_t1_g1063) + (cse_p12_t1_g1040 * ((cse_p11_t1_sqrt809 * (-(v1x))) + (cse_p11_t2_invsqrt810 * cse_p12_t182_g995 * v2z))) + (cse_p13_t1_g1051 * ((v1y * (-(v2z))) + (-(c1x)))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 1, h_z3_y4);
    h_z3_z4 = ((cse_p12_t153_g966 * cse_p12_t157_g970 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t152_g965 * cse_p12_t171_g984) + (cse_p11_t4_invr812 * cse_p12_t167_g980 * cse_p12_t214_g1027) + (cse_p12_t152_g965 * cse_p12_t209_g1022 * t2) + (cse_p12_t167_g980 * cse_p14_t1_g1061) + (cse_p12_t183_g996 * cse_p13_t1_g1055 * v2z) + (cse_p13_t1_g1051 * (((-(v1x)) * (-(v2x))) + (v1y * v2y))))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 2, h_z3_z4);
    h_x4_x4 = ((cse_p12_t160_g973 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t174_g987 * (cse_p14_t1_g1066 + (cse_p11_t4_invr812 * cse_p12_t215_g1028) + (cse_p12_t185_g998 * cse_p13_t1_g1050))) + (cse_p12_t185_g998 * cse_p12_t1_g1043 * cse_p12_t210_g1023))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 0, h_x4_x4);
    h_x4_y4 = ((cse_p12_t155_g968 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t174_g987 * cse_p12_t213_g1026) + (cse_p12_t169_g982 * cse_p12_t185_g998 * cse_p13_t1_g1050) + (cse_p12_t174_g987 * cse_p14_t1_g1063) + (cse_p12_t185_g998 * cse_p12_t1_g1043 * cse_p12_t208_g1021))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 1, h_x4_y4);
    h_x4_z4 = ((cse_p12_t157_g970 * cse_p12_t160_g973 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t174_g987 * cse_p12_t214_g1027) + (cse_p12_t171_g984 * cse_p12_t185_g998 * cse_p13_t1_g1050) + (cse_p12_t174_g987 * cse_p14_t1_g1061) + (cse_p12_t185_g998 * cse_p12_t1_g1043 * cse_p12_t209_g1022))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 2, h_x4_z4);
    h_y4_y4 = ((cse_p12_t155_g968 * cse_p12_t155_g968 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t169_g982 * (cse_p14_t1_g1063 + (cse_p11_t4_invr812 * cse_p12_t213_g1026) + (cse_p12_t182_g995 * cse_p13_t1_g1050))) + (cse_p12_t182_g995 * cse_p12_t1_g1043 * cse_p12_t208_g1021))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 1, h_y4_y4);
    h_y4_z4 = ((cse_p12_t155_g968 * cse_p12_t157_g970 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p11_t4_invr812 * cse_p12_t169_g982 * cse_p12_t214_g1027) + (cse_p12_t169_g982 * cse_p14_t1_g1061) + (cse_p12_t171_g984 * cse_p12_t182_g995 * cse_p13_t1_g1050) + (cse_p12_t182_g995 * cse_p12_t1_g1043 * cse_p12_t209_g1022))));
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 2, h_y4_z4);
    h_z4_z4 = ((cse_p12_t157_g970 * cse_p12_t157_g970 * cse_p12_t1_g1041) + (cse_p12_t1_g1042 * ((cse_p12_t171_g984 * (cse_p14_t1_g1061 + (cse_p11_t4_invr812 * cse_p12_t214_g1027) + (cse_p12_t183_g996 * cse_p13_t1_g1050))) + (cse_p12_t183_g996 * cse_p12_t1_g1043 * cse_p12_t209_g1022))));
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 2, i3x4, 2, h_z4_z4);
  }
}
void hessian_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x4, 0, hval);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 1, hval);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 1, hval);
  }
}

};
