template <typename HESSIAN>
struct Dihedral_Fast {
  static constexpr size_t PositionSize = 12;
  static std::string description() { return "mathkernel-dihedral_fast"; };
double energy(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double c1x;
  double c1y;
  double c1z;
  double c2x;
  double c2y;
  double c2z;
  double cos_angle;
  double cos_nphi;
  double energy;
  double energy_added;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_len;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    DOUBLE x3 = position[i3x3 + 0];
    DOUBLE y3 = position[i3x3 + 1];
    DOUBLE z3 = position[i3x3 + 2];
    DOUBLE x4 = position[i3x4 + 0];
    DOUBLE y4 = position[i3x4 + 1];
    DOUBLE z4 = position[i3x4 + 2];
    {
      /* !BASE */
      v1x = (x2 + (-(x1)));
      v1y = (y2 + (-(y1)));
      v1z = (z2 + (-(z1)));
      v2x = (x3 + (-(x2)));
      v2y = (y3 + (-(y2)));
      v2z = (z3 + (-(z2)));
      v3x = (x4 + (-(x3)));
      v3y = (y4 + (-(y3)));
      v3z = (z4 + (-(z3)));
      c1x = ((v1y * v2z) + (-((v1z * v2y))));
      c1y = ((v1z * v2x) + (-((v1x * v2z))));
      c1z = ((v1x * v2y) + (-((v1y * v2x))));
      c2x = ((v2y * v3z) + (-((v2z * v3y))));
      c2y = ((v2z * v3x) + (-((v2x * v3z))));
      c2z = ((v2x * v3y) + (-((v2y * v3x))));
      v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
      v2_len = sqrt(v2_sq);
      t1 = (v2_len * ((c2x * v1x) + (c2y * v1y) + (c2z * v1z)));
      t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
      phi = atan2(t1, t2);
      nphi = (n * phi);
      sin_nphi = sin(nphi);
      cos_nphi = cos(nphi);
      cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
      sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
      energy = (v * (1.0000000000000000     + cos_angle));
      energy_added += energy;
      *energy_accumulate += energy;
    }
  }
  return energy_added;
}
void energy_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, energy_accumulate, force, hessian, dvec, hdvec);
}

double gradient(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double c1x;
  double c1y;
  double c1z;
  double c2x;
  double c2y;
  double c2z;
  double cos_angle;
  double cos_nphi;
  double cse_p12_t10_g35159;
  double cse_p12_t11_g35160;
  double cse_p12_t12_g35161;
  double cse_p12_t13_g35162;
  double cse_p12_t14_g35163;
  double cse_p12_t1_g35150;
  double cse_p12_t1_g35164;
  double cse_p12_t1_g35165;
  double cse_p12_t1_g35166;
  double cse_p12_t1_g35167;
  double cse_p12_t1_g35168;
  double cse_p12_t1_g35169;
  double cse_p12_t2_g35151;
  double cse_p12_t3_g35152;
  double cse_p12_t4_g35153;
  double cse_p12_t5_g35154;
  double cse_p12_t6_g35155;
  double cse_p12_t7_g35156;
  double cse_p12_t8_g35157;
  double cse_p12_t9_g35158;
  double cse_p1_t1_sqrt35147;
  double cse_p1_t2_invsqrt35148;
  double cse_p1_t3_invr35149;
  double energy;
  double energy_added;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    DOUBLE x3 = position[i3x3 + 0];
    DOUBLE y3 = position[i3x3 + 1];
    DOUBLE z3 = position[i3x3 + 2];
    DOUBLE x4 = position[i3x4 + 0];
    DOUBLE y4 = position[i3x4 + 1];
    DOUBLE z4 = position[i3x4 + 2];
    {
      /* !BASE */
      v1x = (x2 + (-(x1)));
      v1y = (y2 + (-(y1)));
      v1z = (z2 + (-(z1)));
      v2x = (x3 + (-(x2)));
      cse_p12_t6_g35155 = (v1z * v2x);
      v2y = (y3 + (-(y2)));
      cse_p12_t4_g35153 = (v1x * v2y);
      v2z = (z3 + (-(z2)));
      cse_p12_t5_g35154 = (v1y * v2z);
      v3x = (x4 + (-(x3)));
      cse_p12_t8_g35157 = ((-(v2x)) + (-(v3x)));
      cse_p12_t11_g35160 = (v2x + v3x);
      v3y = (y4 + (-(y3)));
      cse_p12_t9_g35158 = ((-(v2y)) + (-(v3y)));
      cse_p12_t12_g35161 = (v2y + v3y);
      v3z = (z4 + (-(z3)));
      cse_p12_t10_g35159 = ((-(v2z)) + (-(v3z)));
      cse_p12_t13_g35162 = (v2z + v3z);
      c1x = (cse_p12_t5_g35154 + (-((v1z * v2y))));
      c1y = (cse_p12_t6_g35155 + (-((v1x * v2z))));
      c1z = (cse_p12_t4_g35153 + (-((v1y * v2x))));
      c2x = ((v2y * v3z) + (-((v2z * v3y))));
      cse_p12_t1_g35150 = (c2x * v1x);
      c2y = ((v2z * v3x) + (-((v2x * v3z))));
      cse_p12_t2_g35151 = (c2y * v1y);
      c2z = ((v2x * v3y) + (-((v2y * v3x))));
      cse_p12_t3_g35152 = (c2z * v1z);
      cse_p12_t7_g35156 = (cse_p12_t1_g35150 + cse_p12_t2_g35151 + cse_p12_t3_g35152);
      v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
      cse_p1_t1_sqrt35147 = sqrt(v2_sq);
      cse_p1_t2_invsqrt35148 = (1.0 / (cse_p1_t1_sqrt35147));
      t1 = (cse_p12_t7_g35156 * cse_p1_t1_sqrt35147);
      t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
      phi = atan2(t1, t2);
      nphi = (n * phi);
      cse_p12_t14_g35163 = (-(sin(nphi)));
      sin_nphi = sin(nphi);
      cos_nphi = cos(nphi);
      cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
      sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
      energy = (v * (1.0000000000000000     + cos_angle));
      energy_added += energy;
      *energy_accumulate += energy;
      cse_p1_t3_invr35149 = (1.0 / ((((t1) * (t1)) + ((t2) * (t2)))));
      cse_p12_t1_g35164 = (cse_p1_t3_invr35149 * (-(t1)));
      cse_p12_t1_g35165 = (cse_p1_t3_invr35149 * t2);
      cse_p12_t1_g35166 = (cos_nphi * n * sinphase);
      cse_p12_t1_g35167 = (cosphase * cse_p12_t14_g35163 * n);
      cse_p12_t1_g35168 = (cse_p12_t1_g35165 * cse_p1_t1_sqrt35147);
      g_x1 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c2y * v2z) + (c2z * (-(v2y))))) + (cse_p12_t1_g35168 * (-(c2x))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c2y * v2z) + (c2z * (-(v2y))))) + (cse_p12_t1_g35168 * (-(c2x)))))));
      KernelGradientAcc(i3x1, 0, g_x1);
      g_y1 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c2x * (-(v2z))) + (c2z * v2x))) + (cse_p12_t1_g35168 * (-(c2y))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c2x * (-(v2z))) + (c2z * v2x))) + (cse_p12_t1_g35168 * (-(c2y)))))));
      KernelGradientAcc(i3x1, 1, g_y1);
      g_z1 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c2x * v2y) + (c2y * (-(v2x))))) + (cse_p12_t1_g35168 * (-(c2z))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c2x * v2y) + (c2y * (-(v2x))))) + (cse_p12_t1_g35168 * (-(c2z)))))));
      KernelGradientAcc(i3x1, 2, g_z1);
      cse_p12_t1_g35169 = (cse_p12_t7_g35156 * cse_p1_t2_invsqrt35148);
      g_x2 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1y * v3z) + (c1z * (-(v3y))) + (c2y * ((-(v1z)) + (-(v2z)))) + (c2z * (v1y + v2y)))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * (-(v2x))) + (cse_p1_t1_sqrt35147 * (c2x + (v1y * v3z) + (v1z * (-(v3y))))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1y * v3z) + (c1z * (-(v3y))) + (c2y * ((-(v1z)) + (-(v2z)))) + (c2z * (v1y + v2y)))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * (-(v2x))) + (cse_p1_t1_sqrt35147 * (c2x + (v1y * v3z) + (v1z * (-(v3y)))))))))));
      KernelGradientAcc(i3x2, 0, g_x2);
      g_y2 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1x * (-(v3z))) + (c1z * v3x) + (c2x * (v1z + v2z)) + (c2z * ((-(v1x)) + (-(v2x)))))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * (-(v2y))) + (cse_p1_t1_sqrt35147 * (c2y + (v1x * (-(v3z))) + (v1z * v3x))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1x * (-(v3z))) + (c1z * v3x) + (c2x * (v1z + v2z)) + (c2z * ((-(v1x)) + (-(v2x)))))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * (-(v2y))) + (cse_p1_t1_sqrt35147 * (c2y + (v1x * (-(v3z))) + (v1z * v3x)))))))));
      KernelGradientAcc(i3x2, 1, g_y2);
      g_z2 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1x * v3y) + (c1y * (-(v3x))) + (c2x * ((-(v1y)) + (-(v2y)))) + (c2y * (v1x + v2x)))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * (-(v2z))) + (cse_p1_t1_sqrt35147 * (c2z + (v1x * v3y) + (v1y * (-(v3x))))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1x * v3y) + (c1y * (-(v3x))) + (c2x * ((-(v1y)) + (-(v2y)))) + (c2y * (v1x + v2x)))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * (-(v2z))) + (cse_p1_t1_sqrt35147 * (c2z + (v1x * v3y) + (v1y * (-(v3x)))))))))));
      KernelGradientAcc(i3x2, 2, g_z2);
      g_x3 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1y * cse_p12_t10_g35159) + (c1z * cse_p12_t12_g35161) + (c2y * v1z) + (c2z * (-(v1y))))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * v2x) + (cse_p1_t1_sqrt35147 * ((cse_p12_t10_g35159 * v1y) + (cse_p12_t12_g35161 * v1z))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1y * cse_p12_t10_g35159) + (c1z * cse_p12_t12_g35161) + (c2y * v1z) + (c2z * (-(v1y))))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * v2x) + (cse_p1_t1_sqrt35147 * ((cse_p12_t10_g35159 * v1y) + (cse_p12_t12_g35161 * v1z)))))))));
      KernelGradientAcc(i3x3, 0, g_x3);
      g_y3 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1x * cse_p12_t13_g35162) + (c1z * cse_p12_t8_g35157) + (c2x * (-(v1z))) + (c2z * v1x))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * v2y) + (cse_p1_t1_sqrt35147 * ((cse_p12_t13_g35162 * v1x) + (cse_p12_t8_g35157 * v1z))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1x * cse_p12_t13_g35162) + (c1z * cse_p12_t8_g35157) + (c2x * (-(v1z))) + (c2z * v1x))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * v2y) + (cse_p1_t1_sqrt35147 * ((cse_p12_t13_g35162 * v1x) + (cse_p12_t8_g35157 * v1z)))))))));
      KernelGradientAcc(i3x3, 1, g_y3);
      g_z3 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1x * cse_p12_t9_g35158) + (c1y * cse_p12_t11_g35160) + (c2x * v1y) + (c2y * (-(v1x))))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * v2z) + (cse_p1_t1_sqrt35147 * ((cse_p12_t11_g35160 * v1y) + (cse_p12_t9_g35158 * v1x))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1x * cse_p12_t9_g35158) + (c1y * cse_p12_t11_g35160) + (c2x * v1y) + (c2y * (-(v1x))))) + (cse_p12_t1_g35165 * ((cse_p12_t1_g35169 * v2z) + (cse_p1_t1_sqrt35147 * ((cse_p12_t11_g35160 * v1y) + (cse_p12_t9_g35158 * v1x)))))))));
      KernelGradientAcc(i3x3, 2, g_z3);
      g_x4 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1y * v2z) + (c1z * (-(v2y))))) + (cse_p12_t1_g35168 * (cse_p12_t5_g35154 + (v1z * (-(v2y))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1y * v2z) + (c1z * (-(v2y))))) + (cse_p12_t1_g35168 * (cse_p12_t5_g35154 + (v1z * (-(v2y)))))))));
      KernelGradientAcc(i3x4, 0, g_x4);
      g_y4 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1x * (-(v2z))) + (c1z * v2x))) + (cse_p12_t1_g35168 * (cse_p12_t6_g35155 + (v1x * (-(v2z))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1x * (-(v2z))) + (c1z * v2x))) + (cse_p12_t1_g35168 * (cse_p12_t6_g35155 + (v1x * (-(v2z)))))))));
      KernelGradientAcc(i3x4, 1, g_y4);
      g_z4 = (v * ((cse_p12_t1_g35166 * ((cse_p12_t1_g35164 * ((c1x * v2y) + (c1y * (-(v2x))))) + (cse_p12_t1_g35168 * (cse_p12_t4_g35153 + (v1y * (-(v2x))))))) + (cse_p12_t1_g35167 * ((cse_p12_t1_g35164 * ((c1x * v2y) + (c1y * (-(v2x))))) + (cse_p12_t1_g35168 * (cse_p12_t4_g35153 + (v1y * (-(v2x)))))))));
      KernelGradientAcc(i3x4, 2, g_z4);
    }
  }
  return energy_added;
}
void gradient_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  double e0 = 0.0;
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
}

double hessian(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec) {
  double c1x;
  double c1y;
  double c1z;
  double c2x;
  double c2y;
  double c2z;
  double cos_angle;
  double cos_nphi;
  double cse_p11_t1_sqrt35173;
  double cse_p11_t2_invsqrt35174;
  double cse_p11_t3_invr35175;
  double cse_p11_t4_invr35176;
  double cse_p11_t5_invr235177;
  double cse_p12_t100_g35277;
  double cse_p12_t101_g35278;
  double cse_p12_t102_g35279;
  double cse_p12_t103_g35280;
  double cse_p12_t104_g35281;
  double cse_p12_t105_g35282;
  double cse_p12_t106_g35283;
  double cse_p12_t107_g35284;
  double cse_p12_t108_g35285;
  double cse_p12_t109_g35286;
  double cse_p12_t10_g35187;
  double cse_p12_t110_g35287;
  double cse_p12_t111_g35288;
  double cse_p12_t112_g35289;
  double cse_p12_t113_g35290;
  double cse_p12_t114_g35291;
  double cse_p12_t115_g35292;
  double cse_p12_t116_g35293;
  double cse_p12_t117_g35294;
  double cse_p12_t118_g35295;
  double cse_p12_t119_g35296;
  double cse_p12_t11_g35188;
  double cse_p12_t120_g35297;
  double cse_p12_t121_g35298;
  double cse_p12_t122_g35299;
  double cse_p12_t123_g35300;
  double cse_p12_t124_g35301;
  double cse_p12_t125_g35302;
  double cse_p12_t126_g35303;
  double cse_p12_t127_g35304;
  double cse_p12_t12_g35189;
  double cse_p12_t130_g35307;
  double cse_p12_t131_g35308;
  double cse_p12_t133_g35310;
  double cse_p12_t134_g35311;
  double cse_p12_t135_g35312;
  double cse_p12_t136_g35313;
  double cse_p12_t137_g35314;
  double cse_p12_t138_g35315;
  double cse_p12_t139_g35316;
  double cse_p12_t13_g35190;
  double cse_p12_t140_g35317;
  double cse_p12_t141_g35318;
  double cse_p12_t142_g35319;
  double cse_p12_t143_g35320;
  double cse_p12_t144_g35321;
  double cse_p12_t145_g35322;
  double cse_p12_t146_g35323;
  double cse_p12_t147_g35324;
  double cse_p12_t148_g35325;
  double cse_p12_t149_g35326;
  double cse_p12_t14_g35191;
  double cse_p12_t150_g35327;
  double cse_p12_t151_g35328;
  double cse_p12_t152_g35329;
  double cse_p12_t153_g35330;
  double cse_p12_t154_g35331;
  double cse_p12_t155_g35332;
  double cse_p12_t156_g35333;
  double cse_p12_t157_g35334;
  double cse_p12_t158_g35335;
  double cse_p12_t159_g35336;
  double cse_p12_t15_g35192;
  double cse_p12_t160_g35337;
  double cse_p12_t161_g35338;
  double cse_p12_t162_g35339;
  double cse_p12_t163_g35340;
  double cse_p12_t164_g35341;
  double cse_p12_t165_g35342;
  double cse_p12_t166_g35343;
  double cse_p12_t167_g35344;
  double cse_p12_t168_g35345;
  double cse_p12_t169_g35346;
  double cse_p12_t16_g35193;
  double cse_p12_t170_g35347;
  double cse_p12_t171_g35348;
  double cse_p12_t172_g35349;
  double cse_p12_t173_g35350;
  double cse_p12_t174_g35351;
  double cse_p12_t175_g35352;
  double cse_p12_t176_g35353;
  double cse_p12_t177_g35354;
  double cse_p12_t178_g35355;
  double cse_p12_t179_g35356;
  double cse_p12_t17_g35194;
  double cse_p12_t180_g35357;
  double cse_p12_t181_g35358;
  double cse_p12_t182_g35359;
  double cse_p12_t183_g35360;
  double cse_p12_t184_g35361;
  double cse_p12_t185_g35362;
  double cse_p12_t186_g35363;
  double cse_p12_t187_g35364;
  double cse_p12_t188_g35365;
  double cse_p12_t189_g35366;
  double cse_p12_t18_g35195;
  double cse_p12_t190_g35367;
  double cse_p12_t191_g35368;
  double cse_p12_t192_g35369;
  double cse_p12_t193_g35370;
  double cse_p12_t194_g35371;
  double cse_p12_t195_g35372;
  double cse_p12_t196_g35373;
  double cse_p12_t197_g35374;
  double cse_p12_t198_g35375;
  double cse_p12_t199_g35376;
  double cse_p12_t19_g35196;
  double cse_p12_t1_g35178;
  double cse_p12_t1_g35401;
  double cse_p12_t1_g35402;
  double cse_p12_t1_g35404;
  double cse_p12_t1_g35405;
  double cse_p12_t1_g35406;
  double cse_p12_t1_g35407;
  double cse_p12_t1_g35408;
  double cse_p12_t1_g35409;
  double cse_p12_t1_g35410;
  double cse_p12_t1_g35411;
  double cse_p12_t1_g35412;
  double cse_p12_t1_g35413;
  double cse_p12_t200_g35377;
  double cse_p12_t201_g35378;
  double cse_p12_t202_g35379;
  double cse_p12_t203_g35380;
  double cse_p12_t204_g35381;
  double cse_p12_t205_g35382;
  double cse_p12_t206_g35383;
  double cse_p12_t207_g35384;
  double cse_p12_t208_g35385;
  double cse_p12_t209_g35386;
  double cse_p12_t20_g35197;
  double cse_p12_t210_g35387;
  double cse_p12_t211_g35388;
  double cse_p12_t212_g35389;
  double cse_p12_t213_g35390;
  double cse_p12_t214_g35391;
  double cse_p12_t215_g35392;
  double cse_p12_t216_g35393;
  double cse_p12_t217_g35394;
  double cse_p12_t218_g35395;
  double cse_p12_t219_g35396;
  double cse_p12_t21_g35198;
  double cse_p12_t220_g35397;
  double cse_p12_t221_g35398;
  double cse_p12_t222_g35399;
  double cse_p12_t223_g35400;
  double cse_p12_t22_g35199;
  double cse_p12_t23_g35200;
  double cse_p12_t24_g35201;
  double cse_p12_t25_g35202;
  double cse_p12_t26_g35203;
  double cse_p12_t27_g35204;
  double cse_p12_t28_g35205;
  double cse_p12_t29_g35206;
  double cse_p12_t2_g35179;
  double cse_p12_t30_g35207;
  double cse_p12_t31_g35208;
  double cse_p12_t32_g35209;
  double cse_p12_t33_g35210;
  double cse_p12_t34_g35211;
  double cse_p12_t35_g35212;
  double cse_p12_t36_g35213;
  double cse_p12_t37_g35214;
  double cse_p12_t38_g35215;
  double cse_p12_t39_g35216;
  double cse_p12_t3_g35180;
  double cse_p12_t40_g35217;
  double cse_p12_t41_g35218;
  double cse_p12_t42_g35219;
  double cse_p12_t43_g35220;
  double cse_p12_t44_g35221;
  double cse_p12_t45_g35222;
  double cse_p12_t46_g35223;
  double cse_p12_t47_g35224;
  double cse_p12_t48_g35225;
  double cse_p12_t49_g35226;
  double cse_p12_t4_g35181;
  double cse_p12_t50_g35227;
  double cse_p12_t51_g35228;
  double cse_p12_t52_g35229;
  double cse_p12_t53_g35230;
  double cse_p12_t54_g35231;
  double cse_p12_t55_g35232;
  double cse_p12_t56_g35233;
  double cse_p12_t57_g35234;
  double cse_p12_t58_g35235;
  double cse_p12_t59_g35236;
  double cse_p12_t5_g35182;
  double cse_p12_t60_g35237;
  double cse_p12_t61_g35238;
  double cse_p12_t62_g35239;
  double cse_p12_t63_g35240;
  double cse_p12_t64_g35241;
  double cse_p12_t66_g35243;
  double cse_p12_t67_g35244;
  double cse_p12_t68_g35245;
  double cse_p12_t69_g35246;
  double cse_p12_t6_g35183;
  double cse_p12_t70_g35247;
  double cse_p12_t71_g35248;
  double cse_p12_t72_g35249;
  double cse_p12_t73_g35250;
  double cse_p12_t74_g35251;
  double cse_p12_t75_g35252;
  double cse_p12_t76_g35253;
  double cse_p12_t77_g35254;
  double cse_p12_t78_g35255;
  double cse_p12_t79_g35256;
  double cse_p12_t7_g35184;
  double cse_p12_t80_g35257;
  double cse_p12_t81_g35258;
  double cse_p12_t82_g35259;
  double cse_p12_t83_g35260;
  double cse_p12_t84_g35261;
  double cse_p12_t85_g35262;
  double cse_p12_t86_g35263;
  double cse_p12_t87_g35264;
  double cse_p12_t88_g35265;
  double cse_p12_t89_g35266;
  double cse_p12_t8_g35185;
  double cse_p12_t90_g35267;
  double cse_p12_t91_g35268;
  double cse_p12_t92_g35269;
  double cse_p12_t93_g35270;
  double cse_p12_t94_g35271;
  double cse_p12_t95_g35272;
  double cse_p12_t96_g35273;
  double cse_p12_t97_g35274;
  double cse_p12_t98_g35275;
  double cse_p12_t99_g35276;
  double cse_p12_t9_g35186;
  double cse_p13_t1_g35414;
  double cse_p13_t1_g35415;
  double cse_p13_t1_g35416;
  double cse_p13_t1_g35417;
  double cse_p13_t1_g35418;
  double cse_p13_t1_g35419;
  double cse_p13_t1_g35420;
  double cse_p13_t1_g35421;
  double cse_p13_t1_g35422;
  double cse_p13_t1_g35423;
  double cse_p14_t1_g35424;
  double cse_p14_t1_g35425;
  double cse_p14_t1_g35426;
  double cse_p14_t1_g35427;
  double cse_p14_t1_g35428;
  double cse_p14_t1_g35429;
  double cse_p14_t1_g35430;
  double cse_p14_t1_g35431;
  double cse_p14_t1_g35432;
  double cse_p14_t1_g35433;
  double cse_p15_t1_g35434;
  double energy;
  double energy_added;
  double g_x1;
  double g_x2;
  double g_x3;
  double g_x4;
  double g_y1;
  double g_y2;
  double g_y3;
  double g_y4;
  double g_z1;
  double g_z2;
  double g_z3;
  double g_z4;
  double h_x1_x1;
  double h_x1_x2;
  double h_x1_x3;
  double h_x1_x4;
  double h_x1_y1;
  double h_x1_y2;
  double h_x1_y3;
  double h_x1_y4;
  double h_x1_z1;
  double h_x1_z2;
  double h_x1_z3;
  double h_x1_z4;
  double h_x2_x2;
  double h_x2_x3;
  double h_x2_x4;
  double h_x2_y2;
  double h_x2_y3;
  double h_x2_y4;
  double h_x2_z2;
  double h_x2_z3;
  double h_x2_z4;
  double h_x3_x3;
  double h_x3_x4;
  double h_x3_y3;
  double h_x3_y4;
  double h_x3_z3;
  double h_x3_z4;
  double h_x4_x4;
  double h_x4_y4;
  double h_x4_z4;
  double h_y1_x2;
  double h_y1_x3;
  double h_y1_x4;
  double h_y1_y1;
  double h_y1_y2;
  double h_y1_y3;
  double h_y1_y4;
  double h_y1_z1;
  double h_y1_z2;
  double h_y1_z3;
  double h_y1_z4;
  double h_y2_x3;
  double h_y2_x4;
  double h_y2_y2;
  double h_y2_y3;
  double h_y2_y4;
  double h_y2_z2;
  double h_y2_z3;
  double h_y2_z4;
  double h_y3_x4;
  double h_y3_y3;
  double h_y3_y4;
  double h_y3_z3;
  double h_y3_z4;
  double h_y4_y4;
  double h_y4_z4;
  double h_z1_x2;
  double h_z1_x3;
  double h_z1_x4;
  double h_z1_y2;
  double h_z1_y3;
  double h_z1_y4;
  double h_z1_z1;
  double h_z1_z2;
  double h_z1_z3;
  double h_z1_z4;
  double h_z2_x3;
  double h_z2_x4;
  double h_z2_y3;
  double h_z2_y4;
  double h_z2_z2;
  double h_z2_z3;
  double h_z2_z4;
  double h_z3_x4;
  double h_z3_y4;
  double h_z3_z3;
  double h_z3_z4;
  double h_z4_z4;
  double nphi;
  double phi;
  double sin_angle;
  double sin_nphi;
  double t1;
  double t2;
  double v1x;
  double v1y;
  double v1z;
  double v2x;
  double v2y;
  double v2z;
  double v2_sq;
  double v3x;
  double v3y;
  double v3z;
  energy_added = 0.0000000000000000    ;
  {
    /* !BASE */
    DOUBLE x1 = position[i3x1 + 0];
    DOUBLE y1 = position[i3x1 + 1];
    DOUBLE z1 = position[i3x1 + 2];
    DOUBLE x2 = position[i3x2 + 0];
    DOUBLE y2 = position[i3x2 + 1];
    DOUBLE z2 = position[i3x2 + 2];
    DOUBLE x3 = position[i3x3 + 0];
    DOUBLE y3 = position[i3x3 + 1];
    DOUBLE z3 = position[i3x3 + 2];
    DOUBLE x4 = position[i3x4 + 0];
    DOUBLE y4 = position[i3x4 + 1];
    DOUBLE z4 = position[i3x4 + 2];
    {
      /* !BASE */
      v1x = (x2 + (-(x1)));
      v1y = (y2 + (-(y1)));
      v1z = (z2 + (-(z1)));
      v2x = (x3 + (-(x2)));
      cse_p12_t118_g35295 = (v1y * (-(v2x)));
      cse_p12_t126_g35303 = (v1z * v2x);
      cse_p12_t186_g35363 = ((-(v1x)) + (-(v2x)));
      cse_p12_t195_g35372 = (v1x + v2x);
      v2y = (y3 + (-(y2)));
      cse_p12_t114_g35291 = (v1x * v2y);
      cse_p12_t124_g35301 = (v1z * (-(v2y)));
      cse_p12_t183_g35360 = (cse_p12_t114_g35291 + cse_p12_t118_g35295);
      cse_p12_t187_g35364 = ((-(v1y)) + (-(v2y)));
      cse_p12_t196_g35373 = (v1y + v2y);
      v2z = (z3 + (-(z2)));
      cse_p12_t112_g35289 = (v1x * (-(v2z)));
      cse_p12_t120_g35297 = (v1y * v2z);
      cse_p12_t182_g35359 = (cse_p12_t112_g35289 + cse_p12_t126_g35303);
      cse_p12_t185_g35362 = (cse_p12_t120_g35297 + cse_p12_t124_g35301);
      cse_p12_t188_g35365 = ((-(v1z)) + (-(v2z)));
      cse_p12_t197_g35374 = (v1z + v2z);
      v3x = (x4 + (-(x3)));
      cse_p12_t117_g35294 = (v1y * (v2x + v3x));
      cse_p12_t119_g35296 = (v1y * (-(v3x)));
      cse_p12_t122_g35299 = (v1z * ((-(v2x)) + (-(v3x))));
      cse_p12_t127_g35304 = (v1z * v3x);
      cse_p12_t189_g35366 = ((-(v2x)) + (-(v3x)));
      cse_p12_t198_g35375 = (v2x + v3x);
      v3y = (y4 + (-(y3)));
      cse_p12_t110_g35287 = (v1x * ((-(v2y)) + (-(v3y))));
      cse_p12_t115_g35292 = (v1x * v3y);
      cse_p12_t123_g35300 = (v1z * (v2y + v3y));
      cse_p12_t125_g35302 = (v1z * (-(v3y)));
      cse_p12_t180_g35357 = (cse_p12_t110_g35287 + cse_p12_t117_g35294);
      cse_p12_t190_g35367 = ((-(v2y)) + (-(v3y)));
      cse_p12_t199_g35376 = (v2y + v3y);
      v3z = (z4 + (-(z3)));
      cse_p12_t111_g35288 = (v1x * (v2z + v3z));
      cse_p12_t113_g35290 = (v1x * (-(v3z)));
      cse_p12_t116_g35293 = (v1y * ((-(v2z)) + (-(v3z))));
      cse_p12_t121_g35298 = (v1y * v3z);
      cse_p12_t181_g35358 = (cse_p12_t111_g35288 + cse_p12_t122_g35299);
      cse_p12_t184_g35361 = (cse_p12_t116_g35293 + cse_p12_t123_g35300);
      cse_p12_t191_g35368 = ((-(v2z)) + (-(v3z)));
      cse_p12_t200_g35377 = (v2z + v3z);
      c1x = (cse_p12_t120_g35297 + (-((v1z * v2y))));
      cse_p12_t23_g35200 = (c1x * cse_p12_t190_g35367);
      cse_p12_t24_g35201 = (c1x * cse_p12_t200_g35377);
      cse_p12_t25_g35202 = (c1x * (-(v2z)));
      cse_p12_t26_g35203 = (c1x * (-(v3z)));
      cse_p12_t27_g35204 = (c1x * v2y);
      cse_p12_t28_g35205 = (c1x * v3y);
      c1y = (cse_p12_t126_g35303 + (-((v1x * v2z))));
      cse_p12_t29_g35206 = (c1y * cse_p12_t191_g35368);
      cse_p12_t30_g35207 = (c1y * cse_p12_t198_g35375);
      cse_p12_t31_g35208 = (c1y * (-(v2x)));
      cse_p12_t32_g35209 = (c1y * (-(v3x)));
      cse_p12_t33_g35210 = (c1y * v2z);
      cse_p12_t34_g35211 = (c1y * v3z);
      cse_p12_t171_g35348 = (cse_p12_t27_g35204 + cse_p12_t31_g35208);
      c1z = (cse_p12_t114_g35291 + (-((v1y * v2x))));
      cse_p12_t35_g35212 = (c1z * cse_p12_t189_g35366);
      cse_p12_t36_g35213 = (c1z * cse_p12_t199_g35376);
      cse_p12_t37_g35214 = (c1z * (-(v2y)));
      cse_p12_t38_g35215 = (c1z * (-(v3y)));
      cse_p12_t39_g35216 = (c1z * v2x);
      cse_p12_t40_g35217 = (c1z * v3x);
      cse_p12_t169_g35346 = (cse_p12_t25_g35202 + cse_p12_t39_g35216);
      cse_p12_t174_g35351 = (cse_p12_t33_g35210 + cse_p12_t37_g35214);
      c2x = ((v2y * v3z) + (-((v2z * v3y))));
      cse_p12_t41_g35218 = (c2x * cse_p12_t187_g35364);
      cse_p12_t42_g35219 = (c2x * cse_p12_t197_g35374);
      cse_p12_t43_g35220 = (c2x * (-(v1z)));
      cse_p12_t44_g35221 = (c2x * (-(v2z)));
      cse_p12_t45_g35222 = (c2x * v1x);
      cse_p12_t46_g35223 = (c2x * v1y);
      cse_p12_t47_g35224 = (c2x * v2y);
      cse_p12_t192_g35369 = (c2x + cse_p12_t121_g35298 + cse_p12_t125_g35302);
      c2y = ((v2z * v3x) + (-((v2x * v3z))));
      cse_p12_t48_g35225 = (c2y * cse_p12_t188_g35365);
      cse_p12_t49_g35226 = (c2y * cse_p12_t195_g35372);
      cse_p12_t50_g35227 = (c2y * (-(v1x)));
      cse_p12_t51_g35228 = (c2y * (-(v2x)));
      cse_p12_t52_g35229 = (c2y * v1y);
      cse_p12_t53_g35230 = (c2y * v1z);
      cse_p12_t54_g35231 = (c2y * v2z);
      cse_p12_t167_g35344 = (cse_p12_t23_g35200 + cse_p12_t30_g35207 + cse_p12_t46_g35223 + cse_p12_t50_g35227);
      cse_p12_t172_g35349 = (cse_p12_t28_g35205 + cse_p12_t32_g35209 + cse_p12_t41_g35218 + cse_p12_t49_g35226);
      cse_p12_t178_g35355 = (cse_p12_t47_g35224 + cse_p12_t51_g35228);
      cse_p12_t193_g35370 = (c2y + cse_p12_t113_g35290 + cse_p12_t127_g35304);
      c2z = ((v2x * v3y) + (-((v2y * v3x))));
      cse_p12_t55_g35232 = (c2z * cse_p12_t186_g35363);
      cse_p12_t56_g35233 = (c2z * cse_p12_t196_g35373);
      cse_p12_t57_g35234 = (c2z * (-(v1y)));
      cse_p12_t58_g35235 = (c2z * (-(v2y)));
      cse_p12_t59_g35236 = (c2z * v1x);
      cse_p12_t60_g35237 = (c2z * v1z);
      cse_p12_t61_g35238 = (c2z * v2x);
      cse_p12_t168_g35345 = (cse_p12_t24_g35201 + cse_p12_t35_g35212 + cse_p12_t43_g35220 + cse_p12_t59_g35236);
      cse_p12_t170_g35347 = (cse_p12_t26_g35203 + cse_p12_t40_g35217 + cse_p12_t42_g35219 + cse_p12_t55_g35232);
      cse_p12_t173_g35350 = (cse_p12_t29_g35206 + cse_p12_t36_g35213 + cse_p12_t53_g35230 + cse_p12_t57_g35234);
      cse_p12_t175_g35352 = (cse_p12_t34_g35211 + cse_p12_t38_g35215 + cse_p12_t48_g35225 + cse_p12_t56_g35233);
      cse_p12_t176_g35353 = (cse_p12_t44_g35221 + cse_p12_t61_g35238);
      cse_p12_t177_g35354 = (cse_p12_t45_g35222 + cse_p12_t52_g35229 + cse_p12_t60_g35237);
      cse_p12_t179_g35356 = (cse_p12_t54_g35231 + cse_p12_t58_g35235);
      cse_p12_t194_g35371 = (c2z + cse_p12_t115_g35292 + cse_p12_t119_g35296);
      v2_sq = ((v2x * v2x) + (v2y * v2y) + (v2z * v2z));
      cse_p11_t1_sqrt35173 = sqrt(v2_sq);
      cse_p11_t2_invsqrt35174 = (1.0 / (cse_p11_t1_sqrt35173));
      cse_p12_t1_g35401 = (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354);
      cse_p12_t62_g35239 = (cse_p12_t1_g35401 * (-(v2x)));
      cse_p12_t63_g35240 = (cse_p12_t1_g35401 * (-(v2y)));
      cse_p12_t64_g35241 = (cse_p12_t1_g35401 * (-(v2z)));
      cse_p12_t72_g35249 = (cse_p12_t1_g35401 * v2x);
      cse_p12_t73_g35250 = (cse_p12_t1_g35401 * v2y);
      cse_p12_t74_g35251 = (cse_p12_t1_g35401 * v2z);
      cse_p12_t201_g35378 = (-(cse_p12_t1_g35401));
      cse_p11_t3_invr35175 = (cse_p11_t2_invsqrt35174 * cse_p11_t2_invsqrt35174);
      cse_p12_t66_g35243 = (cse_p11_t3_invr35175 * cse_p12_t1_g35401 * v2x * v2x);
      cse_p12_t67_g35244 = (cse_p11_t3_invr35175 * cse_p12_t1_g35401 * v2x * v2y);
      cse_p12_t68_g35245 = (cse_p11_t3_invr35175 * cse_p12_t1_g35401 * v2x * v2z);
      cse_p12_t69_g35246 = (cse_p11_t3_invr35175 * cse_p12_t1_g35401 * v2y * v2y);
      cse_p12_t70_g35247 = (cse_p11_t3_invr35175 * cse_p12_t1_g35401 * v2y * v2z);
      cse_p12_t71_g35248 = (cse_p11_t3_invr35175 * cse_p12_t1_g35401 * v2z * v2z);
      cse_p12_t1_g35408 = (cse_p11_t1_sqrt35173 * cse_p12_t180_g35357);
      cse_p12_t1_g35409 = (cse_p11_t1_sqrt35173 * cse_p12_t181_g35358);
      cse_p12_t130_g35307 = (cse_p11_t1_sqrt35173 * cse_p12_t182_g35359);
      cse_p12_t131_g35308 = (cse_p11_t1_sqrt35173 * cse_p12_t183_g35360);
      cse_p12_t1_g35410 = (cse_p11_t1_sqrt35173 * cse_p12_t184_g35361);
      cse_p12_t133_g35310 = (cse_p11_t1_sqrt35173 * cse_p12_t185_g35362);
      cse_p12_t134_g35311 = (cse_p11_t1_sqrt35173 * cse_p12_t192_g35369);
      cse_p12_t135_g35312 = (cse_p11_t1_sqrt35173 * cse_p12_t193_g35370);
      cse_p12_t136_g35313 = (cse_p11_t1_sqrt35173 * cse_p12_t194_g35371);
      cse_p12_t137_g35314 = (cse_p11_t1_sqrt35173 * (-(c2z)));
      cse_p12_t147_g35324 = (cse_p12_t134_g35311 + cse_p12_t62_g35239);
      cse_p12_t148_g35325 = (cse_p12_t135_g35312 + cse_p12_t63_g35240);
      cse_p12_t149_g35326 = (cse_p12_t136_g35313 + cse_p12_t64_g35241);
      cse_p12_t150_g35327 = (cse_p12_t1_g35410 + cse_p12_t72_g35249);
      cse_p12_t151_g35328 = (cse_p12_t1_g35409 + cse_p12_t73_g35250);
      cse_p12_t152_g35329 = (cse_p12_t1_g35408 + cse_p12_t74_g35251);
      cse_p12_t213_g35390 = (-(cse_p12_t130_g35307));
      cse_p12_t214_g35391 = (-(cse_p12_t131_g35308));
      cse_p12_t215_g35392 = (-(cse_p12_t133_g35310));
      cse_p12_t216_g35393 = (-(cse_p12_t147_g35324));
      cse_p12_t217_g35394 = (-(cse_p12_t148_g35325));
      cse_p12_t218_g35395 = (-(cse_p12_t149_g35326));
      cse_p12_t219_g35396 = (-(cse_p12_t150_g35327));
      cse_p12_t220_g35397 = (-(cse_p12_t151_g35328));
      cse_p12_t221_g35398 = (-(cse_p12_t152_g35329));
      cse_p12_t222_g35399 = (-(cse_p12_t137_g35314));
      t1 = (cse_p11_t1_sqrt35173 * cse_p12_t177_g35354);
      cse_p13_t1_g35417 = (2.0000000000000000     * t1);
      cse_p12_t1_g35178 = (cse_p12_t147_g35324 * cse_p13_t1_g35417);
      cse_p12_t2_g35179 = (cse_p12_t148_g35325 * cse_p13_t1_g35417);
      cse_p12_t3_g35180 = (cse_p12_t149_g35326 * cse_p13_t1_g35417);
      cse_p12_t4_g35181 = (cse_p12_t150_g35327 * cse_p13_t1_g35417);
      cse_p12_t5_g35182 = (cse_p12_t151_g35328 * cse_p13_t1_g35417);
      cse_p12_t6_g35183 = (cse_p12_t152_g35329 * cse_p13_t1_g35417);
      cse_p12_t7_g35184 = (cse_p11_t1_sqrt35173 * cse_p12_t182_g35359 * cse_p13_t1_g35417);
      cse_p12_t8_g35185 = (cse_p11_t1_sqrt35173 * cse_p12_t183_g35360 * cse_p13_t1_g35417);
      cse_p12_t9_g35186 = (cse_p11_t1_sqrt35173 * cse_p12_t185_g35362 * cse_p13_t1_g35417);
      cse_p12_t10_g35187 = (cse_p11_t1_sqrt35173 * cse_p13_t1_g35417 * (-(c2y)));
      cse_p12_t11_g35188 = (cse_p11_t1_sqrt35173 * cse_p13_t1_g35417 * (-(c2z)));
      t2 = ((c1x * c2x) + (c1y * c2y) + (c1z * c2z));
      cse_p13_t1_g35418 = (2.0000000000000000     * t2);
      cse_p12_t12_g35189 = (cse_p12_t167_g35344 * cse_p13_t1_g35418);
      cse_p12_t13_g35190 = (cse_p12_t168_g35345 * cse_p13_t1_g35418);
      cse_p12_t14_g35191 = (cse_p12_t169_g35346 * cse_p13_t1_g35418);
      cse_p12_t15_g35192 = (cse_p12_t170_g35347 * cse_p13_t1_g35418);
      cse_p12_t16_g35193 = (cse_p12_t171_g35348 * cse_p13_t1_g35418);
      cse_p12_t17_g35194 = (cse_p12_t172_g35349 * cse_p13_t1_g35418);
      cse_p12_t18_g35195 = (cse_p12_t173_g35350 * cse_p13_t1_g35418);
      cse_p12_t19_g35196 = (cse_p12_t174_g35351 * cse_p13_t1_g35418);
      cse_p12_t20_g35197 = (cse_p12_t175_g35352 * cse_p13_t1_g35418);
      cse_p12_t21_g35198 = (cse_p12_t176_g35353 * cse_p13_t1_g35418);
      cse_p12_t22_g35199 = (cse_p12_t178_g35355 * cse_p13_t1_g35418);
      cse_p12_t138_g35315 = (cse_p12_t1_g35178 + cse_p12_t20_g35197);
      cse_p12_t139_g35316 = (cse_p12_t15_g35192 + cse_p12_t2_g35179);
      cse_p12_t140_g35317 = (cse_p12_t17_g35194 + cse_p12_t3_g35180);
      cse_p12_t141_g35318 = (cse_p12_t18_g35195 + cse_p12_t4_g35181);
      cse_p12_t142_g35319 = (cse_p12_t13_g35190 + cse_p12_t5_g35182);
      cse_p12_t143_g35320 = (cse_p12_t12_g35189 + cse_p12_t6_g35183);
      cse_p12_t144_g35321 = (cse_p12_t14_g35191 + cse_p12_t7_g35184);
      cse_p12_t145_g35322 = (cse_p12_t16_g35193 + cse_p12_t8_g35185);
      cse_p12_t146_g35323 = (cse_p12_t19_g35196 + cse_p12_t9_g35186);
      cse_p12_t165_g35342 = (cse_p12_t10_g35187 + cse_p12_t21_g35198);
      cse_p12_t166_g35343 = (cse_p12_t11_g35188 + cse_p12_t22_g35199);
      phi = atan2(t1, t2);
      nphi = (n * phi);
      cse_p12_t223_g35400 = (-(sin(nphi)));
      sin_nphi = sin(nphi);
      cos_nphi = cos(nphi);
      cos_angle = ((cosphase * cos_nphi) + (sinphase * sin_nphi));
      sin_angle = ((cosphase * sin_nphi) + (-((cos_nphi * sinphase))));
      energy = (v * (1.0000000000000000     + cos_angle));
      energy_added += energy;
      *energy_accumulate += energy;
      cse_p11_t4_invr35176 = (1.0 / ((((t1) * (t1)) + ((t2) * (t2)))));
      cse_p13_t1_g35415 = (cse_p11_t4_invr35176 * (-(t1)));
      cse_p12_t75_g35252 = (cse_p12_t167_g35344 * cse_p13_t1_g35415);
      cse_p12_t76_g35253 = (cse_p12_t168_g35345 * cse_p13_t1_g35415);
      cse_p12_t77_g35254 = (cse_p12_t169_g35346 * cse_p13_t1_g35415);
      cse_p12_t78_g35255 = (cse_p12_t170_g35347 * cse_p13_t1_g35415);
      cse_p12_t79_g35256 = (cse_p12_t171_g35348 * cse_p13_t1_g35415);
      cse_p12_t80_g35257 = (cse_p12_t172_g35349 * cse_p13_t1_g35415);
      cse_p12_t81_g35258 = (cse_p12_t173_g35350 * cse_p13_t1_g35415);
      cse_p12_t82_g35259 = (cse_p12_t174_g35351 * cse_p13_t1_g35415);
      cse_p12_t83_g35260 = (cse_p12_t175_g35352 * cse_p13_t1_g35415);
      cse_p12_t84_g35261 = (cse_p12_t176_g35353 * cse_p13_t1_g35415);
      cse_p12_t85_g35262 = (cse_p12_t178_g35355 * cse_p13_t1_g35415);
      cse_p12_t86_g35263 = (cse_p12_t179_g35356 * cse_p13_t1_g35415);
      cse_p12_t1_g35404 = (cse_p11_t4_invr35176 * t2);
      cse_p12_t87_g35264 = (cse_p12_t147_g35324 * cse_p12_t1_g35404);
      cse_p12_t88_g35265 = (cse_p12_t148_g35325 * cse_p12_t1_g35404);
      cse_p12_t89_g35266 = (cse_p12_t149_g35326 * cse_p12_t1_g35404);
      cse_p12_t90_g35267 = (cse_p12_t150_g35327 * cse_p12_t1_g35404);
      cse_p12_t91_g35268 = (cse_p12_t151_g35328 * cse_p12_t1_g35404);
      cse_p12_t92_g35269 = (cse_p12_t152_g35329 * cse_p12_t1_g35404);
      cse_p13_t1_g35416 = (cse_p11_t1_sqrt35173 * cse_p12_t1_g35404);
      cse_p12_t93_g35270 = (cse_p12_t182_g35359 * cse_p13_t1_g35416);
      cse_p12_t94_g35271 = (cse_p12_t183_g35360 * cse_p13_t1_g35416);
      cse_p12_t95_g35272 = (cse_p12_t185_g35362 * cse_p13_t1_g35416);
      cse_p12_t96_g35273 = (cse_p13_t1_g35416 * (-(c2x)));
      cse_p12_t97_g35274 = (cse_p13_t1_g35416 * (-(c2y)));
      cse_p12_t98_g35275 = (cse_p13_t1_g35416 * (-(c2z)));
      cse_p12_t153_g35330 = (cse_p12_t75_g35252 + cse_p12_t92_g35269);
      cse_p12_t154_g35331 = (cse_p12_t76_g35253 + cse_p12_t91_g35268);
      cse_p12_t155_g35332 = (cse_p12_t77_g35254 + cse_p12_t93_g35270);
      cse_p12_t156_g35333 = (cse_p12_t78_g35255 + cse_p12_t88_g35265);
      cse_p12_t157_g35334 = (cse_p12_t79_g35256 + cse_p12_t94_g35271);
      cse_p12_t158_g35335 = (cse_p12_t80_g35257 + cse_p12_t89_g35266);
      cse_p12_t159_g35336 = (cse_p12_t81_g35258 + cse_p12_t90_g35267);
      cse_p12_t160_g35337 = (cse_p12_t82_g35259 + cse_p12_t95_g35272);
      cse_p12_t161_g35338 = (cse_p12_t83_g35260 + cse_p12_t87_g35264);
      cse_p12_t162_g35339 = (cse_p12_t84_g35261 + cse_p12_t97_g35274);
      cse_p12_t163_g35340 = (cse_p12_t85_g35262 + cse_p12_t98_g35275);
      cse_p12_t164_g35341 = (cse_p12_t86_g35263 + cse_p12_t96_g35273);
      cse_p11_t5_invr235177 = (cse_p11_t4_invr35176 * cse_p11_t4_invr35176);
      cse_p12_t99_g35276 = (cse_p11_t5_invr235177 * cse_p12_t138_g35315);
      cse_p12_t100_g35277 = (cse_p11_t5_invr235177 * cse_p12_t139_g35316);
      cse_p12_t101_g35278 = (cse_p11_t5_invr235177 * cse_p12_t140_g35317);
      cse_p12_t102_g35279 = (cse_p11_t5_invr235177 * cse_p12_t141_g35318);
      cse_p12_t103_g35280 = (cse_p11_t5_invr235177 * cse_p12_t142_g35319);
      cse_p12_t104_g35281 = (cse_p11_t5_invr235177 * cse_p12_t143_g35320);
      cse_p12_t105_g35282 = (cse_p11_t5_invr235177 * cse_p12_t144_g35321);
      cse_p12_t106_g35283 = (cse_p11_t5_invr235177 * cse_p12_t145_g35322);
      cse_p12_t107_g35284 = (cse_p11_t5_invr235177 * cse_p12_t146_g35323);
      cse_p12_t108_g35285 = (cse_p11_t5_invr235177 * cse_p12_t165_g35342);
      cse_p12_t109_g35286 = (cse_p11_t5_invr235177 * cse_p12_t166_g35343);
      cse_p12_t202_g35379 = (-(cse_p12_t99_g35276));
      cse_p12_t203_g35380 = (-(cse_p12_t100_g35277));
      cse_p12_t204_g35381 = (-(cse_p12_t101_g35278));
      cse_p12_t205_g35382 = (-(cse_p12_t102_g35279));
      cse_p12_t206_g35383 = (-(cse_p12_t103_g35280));
      cse_p12_t207_g35384 = (-(cse_p12_t104_g35281));
      cse_p12_t208_g35385 = (-(cse_p12_t105_g35282));
      cse_p12_t209_g35386 = (-(cse_p12_t106_g35283));
      cse_p12_t210_g35387 = (-(cse_p12_t107_g35284));
      cse_p12_t211_g35388 = (-(cse_p12_t108_g35285));
      cse_p12_t212_g35389 = (-(cse_p12_t109_g35286));
      cse_p12_t1_g35407 = (cse_p11_t1_sqrt35173 * t2);
      cse_p13_t1_g35420 = (cse_p12_t1_g35407 * (-(c2x)));
      cse_p13_t1_g35421 = (cos_nphi * n * sinphase);
      cse_p14_t1_g35428 = (cosphase * cse_p12_t223_g35400 * n);
      g_x1 = (v * ((cse_p13_t1_g35421 * (cse_p12_t86_g35263 + (cse_p11_t4_invr35176 * cse_p13_t1_g35420))) + (cse_p14_t1_g35428 * (cse_p12_t86_g35263 + (cse_p11_t4_invr35176 * cse_p13_t1_g35420)))));
      KernelGradientAcc(i3x1, 0, g_x1);
      cse_p13_t1_g35422 = (cse_p12_t1_g35407 * (-(c2y)));
      g_y1 = (v * ((cse_p13_t1_g35421 * (cse_p12_t84_g35261 + (cse_p11_t4_invr35176 * cse_p13_t1_g35422))) + (cse_p14_t1_g35428 * (cse_p12_t84_g35261 + (cse_p11_t4_invr35176 * cse_p13_t1_g35422)))));
      KernelGradientAcc(i3x1, 1, g_y1);
      cse_p14_t1_g35424 = (cse_p12_t1_g35407 * (-(c2z)));
      g_z1 = (v * ((cse_p13_t1_g35421 * (cse_p12_t85_g35262 + (cse_p11_t4_invr35176 * cse_p14_t1_g35424))) + (cse_p14_t1_g35428 * (cse_p12_t85_g35262 + (cse_p11_t4_invr35176 * cse_p14_t1_g35424)))));
      KernelGradientAcc(i3x1, 2, g_z1);
      g_x2 = (v * ((cse_p13_t1_g35421 * (cse_p12_t83_g35260 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t134_g35311 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * (-(v2x))))))) + (cse_p14_t1_g35428 * (cse_p12_t83_g35260 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t134_g35311 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * (-(v2x)))))))));
      KernelGradientAcc(i3x2, 0, g_x2);
      g_y2 = (v * ((cse_p13_t1_g35421 * (cse_p12_t78_g35255 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t135_g35312 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * (-(v2y))))))) + (cse_p14_t1_g35428 * (cse_p12_t78_g35255 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t135_g35312 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * (-(v2y)))))))));
      KernelGradientAcc(i3x2, 1, g_y2);
      g_z2 = (v * ((cse_p13_t1_g35421 * (cse_p12_t80_g35257 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t136_g35313 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * (-(v2z))))))) + (cse_p14_t1_g35428 * (cse_p12_t80_g35257 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t136_g35313 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * (-(v2z)))))))));
      KernelGradientAcc(i3x2, 2, g_z2);
      g_x3 = (v * ((cse_p13_t1_g35421 * (cse_p12_t81_g35258 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t1_g35410 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * v2x))))) + (cse_p14_t1_g35428 * (cse_p12_t81_g35258 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t1_g35410 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * v2x)))))));
      KernelGradientAcc(i3x3, 0, g_x3);
      g_y3 = (v * ((cse_p13_t1_g35421 * (cse_p12_t76_g35253 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t1_g35409 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * v2y))))) + (cse_p14_t1_g35428 * (cse_p12_t76_g35253 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t1_g35409 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * v2y)))))));
      KernelGradientAcc(i3x3, 1, g_y3);
      g_z3 = (v * ((cse_p13_t1_g35421 * (cse_p12_t75_g35252 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t1_g35408 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * v2z))))) + (cse_p14_t1_g35428 * (cse_p12_t75_g35252 + (cse_p11_t4_invr35176 * t2 * (cse_p12_t1_g35408 + (cse_p11_t2_invsqrt35174 * cse_p12_t177_g35354 * v2z)))))));
      KernelGradientAcc(i3x3, 2, g_z3);
      cse_p12_t1_g35413 = (cse_p11_t4_invr35176 * cse_p12_t185_g35362 * cse_p12_t1_g35407);
      g_x4 = (v * ((cse_p13_t1_g35421 * (cse_p12_t1_g35413 + cse_p12_t82_g35259)) + (cse_p14_t1_g35428 * (cse_p12_t1_g35413 + cse_p12_t82_g35259))));
      KernelGradientAcc(i3x4, 0, g_x4);
      cse_p12_t1_g35411 = (cse_p11_t4_invr35176 * cse_p12_t182_g35359 * cse_p12_t1_g35407);
      g_y4 = (v * ((cse_p13_t1_g35421 * (cse_p12_t1_g35411 + cse_p12_t77_g35254)) + (cse_p14_t1_g35428 * (cse_p12_t1_g35411 + cse_p12_t77_g35254))));
      KernelGradientAcc(i3x4, 1, g_y4);
      cse_p12_t1_g35412 = (cse_p11_t4_invr35176 * cse_p12_t183_g35360 * cse_p12_t1_g35407);
      g_z4 = (v * ((cse_p13_t1_g35421 * (cse_p12_t1_g35412 + cse_p12_t79_g35256)) + (cse_p14_t1_g35428 * (cse_p12_t1_g35412 + cse_p12_t79_g35256))));
      KernelGradientAcc(i3x4, 2, g_z4);
      cse_p12_t1_g35402 = (n * (-(v)));
      cse_p12_t1_g35405 = (cos_angle * cse_p12_t1_g35402 * n);
      cse_p12_t1_g35406 = (cse_p12_t1_g35402 * sin_angle);
      cse_p13_t1_g35414 = (cse_p11_t1_sqrt35173 * cse_p11_t4_invr35176);
      cse_p13_t1_g35423 = (cse_p13_t1_g35414 * (-(c2x)));
      h_x1_x1 = ((cse_p12_t164_g35341 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t179_g35356 * (cse_p13_t1_g35423 + (-((cse_p11_t1_sqrt35173 * cse_p11_t4_invr35176 * (-(c2x))))) + (-((cse_p11_t5_invr235177 * ((cse_p11_t1_sqrt35173 * cse_p13_t1_g35417 * (-(c2x))) + (cse_p12_t179_g35356 * cse_p13_t1_g35418)) * (-(t1))))))) + (-((cse_p11_t5_invr235177 * cse_p13_t1_g35420 * ((cse_p11_t1_sqrt35173 * cse_p13_t1_g35417 * (-(c2x))) + (cse_p12_t179_g35356 * cse_p13_t1_g35418))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 0, h_x1_x1);
      h_x1_y1 = ((cse_p12_t162_g35339 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t176_g35353 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t211_g35388 * (-(t1))) + (cse_p12_t211_g35388 * cse_p13_t1_g35420) + (-((cse_p11_t1_sqrt35173 * cse_p11_t4_invr35176 * cse_p12_t179_g35356 * (-(c2y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 1, h_x1_y1);
      h_x1_z1 = ((cse_p12_t163_g35340 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t222_g35399) + (cse_p12_t178_g35355 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t212_g35389 * (-(t1))) + (cse_p12_t212_g35389 * cse_p13_t1_g35420))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x1, 2, h_x1_z1);
      cse_p13_t1_g35419 = (cse_p11_t2_invsqrt35174 * cse_p12_t1_g35404);
      h_x1_x2 = ((cse_p12_t161_g35338 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t216_g35393) + (cse_p12_t175_g35352 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t202_g35379 * (-(t1))) + (cse_p12_t202_g35379 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * (((-(v2y)) * (-(v3y))) + (v2z * v3z))) + (-((cse_p13_t1_g35419 * v2x * (-(c2x))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 0, h_x1_x2);
      h_x1_y2 = ((cse_p12_t156_g35333 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t217_g35394) + (cse_p12_t170_g35347 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t203_g35380 * (-(t1))) + (cse_p12_t203_g35380 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * (c2z + (v3x * (-(v2y))))) + (cse_p13_t1_g35416 * v3z) + (-((cse_p13_t1_g35419 * v2y * (-(c2x))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 1, h_x1_y2);
      h_x1_z2 = ((cse_p12_t158_g35335 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t218_g35395) + (cse_p12_t172_g35349 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t204_g35381 * (-(t1))) + (cse_p12_t204_g35381 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * ((v2z * (-(v3x))) + (-(c2y)))) + (cse_p13_t1_g35416 * (-(v3y))) + (-((cse_p13_t1_g35419 * v2z * (-(c2x))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x2, 2, h_x1_z2);
      h_x1_x3 = ((cse_p12_t159_g35336 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t219_g35396) + (cse_p12_t173_g35350 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t205_g35382 * (-(t1))) + (cse_p12_t205_g35382 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * ((cse_p12_t191_g35368 * v2z) + (cse_p12_t199_g35376 * (-(v2y))))) + (cse_p13_t1_g35419 * v2x * (-(c2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 0, h_x1_x3);
      h_x1_y3 = ((cse_p12_t154_g35331 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t220_g35397) + (cse_p12_t168_g35345 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t191_g35368 * cse_p13_t1_g35416) + (cse_p12_t206_g35383 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * ((cse_p12_t189_g35366 * (-(v2y))) + (-(c2z)))) + (cse_p13_t1_g35419 * v2y * (-(c2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 1, h_x1_y3);
      cse_p14_t1_g35431 = (cse_p12_t207_g35384 * (-(t1)));
      h_x1_z3 = ((cse_p12_t153_g35330 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t221_g35398) + (cse_p12_t167_g35344 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p14_t1_g35431) + (cse_p12_t199_g35376 * cse_p13_t1_g35416) + (cse_p12_t207_g35384 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * (c2y + (cse_p12_t198_g35375 * v2z))) + (cse_p13_t1_g35419 * v2z * (-(c2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x3, 2, h_x1_z3);
      cse_p14_t1_g35430 = (cse_p12_t210_g35387 * (-(t1)));
      h_x1_x4 = ((cse_p12_t160_g35337 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t215_g35392) + (cse_p12_t174_g35351 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p14_t1_g35430) + (cse_p12_t210_g35387 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * (((-(v2y)) * (-(v2y))) + (v2z * v2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 0, h_x1_x4);
      cse_p14_t1_g35427 = (cse_p12_t208_g35385 * (-(t1)));
      h_x1_y4 = ((cse_p12_t155_g35332 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t213_g35390) + (cse_p12_t169_g35346 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p14_t1_g35427) + (cse_p12_t208_g35385 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * v2x * (-(v2y))) + (cse_p13_t1_g35416 * v2z))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 1, h_x1_y4);
      cse_p14_t1_g35425 = (cse_p12_t209_g35386 * (-(t1)));
      h_x1_z4 = ((cse_p12_t157_g35334 * cse_p12_t164_g35341 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t179_g35356 * cse_p12_t214_g35391) + (cse_p12_t171_g35348 * cse_p13_t1_g35423) + (cse_p12_t179_g35356 * cse_p14_t1_g35425) + (cse_p12_t209_g35386 * cse_p13_t1_g35420) + (cse_p13_t1_g35415 * v2z * (-(v2x))) + (cse_p13_t1_g35416 * (-(v2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 0, i3x4, 2, h_x1_z4);
      cse_p14_t1_g35426 = (cse_p13_t1_g35414 * (-(c2y)));
      h_y1_y1 = ((cse_p12_t162_g35339 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t176_g35353 * (cse_p14_t1_g35426 + (cse_p12_t211_g35388 * (-(t1))) + (-((cse_p11_t1_sqrt35173 * cse_p11_t4_invr35176 * (-(c2y))))))) + (cse_p12_t211_g35388 * cse_p13_t1_g35422))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 1, h_y1_y1);
      h_y1_z1 = ((cse_p12_t162_g35339 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t222_g35399) + (cse_p12_t176_g35353 * cse_p12_t212_g35389 * (-(t1))) + (cse_p12_t178_g35355 * cse_p14_t1_g35426) + (cse_p12_t212_g35389 * cse_p13_t1_g35422))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x1, 2, h_y1_z1);
      h_y1_x2 = ((cse_p12_t161_g35338 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t216_g35393) + (cse_p12_t175_g35352 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p12_t202_g35379 * (-(t1))) + (cse_p12_t202_g35379 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * ((v2x * (-(v3y))) + (-(c2z)))) + (cse_p13_t1_g35416 * (-(v3z))) + (-((cse_p13_t1_g35419 * v2x * (-(c2y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 0, h_y1_x2);
      h_y1_y2 = ((cse_p12_t156_g35333 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t217_g35394) + (cse_p12_t170_g35347 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p12_t203_g35380 * (-(t1))) + (cse_p12_t203_g35380 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * (((-(v2z)) * (-(v3z))) + (v2x * v3x))) + (-((cse_p13_t1_g35419 * v2y * (-(c2y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 1, h_y1_y2);
      h_y1_z2 = ((cse_p12_t158_g35335 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t218_g35395) + (cse_p12_t172_g35349 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p12_t204_g35381 * (-(t1))) + (cse_p12_t204_g35381 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * (c2x + (v3y * (-(v2z))))) + (cse_p13_t1_g35416 * v3x) + (-((cse_p13_t1_g35419 * v2z * (-(c2y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x2, 2, h_y1_z2);
      h_y1_x3 = ((cse_p12_t159_g35336 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t219_g35396) + (cse_p12_t173_g35350 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p12_t205_g35382 * (-(t1))) + (cse_p12_t200_g35377 * cse_p13_t1_g35416) + (cse_p12_t205_g35382 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * (c2z + (cse_p12_t199_g35376 * v2x))) + (cse_p13_t1_g35419 * v2x * (-(c2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 0, h_y1_x3);
      h_y1_y3 = ((cse_p12_t154_g35331 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t220_g35397) + (cse_p12_t168_g35345 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t206_g35383 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * ((cse_p12_t189_g35366 * v2x) + (cse_p12_t200_g35377 * (-(v2z))))) + (cse_p13_t1_g35419 * v2y * (-(c2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 1, h_y1_y3);
      h_y1_z3 = ((cse_p12_t153_g35330 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t221_g35398) + (cse_p12_t167_g35344 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p14_t1_g35431) + (cse_p12_t189_g35366 * cse_p13_t1_g35416) + (cse_p12_t207_g35384 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * ((cse_p12_t190_g35367 * (-(v2z))) + (-(c2x)))) + (cse_p13_t1_g35419 * v2z * (-(c2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x3, 2, h_y1_z3);
      h_y1_x4 = ((cse_p12_t160_g35337 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t215_g35392) + (cse_p12_t174_g35351 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p14_t1_g35430) + (cse_p12_t210_g35387 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * v2x * (-(v2y))) + (cse_p13_t1_g35416 * (-(v2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 0, h_y1_x4);
      h_y1_y4 = ((cse_p12_t155_g35332 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t213_g35390) + (cse_p12_t169_g35346 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p14_t1_g35427) + (cse_p12_t208_g35385 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * (((-(v2z)) * (-(v2z))) + (v2x * v2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 1, h_y1_y4);
      h_y1_z4 = ((cse_p12_t157_g35334 * cse_p12_t162_g35339 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t176_g35353 * cse_p12_t214_g35391) + (cse_p12_t171_g35348 * cse_p14_t1_g35426) + (cse_p12_t176_g35353 * cse_p14_t1_g35425) + (cse_p12_t209_g35386 * cse_p13_t1_g35422) + (cse_p13_t1_g35415 * v2y * (-(v2z))) + (cse_p13_t1_g35416 * v2x))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 1, i3x4, 2, h_y1_z4);
      cse_p14_t1_g35429 = (cse_p13_t1_g35414 * (-(c2z)));
      h_z1_z1 = ((cse_p12_t163_g35340 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t178_g35355 * (cse_p14_t1_g35429 + (cse_p11_t4_invr35176 * cse_p12_t222_g35399) + (cse_p12_t212_g35389 * (-(t1))))) + (cse_p12_t212_g35389 * cse_p14_t1_g35424))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x1, 2, h_z1_z1);
      h_z1_x2 = ((cse_p12_t161_g35338 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t216_g35393) + (cse_p12_t175_g35352 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p12_t202_g35379 * (-(t1))) + (cse_p12_t202_g35379 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * (c2y + (v3z * (-(v2x))))) + (cse_p13_t1_g35416 * v3y) + (-((cse_p13_t1_g35419 * v2x * (-(c2z))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 0, h_z1_x2);
      h_z1_y2 = ((cse_p12_t156_g35333 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t217_g35394) + (cse_p12_t170_g35347 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p12_t203_g35380 * (-(t1))) + (cse_p12_t203_g35380 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * ((v2y * (-(v3z))) + (-(c2x)))) + (cse_p13_t1_g35416 * (-(v3x))) + (-((cse_p13_t1_g35419 * v2y * (-(c2z))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 1, h_z1_y2);
      h_z1_z2 = ((cse_p12_t158_g35335 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t218_g35395) + (cse_p12_t172_g35349 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p12_t204_g35381 * (-(t1))) + (cse_p12_t204_g35381 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * (((-(v2x)) * (-(v3x))) + (v2y * v3y))) + (-((cse_p13_t1_g35419 * v2z * (-(c2z))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x2, 2, h_z1_z2);
      h_z1_x3 = ((cse_p12_t159_g35336 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t219_g35396) + (cse_p12_t173_g35350 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p12_t205_g35382 * (-(t1))) + (cse_p12_t190_g35367 * cse_p13_t1_g35416) + (cse_p12_t205_g35382 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * ((cse_p12_t191_g35368 * (-(v2x))) + (-(c2y)))) + (cse_p13_t1_g35419 * v2x * (-(c2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 0, h_z1_x3);
      h_z1_y3 = ((cse_p12_t154_g35331 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t220_g35397) + (cse_p12_t168_g35345 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t198_g35375 * cse_p13_t1_g35416) + (cse_p12_t206_g35383 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * (c2x + (cse_p12_t200_g35377 * v2y))) + (cse_p13_t1_g35419 * v2y * (-(c2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 1, h_z1_y3);
      h_z1_z3 = ((cse_p12_t153_g35330 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t221_g35398) + (cse_p12_t167_g35344 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p14_t1_g35431) + (cse_p12_t207_g35384 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * ((cse_p12_t190_g35367 * v2y) + (cse_p12_t198_g35375 * (-(v2x))))) + (cse_p13_t1_g35419 * v2z * (-(c2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x3, 2, h_z1_z3);
      h_z1_x4 = ((cse_p12_t160_g35337 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t215_g35392) + (cse_p12_t174_g35351 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p14_t1_g35430) + (cse_p12_t210_g35387 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * v2z * (-(v2x))) + (cse_p13_t1_g35416 * v2y))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 0, h_z1_x4);
      h_z1_y4 = ((cse_p12_t155_g35332 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t213_g35390) + (cse_p12_t169_g35346 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p14_t1_g35427) + (cse_p12_t208_g35385 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * v2y * (-(v2z))) + (cse_p13_t1_g35416 * (-(v2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 1, h_z1_y4);
      h_z1_z4 = ((cse_p12_t157_g35334 * cse_p12_t163_g35340 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t178_g35355 * cse_p12_t214_g35391) + (cse_p12_t171_g35348 * cse_p14_t1_g35429) + (cse_p12_t178_g35355 * cse_p14_t1_g35425) + (cse_p12_t209_g35386 * cse_p14_t1_g35424) + (cse_p13_t1_g35415 * (((-(v2x)) * (-(v2x))) + (v2y * v2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x1, 2, i3x4, 2, h_z1_z4);
      cse_p14_t1_g35432 = (cse_p11_t2_invsqrt35174 * (-(v2x)));
      h_x2_x2 = ((cse_p12_t161_g35338 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t147_g35324 * cse_p12_t202_g35379 * t2) + (cse_p12_t175_g35352 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324) + (cse_p11_t4_invr35176 * cse_p12_t216_g35393) + (cse_p12_t202_g35379 * (-(t1))))) + (cse_p12_t1_g35404 * (cse_p12_t1_g35401 + (cse_p12_t192_g35369 * cse_p14_t1_g35432) + (cse_p12_t192_g35369 * cse_p14_t1_g35432) + (-(cse_p12_t66_g35243)))) + (cse_p13_t1_g35415 * ((cse_p12_t188_g35365 * v3z) + (cse_p12_t188_g35365 * v3z) + (cse_p12_t196_g35373 * (-(v3y))) + (cse_p12_t196_g35373 * (-(v3y))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 0, h_x2_x2);
      cse_p14_t1_g35433 = (cse_p11_t2_invsqrt35174 * (-(v2y)));
      h_x2_y2 = ((cse_p12_t156_g35333 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t170_g35347) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t217_g35394) + (cse_p12_t147_g35324 * cse_p12_t203_g35380 * t2) + (cse_p12_t175_g35352 * cse_p12_t203_g35380 * (-(t1))) + (cse_p12_t1_g35404 * ((cse_p12_t192_g35369 * cse_p14_t1_g35433) + (cse_p12_t193_g35370 * cse_p14_t1_g35432) + (-(cse_p12_t67_g35244)))) + (cse_p13_t1_g35415 * ((cse_p12_t186_g35363 * (-(v3y))) + (cse_p12_t196_g35373 * v3x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 1, h_x2_y2);
      cse_p15_t1_g35434 = (cse_p11_t2_invsqrt35174 * (-(v2z)));
      h_x2_z2 = ((cse_p12_t158_g35335 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t172_g35349) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t218_g35395) + (cse_p12_t147_g35324 * cse_p12_t204_g35381 * t2) + (cse_p12_t175_g35352 * cse_p12_t204_g35381 * (-(t1))) + (cse_p12_t1_g35404 * ((cse_p12_t192_g35369 * cse_p15_t1_g35434) + (cse_p12_t194_g35371 * cse_p14_t1_g35432) + (-(cse_p12_t68_g35245)))) + (cse_p13_t1_g35415 * ((cse_p12_t188_g35365 * (-(v3x))) + (cse_p12_t195_g35372 * v3z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x2, 2, h_x2_z2);
      h_x2_x3 = ((cse_p12_t159_g35336 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t173_g35350) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t219_g35396) + (cse_p12_t147_g35324 * cse_p12_t205_g35382 * t2) + (cse_p12_t175_g35352 * cse_p12_t205_g35382 * (-(t1))) + (cse_p12_t1_g35404 * (cse_p12_t201_g35378 + cse_p12_t66_g35243 + (cse_p11_t2_invsqrt35174 * cse_p12_t192_g35369 * v2x) + (cse_p12_t184_g35361 * cse_p14_t1_g35432))) + (cse_p13_t1_g35415 * (((-(v1y)) * (-(v3y))) + (cse_p12_t188_g35365 * cse_p12_t191_g35368) + (cse_p12_t196_g35373 * cse_p12_t199_g35376) + (v1z * v3z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 0, h_x2_x3);
      h_x2_y3 = ((cse_p12_t154_g35331 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t168_g35345) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t220_g35397) + (cse_p12_t147_g35324 * cse_p12_t206_g35383 * t2) + (cse_p12_t175_g35352 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t1_g35404 * (cse_p12_t67_g35244 + (cse_p11_t1_sqrt35173 * (v1z + v2z + v3z)) + (cse_p11_t2_invsqrt35174 * cse_p12_t192_g35369 * v2y) + (cse_p12_t181_g35358 * cse_p14_t1_g35432))) + (cse_p13_t1_g35415 * (c1z + c2z + (cse_p12_t189_g35366 * cse_p12_t196_g35373) + (v1x * (-(v3y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 1, h_x2_y3);
      h_x2_z3 = ((cse_p12_t153_g35330 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t167_g35344) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t221_g35398) + (cse_p12_t147_g35324 * cse_p12_t207_g35384 * t2) + (cse_p12_t175_g35352 * cse_p14_t1_g35431) + (cse_p12_t1_g35404 * (cse_p12_t68_g35245 + (cse_p11_t1_sqrt35173 * ((-(v1y)) + (-(v2y)) + (-(v3y)))) + (cse_p11_t2_invsqrt35174 * cse_p12_t192_g35369 * v2z) + (cse_p12_t180_g35357 * cse_p14_t1_g35432))) + (cse_p13_t1_g35415 * ((cse_p12_t188_g35365 * cse_p12_t198_g35375) + (v3z * (-(v1x))) + (-(c1y)) + (-(c2y)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x3, 2, h_x2_z3);
      h_x2_x4 = ((cse_p12_t160_g35337 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t174_g35351) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t215_g35392) + (cse_p12_t147_g35324 * cse_p12_t210_g35387 * t2) + (cse_p12_t175_g35352 * cse_p14_t1_g35430) + (cse_p13_t1_g35415 * ((cse_p12_t188_g35365 * v2z) + (cse_p12_t196_g35373 * (-(v2y))))) + (-((cse_p12_t185_g35362 * cse_p13_t1_g35419 * v2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 0, h_x2_x4);
      h_x2_y4 = ((cse_p12_t155_g35332 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t169_g35346) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t213_g35390) + (cse_p12_t147_g35324 * cse_p12_t208_g35385 * t2) + (cse_p12_t175_g35352 * cse_p14_t1_g35427) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * cse_p12_t188_g35365) + (cse_p12_t182_g35359 * cse_p14_t1_g35432))) + (cse_p13_t1_g35415 * ((cse_p12_t196_g35373 * v2x) + (-(c1z)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 1, h_x2_y4);
      h_x2_z4 = ((cse_p12_t157_g35334 * cse_p12_t161_g35338 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t147_g35324 * cse_p12_t171_g35348) + (cse_p11_t4_invr35176 * cse_p12_t175_g35352 * cse_p12_t214_g35391) + (cse_p12_t147_g35324 * cse_p12_t209_g35386 * t2) + (cse_p12_t175_g35352 * cse_p14_t1_g35425) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * cse_p12_t196_g35373) + (cse_p12_t183_g35360 * cse_p14_t1_g35432))) + (cse_p13_t1_g35415 * (c1y + (cse_p12_t188_g35365 * (-(v2x))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 0, i3x4, 2, h_x2_z4);
      h_y2_y2 = ((cse_p12_t156_g35333 * cse_p12_t156_g35333 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t148_g35325 * cse_p12_t203_g35380 * t2) + (cse_p12_t170_g35347 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325) + (cse_p11_t4_invr35176 * cse_p12_t217_g35394) + (cse_p12_t203_g35380 * (-(t1))))) + (cse_p12_t1_g35404 * (cse_p12_t1_g35401 + (cse_p12_t193_g35370 * cse_p14_t1_g35433) + (cse_p12_t193_g35370 * cse_p14_t1_g35433) + (-(cse_p12_t69_g35246)))) + (cse_p13_t1_g35415 * ((cse_p12_t186_g35363 * v3x) + (cse_p12_t186_g35363 * v3x) + (cse_p12_t197_g35374 * (-(v3z))) + (cse_p12_t197_g35374 * (-(v3z))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 1, h_y2_y2);
      h_y2_z2 = ((cse_p12_t156_g35333 * cse_p12_t158_g35335 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t172_g35349) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t218_g35395) + (cse_p12_t148_g35325 * cse_p12_t204_g35381 * t2) + (cse_p12_t170_g35347 * cse_p12_t204_g35381 * (-(t1))) + (cse_p12_t1_g35404 * ((cse_p12_t193_g35370 * cse_p15_t1_g35434) + (cse_p12_t194_g35371 * cse_p14_t1_g35433) + (-(cse_p12_t70_g35247)))) + (cse_p13_t1_g35415 * ((cse_p12_t187_g35364 * (-(v3z))) + (cse_p12_t197_g35374 * v3y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x2, 2, h_y2_z2);
      h_y2_x3 = ((cse_p12_t156_g35333 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t173_g35350) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t219_g35396) + (cse_p12_t148_g35325 * cse_p12_t205_g35382 * t2) + (cse_p12_t170_g35347 * cse_p12_t205_g35382 * (-(t1))) + (cse_p12_t1_g35404 * (cse_p12_t67_g35244 + (cse_p11_t1_sqrt35173 * ((-(v1z)) + (-(v2z)) + (-(v3z)))) + (cse_p11_t2_invsqrt35174 * cse_p12_t193_g35370 * v2x) + (cse_p12_t184_g35361 * cse_p14_t1_g35433))) + (cse_p13_t1_g35415 * ((cse_p12_t186_g35363 * cse_p12_t199_g35376) + (v3x * (-(v1y))) + (-(c1z)) + (-(c2z)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 0, h_y2_x3);
      h_y2_y3 = ((cse_p12_t154_g35331 * cse_p12_t156_g35333 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t168_g35345) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t220_g35397) + (cse_p12_t148_g35325 * cse_p12_t206_g35383 * t2) + (cse_p12_t170_g35347 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t1_g35404 * (cse_p12_t201_g35378 + cse_p12_t69_g35246 + (cse_p11_t2_invsqrt35174 * cse_p12_t193_g35370 * v2y) + (cse_p12_t181_g35358 * cse_p14_t1_g35433))) + (cse_p13_t1_g35415 * (((-(v1z)) * (-(v3z))) + (cse_p12_t186_g35363 * cse_p12_t189_g35366) + (cse_p12_t197_g35374 * cse_p12_t200_g35377) + (v1x * v3x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 1, h_y2_y3);
      h_y2_z3 = ((cse_p12_t153_g35330 * cse_p12_t156_g35333 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t167_g35344) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t221_g35398) + (cse_p12_t148_g35325 * cse_p12_t207_g35384 * t2) + (cse_p12_t170_g35347 * cse_p14_t1_g35431) + (cse_p12_t1_g35404 * (cse_p12_t70_g35247 + (cse_p11_t1_sqrt35173 * (v1x + v2x + v3x)) + (cse_p11_t2_invsqrt35174 * cse_p12_t193_g35370 * v2z) + (cse_p12_t180_g35357 * cse_p14_t1_g35433))) + (cse_p13_t1_g35415 * (c1x + c2x + (cse_p12_t190_g35367 * cse_p12_t197_g35374) + (v1y * (-(v3z))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x3, 2, h_y2_z3);
      h_y2_x4 = ((cse_p12_t156_g35333 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t174_g35351) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t215_g35392) + (cse_p12_t148_g35325 * cse_p12_t210_g35387 * t2) + (cse_p12_t170_g35347 * cse_p14_t1_g35430) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * cse_p12_t197_g35374) + (cse_p12_t185_g35362 * cse_p14_t1_g35433))) + (cse_p13_t1_g35415 * (c1z + (cse_p12_t186_g35363 * (-(v2y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 0, h_y2_x4);
      h_y2_y4 = ((cse_p12_t155_g35332 * cse_p12_t156_g35333 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t169_g35346) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t213_g35390) + (cse_p12_t148_g35325 * cse_p12_t208_g35385 * t2) + (cse_p12_t170_g35347 * cse_p14_t1_g35427) + (cse_p13_t1_g35415 * ((cse_p12_t186_g35363 * v2x) + (cse_p12_t197_g35374 * (-(v2z))))) + (-((cse_p12_t182_g35359 * cse_p13_t1_g35419 * v2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 1, h_y2_y4);
      h_y2_z4 = ((cse_p12_t156_g35333 * cse_p12_t157_g35334 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t148_g35325 * cse_p12_t171_g35348) + (cse_p11_t4_invr35176 * cse_p12_t170_g35347 * cse_p12_t214_g35391) + (cse_p12_t148_g35325 * cse_p12_t209_g35386 * t2) + (cse_p12_t170_g35347 * cse_p14_t1_g35425) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * cse_p12_t186_g35363) + (cse_p12_t183_g35360 * cse_p14_t1_g35433))) + (cse_p13_t1_g35415 * ((cse_p12_t197_g35374 * v2y) + (-(c1x)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 1, i3x4, 2, h_y2_z4);
      h_z2_z2 = ((cse_p12_t158_g35335 * cse_p12_t158_g35335 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t149_g35326 * cse_p12_t204_g35381 * t2) + (cse_p12_t172_g35349 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326) + (cse_p11_t4_invr35176 * cse_p12_t218_g35395) + (cse_p12_t204_g35381 * (-(t1))))) + (cse_p12_t1_g35404 * (cse_p12_t1_g35401 + (cse_p12_t194_g35371 * cse_p15_t1_g35434) + (cse_p12_t194_g35371 * cse_p15_t1_g35434) + (-(cse_p12_t71_g35248)))) + (cse_p13_t1_g35415 * ((cse_p12_t187_g35364 * v3y) + (cse_p12_t187_g35364 * v3y) + (cse_p12_t195_g35372 * (-(v3x))) + (cse_p12_t195_g35372 * (-(v3x))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x2, 2, h_z2_z2);
      h_z2_x3 = ((cse_p12_t158_g35335 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326 * cse_p12_t173_g35350) + (cse_p11_t4_invr35176 * cse_p12_t172_g35349 * cse_p12_t219_g35396) + (cse_p12_t149_g35326 * cse_p12_t205_g35382 * t2) + (cse_p12_t172_g35349 * cse_p12_t205_g35382 * (-(t1))) + (cse_p12_t1_g35404 * (cse_p12_t68_g35245 + (cse_p11_t1_sqrt35173 * (v1y + v2y + v3y)) + (cse_p11_t2_invsqrt35174 * cse_p12_t194_g35371 * v2x) + (cse_p12_t184_g35361 * cse_p15_t1_g35434))) + (cse_p13_t1_g35415 * (c1y + c2y + (cse_p12_t191_g35368 * cse_p12_t195_g35372) + (v1z * (-(v3x))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 0, h_z2_x3);
      h_z2_y3 = ((cse_p12_t154_g35331 * cse_p12_t158_g35335 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326 * cse_p12_t168_g35345) + (cse_p11_t4_invr35176 * cse_p12_t172_g35349 * cse_p12_t220_g35397) + (cse_p12_t149_g35326 * cse_p12_t206_g35383 * t2) + (cse_p12_t172_g35349 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t1_g35404 * (cse_p12_t70_g35247 + (cse_p11_t1_sqrt35173 * ((-(v1x)) + (-(v2x)) + (-(v3x)))) + (cse_p11_t2_invsqrt35174 * cse_p12_t194_g35371 * v2y) + (cse_p12_t181_g35358 * cse_p15_t1_g35434))) + (cse_p13_t1_g35415 * ((cse_p12_t187_g35364 * cse_p12_t200_g35377) + (v3y * (-(v1z))) + (-(c1x)) + (-(c2x)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 1, h_z2_y3);
      h_z2_z3 = ((cse_p12_t153_g35330 * cse_p12_t158_g35335 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326 * cse_p12_t167_g35344) + (cse_p11_t4_invr35176 * cse_p12_t172_g35349 * cse_p12_t221_g35398) + (cse_p12_t149_g35326 * cse_p12_t207_g35384 * t2) + (cse_p12_t172_g35349 * cse_p14_t1_g35431) + (cse_p12_t1_g35404 * (cse_p12_t201_g35378 + cse_p12_t71_g35248 + (cse_p11_t2_invsqrt35174 * cse_p12_t194_g35371 * v2z) + (cse_p12_t180_g35357 * cse_p15_t1_g35434))) + (cse_p13_t1_g35415 * (((-(v1x)) * (-(v3x))) + (cse_p12_t187_g35364 * cse_p12_t190_g35367) + (cse_p12_t195_g35372 * cse_p12_t198_g35375) + (v1y * v3y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x3, 2, h_z2_z3);
      h_z2_x4 = ((cse_p12_t158_g35335 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326 * cse_p12_t174_g35351) + (cse_p11_t4_invr35176 * cse_p12_t172_g35349 * cse_p12_t215_g35392) + (cse_p12_t149_g35326 * cse_p12_t210_g35387 * t2) + (cse_p12_t172_g35349 * cse_p14_t1_g35430) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * cse_p12_t187_g35364) + (cse_p12_t185_g35362 * cse_p15_t1_g35434))) + (cse_p13_t1_g35415 * ((cse_p12_t195_g35372 * v2z) + (-(c1y)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 0, h_z2_x4);
      h_z2_y4 = ((cse_p12_t155_g35332 * cse_p12_t158_g35335 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326 * cse_p12_t169_g35346) + (cse_p11_t4_invr35176 * cse_p12_t172_g35349 * cse_p12_t213_g35390) + (cse_p12_t149_g35326 * cse_p12_t208_g35385 * t2) + (cse_p12_t172_g35349 * cse_p14_t1_g35427) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * cse_p12_t195_g35372) + (cse_p12_t182_g35359 * cse_p15_t1_g35434))) + (cse_p13_t1_g35415 * (c1x + (cse_p12_t187_g35364 * (-(v2z))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 1, h_z2_y4);
      h_z2_z4 = ((cse_p12_t157_g35334 * cse_p12_t158_g35335 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t149_g35326 * cse_p12_t171_g35348) + (cse_p11_t4_invr35176 * cse_p12_t172_g35349 * cse_p12_t214_g35391) + (cse_p12_t149_g35326 * cse_p12_t209_g35386 * t2) + (cse_p12_t172_g35349 * cse_p14_t1_g35425) + (cse_p13_t1_g35415 * ((cse_p12_t187_g35364 * v2y) + (cse_p12_t195_g35372 * (-(v2x))))) + (-((cse_p12_t183_g35360 * cse_p13_t1_g35419 * v2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x2, 2, i3x4, 2, h_z2_z4);
      h_x3_x3 = ((cse_p12_t159_g35336 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t150_g35327 * cse_p12_t205_g35382 * t2) + (cse_p12_t173_g35350 * ((cse_p11_t4_invr35176 * cse_p12_t150_g35327) + (cse_p11_t4_invr35176 * cse_p12_t219_g35396) + (cse_p12_t205_g35382 * (-(t1))))) + (cse_p12_t1_g35404 * (cse_p12_t1_g35401 + (cse_p11_t2_invsqrt35174 * cse_p12_t184_g35361 * v2x) + (cse_p11_t2_invsqrt35174 * cse_p12_t184_g35361 * v2x) + (-(cse_p12_t66_g35243)))) + (cse_p13_t1_g35415 * ((cse_p12_t191_g35368 * v1z) + (cse_p12_t191_g35368 * v1z) + (cse_p12_t199_g35376 * (-(v1y))) + (cse_p12_t199_g35376 * (-(v1y))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 0, h_x3_x3);
      h_x3_y3 = ((cse_p12_t154_g35331 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t150_g35327 * cse_p12_t168_g35345) + (cse_p11_t4_invr35176 * cse_p12_t173_g35350 * cse_p12_t220_g35397) + (cse_p12_t150_g35327 * cse_p12_t206_g35383 * t2) + (cse_p12_t173_g35350 * cse_p12_t206_g35383 * (-(t1))) + (cse_p12_t1_g35404 * ((cse_p11_t2_invsqrt35174 * cse_p12_t181_g35358 * v2x) + (cse_p11_t2_invsqrt35174 * cse_p12_t184_g35361 * v2y) + (-(cse_p12_t67_g35244)))) + (cse_p13_t1_g35415 * ((cse_p12_t189_g35366 * (-(v1y))) + (cse_p12_t199_g35376 * v1x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 1, h_x3_y3);
      h_x3_z3 = ((cse_p12_t153_g35330 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t150_g35327 * cse_p12_t167_g35344) + (cse_p11_t4_invr35176 * cse_p12_t173_g35350 * cse_p12_t221_g35398) + (cse_p12_t150_g35327 * cse_p12_t207_g35384 * t2) + (cse_p12_t173_g35350 * cse_p14_t1_g35431) + (cse_p12_t1_g35404 * ((cse_p11_t2_invsqrt35174 * cse_p12_t180_g35357 * v2x) + (cse_p11_t2_invsqrt35174 * cse_p12_t184_g35361 * v2z) + (-(cse_p12_t68_g35245)))) + (cse_p13_t1_g35415 * ((cse_p12_t191_g35368 * (-(v1x))) + (cse_p12_t198_g35375 * v1z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x3, 2, h_x3_z3);
      h_x3_x4 = ((cse_p12_t159_g35336 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t150_g35327 * cse_p12_t174_g35351) + (cse_p11_t4_invr35176 * cse_p12_t173_g35350 * cse_p12_t215_g35392) + (cse_p12_t150_g35327 * cse_p12_t210_g35387 * t2) + (cse_p12_t173_g35350 * cse_p14_t1_g35430) + (cse_p12_t185_g35362 * cse_p13_t1_g35419 * v2x) + (cse_p13_t1_g35415 * (((-(v1y)) * (-(v2y))) + (v1z * v2z))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 0, h_x3_x4);
      h_x3_y4 = ((cse_p12_t155_g35332 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t150_g35327 * cse_p12_t169_g35346) + (cse_p11_t4_invr35176 * cse_p12_t173_g35350 * cse_p12_t213_g35390) + (cse_p12_t150_g35327 * cse_p12_t208_g35385 * t2) + (cse_p12_t173_g35350 * cse_p14_t1_g35427) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * v1z) + (cse_p11_t2_invsqrt35174 * cse_p12_t182_g35359 * v2x))) + (cse_p13_t1_g35415 * (c1z + (v2x * (-(v1y))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 1, h_x3_y4);
      h_x3_z4 = ((cse_p12_t157_g35334 * cse_p12_t159_g35336 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t150_g35327 * cse_p12_t171_g35348) + (cse_p11_t4_invr35176 * cse_p12_t173_g35350 * cse_p12_t214_g35391) + (cse_p12_t150_g35327 * cse_p12_t209_g35386 * t2) + (cse_p12_t173_g35350 * cse_p14_t1_g35425) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * (-(v1y))) + (cse_p11_t2_invsqrt35174 * cse_p12_t183_g35360 * v2x))) + (cse_p13_t1_g35415 * ((v1z * (-(v2x))) + (-(c1y)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 0, i3x4, 2, h_x3_z4);
      h_y3_y3 = ((cse_p12_t154_g35331 * cse_p12_t154_g35331 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t151_g35328 * cse_p12_t206_g35383 * t2) + (cse_p12_t168_g35345 * ((cse_p11_t4_invr35176 * cse_p12_t151_g35328) + (cse_p11_t4_invr35176 * cse_p12_t220_g35397) + (cse_p12_t206_g35383 * (-(t1))))) + (cse_p12_t1_g35404 * (cse_p12_t1_g35401 + (cse_p11_t2_invsqrt35174 * cse_p12_t181_g35358 * v2y) + (cse_p11_t2_invsqrt35174 * cse_p12_t181_g35358 * v2y) + (-(cse_p12_t69_g35246)))) + (cse_p13_t1_g35415 * ((cse_p12_t189_g35366 * v1x) + (cse_p12_t189_g35366 * v1x) + (cse_p12_t200_g35377 * (-(v1z))) + (cse_p12_t200_g35377 * (-(v1z))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 1, h_y3_y3);
      h_y3_z3 = ((cse_p12_t153_g35330 * cse_p12_t154_g35331 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t151_g35328 * cse_p12_t167_g35344) + (cse_p11_t4_invr35176 * cse_p12_t168_g35345 * cse_p12_t221_g35398) + (cse_p12_t151_g35328 * cse_p12_t207_g35384 * t2) + (cse_p12_t168_g35345 * cse_p14_t1_g35431) + (cse_p12_t1_g35404 * ((cse_p11_t2_invsqrt35174 * cse_p12_t180_g35357 * v2y) + (cse_p11_t2_invsqrt35174 * cse_p12_t181_g35358 * v2z) + (-(cse_p12_t70_g35247)))) + (cse_p13_t1_g35415 * ((cse_p12_t190_g35367 * (-(v1z))) + (cse_p12_t200_g35377 * v1y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x3, 2, h_y3_z3);
      h_y3_x4 = ((cse_p12_t154_g35331 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t151_g35328 * cse_p12_t174_g35351) + (cse_p11_t4_invr35176 * cse_p12_t168_g35345 * cse_p12_t215_g35392) + (cse_p12_t151_g35328 * cse_p12_t210_g35387 * t2) + (cse_p12_t168_g35345 * cse_p14_t1_g35430) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * (-(v1z))) + (cse_p11_t2_invsqrt35174 * cse_p12_t185_g35362 * v2y))) + (cse_p13_t1_g35415 * ((v1x * (-(v2y))) + (-(c1z)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 0, h_y3_x4);
      h_y3_y4 = ((cse_p12_t154_g35331 * cse_p12_t155_g35332 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t151_g35328 * cse_p12_t169_g35346) + (cse_p11_t4_invr35176 * cse_p12_t168_g35345 * cse_p12_t213_g35390) + (cse_p12_t151_g35328 * cse_p12_t208_g35385 * t2) + (cse_p12_t168_g35345 * cse_p14_t1_g35427) + (cse_p12_t182_g35359 * cse_p13_t1_g35419 * v2y) + (cse_p13_t1_g35415 * (((-(v1z)) * (-(v2z))) + (v1x * v2x))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 1, h_y3_y4);
      h_y3_z4 = ((cse_p12_t154_g35331 * cse_p12_t157_g35334 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t151_g35328 * cse_p12_t171_g35348) + (cse_p11_t4_invr35176 * cse_p12_t168_g35345 * cse_p12_t214_g35391) + (cse_p12_t151_g35328 * cse_p12_t209_g35386 * t2) + (cse_p12_t168_g35345 * cse_p14_t1_g35425) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * v1x) + (cse_p11_t2_invsqrt35174 * cse_p12_t183_g35360 * v2y))) + (cse_p13_t1_g35415 * (c1x + (v2y * (-(v1z))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 1, i3x4, 2, h_y3_z4);
      h_z3_z3 = ((cse_p12_t153_g35330 * cse_p12_t153_g35330 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t152_g35329 * cse_p12_t207_g35384 * t2) + (cse_p12_t167_g35344 * (cse_p14_t1_g35431 + (cse_p11_t4_invr35176 * cse_p12_t152_g35329) + (cse_p11_t4_invr35176 * cse_p12_t221_g35398))) + (cse_p12_t1_g35404 * (cse_p12_t1_g35401 + (cse_p11_t2_invsqrt35174 * cse_p12_t180_g35357 * v2z) + (cse_p11_t2_invsqrt35174 * cse_p12_t180_g35357 * v2z) + (-(cse_p12_t71_g35248)))) + (cse_p13_t1_g35415 * ((cse_p12_t190_g35367 * v1y) + (cse_p12_t190_g35367 * v1y) + (cse_p12_t198_g35375 * (-(v1x))) + (cse_p12_t198_g35375 * (-(v1x))))))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x3, 2, h_z3_z3);
      h_z3_x4 = ((cse_p12_t153_g35330 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t152_g35329 * cse_p12_t174_g35351) + (cse_p11_t4_invr35176 * cse_p12_t167_g35344 * cse_p12_t215_g35392) + (cse_p12_t152_g35329 * cse_p12_t210_g35387 * t2) + (cse_p12_t167_g35344 * cse_p14_t1_g35430) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * v1y) + (cse_p11_t2_invsqrt35174 * cse_p12_t185_g35362 * v2z))) + (cse_p13_t1_g35415 * (c1y + (v2z * (-(v1x))))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 0, h_z3_x4);
      h_z3_y4 = ((cse_p12_t153_g35330 * cse_p12_t155_g35332 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t152_g35329 * cse_p12_t169_g35346) + (cse_p11_t4_invr35176 * cse_p12_t167_g35344 * cse_p12_t213_g35390) + (cse_p12_t152_g35329 * cse_p12_t208_g35385 * t2) + (cse_p12_t167_g35344 * cse_p14_t1_g35427) + (cse_p12_t1_g35404 * ((cse_p11_t1_sqrt35173 * (-(v1x))) + (cse_p11_t2_invsqrt35174 * cse_p12_t182_g35359 * v2z))) + (cse_p13_t1_g35415 * ((v1y * (-(v2z))) + (-(c1x)))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 1, h_z3_y4);
      h_z3_z4 = ((cse_p12_t153_g35330 * cse_p12_t157_g35334 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t152_g35329 * cse_p12_t171_g35348) + (cse_p11_t4_invr35176 * cse_p12_t167_g35344 * cse_p12_t214_g35391) + (cse_p12_t152_g35329 * cse_p12_t209_g35386 * t2) + (cse_p12_t167_g35344 * cse_p14_t1_g35425) + (cse_p12_t183_g35360 * cse_p13_t1_g35419 * v2z) + (cse_p13_t1_g35415 * (((-(v1x)) * (-(v2x))) + (v1y * v2y))))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x3, 2, i3x4, 2, h_z3_z4);
      h_x4_x4 = ((cse_p12_t160_g35337 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t174_g35351 * (cse_p14_t1_g35430 + (cse_p11_t4_invr35176 * cse_p12_t215_g35392) + (cse_p12_t185_g35362 * cse_p13_t1_g35414))) + (cse_p12_t185_g35362 * cse_p12_t1_g35407 * cse_p12_t210_g35387))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 0, h_x4_x4);
      h_x4_y4 = ((cse_p12_t155_g35332 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t174_g35351 * cse_p12_t213_g35390) + (cse_p12_t169_g35346 * cse_p12_t185_g35362 * cse_p13_t1_g35414) + (cse_p12_t174_g35351 * cse_p14_t1_g35427) + (cse_p12_t185_g35362 * cse_p12_t1_g35407 * cse_p12_t208_g35385))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 1, h_x4_y4);
      h_x4_z4 = ((cse_p12_t157_g35334 * cse_p12_t160_g35337 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t174_g35351 * cse_p12_t214_g35391) + (cse_p12_t171_g35348 * cse_p12_t185_g35362 * cse_p13_t1_g35414) + (cse_p12_t174_g35351 * cse_p14_t1_g35425) + (cse_p12_t185_g35362 * cse_p12_t1_g35407 * cse_p12_t209_g35386))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 0, i3x4, 2, h_x4_z4);
      h_y4_y4 = ((cse_p12_t155_g35332 * cse_p12_t155_g35332 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t169_g35346 * (cse_p14_t1_g35427 + (cse_p11_t4_invr35176 * cse_p12_t213_g35390) + (cse_p12_t182_g35359 * cse_p13_t1_g35414))) + (cse_p12_t182_g35359 * cse_p12_t1_g35407 * cse_p12_t208_g35385))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 1, h_y4_y4);
      h_y4_z4 = ((cse_p12_t155_g35332 * cse_p12_t157_g35334 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p11_t4_invr35176 * cse_p12_t169_g35346 * cse_p12_t214_g35391) + (cse_p12_t169_g35346 * cse_p14_t1_g35425) + (cse_p12_t171_g35348 * cse_p12_t182_g35359 * cse_p13_t1_g35414) + (cse_p12_t182_g35359 * cse_p12_t1_g35407 * cse_p12_t209_g35386))));
      KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 1, i3x4, 2, h_y4_z4);
      h_z4_z4 = ((cse_p12_t157_g35334 * cse_p12_t157_g35334 * cse_p12_t1_g35405) + (cse_p12_t1_g35406 * ((cse_p12_t171_g35348 * (cse_p14_t1_g35425 + (cse_p11_t4_invr35176 * cse_p12_t214_g35391) + (cse_p12_t183_g35360 * cse_p13_t1_g35414))) + (cse_p12_t183_g35360 * cse_p12_t1_g35407 * cse_p12_t209_g35386))));
      KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec,  i3x4, 2, i3x4, 2, h_z4_z4);
    }
  }
  return energy_added;
}
void hessian_fd(double v, double n, double sinphase, double cosphase, size_t i3x1, size_t i3x2, size_t i3x3, size_t i3x4, double* position, double* energy_accumulate, double* force, HESSIAN hessian, double* dvec, double* hdvec)
{
  constexpr size_t PositionSize = 12;
  const double h = 1.0e-5;
  const double inv2h = 1.0/(2.0*h);
  const double invh2 = 1.0/((h*h));
  double e0 = 0.0;
  energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e0, 0, 0, 0, 0);
  if (energy_accumulate) { *energy_accumulate += e0; }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 0, d);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 1, d);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x1, 2, d);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 0, d);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 1, d);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x2, 2, d);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 0, d);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 1, d);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x3, 2, d);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 0, d);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 1, d);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double d = (e_plus - e_minus) * inv2h;
    KernelGradientAcc(i3x4, 2, d);
  }
  {
    double saved = position[i3x1 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 0, i3x1, 0, hval);
  }
  {
    double saved = position[i3x1 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 1, hval);
  }
  {
    double saved = position[i3x1 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x1 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x1 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 2, hval);
  }
  {
    double saved = position[i3x2 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x2, 0, hval);
  }
  {
    double saved = position[i3x2 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 1, hval);
  }
  {
    double saved = position[i3x2 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x2 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x2 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 2, hval);
  }
  {
    double saved = position[i3x3 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x3, 0, hval);
  }
  {
    double saved = position[i3x3 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 1, hval);
  }
  {
    double saved = position[i3x3 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x3 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x3 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 2, hval);
  }
  {
    double saved = position[i3x4 + 0];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 0] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 0] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x4, 0, hval);
  }
  {
    double saved = position[i3x4 + 1];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 1] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 1] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 1, hval);
  }
  {
    double saved = position[i3x4 + 2];
    double e_plus = 0.0;
    double e_minus = 0.0;
    position[i3x4 + 2] = saved + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_plus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_minus, 0, 0, 0, 0);
    position[i3x4 + 2] = saved;
    double hval = (e_plus + e_minus - (2.0*e0)) * invh2;
    KernelHessDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 2, hval);
  }
  {
    double saved_i = position[i3x1 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x1 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x1 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x1, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x2 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x2 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x2, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x3 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x3 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x3, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 0];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 0] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 0, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 1];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 1] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 1, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x1 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x1 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x1 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x1 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x1, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x2 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x2 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x2 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x2 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x2, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 1, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x3 + 2];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x3 + 2] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x3 + 2] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x3 + 2] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x3, 2, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 0];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 0] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 0] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 0] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 0, hval);
  }
  {
    double saved_i = position[i3x4 + 2];
    double saved_j = position[i3x4 + 1];
    double e_pp = 0.0;
    double e_pm = 0.0;
    double e_mp = 0.0;
    double e_mm = 0.0;
    position[i3x4 + 2] = saved_i + h; position[i3x4 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_pm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i - h; position[i3x4 + 1] = saved_j + h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mp, 0, 0, 0, 0);
    position[i3x4 + 1] = saved_j - h;
    energy(v, n, sinphase, cosphase, i3x1, i3x2, i3x3, i3x4, position, &e_mm, 0, 0, 0, 0);
    position[i3x4 + 2] = saved_i; position[i3x4 + 1] = saved_j;
    double hval = (e_pp - e_pm - e_mp + e_mm) * (0.25*invh2);
    KernelHessOffDiagAcc( PositionSize, hessian, dvec, hdvec, i3x4, 2, i3x4, 1, hval);
  }
}

};
