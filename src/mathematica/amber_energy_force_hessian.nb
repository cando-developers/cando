(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    772503,      19658]
NotebookOptionsPosition[    734431,      18579]
NotebookOutlinePosition[    735067,      18604]
CellTagsIndexPosition[    735024,      18601]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Generate optimized energy, gradient, and Hessian expressions for molecular \
mechanics.\
\>", "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.402914001047615*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675593015943*^9, 3.40267560234683*^9}, 
   3.402675719919037*^9, 3.402914001047728*^9}],

Cell[BoxData["\<\"/Users/meister/temp/Mathematica\"\>"], "Output",
 CellChangeTimes->{{3.61955693636098*^9, 3.619556937398514*^9}, {
   3.702653597250333*^9, 3.702653598698069*^9}, 3.7026542065219917`*^9, {
   3.702664702977771*^9, 3.702664703748498*^9}, 3.702664834741228*^9, 
   3.702664879624086*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\</Users/meister/Temp/Mathematica\>\"", 
  "]"}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675724744155*^9, 3.402675744579932*^9}, {
   3.4026757812426653`*^9, 3.402675795163514*^9}, 3.4029140010477962`*^9, {
   3.404776927640129*^9, 3.4047769282020483`*^9}, {3.485009516098822*^9, 
   3.4850095173434477`*^9}, {3.619556879758088*^9, 3.6195568829874687`*^9}, {
   3.7026648712565193`*^9, 3.702664872815674*^9}}],

Cell[BoxData["\<\"/Users/meister/temp/Mathematica\"\>"], "Output",
 CellChangeTimes->{{3.619556936691887*^9, 3.619556937459659*^9}, {
   3.702653597583889*^9, 3.702653598769026*^9}, 3.702654206704248*^9, {
   3.70266470316539*^9, 3.702664703807929*^9}, {3.70266487362453*^9, 
   3.702664879745595*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.408659022451297*^9, 3.408659024556794*^9}}],

Cell["Setup to generate code that is embeded within CANDO", "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.402914001047846*^9, {3.494842902549116*^9, 3.494842937561069*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<optimizeExpressions`\>\"", "]"}]], "Code",
 CellChangeTimes->{{3.4055916304006453`*^9, 3.405591641125656*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Bond stretch term between two atoms with coordinates {x1,y1,z1} and {x2,y2,z2}
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.4948432970798798`*^9, 3.494843313989492*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}}],

Cell["Define the Hooks law bond stretch potential", "Subsection",
 CellChangeTimes->{{3.494843329696516*^9, 3.4948433485250063`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchDeviation", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"bb", "-", "ba"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"bb", "-", "ba"}], ")"}]}], "]"}], "-", "r0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
  3.411152033364759*^9, 3.411152034157058*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stretchEnergyFn", " ", "=", "  ", 
  RowBox[{"kb", "  ", 
   RowBox[{
    RowBox[{"(", "stretchDeviation", ")"}], "^", "2.0"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.416871725859004*^9, 3.416871727438574*^9}, 3.416872040224017*^9}],

Cell[BoxData[
 RowBox[{"kb", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "r0"}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
   "2.`"]}]], "Output",
 CellChangeTimes->{3.6195569378511963`*^9, 3.7026536050738993`*^9, 
  3.7026536855462227`*^9, 3.702654207372356*^9, 3.7026597526627398`*^9, 
  3.702664708176724*^9, 3.702664882707621*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619556937908368*^9, 3.702653605128133*^9, 
  3.7026536855978527`*^9, 3.702654207431299*^9, 3.702659752738065*^9, 
  3.7026647082359858`*^9, 3.702664882771675*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assemble the energy function rules to expand", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 3.401714291927002*^9}, {
  3.494843844071973*^9, 3.494843851677432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stretchSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(kb);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(r0);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "stretchVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<STRETCH_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"stretchSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}}],

Cell[BoxData["\<\"STRETCH_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 3.7026648828907623`*^9}],

Cell[BoxData["\<\"STRETCH_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 3.7026648828925743`*^9}],

Cell[BoxData["\<\"STRETCH_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 3.702664882893835*^9}],

Cell[BoxData["\<\"STRETCH_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 3.702664882895054*^9}],

Cell[BoxData["\<\"STRETCH_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 3.7026648828963337`*^9}],

Cell[BoxData["\<\"STRETCH_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 3.7026648828977137`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stretchSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
  3.41017756267308*^9, 3.4101775644454517`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(kb);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(r0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(z2,I2,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556938092057*^9, 3.702653605327971*^9, 
  3.702653685806456*^9, 3.702654207694806*^9, 3.702659752987501*^9, 
  3.7026647084190598`*^9, 3.702664882946087*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stretchEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stretchOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"StretchDeviation", ",", "stretchDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "stretchEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<STRETCH\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 3.411152028421866*^9}}]
}, Open  ]],

Cell["Append the Gradient and Hessian rules", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 3.408559038294833*^9}, {3.494843872271369*^9, 
  3.4948438859081783`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["stretchEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}}],

Cell[BoxData[
 RowBox[{"kb", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "r0"}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
   "2.`"]}]], "Output",
 CellChangeTimes->{3.619556938156497*^9, 3.7026536054685583`*^9, 
  3.702653685912662*^9, 3.702654207807459*^9, 3.702659753095257*^9, 
  3.702664708535633*^9, 3.70266488302398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"stretchHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556938208083*^9, 3.7026536055282393`*^9, 
  3.702653685978429*^9, 3.702654207849318*^9, 3.702659753187606*^9, 
  3.702664708590064*^9, 3.702664883081134*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<STRETCH\>\"", ",", "stretchForceHessianRules", ",", "stretchOutputs", 
    ",", "stretchHessian", ",", "stretchEnergyFn", ",", "stretchVarNames"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
  3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
  3.410177087548172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stretchHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
  3.40933303751335*^9, 3.4093330391745863`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"8", "14", "15", "16", "17", "18"},
     {"14", "9", "19", "20", "21", "22"},
     {"15", "19", "10", "23", "24", "25"},
     {"16", "20", "23", "11", "26", "27"},
     {"17", "21", "24", "26", "12", "28"},
     {"18", "22", "25", "27", "28", "13"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556939636632*^9, 3.702653608699246*^9, 
  3.702653689631126*^9, 3.7026542125522013`*^9, 3.702659756516313*^9, 
  3.7026647121697493`*^9, 3.702664884656994*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["stretchOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", 
   "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", 
   "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", 
   "ohx2z2", ",", "ohy2z2"}], "}"}]], "Output",
 CellChangeTimes->{3.6195569396919193`*^9, 3.702653608899151*^9, 
  3.702653689710197*^9, 3.702654212624216*^9, 3.702659756587872*^9, 
  3.702664712435915*^9, 3.702664884694969*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 3.401714390085981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "stretchSetupRules", ",", "\[IndentingNewLine]", "stretchEnergyRules", 
     ",", "\[IndentingNewLine]", "stretchForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "stretchAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}}],

Cell[CellGroupData[{

Cell[BoxData["stretchRules"], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 3.411210898002816*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(kb);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(r0);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(I1);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(I2);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(x1,I1,0);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(y1,I1,1);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(z1,I1,2);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(x2,I2,0);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(y2,I2,1);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(z2,I2,2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "r0"}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "\[Rule]", 
    "StretchDeviation"}], ",", 
   RowBox[{
    RowBox[{"kb", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r0"}], "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
      "2.`"]}], "\[Rule]", "Energy"}], ",", 
   RowBox[{"CCode", "[", "\<\"STRETCH_ENERGY_ACCUMULATE(Energy);\"\>", "]"}], 
   ",", 
   RowBox[{"CCode", "[", "\<\"#ifdef STRETCH_CALC_FORCE //[\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "gx1"}], ",", 
   RowBox[{
    RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "gy1"}], ",", 
   RowBox[{
    RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "gz1"}], ",", 
   RowBox[{
    RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", "]"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2.`", " ", "kb", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r0"}], "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
       "1.`"]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]], "\[Rule]", 
    "gx2"}], ",", 
   RowBox[{
    RowBox[{"-", "gx2"}], "\[Rule]", "fx2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );\"\>", "]"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2.`", " ", "kb", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r0"}], "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
       "1.`"]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]], "\[Rule]", 
    "gy2"}], ",", 
   RowBox[{
    RowBox[{"-", "gy2"}], "\[Rule]", "fy2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 );\"\>", "]"}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"2.`", " ", "kb", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "r0"}], "+", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
       "1.`"]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]], "\[Rule]", 
    "gz2"}], ",", 
   RowBox[{
    RowBox[{"-", "gz2"}], "\[Rule]", "fz2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"#ifdef STRETCH_CALC_DIAGONAL_HESSIAN //[\"\>", "]"}], 
   ",", 
   RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "dhx1x1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "dhy1y1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "dhz1z1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "dhx2x2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, \
dhx2x2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "dhy2y2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, \
dhy2y2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "dhz2z2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, \
dhz2z2);\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN //[\"\>", 
    "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], 
   ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohx1y1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohx1z1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "ohx1x2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohx1y2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohx1z2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohy1z1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohy1x2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "ohy1y2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohy1z2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohz1x2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohz1y2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2.`", " ", "kb", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "-", 
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "r0"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
        "1.`"]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]]}], "\[Rule]", 
    "ohz1z2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohx2y2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohx2z2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2.`", " ", "kb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.`", " ", "kb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r0"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
         "1.`"]}], ")"}], "/", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]}], "\[Rule]", "ohy2z2"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], 
   ",", 
   RowBox[{
   "CCode", "[", "\<\"#endif /* STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\>", 
    "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/\"\>", "]"}],
    ",", 
   RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"#endif /* STRETCH_CALC_FORCE ]*/\"\>", "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619556939840193*^9, 3.702653609565177*^9, 
  3.702653689886273*^9, 3.7026542127845984`*^9, 3.702659631817461*^9, 
  3.7026596908466673`*^9, 3.7026597567357264`*^9, 3.702664712584796*^9, 
  3.702664884815559*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "r0", 
     ",", "kb"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
  3.408556502824588*^9, 3.4085565040993557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchOutputs", ",", "StretchDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 3.411152052756624*^9}}],

Cell["\<\
Assemble the rules, the name of the energy term, the independant variable \
names, etc. into what passes for a structure in Mathematica (I call it a Pack)\
\>", "Subsection",
 CellChangeTimes->{{3.494843911918105*^9, 3.494844017248684*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Stretch\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "stretchHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "stretchRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "stretchInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "stretchOutputs"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "stretchPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 3.4110670621890917`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing finite difference debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugFiniteDifference.cc\"\>"}],
  SequenceForm[
  "Writing finite difference debug code to: ", 
   "_Stretch_debugFiniteDifference.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 3.702664884974375*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing debug variable declares to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugEvalDeclares.cc\"\>"}],
  SequenceForm[
  "Writing debug variable declares to: ", "_Stretch_debugEvalDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 3.702664884976199*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing xml output debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugEvalSerialize.cc\"\>"}],
  SequenceForm[
  "Writing xml output debug code to: ", "_Stretch_debugEvalSerialize.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 3.702664884977539*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing set variables debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugEvalSet.cc\"\>"}],
  SequenceForm[
  "Writing set variables debug code to: ", "_Stretch_debugEvalSet.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 3.702664884978869*^9}]
}, Open  ]],

Cell["\<\
stretchPack = Block[{PrintTemporary = Print}, packOptimize[stretchPack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}}],

Cell["Put the pedal to the metal and generate \"C\" code.", "Subsection",
 CellChangeTimes->{{3.494844094666773*^9, 3.494844119787055*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "stretchPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}}],

Cell[BoxData[
 StyleBox["\<\"Set TimesSimplify and PlusSimplify to turn these \
simplifications off and on\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->24,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664885030191*^9}],

Cell[BoxData[
 StyleBox["\<\"PlusOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664885032074*^9}],

Cell[BoxData[
 StyleBox["\<\"TimesOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.7026648850334*^9}],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664887928844*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664887930175*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664887931446*^9}],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664887932836*^9}],

Cell[BoxData["\<\"Collecting terms\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664887977501*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(Times\\)\[NoBreak] in \
\[NoBreak]\\!\\(Null\\\\ \\(\\({\\(\\(Name \[Rule] \\\"Stretch\\\"\\)\\), \\(\
\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \\(\\(Output \[Rule] \
\\(\\({Energy, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), ohx1z2, ohy1z1, \
ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
StretchDeviation}\\)\\)\\)\\)}\\)\\)\\)\[NoBreak] is Protected. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/write\\\", \
ButtonNote -> \\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.702659694848699*^9, 3.702659760691435*^9, 
  3.702664716820163*^9, 3.70266488797926*^9}],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664890878891*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664890880373*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664890881813*^9}],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664890883408*^9}],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891128175*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891129704*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.7026648911311502`*^9}],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891132653*^9}],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891179064*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891180541*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891182026*^9}],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.70266489118356*^9}],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\n-2. kb \
tx47 tx57 tx58 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\n-2. kb tx48 tx57 \
tx58 -> gy1\\n\\n-gy1 -> fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n-2. kb tx49 tx57 tx58 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n2. kb tx47 tx57 \
tx58 -> gx2\\n\\n-gx2 -> fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 \
);]\\n\\n2. kb tx48 tx57 tx58 -> gy2\\n\\n-gy2 -> \
fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 );]\\n\\n2. kb tx49 tx57 \
tx58 -> gz2\\n\\n-gz2 -> fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 \
);]\\n\\nCCode[#ifdef STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcDiagonalHessian ) {]\\n\\ntx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\nreciprocal[tx87] -> tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> \
tx60\\n\\n2. kb tx57 tx88 -> tx61\\n\\n-2. kb tx50 tx57 tx59 -> tx62\\n\\n2. \
kb tx50 tx60 -> tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\n-2. kb tx51 tx57 tx59 -> tx64\\n\\n2. kb tx51 tx60 -> tx65\\n\\ntx61 + \
tx64 + tx65 -> dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);]\\n\\n-2. kb tx52 tx57 tx59 -> tx66\\n\\n2. kb tx52 tx60 -> \
tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\n-2. kb tx47 tx48 tx57 \
tx59 -> tx68\\n\\n2. kb tx47 tx48 tx60 -> tx69\\n\\ntx68 + tx69 -> \
ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\n-2. kb tx47 tx49 tx57 tx59 -> tx70\\n\\n2. kb tx47 tx49 tx60 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. kb tx57 tx88 -> tx72\\n\\n2. kb tx50 tx57 tx59 -> \
tx73\\n\\n-2. kb tx50 tx60 -> tx74\\n\\ntx72 + tx73 + tx74 -> \
ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\n2. kb tx47 tx48 tx57 tx59 -> tx75\\n\\n-2. kb tx47 tx48 tx60 \
-> tx76\\n\\ntx75 + tx76 -> \
ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\n2. kb tx47 tx49 tx57 tx59 -> tx77\\n\\n-2. kb tx47 tx49 tx60 \
-> tx78\\n\\ntx77 + tx78 -> \
ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\n-2. kb tx48 tx49 tx57 tx59 -> tx79\\n\\n2. kb tx48 tx49 tx60 \
-> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\n2. kb tx51 tx57 tx59 -> tx81\\n\\n-2. kb tx51 tx60 -> \
tx82\\n\\ntx72 + tx81 + tx82 -> \
ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\n2. kb tx48 tx49 tx57 tx59 -> tx83\\n\\n-2. kb tx48 tx49 tx60 \
-> tx84\\n\\ntx83 + tx84 -> \
ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\n2. kb tx52 tx57 tx59 -> tx85\\n\\n-2. kb tx52 tx60 -> \
tx86\\n\\ntx72 + tx85 + tx86 -> \
ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891185121*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891929039*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891930646*^9}],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891932186*^9}],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\nkb tx57 \
-> tzz90\\n\\ntx58 tzz90 -> tzz93\\n\\n-2. tzz93 -> tzz102\\n\\ntx47 tzz102 \
-> gx1\\n\\n-gx1 -> fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\
\\ntx48 tzz102 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx49 tzz102 -> \
gz1\\n\\n-gz1 -> fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n2. tzz93 -> tzz101\\n\\ntx47 tzz101 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\ntx48 tzz101 -> \
gy2\\n\\n-gy2 -> fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 \
);]\\n\\ntx49 tzz101 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ntx53 -> tx87\\n\\ntx58 -> tx88\\n\\nreciprocal[tx87] -> \
tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> tx60\\n\\n2. tx88 tzz90 -> \
tx61\\n\\ntx59 tzz90 -> tzz91\\n\\n-2. tzz91 -> tzz97\\n\\ntx50 tzz97 -> tx62\
\\n\\nkb tx60 -> tzz92\\n\\n2. tzz92 -> tzz94\\n\\ntx50 tzz94 -> \
tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx51 tzz97 -> tx64\\n\\ntx51 tzz94 -> tx65\\n\\ntx61 + tx64 + tx65 -> \
dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx52 tzz97 -> tx66\\n\\ntx52 tzz94 -> tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx47 tx48 -> \
tzz100\\n\\ntzz100 tzz97 -> tx68\\n\\ntzz100 tzz94 -> tx69\\n\\ntx68 + tx69 \
-> ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx47 tx49 -> tzz99\\n\\ntzz97 tzz99 -> tx70\\n\\ntzz94 tzz99 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. tx88 tzz90 -> tx72\\n\\n2. tzz91 -> tzz95\\n\\ntx50 tzz95 \
-> tx73\\n\\n-2. tzz92 -> tzz96\\n\\ntx50 tzz96 -> tx74\\n\\ntx72 + tx73 + \
tx74 -> ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
0, ohx1x2);]\\n\\ntzz100 tzz95 -> tx75\\n\\ntzz100 tzz96 -> tx76\\n\\ntx75 + \
tx76 -> ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
1, ohx1y2);]\\n\\ntzz95 tzz99 -> tx77\\n\\ntzz96 tzz99 -> tx78\\n\\ntx77 + \
tx78 -> ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
2, ohx1z2);]\\n\\ntx48 tx49 -> tzz98\\n\\ntzz97 tzz98 -> tx79\\n\\ntzz94 \
tzz98 -> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx51 tzz95 -> tx81\\n\\ntx51 tzz96 -> tx82\\n\\ntx72 + tx81 + \
tx82 -> ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
1, ohy1y2);]\\n\\ntzz95 tzz98 -> tx83\\n\\ntzz96 tzz98 -> tx84\\n\\ntx83 + \
tx84 -> ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
2, ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx52 tzz95 -> tx85\\n\\ntx52 tzz96 -> tx86\\n\\ntx72 + tx85 + \
tx86 -> ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, \
2, ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.70266489193359*^9}],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891977737*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891979203*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891980592*^9}],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664891982128*^9}],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\nkb tx57 \
-> tzz90\\n\\ntx58 tzz90 -> tzz93\\n\\n-2. tzz93 -> tzz102\\n\\ntx47 tzz102 \
-> gx1\\n\\n-gx1 -> fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\
\\ntx48 tzz102 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx49 tzz102 -> \
gz1\\n\\n-gz1 -> fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n2. tzz93 -> tzz101\\n\\ntx47 tzz101 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\ntx48 tzz101 -> \
gy2\\n\\n-gy2 -> fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 \
);]\\n\\ntx49 tzz101 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ntx53 -> tx87\\n\\ntx58 -> tx88\\n\\nreciprocal[tx87] -> \
tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> tx60\\n\\n2. tx88 tzz90 -> \
tx61\\n\\ntx59 tzz90 -> tzz91\\n\\n-2. tzz91 -> tzz97\\n\\ntx50 tzz97 -> tx62\
\\n\\nkb tx60 -> tzz92\\n\\n2. tzz92 -> tzz94\\n\\ntx50 tzz94 -> \
tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx51 tzz97 -> tx64\\n\\ntx51 tzz94 -> tx65\\n\\ntx61 + tx64 + tx65 -> \
dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx52 tzz97 -> tx66\\n\\ntx52 tzz94 -> tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx47 tx48 -> \
tzz100\\n\\ntzz100 tzz97 -> tx68\\n\\ntzz100 tzz94 -> tx69\\n\\ntx68 + tx69 \
-> ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx47 tx49 -> tzz99\\n\\ntzz97 tzz99 -> tx70\\n\\ntzz94 tzz99 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. tx88 tzz90 -> tx72\\n\\n2. tzz91 -> tzz95\\n\\ntx50 tzz95 \
-> tx73\\n\\n-2. tzz92 -> tzz96\\n\\ntx50 tzz96 -> tx74\\n\\ntx72 + tx73 + \
tx74 -> ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
0, ohx1x2);]\\n\\ntzz100 tzz95 -> tx75\\n\\ntzz100 tzz96 -> tx76\\n\\ntx75 + \
tx76 -> ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
1, ohx1y2);]\\n\\ntzz95 tzz99 -> tx77\\n\\ntzz96 tzz99 -> tx78\\n\\ntx77 + \
tx78 -> ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
2, ohx1z2);]\\n\\ntx48 tx49 -> tzz98\\n\\ntzz97 tzz98 -> tx79\\n\\ntzz94 \
tzz98 -> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx51 tzz95 -> tx81\\n\\ntx51 tzz96 -> tx82\\n\\ntx72 + tx81 + \
tx82 -> ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
1, ohy1y2);]\\n\\ntzz95 tzz98 -> tx83\\n\\ntzz96 tzz98 -> tx84\\n\\ntx83 + \
tx84 -> ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
2, ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx52 tzz95 -> tx85\\n\\ntx52 tzz96 -> tx86\\n\\ntx72 + tx85 + \
tx86 -> ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, \
2, ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.7026648919835453`*^9}],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664892078755*^9}],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.7026648920802526`*^9}],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.70266489208176*^9}],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\nkb tx57 \
-> tzz90\\n\\ntx58 tzz90 -> tzz93\\n\\n-2. tzz93 -> tzz102\\n\\ntx47 tzz102 \
-> gx1\\n\\n-gx1 -> fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\
\\ntx48 tzz102 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx49 tzz102 -> \
gz1\\n\\n-gz1 -> fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n2. tzz93 -> tzz101\\n\\ntx47 tzz101 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\ntx48 tzz101 -> \
gy2\\n\\n-gy2 -> fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 \
);]\\n\\ntx49 tzz101 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ntx53 -> tx87\\n\\ntx58 -> tx88\\n\\nreciprocal[tx87] -> \
tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> tx60\\n\\n2. tx88 tzz90 -> \
tx61\\n\\ntx59 tzz90 -> tzz91\\n\\n-2. tzz91 -> tzz97\\n\\ntx50 tzz97 -> tx62\
\\n\\nkb tx60 -> tzz92\\n\\n2. tzz92 -> tzz94\\n\\ntx50 tzz94 -> \
tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx51 tzz97 -> tx64\\n\\ntx51 tzz94 -> tx65\\n\\ntx61 + tx64 + tx65 -> \
dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx52 tzz97 -> tx66\\n\\ntx52 tzz94 -> tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx47 tx48 -> \
tzz100\\n\\ntzz100 tzz97 -> tx68\\n\\ntzz100 tzz94 -> tx69\\n\\ntx68 + tx69 \
-> ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx47 tx49 -> tzz99\\n\\ntzz97 tzz99 -> tx70\\n\\ntzz94 tzz99 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. tx88 tzz90 -> tx72\\n\\n2. tzz91 -> tzz95\\n\\ntx50 tzz95 \
-> tx73\\n\\n-2. tzz92 -> tzz96\\n\\ntx50 tzz96 -> tx74\\n\\ntx72 + tx73 + \
tx74 -> ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
0, ohx1x2);]\\n\\ntzz100 tzz95 -> tx75\\n\\ntzz100 tzz96 -> tx76\\n\\ntx75 + \
tx76 -> ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
1, ohx1y2);]\\n\\ntzz95 tzz99 -> tx77\\n\\ntzz96 tzz99 -> tx78\\n\\ntx77 + \
tx78 -> ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
2, ohx1z2);]\\n\\ntx48 tx49 -> tzz98\\n\\ntzz97 tzz98 -> tx79\\n\\ntzz94 \
tzz98 -> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx51 tzz95 -> tx81\\n\\ntx51 tzz96 -> tx82\\n\\ntx72 + tx81 + \
tx82 -> ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
1, ohy1y2);]\\n\\ntzz95 tzz98 -> tx83\\n\\ntzz96 tzz98 -> tx84\\n\\ntx83 + \
tx84 -> ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
2, ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx52 tzz95 -> tx85\\n\\ntx52 tzz96 -> tx86\\n\\ntx72 + tx85 + \
tx86 -> ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, \
2, ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664892083129*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing declares to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_termDeclares.cc\"\>"}],
  SequenceForm["Writing declares to file: ", "_Stretch_termDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.702664892128408*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing code to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_termCode.cc\"\>"}],
  SequenceForm["Writing code to file: ", "_Stretch_termCode.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 3.7026648921298313`*^9}]
}, {32}]]
}, Open  ]],

Cell["\<\
Draw an evaluation tree for the optimized \"C\" code.  It doesn' t do \
anything useful but it looks impressive - I have got to print some of these \
on large format posters.

Inputs (independent variables and parameters) are on the left and drawn in \
Black, and outputs are on the right and also drawn in Black. Computationally \
expensive functions are highlighted in red, Plus functions are blue and Times \
functions are green.\
\>", "Subsection",
 CellChangeTimes->{{3.494844130294557*^9, 3.494844200819201*^9}, {
  3.494844239453156*^9, 3.494844307388302*^9}, {3.494844349909049*^9, 
  3.494844362349473*^9}, {3.494844417981534*^9, 3.49484444617253*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "stretchPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
  3.4085648880849*^9, 3.408564889562644*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 19.}, {0.03, 11.875}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 56.99999999999999}, {0.03, 35.625}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 95.}, {0.03, 59.375}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 23.75}, {0.13, 19.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 23.75}, {0.03, 83.125}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 71.25}, {0.13, 56.99999999999999}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 71.25}, {0.03, 106.875}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 118.75}, {0.13, 95.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 118.75}, {0.03, 130.625}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 13.571428571428573`}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 40.71428571428571}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 67.85714285714286}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.5}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.5}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.5}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 133.}, {0.03, 154.375}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.47000000000000003`, 31.666666666666664`}, {0.43, 47.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.5700000000000001, 19.}, {0.13, 133.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.5700000000000001, 19.}, {0.53, 31.666666666666664`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 19.}, {0.63, 19.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 19.}, {0.63, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 19.}, {0.73, 19.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 56.99999999999999}, {0.63, 19.}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.5700000000000001, 95.}, {0.53, 31.666666666666664`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 56.99999999999999}, {0.63, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 56.99999999999999}, {0.73, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 13.571428571428573`}, {0.63, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 13.571428571428573`}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 5.588235294117647}, {0.9300000000000002, 
     13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 5.}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 5.}, {1.03, 5.588235294117647}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 5.}, {1.1300000000000001`, 5.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 15.}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 15.}, {1.03, 5.588235294117647}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 15.}, {1.1300000000000001`, 15.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 25.}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 25.}, {1.03, 5.588235294117647}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 25.}, {1.1300000000000001`, 25.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 16.764705882352942`}, {0.9300000000000002, 
     13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 35.}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 35.}, {1.03, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 35.}, {1.1300000000000001`, 35.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 45.}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 45.}, {1.03, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 45.}, {1.1300000000000001`, 45.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 55.}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 55.}, {1.03, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 55.}, {1.1300000000000001`, 55.}}]}, 
   {GrayLevel[0], LineBox[{{0.47000000000000003`, 95.}, {0.43, 47.5}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 95.}, {0.63, 95.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.5700000000000001, 133.}, {0.53, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 95.}, {0.73, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 95.}, {0.63, 133.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 133.}, {0.63, 133.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 40.71428571428571}, {0.73, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 40.71428571428571}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 67.85714285714286}, {0.8300000000000001, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 67.85714285714286}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 27.941176470588232`}, {0.9300000000000002, 
     67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 65.}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 65.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 133.}, {0.63, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 133.}, {0.73, 133.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 95.}, {0.8300000000000001, 133.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 39.117647058823536`}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 39.117647058823536`}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 65.}, {0.9300000000000002, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 65.}, {1.1300000000000001`, 65.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 65.}, {1.03, 39.117647058823536`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 75.}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 75.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 50.294117647058826`}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 50.294117647058826`}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 75.}, {0.9300000000000002, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 75.}, {1.1300000000000001`, 75.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 75.}, {1.03, 50.294117647058826`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 85.}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 85.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 61.47058823529412}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 61.47058823529412}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 85.}, {0.9300000000000002, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 85.}, {1.1300000000000001`, 85.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 85.}, {1.03, 61.47058823529412}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 9.5}, {1.2300000000000002`, 65.}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.27, 28.499999999999996`}, {1.2300000000000002`, 75.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 47.5}, {1.2300000000000002`, 85.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 95.}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 95.}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 95.}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 95.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 72.6470588235294}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 72.6470588235294}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 95.}, {1.1300000000000001`, 95.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 95.}, {1.03, 72.6470588235294}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 122.14285714285715`}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 122.14285714285715`}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 105.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 105.}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 83.82352941176471}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 83.82352941176471}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 105.}, {1.1300000000000001`, 105.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 105.}, {1.03, 83.82352941176471}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 122.14285714285715`}, {0.73, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 122.14285714285715`}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 95.}, {0.9300000000000002, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 115.}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 115.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 149.28571428571428`}, {0.8300000000000001, 133.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 106.17647058823529`}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 106.17647058823529`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 115.}, {0.9300000000000002, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 115.}, {1.1300000000000001`, 115.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 115.}, {1.03, 106.17647058823529`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 125.}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 125.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 117.3529411764706}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 117.3529411764706}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 125.}, {1.1300000000000001`, 125.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 125.}, {1.03, 117.3529411764706}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 135.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 135.}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 128.52941176470588`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 128.52941176470588`}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 135.}, {1.1300000000000001`, 135.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 135.}, {1.03, 128.52941176470588`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 149.28571428571428`}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 149.28571428571428`}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 145.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 145.}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 139.7058823529412}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 139.7058823529412}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 145.}, {1.1300000000000001`, 145.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 145.}, {1.03, 139.7058823529412}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 66.5}, {1.2300000000000002`, 125.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 155.}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 155.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 150.88235294117646`}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 150.88235294117646`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 155.}, {0.9300000000000002, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 155.}, {1.1300000000000001`, 155.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 155.}, {1.03, 150.88235294117646`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 165.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 165.}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 162.05882352941177`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 162.05882352941177`}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 165.}, {1.1300000000000001`, 165.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 165.}, {1.03, 162.05882352941177`}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.27, 85.49999999999999}, {1.2300000000000002`, 135.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 104.5}, {1.2300000000000002`, 165.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 175.}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 175.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 173.23529411764707`}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 173.23529411764707`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 175.}, {0.9300000000000002, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 175.}, {1.1300000000000001`, 175.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 175.}, {1.03, 173.23529411764707`}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 123.5}, {1.2300000000000002`, 95.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 142.5}, {1.2300000000000002`, 105.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 161.5}, {1.2300000000000002`, 145.}}]}, 
   {GrayLevel[0], InsetBox["\<\"x1\"\>", {0., 11.875},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx44:Times(-1)\"\>", {0.1, 19.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y1\"\>", {0., 35.625},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx45:Times(-1)\"\>", {0.1, 56.99999999999999},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z1\"\>", {0., 59.375},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx46:Times(-1)\"\>", {0.1, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"x2\"\>", {0., 83.125},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx47:Plus\"\>", {0.2, 23.75},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y2\"\>", {0., 106.875},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx48:Plus\"\>", {0.2, 71.25},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z2\"\>", {0., 130.625},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx49:Plus\"\>", {0.2, 118.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx50:power2\"\>", {0.30000000000000004`, 13.571428571428573`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx51:power2\"\>", {0.30000000000000004`, 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx52:power2\"\>", {0.30000000000000004`, 67.85714285714286},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx53:Plus\"\>", {0.4, 47.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"r0\"\>", {0., 154.375},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx54:Times(-1)\"\>", {0.1, 133.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx55:mysqrt\"\>", {0.5, 31.666666666666664`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"StretchDeviation:Plus\"\>", {0.6000000000000001, 19.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx56:power2\"\>", {0.7000000000000001, 19.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"kb\"\>", {0.6000000000000001, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"Energy:Times\"\>", {0.8, 19.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx57:Symbol\"\>", {0.7000000000000001, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx58:reciprocal\"\>", {0.6000000000000001, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz90:Times\"\>", {0.8, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz93:Times\"\>", {0.9, 13.571428571428573`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz102:Times(-2.)\"\>", {1., 5.588235294117647},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gx1:Times\"\>", {1.1, 5.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx1:Times(-1)\"\>", {1.2000000000000002`, 5.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gy1:Times\"\>", {1.1, 15.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy1:Times(-1)\"\>", {1.2000000000000002`, 15.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz1:Times\"\>", {1.1, 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz1:Times(-1)\"\>", {1.2000000000000002`, 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], 
    InsetBox["\<\"tzz101:Times(2.)\"\>", {1., 16.764705882352942`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gx2:Times\"\>", {1.1, 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx2:Times(-1)\"\>", {1.2000000000000002`, 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gy2:Times\"\>", {1.1, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy2:Times(-1)\"\>", {1.2000000000000002`, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz2:Times\"\>", {1.1, 55.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz2:Times(-1)\"\>", {1.2000000000000002`, 55.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx87:Symbol\"\>", {0.5, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx88:Symbol\"\>", {0.7000000000000001, 95.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx89:reciprocal\"\>", {0.6000000000000001, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx59:Times\"\>", {0.8, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx60:Symbol\"\>", {0.7000000000000001, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx61:Times(2.)\"\>", {0.9, 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz91:Times\"\>", {0.9, 67.85714285714286},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz97:Times(-2.)\"\>", {1., 27.941176470588232`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx62:Times\"\>", {1.1, 65.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz92:Times\"\>", {0.8, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz94:Times(2.)\"\>", {0.9, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx63:Times\"\>", {1., 39.117647058823536`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhx1x1:Plus\"\>", {1.2000000000000002`, 65.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx64:Times\"\>", {1.1, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx65:Times\"\>", {1., 50.294117647058826`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhy1y1:Plus\"\>", {1.2000000000000002`, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx66:Times\"\>", {1.1, 85.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx67:Times\"\>", {1., 61.47058823529412},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhz1z1:Plus\"\>", {1.2000000000000002`, 85.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhx2x2:Symbol\"\>", {1.3, 9.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhy2y2:Symbol\"\>", {1.3, 28.499999999999996`},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhz2z2:Symbol\"\>", {1.3, 47.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz100:Times\"\>", {0.30000000000000004`, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx68:Times\"\>", {1.1, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx69:Times\"\>", {1., 72.6470588235294},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y1:Plus\"\>", {1.2000000000000002`, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz99:Times\"\>", {0.30000000000000004`, 122.14285714285715`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx70:Times\"\>", {1.1, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx71:Times\"\>", {1., 83.82352941176471},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z1:Plus\"\>", {1.2000000000000002`, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx72:Times(-2.)\"\>", {0.9, 122.14285714285715`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz95:Times(2.)\"\>", {1., 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx73:Times\"\>", {1.1, 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz96:Times(-2.)\"\>", {0.9, 149.28571428571428`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx74:Times\"\>", {1., 106.17647058823529`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1x2:Plus\"\>", {1.2000000000000002`, 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx75:Times\"\>", {1.1, 125.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx76:Times\"\>", {1., 117.3529411764706},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y2:Plus\"\>", {1.2000000000000002`, 125.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx77:Times\"\>", {1.1, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx78:Times\"\>", {1., 128.52941176470588`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z2:Plus\"\>", {1.2000000000000002`, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz98:Times\"\>", {0.30000000000000004`, 149.28571428571428`},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx79:Times\"\>", {1.1, 145.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx80:Times\"\>", {1., 139.7058823529412},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z1:Plus\"\>", {1.2000000000000002`, 145.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy1x2:Symbol\"\>", {1.3, 66.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx81:Times\"\>", {1.1, 155.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx82:Times\"\>", {1., 150.88235294117646`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1y2:Plus\"\>", {1.2000000000000002`, 155.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx83:Times\"\>", {1.1, 165.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx84:Times\"\>", {1., 162.05882352941177`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z2:Plus\"\>", {1.2000000000000002`, 165.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1x2:Symbol\"\>", {1.3, 85.49999999999999},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1y2:Symbol\"\>", {1.3, 104.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx85:Times\"\>", {1.1, 175.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx86:Times\"\>", {1., 173.23529411764707`},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohz1z2:Plus\"\>", {1.2000000000000002`, 175.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2y2:Symbol\"\>", {1.3, 123.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2z2:Symbol\"\>", {1.3, 142.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy2z2:Symbol\"\>", {1.3, 161.5},
     Background->Automatic]}},
  AspectRatio->0.41,
  ImageSize->{464.44374999999945`, Automatic}]], "Output",
 CellChangeTimes->{3.619556950288836*^9, 3.7026536103341227`*^9, 
  3.702653690221656*^9, 3.7026542134211082`*^9, 3.702659732981819*^9, 
  3.7026597709221783`*^9, 3.7026647218992643`*^9, 3.7026648925602007`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Angle bend term using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " generated gradient/Hessian expansion"
}], "Subtitle",
 CellChangeTimes->{{3.494844035232679*^9, 3.494844038080626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", 
    ",", "y3", ",", "z3", ",", "ab", ",", "cb", ",", "ba", ",", "bb", ",", 
    "bc"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.402652780531734*^9, 3.402652792729147*^9}, {
  3.405593978391768*^9, 3.405593979390263*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40265249626128*^9, 3.4026525067255383`*^9}, {
  3.402652543649145*^9, 3.4026526050967493`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "bc", ",", 
     RowBox[{"{", 
      RowBox[{"t0", ",", "kt"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4055966209501877`*^9, 3.405596670762001*^9}, {
  3.405596704315874*^9, 3.405596706769898*^9}, {3.410178228193839*^9, 
  3.410178228313593*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "t0", ",", "kt"}], "}"}]], "Output",
 CellChangeTimes->{3.61955698576481*^9, 3.702654213575954*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecLen", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", "=", " ", 
   RowBox[{"ba", " ", "-", " ", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cb", " ", "=", " ", 
   RowBox[{"bc", " ", "-", " ", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotNormAbNormCb", "=", " ", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{"ab", ",", "cb"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vecLen", "[", "ab", "]"}], 
      RowBox[{"vecLen", "[", "cb", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fnThetaDev", " ", "=", " ", 
  RowBox[{
   RowBox[{"ArcCos", "[", "dotNormAbNormCb", "]"}], "-", "t0"}]}]}], "Input",
 CellChangeTimes->{{3.405593952552783*^9, 3.4055939691503*^9}, {
   3.410366657579863*^9, 3.41036669377003*^9}, 3.410366728321971*^9, {
   3.41038785424853*^9, 3.410387855638277*^9}, {3.410392048482498*^9, 
   3.4103920758498573`*^9}, {3.4103921152109213`*^9, 3.4103921313864594`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "t0"}], "+", 
  RowBox[{"ArcCos", "[", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "x2"}], "+", "x3"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y2"}], "+", "y3"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z1", "-", "z2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z2"}], "+", "z3"}], ")"}]}]}], 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x2"}], "+", "x3"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y2"}], "+", "y3"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z2"}], "+", "z3"}], ")"}], "2"]}]]}]], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.619556985853228*^9, 3.702654213659534*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleEnergyFn", " ", "=", "  ", 
  RowBox[{"kt", " ", 
   RowBox[{
    RowBox[{"(", "thetaDev", ")"}], "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.403186067709779*^9, 3.40318606785948*^9}, {
   3.403215088875318*^9, 3.4032150908565807`*^9}, {3.407556644898531*^9, 
   3.407556646619691*^9}, {3.4101782310204906`*^9, 3.41017823112637*^9}, {
   3.4168717384493732`*^9, 3.416871739535102*^9}, 3.416872046887182*^9}],

Cell[BoxData[
 RowBox[{"kt", " ", 
  SuperscriptBox["thetaDev", "2"]}]], "Output",
 CellChangeTimes->{3.619556985904277*^9, 3.702654213713703*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleEnergyFn", " ", "=", " ", 
  RowBox[{"angleEnergyFn", "/.", 
   RowBox[{"{", 
    RowBox[{"thetaDev", "\[Rule]", "fnThetaDev"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.403215209201358*^9, 3.4032152152672787`*^9}}],

Cell[BoxData[
 RowBox[{"kt", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "t0"}], "+", 
     RowBox[{"ArcCos", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x2"}], "+", "x3"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y2"}], "+", "y3"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z1", "-", "z2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z2"}], "+", "z3"}], ")"}]}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x2"}], "+", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y2"}], "+", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z2"}], "+", "z3"}], ")"}], "2"]}]]}]], "]"}]}], 
    ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.6195569859544907`*^9, 3.702654213767082*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "bc"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.406839124224272*^9, 3.406839125529244*^9}, {
  3.4068391856032763`*^9, 3.406839188261937*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3"}], "}"}]], "Output",
 CellChangeTimes->{3.61955698602324*^9, 3.702654213830043*^9}]
}, Open  ]],

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.4017146731336727`*^9, 3.4017146744551163`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(kt);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(t0);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I1);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I2);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I3);\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410178179796535*^9, 
  3.410178203278604*^9}, {3.4101782360285482`*^9, 3.410178236128345*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "angleVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<ANGLE_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"angleSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.7026542139400797`*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.7026542139417963`*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.702654213943021*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.702654213944178*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.702654213945311*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.7026542139464407`*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.702654213947575*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.7026542139487123`*^9}],

Cell[BoxData["\<\"ANGLE_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 3.702654213949847*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(kt);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(t0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(z2,I2,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(x3,I3,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(y3,I3,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(z3,I3,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556986188156*^9, 3.702654214110808*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408587821227968*^9, 3.4085878252235737`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "9", "}"}]}], "]"}], ",", 
    RowBox[{"{", "9", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.40933335742642*^9, 3.40933336900301*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.619556986261386*^9, 3.702654214189488*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DotNormAbNormCb", ",", "dotNormAbNormCb"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"AngleDeviation", ",", "fnThetaDev"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<bool IllegalAngle=false;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if(fabs(DotNormAbNormCb)>(1.0-VERYSMALL)) IllegalAngle=true;\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "angleEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<ANGLE\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408563249888267*^9, 
   3.408563318638526*^9}, {3.4085635055620623`*^9, 3.408563506089058*^9}, {
   3.409106851769322*^9, 3.409106882056981*^9}, {3.409333352642502*^9, 
   3.40933335434091*^9}, {3.4101778333157253`*^9, 3.410177835865591*^9}, {
   3.410177870714059*^9, 3.410177885725202*^9}, {3.410366745442485*^9, 
   3.4103668611031027`*^9}, {3.410387627352058*^9, 3.410387662996006*^9}, {
   3.410388393326111*^9, 3.4103883934847193`*^9}, {3.4103920130578737`*^9, 
   3.410392015575086*^9}, {3.410392087452957*^9, 3.4103920915966787`*^9}, {
   3.410392140741385*^9, 3.41039215558921*^9}, 3.410743057646208*^9, {
   3.411174874722517*^9, 3.411174878860882*^9}, {3.411174974239976*^9, 
   3.4111749916562967`*^9}, {3.41119932577212*^9, 3.4111993265205603`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<ANGLE\>\"", ",", "angleForceHessianRules", ",", "angleOutputs", ",", 
    "angleHessian", ",", "angleEnergyFn", ",", "angleVarNames"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177889712893*^9, 3.410177894565605*^9}}],

Cell[CellGroupData[{

Cell["Collect and simplify", "Subsection",
 CellChangeTimes->{{3.4017146838017387`*^9, 3.40171468680226*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "angleEnergyRules", "]"}]], "Input",
 CellChangeTimes->{3.410177837451532*^9}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{3.619556988925642*^9, 3.702654219118945*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "angleSetupRules", ",", "angleEnergyRules", ",", 
      "angleForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.410177844659294*^9, 3.410177860940928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleOutputs", ",", "AngleDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411175001078189*^9, 3.411175017147767*^9}, {
  3.411199340815207*^9, 3.411199341516654*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.40683925297971*^9, 3.406839254423614*^9}, {
  3.407733474203383*^9, 3.407733475711347*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",",
      "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", "dhx1x1", ",", "dhy1y1",
      ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", 
     "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "ohx1y1", ",", "ohx1z1", 
     ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohx1x3", ",", 
     "ohx1y3", ",", "ohx1z3", ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", 
     ",", "ohy1z2", ",", "ohy1x3", ",", "ohy1y3", ",", "ohy1z3", ",", 
     "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohz1x3", ",", "ohz1y3", 
     ",", "ohz1z3", ",", "ohx2y2", ",", "ohx2z2", ",", "ohx2x3", ",", 
     "ohx2y3", ",", "ohx2z3", ",", "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", 
     ",", "ohy2z3", ",", "ohz2x3", ",", "ohz2y3", ",", "ohz2z3", ",", 
     "ohx3y3", ",", "ohx3z3", ",", "ohy3z3", ",", "AngleDeviation"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.6195569890302134`*^9, 3.70265421927724*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglePack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Angle\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "angleEnergyFn"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", " ", "\[Rule]", " ", "angleHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "angleRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "angleInputs"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "angleOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402880698908718*^9, 3.402880718144539*^9}, {
   3.405596810467842*^9, 3.405596826860199*^9}, {3.4056361468455667`*^9, 
   3.405636199543017*^9}, {3.407679917652017*^9, 3.407679931016655*^9}, 
   3.407763159631695*^9, {3.409333420940812*^9, 3.40933342773901*^9}, {
   3.410177864101145*^9, 3.410177865400531*^9}, {3.411066512729656*^9, 
   3.411066516761778*^9}, {3.41106697034696*^9, 3.411066970912582*^9}, {
   3.411073962997476*^9, 3.411073966619384*^9}, {3.411075733472687*^9, 
   3.411075737805724*^9}, {3.411076079199256*^9, 3.411076112584221*^9}, 
   3.411079373612965*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "anglePack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.4087904395372047`*^9, 3.408790444006906*^9}, 3.411067068587775*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglePack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "anglePack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402959459618227*^9, 3.402959463819249*^9}, {
   3.405593701662167*^9, 3.405593708470829*^9}, {3.405596867763544*^9, 
   3.405596869120884*^9}, {3.407559212533072*^9, 3.407559212922392*^9}, 
   3.4110666677440443`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "anglePack", "]"}]], "Input",
 CellChangeTimes->{{3.402959492934514*^9, 3.402959496895535*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{349., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"Angle\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "6", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
                "dhy2y2", ",", "dhz2z2", ",", "dhx3x3", ",", "dhy3y3", ",", 
                "dhz3z3", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", 
                "ohx1y2", ",", "ohx1z2", ",", 
                RowBox[{"\[LeftSkeleton]", "9", "\[RightSkeleton]"}], ",", 
                "ohy1z3", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", 
                "ohz1x3", ",", "ohz1y3", ",", "ohz1z3", ",", "ohx2y2", ",", 
                "ohx2z2", ",", "ohx2x3", ",", "ohx2y3", ",", "ohx2z3", ",", 
                "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", ",", "ohy2z3", ",", 
                "ohz2x3", ",", "ohz2y3", ",", "ohz2z3", ",", "ohx3y3", ",", 
                "ohx3z3", ",", "ohy3z3", ",", "AngleDeviation"}], "}"}]}]}], 
            "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{62., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 220, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{67., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 220, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{104., {3., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 220, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{92., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[220]]], "Output",
 CellChangeTimes->{3.619557578663659*^9, 3.702654219593328*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Non-bonding terms
\t- Van der Waals and Electrostatic interactions.
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 3.402672664963516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", " ", 
    "evdw", ",", " ", "eeel", ",", "nonbondEquation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
  3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
  3.402741179258795*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 3.402652572153042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonBondInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "dA", ",", "dC", ",", "dQ1Q2"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 3.4111751886209507`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "dA", ",",
    "dC", ",", "dQ1Q2"}], "}"}]], "Output",
 CellChangeTimes->{3.6195575788114634`*^9, 3.7026542197779293`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondDistance", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
  3.411197578518401*^9, 3.411197589788989*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evdwEquation", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["dA", 
     SuperscriptBox["nonbondDistance", "12"]], "-", 
    FractionBox["dC", 
     SuperscriptBox["nonbondDistance", "6"]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 3.416871995722517*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{3.6195575788781567`*^9, 3.702654219876251*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eeelEquation", " ", "=", " ", 
  RowBox[{"(", 
   FractionBox["dQ1Q2", "nonbondDistance"], ")"}]}]], "Input",
 CellChangeTimes->{{3.4026534322622623`*^9, 3.402653496407857*^9}, {
   3.4026535524322023`*^9, 3.402653641591628*^9}, {3.4026779483394947`*^9, 
   3.402677953362184*^9}, {3.4026781314714537`*^9, 3.4026781348802843`*^9}, {
   3.40274101413416*^9, 3.402741050316153*^9}, {3.407556736609376*^9, 
   3.4075567425681257`*^9}, {3.407557208386277*^9, 3.407557225106896*^9}, {
   3.408662115934063*^9, 3.408662119317389*^9}, 3.411081885331176*^9, {
   3.411197627982712*^9, 3.411197630382259*^9}, 3.416871999453731*^9}],

Cell[BoxData[
 FractionBox["dQ1Q2", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]]], "Output",
 CellChangeTimes->{3.619557578944563*^9, 3.70265421993542*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondEquation", " ", "=", " ", 
  RowBox[{"evdwEquation", " ", "+", " ", "eeelEquation"}]}]], "Input",
 CellChangeTimes->{{3.4027412120076227`*^9, 3.402741220906414*^9}, {
  3.4086620876703787`*^9, 3.408662102195766*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]], "+", 
  FractionBox["dQ1Q2", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]]}]], "Output",
 CellChangeTimes->{3.619557579005105*^9, 3.7026542201230917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.61955757905573*^9, 3.702654220197392*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 3.401714933019302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408564450747929*^9, 3.408564451541582*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonbondSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dQ1Q2);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dA);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dC);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
  3.487025950138463*^9, 3.487025960189999*^9}, {3.487026052805409*^9, 
  3.487026058323876*^9}, {3.487032089923287*^9, 3.487032096633906*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "nonbondVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<NONBOND_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"nonbondSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}}],

Cell[BoxData["\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 3.702654220340228*^9}],

Cell[BoxData["\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 3.702654220341023*^9}],

Cell[BoxData["\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 3.702654220341647*^9}],

Cell[BoxData["\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 3.702654220342312*^9}],

Cell[BoxData["\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 3.702654220342929*^9}],

Cell[BoxData["\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 3.7026542203435707`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dA);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dC);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.61955757918412*^9, 3.702654220398633*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonbondEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonbondOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"NonbondDistance", ",", "nonbondDistance"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Evdw", ",", "evdwEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND_EVDW\>\"", ",", "Evdw"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Eeel", ",", "eeelEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND_EEEL\>\"", ",", "Eeel"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", 
      RowBox[{"Evdw", "+", "Eeel"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Evdw"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Eeel"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 3.409334145792842*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557579261977*^9, 3.702654220511101*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 3.410177986821323*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<NONBOND\>\"", ",", "nonbondForceHessianRules", ",", "nonbondOutputs", 
    ",", "nonbondHessian", ",", "nonbondEquation", ",", "nonbondVarNames"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
  3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
  3.410177993430345*^9}}],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 3.4017149467691317`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"nonbondOutputs", ",", "NonbondDistance"}], "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
  3.4111976578180523`*^9, 3.411197662226531*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "Evdw", ",", "Eeel", ",", "fx1", ",", "fy1", ",", "fz1", ",",
    "fx2", ",", "fy2", ",", "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", 
   "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", 
   "ohx1z1", ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", 
   "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", 
   "ohz1z2", ",", "ohx2y2", ",", "ohx2z2", ",", "ohy2z2", ",", 
   "NonbondDistance"}], "}"}]], "Output",
 CellChangeTimes->{3.61955758071804*^9, 3.7026542237637577`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Energy", ",", "Evdw", ",", "Eeel", ",", "fx1", ",", "fy1", ",", "fz1", 
     ",", "fx2", ",", "fy2", ",", "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", 
     "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", 
     ",", "ohx1z1", ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", 
     "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohz1x2", 
     ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", "ohx2z2", ",", 
     "ohy2z2", ",", "NonbondDistance"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.619557580744179*^9, 3.702654223815927*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "nonbondSetupRules", ",", "nonbondEnergyRules", ",", 
      "nonbondForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 3.410178019066489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Nonbond\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "nonbondEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "nonbondHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "nonbondRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "nonBondInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "nonbondOutputs"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "nbPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 3.4110670742215853`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "nbPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 3.411066673303035*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.494844329106917*^9, 3.494844338578497*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "nbPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 3.4055995100170727`*^9}}],

Cell[BoxData[
 RowBox[{"packGraph", "[", 
  RowBox[{"packOptimize", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\<\"Nonbond\"\>"}], ",", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\<\"\"\>"}], ",", 
     RowBox[{"EnergyFunction", "\[Rule]", 
      RowBox[{
       FractionBox["dA", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
       FractionBox["dC", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]], "+", 
       FractionBox["dQ1Q2", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]]}]}], ",", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", 
     RowBox[{"HessianStructure", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "10", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "16", ",", "11", ",", "21", ",", "22", ",", "23", ",", "24"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "17", ",", "21", ",", "12", ",", "25", ",", "26", ",", "27"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "18", ",", "22", ",", "25", ",", "13", ",", "28", ",", "29"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "19", ",", "23", ",", "26", ",", "28", ",", "14", ",", "30"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "20", ",", "24", ",", "27", ",", "29", ",", "30", ",", "15"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"Rules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I1);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I2);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dA);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dC);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>", "]"}],
         ",", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], "\[Rule]", 
         "NonbondDistance"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["dA", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
          FractionBox["dC", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]]}], 
         "\[Rule]", "Evdw"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_EVDW_ENERGY_ACCUMULATE(Evdw);\"\>", "]"}], 
        ",", 
        RowBox[{
         FractionBox["dQ1Q2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]], "\[Rule]", "Eeel"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_EEEL_ENERGY_ACCUMULATE(Eeel);\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"Eeel", "+", "Evdw"}], "\[Rule]", "Energy"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_ENERGY_ACCUMULATE(Energy);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"#ifdef NONBOND_CALC_FORCE //[\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gx1"}], ",", 
        RowBox[{
         RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gy1"}], ",", 
        RowBox[{
         RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gz1"}], ",", 
        RowBox[{
         RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gx2"}], ",", 
        RowBox[{
         RowBox[{"-", "gx2"}], "\[Rule]", "fx2"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I2, 0, fx2 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gy2"}], ",", 
        RowBox[{
         RowBox[{"-", "gy2"}], "\[Rule]", "fy2"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I2, 1, fy2 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gz2"}], ",", 
        RowBox[{
         RowBox[{"-", "gz2"}], "\[Rule]", "fz2"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I2, 2, fz2 );\"\>", "]"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef NONBOND_CALC_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhx1x1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhy1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "+", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "dhz1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhx2x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, dhx2x2);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhy2y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "+", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "dhz2z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, dhz2z2);\
\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef NONBOND_CALC_OFF_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "+", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "ohx1x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "+", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "ohy1y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohz1x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohz1y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "-", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohz1z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx2y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx2z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy2z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* NONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* NONBOND_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* NONBOND_CALC_FORCE ]*/\"\>", "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"Input", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "dA",
         ",", "dC", ",", "dQ1Q2"}], "}"}]}], ",", 
     RowBox[{"Output", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Energy", ",", "Evdw", ",", "Eeel", ",", "fx1", ",", "fy1", ",", "fz1",
         ",", "fx2", ",", "fy2", ",", "fz2", ",", "dhx1x1", ",", "dhy1y1", 
        ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", 
        "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", 
        ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", 
        "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", "ohx2z2", 
        ",", "ohy2z2", ",", "NonbondDistance"}], "}"}]}]}], "}"}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.619557597742949*^9, 3.702654224144334*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Dihedral angle", "Subtitle",
 CellChangeTimes->{
  3.402881806378004*^9, {3.4029555772158318`*^9, 3.4029555790467377`*^9}}],

Cell[CellGroupData[{

Cell["Setup the torsion term", "Subtitle",
 CellChangeTimes->{{3.402833465987742*^9, 3.402833468829653*^9}, 
   3.4028818063788223`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"phi", ",", "CosNPhi", ",", "SinNPhi", ",", "Phi"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.402653084688365*^9, 3.402653100998479*^9}, {
   3.402833442487673*^9, 3.4028334501114883`*^9}, 3.402881806379428*^9, {
   3.40296426730527*^9, 3.402964283016556*^9}, 3.405637646867723*^9, {
   3.40960202074789*^9, 3.409602031402295*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ri", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rj", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rk", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x4", ",", " ", "y4", ",", " ", "z4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl"}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40265249702987*^9, 3.4026525074946632`*^9}, {
   3.402652543668639*^9, 3.4026526354944773`*^9}, 3.402881806379868*^9, {
   3.4029642140397663`*^9, 3.402964261657007*^9}, 3.402968762538885*^9, {
   3.4056376184618797`*^9, 3.4056376382193604`*^9}, {3.408634462799267*^9, 
   3.408634470108696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecLen", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.402881806380116*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"ri", " ", "-", " ", "rj"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", " ", "=", " ", 
   RowBox[{"rj", " ", "-", " ", "rk"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"rl", " ", "-", " ", "rk"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402755487828414*^9, 3.4027555454245787`*^9}, {
   3.4028250971369543`*^9, 3.4028251976062737`*^9}, {3.4028282092482367`*^9, 
   3.402828220149057*^9}, 3.402881806380427*^9, {3.402964299899055*^9, 
   3.402964340775798*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"F", ",", "G"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028282142394447`*^9, 3.402828222806171*^9}, {
   3.402834973364376*^9, 3.402834982337648*^9}, 3.4028818063806667`*^9, 
   3.402955566383662*^9, {3.4029643524819727`*^9, 3.4029643605165043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"H", ",", "G"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.402828225130542*^9, 3.402881806381667*^9, 3.402955564159459*^9, {
   3.402964370060401*^9, 3.402964375836578*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lenA", " ", "=", " ", 
   RowBox[{"vecLen", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenB", " ", "=", " ", 
   RowBox[{"vecLen", "[", "B", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403381748201618*^9, 3.403381765864654*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reciprocalLenA", " ", "=", " ", 
   RowBox[{"reciprocal", "[", "lenA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reciprocalLenB", " ", "=", " ", 
   RowBox[{"reciprocal", "[", "lenB", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403382804807138*^9, 3.403382828904648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x4", ",", "x", ",", "I4", ",", "0", ",", "DPhiDrl"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y4", ",", "y", ",", "I4", ",", "1", ",", "DPhiDrl"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "z", ",", "I4", ",", "2", ",", "DPhiDrl"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}, {
  3.408584461197592*^9, 3.408584542081841*^9}, {3.40858684037824*^9, 
  3.408586889698691*^9}, {3.408625912333675*^9, 3.4086259293924017`*^9}, {
  3.408653564774177*^9, 3.408653597724698*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dihedralSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(sinPhase);\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(cosPhase);\>\"", "]"}]}], "]"}],
   ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(V);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(DN);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(IN);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.410178119207843*^9, 3.410178147107234*^9}, {
  3.410178361408951*^9, 3.4101784213739767`*^9}, {3.410178946297854*^9, 
  3.4101789485592403`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "dihedralVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<DIHEDRAL_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4101781215075903`*^9, 
  3.4101781485693007`*^9}}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.702654224540269*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.702654224541053*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.702654224541664*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.7026542245422707`*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.70265422454288*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.702654224543495*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.70265422454408*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.702654224544661*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.7026542245452423`*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x4,I4,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.7026542245458307`*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y4,I4,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.70265422454639*^9}],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z4,I4,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 3.7026542245469513`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 3.4101781294677153`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(sinPhase);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(cosPhase);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(V);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(DN);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(IN);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I4);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z2,I2,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x3,I3,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y3,I3,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z3,I3,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x4,I4,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y4,I4,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z4,I4,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557598204474*^9, 3.702654224597253*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralCosPhiRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"lenA", "\[Rule]", "LenA"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"lenB", "\[Rule]", "LenB"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"reciprocalLenA", "\[Rule]", "ReciprocalLenA"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"reciprocalLenB", "\[Rule]", "ReciprocalLenB"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.403381795133479*^9, 3.403381809347353*^9}, {
  3.4033829211263123`*^9, 3.403382946948868*^9}, {3.408654812106743*^9, 
  3.408654814048378*^9}, {3.408654920425684*^9, 3.408654921999897*^9}, {
  3.409075691562851*^9, 3.409075693450658*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<if (fabs(LenA)<TENM3) ReciprocalLenA = 0.0;\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<if (fabs(LenB)<TENM3) ReciprocalLenB = 0.0;\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4033818122758904`*^9, 3.403381840232418*^9}, {
  3.4033827438088503`*^9, 3.403382763638501*^9}, {3.4033829548741693`*^9, 
  3.403383007369802*^9}, {3.4055924931110487`*^9, 3.405592500629326*^9}, {
  3.405592532178042*^9, 3.405592534505735*^9}, {3.4086548146190777`*^9, 
  3.408654815130253*^9}, {3.408654922633814*^9, 3.408654923297142*^9}, {
  3.409075693987598*^9, 3.4090756946375628`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recLenArecLenB", " ", "=", " ", 
   RowBox[{"ReciprocalLenA", "*", "ReciprocalLenB"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403388254532496*^9, 3.403388262628626*^9}, {
  3.403388309891501*^9, 3.403388332051207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"recLenArecLenB", "\[Rule]", "RecLenARecLenB"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.403388232755147*^9, 3.403388241973654*^9}, {
   3.403388501153823*^9, 3.403388516222354*^9}, 3.408654816210609*^9, 
   3.408654924312829*^9, 3.409075695424748*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"CCode", "[", "\"\<EraseLinearDihedral = 1.0;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if (RecLenARecLenB==0.0) EraseLinearDihedral = 0.0;\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4033919483618107`*^9, 3.403391962642305*^9}, {
   3.403392705555187*^9, 3.4033927065442123`*^9}, 3.405592505204919*^9, 
   3.405593744922014*^9, {3.405601635740213*^9, 3.405601636005928*^9}, 
   3.408465248370534*^9, {3.408654816731285*^9, 3.408654817290806*^9}, {
   3.408654924945858*^9, 3.408654925617879*^9}, {3.409075696112319*^9, 
   3.409075697100321*^9}, {3.4103580164504538`*^9, 3.410358022595854*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"A", ".", "B"}], "*", 
    RowBox[{"(", "RecLenARecLenB", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"vecLen", "[", "G", "]"}], "*", "RecLenARecLenB", "*", 
    RowBox[{"Dot", "[", 
     RowBox[{"A", ",", "H"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402964460638973*^9, 3.4029644979500027`*^9}, 
   3.403138409061648*^9, 3.403138952358144*^9, {3.403381771339631*^9, 
   3.403381781016387*^9}, {3.403382836161371*^9, 3.40338284912206*^9}, {
   3.403388413788684*^9, 3.4033884282841063`*^9}, {3.405601670420813*^9, 
   3.405601670652701*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"cosPhi", "\[Rule]", "CosPhi"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"sinPhi", "\[Rule]", "SinPhi"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.403383084646188*^9, 3.403383094503001*^9}, {
  3.4056016822760763`*^9, 3.405601688783058*^9}, {3.408654818267323*^9, 
  3.40865481882014*^9}, {3.408654926626211*^9, 3.408654927282428*^9}, {
  3.4090757012621*^9, 3.409075701874107*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CosPhi=MAX(-1.0,MIN(1.0,CosPhi));\>\"", "]"}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.403389122700157*^9, 3.4033891636404963`*^9}, {
   3.405592510669314*^9, 3.405592526290204*^9}, {3.405603211703527*^9, 
   3.4056032309337063`*^9}, 3.408654819467073*^9, 3.408654927979665*^9, 
   3.4090757033740664`*^9}],

Cell["phi = ArcCos[CosPhi];", "Text",
 CellChangeTimes->{{3.40282522628094*^9, 3.402825239560916*^9}, 
   3.402828109424087*^9, 3.4028818064977922`*^9, 3.402955593607312*^9, {
   3.402966167764285*^9, 3.4029662209128017`*^9}, {3.402969136323854*^9, 
   3.4029691467936563`*^9}, 3.403118920705655*^9, {3.403382875874411*^9, 
   3.403382893266426*^9}, {3.403383072284999*^9, 3.403383073172804*^9}}],

Cell["\<\
AppendTo[dihedralEnergyRules, phi -> Phi]; (* I don't think I need to \
evaluate Phi *)\
\>", "Text",
 CellChangeTimes->{{3.402965641072318*^9, 3.402965644799386*^9}, {
   3.402966337775351*^9, 3.402966341759678*^9}, {3.405601725668915*^9, 
   3.4056017329385233`*^9}, 3.408654821084379*^9, 3.4086549288754272`*^9}],

Cell["\<\
At this point we need to calculate SinNPhi and CosNPhi and we use the \
function calculateSinNPhiCosNPhi in both C and Mathematica.Insert function \
sinNPhiCosNPhi[N, &sinNPhi, &cosNPhi, sinPhi, cosPhi] into evaluation\
\>", "Text",
 CellChangeTimes->{{3.403169337342634*^9, 3.4031693991609783`*^9}, {
   3.4031694370531073`*^9, 3.403169446972969*^9}, 3.405602925754593*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralEnergyRules", " ", "=", " ", "dihedralCosPhiRules"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4090757099968023`*^9, 3.409075717160824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "MathCode", "[", "\"\<CosNPhi = mathCosNPhi[IN,SinPhi,CosPhi];\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "MathCode", "[", "\"\<SinNPhi = mathSinNPhi[IN,SinPhi,CosPhi];\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.405602524021294*^9, 3.4056025656526947`*^9}, {
  3.40560260894772*^9, 3.40560261252293*^9}, {3.4056026493129673`*^9, 
  3.4056026535224733`*^9}, {3.405602967032895*^9, 3.405603034772718*^9}, {
  3.405603082328196*^9, 3.405603085028963*^9}, {3.405603291979817*^9, 
  3.405603295480481*^9}, {3.405636297453783*^9, 3.4056363006503143`*^9}, {
  3.405689828587071*^9, 3.405689830571216*^9}, {3.405690580000684*^9, 
  3.405690585973423*^9}, {3.408654825235148*^9, 3.4086548259385366`*^9}, {
  3.4086549296133757`*^9, 3.408654930210107*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralEnergyRules", ",", 
       RowBox[{
       "MathCode", "[", 
        "\"\<If[CosPhi>0.1,Phi=ArcSin[SinPhi],\n\t\t\t\t\t\
Phi=ArcCos[CosPhi]*Sign[SinPhi]];\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralEnergyRules", ",", 
       RowBox[{
       "CCode", "[", 
        "\"\<if(CosPhi>0.1){Phi=asin(SinPhi);}else\n\t\t\t\t\t\
{Phi=acos(CosPhi)*SIGN(SinPhi);}\>\"", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.407764211219077*^9, 3.407764213360669*^9}, {
  3.409076769869112*^9, 3.409076770848304*^9}, {3.4090773287521353`*^9, 
  3.4090773292641153`*^9}, {3.4090773794499187`*^9, 3.409077380038114*^9}, {
  3.409361613956606*^9, 3.409361646817099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<sinNPhiCosNPhi(IN, &SinNPhi, &CosNPhi, SinPhi, CosPhi);\>\"", 
     "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4031695628011417`*^9, 3.403169583242929*^9}, {
   3.403170106527663*^9, 3.403170113631514*^9}, 3.403171032582622*^9, {
   3.403174922877117*^9, 3.403174926106832*^9}, {3.405592540417914*^9, 
   3.405592544481194*^9}, 3.4086548276018343`*^9, 3.408654930937489*^9}],

Cell["\<\
Sum and difference formulas
sin (A + B) = sin A cos B + cos A sin B
sin (A - B) = sin A cos B - cos A sin B
cos (A + B) = cos A cos B - sin A sin B
cos (A - B) = cos A cos B + sin A sin B\
\>", "Text",
 CellChangeTimes->{{3.4029651450204144`*^9, 3.402965152857622*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosNPhiPhase", " ", "=", 
   RowBox[{
    RowBox[{"CosNPhi", "*", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", "*", "sinPhase"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinNPhiPhase", "=", 
   RowBox[{
    RowBox[{"SinNPhi", "*", "cosPhase"}], "-", 
    RowBox[{"CosNPhi", "*", "sinPhase"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403139078293602*^9, 3.4031391381942577`*^9}, {
  3.403139212082849*^9, 3.4031392263073587`*^9}, {3.403169453484665*^9, 
  3.403169458640418*^9}, {3.403172460862658*^9, 3.40317246375632*^9}, {
  3.403392657908375*^9, 3.4033926638482733`*^9}, {3.405602017427895*^9, 
  3.405602050542378*^9}, {3.407679968844823*^9, 3.407680033912936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dihedralDeviation", " ", "=", " ", 
    RowBox[{"1.0", "+", "cosNPhiPhase"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"between", " ", "0.0", " ", "and", " ", "2.0"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.411197914354374*^9, 3.4111979407786827`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fnETorsion", " ", "=", " ", 
  RowBox[{"EraseLinearDihedral", " ", "*", " ", "V", " ", 
   RowBox[{"(", "dihedralDeviation", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.405602085801338*^9, 3.405602087655345*^9}, 
   3.4096015455999117`*^9, {3.411197947482793*^9, 3.411197949874654*^9}}],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", 
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "+", 
    RowBox[{"CosNPhi", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", " ", "sinPhase"}]}], ")"}], " ", "V"}]], "Output",
 CellChangeTimes->{3.619557598678335*^9, 3.702654225343552*^9}]
}, Open  ]],

Cell["\<\
fnETorsion = EraseLinearDihedral * V (1.0 + Cos[DN Phi - phase]);\
\>", "Text",
 CellChangeTimes->{{3.402664776710464*^9, 3.4026647964202747`*^9}, {
   3.402741579461403*^9, 3.402741589532634*^9}, {3.4027540176742983`*^9, 
   3.402754019034227*^9}, 3.402754202717703*^9, {3.4028278800721903`*^9, 
   3.402827880421856*^9}, {3.402833328460658*^9, 3.402833328801766*^9}, 
   3.402833524934355*^9, {3.402833585431164*^9, 3.4028335857684526`*^9}, 
   3.402881806518937*^9, 3.4029662365236692`*^9, 3.402966333014995*^9, {
   3.403170907390308*^9, 3.403170917454175*^9}, {3.403391977060162*^9, 
   3.403391981586698*^9}, {3.403392611162285*^9, 3.4033926122962713`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DihedralDeviation", ",", "dihedralDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"fnETorsion", "\[Rule]", "Energy"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<DIHEDRAL\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dihedralOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.402966429264083*^9, 3.402966441189411*^9}, {
  3.403180571417967*^9, 3.403180572463499*^9}, {3.408588700097761*^9, 
  3.408588806889308*^9}, {3.408654830951703*^9, 3.408654831761635*^9}, {
  3.4086549320244093`*^9, 3.4086549327532454`*^9}, {3.409106916232429*^9, 
  3.409106923925405*^9}, {3.409108094891713*^9, 3.409108096587041*^9}, {
  3.411197956372534*^9, 3.4111979918487797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl", ",", 
     RowBox[{"{", 
      RowBox[{
      "V", ",", "DN", ",", "IN", ",", "cosPhase", ",", " ", "sinPhase"}], 
      "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598381722083*^9, 3.4055984189648457`*^9}, {
  3.405603057636241*^9, 3.4056030583078613`*^9}, {3.405690789130921*^9, 
  3.40569079264091*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4", ",", "V", ",", "DN", 
   ",", "IN", ",", "cosPhase", ",", "sinPhase"}], "}"}]], "Output",
 CellChangeTimes->{3.61955759878785*^9, 3.702654225477248*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralEnergyFn", " ", "=", " ", 
  RowBox[{"fnETorsion", "/.", 
   RowBox[{"{", 
    RowBox[{"Phi", "\[Rule]", "phi"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.403216193482387*^9, 3.403216216011763*^9}, {
  3.4032164096112223`*^9, 3.403216415920596*^9}}],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", 
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "+", 
    RowBox[{"CosNPhi", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", " ", "sinPhase"}]}], ")"}], " ", "V"}]], "Output",
 CellChangeTimes->{3.619557598876274*^9, 3.7026542255531063`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dETorsiondPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "EraseLinearDihedral"}], "*", "V", "*", "DN", "*", 
    "sinNPhiPhase"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, 3.416871814458685*^9, 3.416872019347313*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralGradientRules", " ", "=", " ", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.408654769261054*^9, 3.408654775197638*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.6195575989908123`*^9, 3.702654225742764*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralGradientRules", ",", " ", 
    RowBox[{"Assign", "[", 
     RowBox[{"DeDPhi", ",", " ", "dETorsiondPhi"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.403119298187716*^9, 3.403119313404195*^9}, {
   3.403119766211968*^9, 3.4031197683762083`*^9}, 3.408583034341649*^9, {
   3.408583127586095*^9, 3.4085831347382*^9}, {3.408654883213402*^9, 
   3.408654886361278*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDri", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"A", ".", "A"}]]}], "A"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408582505876679*^9, 3.4085825260019217`*^9}, {
   3.408582666908884*^9, 3.4085826685540457`*^9}, {3.408582953793984*^9, 
   3.40858295864988*^9}, {3.408583027864543*^9, 3.408583040966227*^9}, 
   3.408583191274479*^9, {3.40858326860931*^9, 3.4085832687611732`*^9}, {
   3.408626032409171*^9, 3.408626033373294*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrj", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"A", ".", "A"}]], "A"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"F", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"A", ".", "A"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "A"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"H", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"B", ".", "B"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "B"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4085825280925817`*^9, 3.4085825309826937`*^9}, 
   3.408582577839138*^9, {3.4085826709324503`*^9, 3.408582715459239*^9}, {
   3.408582926123191*^9, 3.408582929442951*^9}, {3.408583042966744*^9, 
   3.4085830443033247`*^9}, {3.408583194635971*^9, 3.408583194955699*^9}, {
   3.408583270147748*^9, 3.408583270323516*^9}, {3.408626035616419*^9, 
   3.408626042918641*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrk", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"H", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"B", ".", "B"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "B"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"F", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"A", ".", "A"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "A"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"B", ".", "B"}]], "B"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085828262895317`*^9, 3.408582843568289*^9}, {
  3.4085828906122704`*^9, 3.408582896089611*^9}, {3.4085829396988707`*^9, 
  3.4085829428671217`*^9}, {3.408583046239622*^9, 3.4085830475434027`*^9}, {
  3.408583197915868*^9, 3.408583198955614*^9}, {3.4085832717315197`*^9, 
  3.408583271883222*^9}, {3.408626045600368*^9, 3.4086260528864803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrl", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"vecLen", "[", "G", "]"}], 
      RowBox[{"B", ".", "B"}]], "B"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408582881233783*^9, 3.4085828856608562`*^9}, {
  3.408582948194116*^9, 3.4085829506817493`*^9}, {3.408583050590252*^9, 
  3.408583051838098*^9}, {3.40858320066665*^9, 3.408583201666376*^9}, {
  3.408583273650627*^9, 3.408583273778283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhidr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408626318970158*^9, 3.408626321691942*^9}, {
  3.408653535566351*^9, 3.408653537581769*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendOneDihedralGradientForce", "[", 
    RowBox[{
    "rawMacroPrefix_", ",", "be_", ",", "dPhidr_", ",", "outputs_", ",", 
     "rawNameInfo_", ",", "rawdEdPhi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fn", ",", "gradName", ",", "zforceName", ",", "nameRules", ",", "\n", 
       "\t", 
       RowBox[{"dEdPhi", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawdEdPhi", "]"}]}], ",", "\n", "\t", 
       RowBox[{"nameInfo", "=", 
        RowBox[{"Evaluate", "[", "rawNameInfo", "]"}]}], ",", "\n", "\t", 
       RowBox[{"macroPrefix", "=", 
        RowBox[{"Evaluate", "[", "rawMacroPrefix", "]"}]}], ",", "var"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"nameRules", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", "nameInfo", "]"}]}], ";", "\n", "\t", 
      RowBox[{"var", " ", "=", " ", 
       RowBox[{"Name", "/.", "nameRules"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"gradName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<g\>\"", "<>", 
         RowBox[{"ToString", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"zforceName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<f\>\"", "<>", 
         RowBox[{"ToString", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"fn", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Func", "/.", "nameRules"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Offset", "/.", "nameRules"}], ")"}], "+", "1"}], "]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"dPhidr", ",", "fn"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"Assign", "[", 
         RowBox[{"gradName", ",", 
          RowBox[{"fn", "*", "dEdPhi"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"Assign", "[", 
         RowBox[{"zforceName", ",", 
          RowBox[{"-", "gradName"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"ForceAccumulate", "[", 
         RowBox[{"macroPrefix", ",", "nameRules", ",", "zforceName"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"outputs", ",", "zforceName"}], "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendOneDihedralGradientForce", ",", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408583442273871*^9, 3.40858347975031*^9}, {
   3.408583509820074*^9, 3.408583633252095*^9}, {3.408583848031049*^9, 
   3.408583860112351*^9}, {3.4085840615783367`*^9, 3.408584074466069*^9}, {
   3.408585289468058*^9, 3.408585296407564*^9}, {3.408586346355459*^9, 
   3.408586397442857*^9}, {3.408586551965033*^9, 3.40858656097042*^9}, {
   3.408586661640358*^9, 3.4085866701015673`*^9}, {3.408586723624707*^9, 
   3.408586762807335*^9}, {3.408586957277357*^9, 3.408586960316139*^9}, {
   3.408587490456483*^9, 3.408587497630123*^9}, {3.4085885065212183`*^9, 
   3.408588518784276*^9}, {3.408626242208082*^9, 3.40862626034951*^9}, {
   3.4086268358875427`*^9, 3.40862683796587*^9}, {3.408628276023779*^9, 
   3.408628277246122*^9}, {3.408628754748343*^9, 3.4086287554412327`*^9}, {
   3.408629317810897*^9, 3.40862932003971*^9}, {3.408629434381608*^9, 
   3.408629465997069*^9}, {3.4086297839355583`*^9, 3.408629799055213*^9}, {
   3.4086298969824553`*^9, 3.408629947960977*^9}, {3.408629990536791*^9, 
   3.4086300132964287`*^9}, 3.4086301209959106`*^9, {3.408630182148696*^9, 
   3.408630186363256*^9}, {3.408630225944582*^9, 3.408630291379216*^9}, {
   3.408630611862846*^9, 3.408630612733583*^9}, {3.408630750709251*^9, 
   3.408630764213498*^9}, {3.408630802985215*^9, 3.408630809271747*^9}, {
   3.408632107394019*^9, 3.40863211369786*^9}, {3.4086537003532047`*^9, 
   3.408653755712685*^9}, {3.408653792483273*^9, 3.408653811300997*^9}, {
   3.4086540934716377`*^9, 3.408654094356517*^9}, {3.408654124753436*^9, 
   3.4086541807725286`*^9}, {3.40865545878123*^9, 3.408655487290687*^9}, {
   3.411067845895697*^9, 3.411067854808709*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralGradientForce", "[", 
    RowBox[{
    "rawMacroPrefix_", ",", "be_", ",", "dPhidr_", ",", "outputs_", ",", 
     "rawNames_", ",", "rawdEdPhi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"macroPrefix", "=", 
        RowBox[{"Evaluate", "[", "rawMacroPrefix", "]"}]}], ",", "\n", "\t", 
       RowBox[{"dEdPhi", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawdEdPhi", "]"}]}], ",", "\n", "\t", 
       RowBox[{"names", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawNames", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "names", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Appending gradient force for name: \>\"", ",", " ", 
           RowBox[{
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"AppendOneDihedralGradientForce", "[", 
          RowBox[{
          "macroPrefix", ",", "be", ",", "dPhidr", ",", "outputs", ",", 
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "dEdPhi"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralGradientForce", ",", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvcOdzS869aWjjoR5IIj292mKANFi/owxIHpiIm9o
DJCuYhCMANEd0i05IDpAsyQfRNfw5ZeB6M25JRUg+kDnmloQ/fRiRj2IzpZ+
fwdE65RPvguid/htuRkLpFue378Fol1udT8C0UkxSo9BtNVZV+cCIN24JN4d
REtd0XAvBNLrlvuA6Xu+XiUg+oW9UTmI3s17ohpEz9R+DqajVvA8BdFGa1ne
guhtt1/8BdGtv2f/A9HOn79wFAFpVo5YARC9LyJGBkS/+2ulAKKVN/zXANFT
Olg1QXSLz6GltSD/pymsB9Gpj3Y8ANHzbwg8AdEAikqcuQ==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendDihedralGradientForce", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralGradientRules", ",", "dPhidr", ",", 
    "dihedralOutputs", ",", "dihedralVarNames", ",", "DeDPhi"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408583158451829*^9, 3.408583204297793*^9}, {
   3.408583250507711*^9, 3.4085832774018927`*^9}, {3.4085860684090223`*^9, 
   3.408586084549323*^9}, {3.4085861890242767`*^9, 3.408586192646565*^9}, 
   3.408625788717267*^9, {3.408626324346002*^9, 3.4086263256575327`*^9}, {
   3.408626862127885*^9, 3.408626863302903*^9}, {3.408653540706973*^9, 
   3.408653549608212*^9}, {3.4086547771718388`*^9, 3.408654780018731*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.70265422604834*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.702654226049123*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.7026542260497093`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.702654226050302*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.70265422605087*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.702654226051458*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.7026542260520563`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.702654226052658*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.7026542260532722`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.702654226053913*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.702654226054577*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 3.7026542260551977`*^9}]
}, Open  ]],

Cell["\<\
Now dPhidr contains the vector derivative of Phi wrt every component in (r)\
\>", "Subsubsection",
 CellChangeTimes->{{3.408653888574654*^9, 3.408653908030429*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "dPhidr", "]"}]], "Input",
 CellChangeTimes->{{3.40865419380256*^9, 3.408654215591751*^9}}],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{3.6195575994161453`*^9, 3.7026542261232853`*^9}]
}, Open  ]],

Cell["Calculate the Second derivatives of d2Edr2", "Section",
 CellChangeTimes->{{3.408638468118968*^9, 3.408638485233533*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OuterVector", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "a", ",", "b"}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.4086496700448513`*^9, 3.408649688184026*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OverlayMatrix", "[", 
    RowBox[{"phiMatrix_", ",", "xo_", ",", "yo_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xa", ",", "ya"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", 
        RowBox[{"x", "\[LessEqual]", "3"}], ",", 
        RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"y", "=", "1"}], ",", 
           RowBox[{"y", "\[LessEqual]", "3"}], ",", 
           RowBox[{"y", "++"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"xa", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xo", "-", "1"}], ")"}], "*", "3"}], "+", "x"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"ya", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"yo", "-", "1"}], ")"}], "*", "3"}], "+", "y"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Filling matrix[\>\"", ",", "xa", ",", "\"\<,\>\"", ",", 
              "ya", ",", "\"\<] := mat[\>\"", ",", "x", ",", "\"\<,\>\"", ",",
               "y", ",", "\"\<];\>\""}], "]"}], ";", "\[IndentingNewLine]", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"phiMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"xa", ",", "ya"}], "]"}], "]"}], "=", " ", 
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "x", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xa", "\[NotEqual]", "ya"}], ",", 
              RowBox[{
               RowBox[{"phiMatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"ya", ",", "xa"}], "]"}], "]"}], "=", " ", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], "[", 
                RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"OverlayMatrix", ",", "HoldFirst"}], "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.4085956931446743`*^9, 3.408595765358075*^9}, {
   3.408595994831271*^9, 3.408596075787022*^9}, {3.408596527240266*^9, 
   3.4085965346782017`*^9}, {3.408596636857461*^9, 3.4085966739671087`*^9}, {
   3.4085967280507107`*^9, 3.408596734282061*^9}, {3.408597028304843*^9, 
   3.408597028648077*^9}, {3.408600049585248*^9, 3.408600050238905*^9}, {
   3.4086001540863256`*^9, 3.40860015575526*^9}, {3.408650868168599*^9, 
   3.408650874342412*^9}, {3.409176994256433*^9, 3.409176998128837*^9}, {
   3.40917705911803*^9, 3.4091770600650053`*^9}, 3.409177469431367*^9, {
   3.409194918943551*^9, 3.409195004699732*^9}, {3.409196900262257*^9, 
   3.4091969757737427`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OverlaySymmetricMatrix", "[", 
    RowBox[{"phiMatrix_", ",", "xo_", ",", "yo_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"OverlayMatrix", "[", 
       RowBox[{"phiMatrix", ",", "xo", ",", "yo", ",", "mat"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"OverlaySymmetricMatrix", ",", "HoldFirst"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408597009173896*^9, 3.408597090552865*^9}, {
  3.408600053806898*^9, 3.408600054390049*^9}, {3.408650877237729*^9, 
  3.4086508834211607`*^9}, {3.4091969226416397`*^9, 3.409196923185772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"According", " ", "to", " ", "the", " ", "paper"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "what", " ", "the", " ", "Outer", " ", "product", 
     " ", "of", " ", "two", " ", "matrices", " ", "should", " ", "be"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixOuter", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "a", "]"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "b", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "a", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "a", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", 
               RowBox[{"b", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.408646334685039*^9, 3.408646348937072*^9}, {
  3.408646393499062*^9, 3.408646441191723*^9}, {3.4086464941951*^9, 
  3.408646501455883*^9}, {3.408646567290539*^9, 3.408646603288045*^9}, {
  3.408646734480702*^9, 3.408646748040139*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhi2dFGHdFGH", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "9", "}"}]}], "]"}], ",", 
     RowBox[{"{", "9", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408650916620843*^9, 3.4086509484346237`*^9}, 
   3.408651027715415*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dPhi2dFGHdFGH", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40865095085678*^9, 3.408650959889976*^9}, 
   3.408651029835174*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557600321226*^9, 3.702654226383007*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "32"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dFdF", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OuterVector", "[", 
         RowBox[{"A", ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "A"}], "]"}]}], "]"}], "+", 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "A"}], "]"}], ",", "A"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "1", ",", "dPhi2dFdF"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408649591846072*^9, 3.408649725124913*^9}, 
   3.40864990872332*^9, {3.408650410732383*^9, 3.408650413905846*^9}, {
   3.409174396822336*^9, 3.409174400831032*^9}, {3.409174874841948*^9, 
   3.409174875243573*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 1, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226454729*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 2, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226455908*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 3, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226456629*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 1, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.7026542264573193`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 2, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226458003*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 3, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226458652*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 1, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226459292*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 2, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226459917*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 3, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 3.702654226460539*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.40936184075718*^9, 3.409361845493381*^9}, {
  3.409362483405528*^9, 3.4093624844665956`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"DebugDihedral", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{3.619557600510736*^9, 3.702654226531352*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "33"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dHdH", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"-", 
        RowBox[{"vecLen", "[", "G", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B", ".", "B"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"B", ".", "B"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OuterVector", "[", 
         RowBox[{"B", ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "B"}], "]"}]}], "]"}], "+", 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "B"}], "]"}], ",", "B"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "3", ",", "3", ",", "dPhi2dHdH"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408649892341941*^9, 3.408649947886446*^9}, {
  3.408650378644896*^9, 3.40865040833183*^9}, {3.409174866931617*^9, 
  3.409174867233015*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 7, ",", 7, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.7026542265967417`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 7, ",", 8, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.702654226597788*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 7, ",", 9, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.702654226598504*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 8, ",", 7, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.7026542265991783`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 8, ",", 8, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.7026542265998487`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 8, ",", 9, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.70265422660052*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 9, ",", 7, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.702654226601194*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 9, ",", 8, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.702654226601866*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 9, ",", 9, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 3.70265422660251*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Equation", " ", "38"}], ",", " ", 
    RowBox[{
    "this", " ", "one", " ", "has", " ", "the", " ", "weird", " ", 
     "subscripts", " ", "but", " ", 
     RowBox[{"I", "'"}], "m", " ", "just", " ", "going", " ", "to", " ", 
     "assume", " ", "its", " ", "simple"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dFdG", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{"vecLen", "[", "G", "]"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"G", ".", "G"}], ")"}], 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"A", ",", "F"}], "]"}], 
           RowBox[{"(*", "F", "*)"}], ",", "A"}], 
          RowBox[{"(*", "G", "*)"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"F", ".", "G"}], ")"}], 
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", 
           RowBox[{"(*", "F", "*)"}], ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"A", ",", "G"}], "]"}]}], 
          RowBox[{"(*", "G", "*)"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "2", ",", "dPhi2dFdG"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408650421678527*^9, 3.408650598200132*^9}, {
  3.409174836771996*^9, 3.409174837132331*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 4, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226676071*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 5, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226677128*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 6, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226677897*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 4, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226678588*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 5, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226679216*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 6, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226679832*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 4, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226680496*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 5, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226681101*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 6, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 3.702654226681731*^9}]
}, Open  ]],

Cell["\<\
Equation (39), this one needs to be transposed wrt the equation described in \
the paper.\
\>", "Subsubsection",
 CellChangeTimes->{{3.409498511759589*^9, 3.40949854269335*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhi2dGdH", " ", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"(", 
        RowBox[{"B", ".", "B"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"B", ".", "B"}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", ".", "G"}], ")"}], 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"B", ",", "H"}], "]"}], 
          RowBox[{"(*", "H", "*)"}], ",", "B"}], 
         RowBox[{"(*", "G", "*)"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"H", ".", "G"}], ")"}], 
        RowBox[{"OuterVector", "[", 
         RowBox[{"B", 
          RowBox[{"(*", "H", "*)"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"B", ",", "G"}], "]"}]}], 
         RowBox[{"(*", "G", "*)"}], "]"}]}]}], ")"}]}], "]"}]}], ";", 
  RowBox[{"OverlaySymmetricMatrix", "[", 
   RowBox[{"dPhi2dFGHdFGH", ",", "2", ",", "3", ",", "dPhi2dGdH"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.40865064540567*^9, 3.408650762067699*^9}, 
   3.4091748525583963`*^9, 3.4093531703199453`*^9, 3.409353656265156*^9, 
   3.409355906322811*^9, {3.409356672901971*^9, 3.409356682609378*^9}, 
   3.409357158267292*^9, {3.409357736245742*^9, 3.409357739845209*^9}, {
   3.4094984946855507`*^9, 3.409498508997938*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 7, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.702654226890703*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 8, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.7026542268915577`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 9, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.7026542268922367`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 7, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.702654226892911*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 8, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.7026542268935966`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 9, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.702654226894206*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 7, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.702654226894788*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 8, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.702654226895363*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 9, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 3.702654226895937*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "40"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dPhi2dFdH", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.408650327222185*^9, 3.408650362439267*^9}, {
  3.409174826448645*^9, 3.409174826884821*^9}, {3.4093412251438437`*^9, 
  3.409341230236353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OverlaySymmetricMatrix", "[", 
  RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "3", ",", "dPhi2dFdH"}], 
  "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 7, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.7026542270085573`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 8, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.702654227009417*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 9, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.702654227010103*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 7, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.7026542270107822`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 8, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.702654227011462*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 9, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.70265422701215*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 7, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.702654227012849*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 8, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.7026542270135107`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 9, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 3.702654227014174*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "44"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dPhi2dGdG", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"vecLen", "[", "G", "]"}], "3"], ")"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "A"}], "]"}], ",", "A"}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "A"}], "]"}]}], "]"}]}], ")"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"F", ".", "G"}], ")"}], 
        RowBox[{
         RowBox[{"vecLen", "[", "G", "]"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"F", ",", "A"}], "]"}]}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"F", ",", "A"}], "]"}], ",", "A"}], "]"}]}], ")"}]}], 
      ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"2", 
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"vecLen", "[", "G", "]"}], "3"], ")"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "B"}], "]"}], ",", "B"}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "B"}], "]"}]}], "]"}]}], ")"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"H", ".", "G"}], ")"}]}], 
        RowBox[{
         RowBox[{"vecLen", "[", "G", "]"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"H", ",", "B"}], "]"}]}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"H", ",", "B"}], "]"}], ",", "B"}], "]"}]}], ")"}]}], 
      ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4086499523593807`*^9, 3.408650321250239*^9}, {
  3.408650365353183*^9, 3.408650375568879*^9}, {3.4091748106831207`*^9, 
  3.4091748168818808`*^9}, {3.409175136588516*^9, 3.4091752082194633`*^9}, {
  3.409175244309362*^9, 3.409175247198543*^9}, {3.409175357119368*^9, 
  3.40917538223105*^9}, {3.40917613547653*^9, 3.4091761385193377`*^9}, {
  3.409177065118088*^9, 3.4091770663792353`*^9}, {3.409177454434731*^9, 
  3.409177458268008*^9}, {3.409341216600507*^9, 3.40934122099883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OverlaySymmetricMatrix", "[", 
   RowBox[{"dPhi2dFGHdFGH", ",", "2", ",", "2", ",", "dPhi2dGdG"}], "]"}], 
  ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 4, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227141191*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 5, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227142106*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 6, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.7026542271428223`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 4, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.7026542271435328`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 5, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227144236*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 6, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227144926*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 4, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227145611*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 5, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227146288*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 6, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 3.702654227146948*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dPhi2dFGHdFGH", "]"}]], "Input",
 CellChangeTimes->{{3.408651792060197*^9, 3.4086517978656282`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9"}], "}"}]], "Output",
 CellChangeTimes->{3.6195576011769657`*^9, 3.7026542271982307`*^9}]
}, Open  ]],

Cell["\<\
At this point (dPhi2dFGHdFGH) should represent the first term in equation 29 \
\>", "Subsubsection",
 CellChangeTimes->{{3.408651738274075*^9, 3.408651769106864*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dFGHdr", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"F", ",", "G", ",", "H"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl"}], "}"}], "]"}], 
       "}"}]}], "]"}]}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.408591384187497*^9, 3.4085914854368362`*^9}, {
   3.408591781261639*^9, 3.408591823963297*^9}, 3.408597322574074*^9, {
   3.4086384990450077`*^9, 3.4086385101740522`*^9}, {3.409362248899851*^9, 
   3.409362263073306*^9}, 3.409362549838602*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557601287183*^9, 3.7026542272829247`*^9}]
}, Open  ]],

Cell["Let' s try a scalar product between dPhi2dFGHdFGH and dFGHdr", \
"Subsubsection",
 CellChangeTimes->{{3.408651818318852*^9, 3.408651834507773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralProd1", " ", "=", " ", 
   RowBox[{"dPhi2dFGHdFGH", ".", "dFGHdr"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408651845045583*^9, 3.4086518659143333`*^9}, {
  3.409339111432386*^9, 3.409339112905542*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dihedralProd1", "]"}]], "Input",
 CellChangeTimes->{{3.408651870376741*^9, 3.408651872801318*^9}, {
  3.409339115543014*^9, 3.409339117067672*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557601408881*^9, 3.702654227422731*^9}]
}, Open  ]],

Cell["Now try a matrix outer product between (prod1) and dFGHdr.", \
"Subsubsection",
 CellChangeTimes->{{3.408651883486541*^9, 3.408651897034092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Phidr2", " ", "=", " ", 
   RowBox[{"MatrixOuter", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "dihedralProd1", "]"}], ",", 
     RowBox[{"Transpose", "[", "dFGHdr", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408651904044354*^9, 3.408651936666416*^9}, {
  3.408652075768901*^9, 3.408652083457493*^9}, {3.409339121243396*^9, 
  3.409339123792976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2Phidr2", "]"}]], "Input",
 CellChangeTimes->{{3.408652112695722*^9, 3.408652116232728*^9}, {
  3.4091963372082033`*^9, 3.409196338965362*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557601492033*^9, 3.702654227509246*^9}]
}, Open  ]],

Cell["d2Phidr2 Should contain the product of equation 29", "Subsubsection",
 CellChangeTimes->{{3.4086520902119923`*^9, 3.4086521017608767`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "dFGHdr", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.408648903929661*^9, 3.4086489127940187`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557601576988*^9, 3.702654227582397*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dETorsiondPhi", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "EraseLinearDihedral"}], "*", "dihedralScale", "*", "V", 
     "*", "DN", "*", "sinNPhiPhase"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, {3.408653407072007*^9, 3.408653409365189*^9}}],

Cell["\<\
Assemble equation 28, the final equation for the second derivative, it should \
be a 12x12 matrix\
\>", "Section",
 CellChangeTimes->{{3.408654462449683*^9, 3.408654491289156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2EdPhi2", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "V"}], "*", "DN", "*", "DN", "*", "cosNPhiPhase"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408653336194317*^9, 3.408653358981037*^9}, {
  3.408653422437386*^9, 3.408653431132839*^9}, {3.408654249922738*^9, 
  3.4086542980744057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Edr2", " ", "=", " ", 
   RowBox[{
    RowBox[{"OuterVector", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2EdPhi2", "*", "dPhidr"}], ")"}], ",", "dPhidr"}], "]"}], 
    "+", 
    RowBox[{"DeDPhi", "*", "d2Phidr2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408653271521331*^9, 3.4086532779472837`*^9}, {
  3.4086534333111267`*^9, 3.408653436052641*^9}, {3.4086543078086443`*^9, 
  3.4086543833682623`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.408654332976136*^9, 3.408654336760715*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557601720749*^9, 3.702654227909264*^9}]
}, Open  ]],

Cell["Assemble the names of the second derivatives ", "Subsubsection",
 CellChangeTimes->{{3.4086545923916807`*^9, 3.408654601424361*^9}}],

Cell["\<\
dihedralVarNames = { 
   {x1, x, I1, 0, DPhiDri},
   {y1, y, I1, 1, DPhiDri},
   {z1, z, I1, 2, DPhiDri},
   {x2, x, I2, 0, DPhiDrj},
   {y2, y, I2, 1, DPhiDrj},
   {z2, z, I2, 2, DPhiDrj},
   {x3, x, I3, 0, DPhiDrk},
   {y3, y, I3, 1, DPhiDrk},
   {z3, z, I3, 2, DPhiDrk},
   {x4, x, I4, 0, DPhiDrl},
   {y4, y, I4, 1, DPhiDrl},
   {z4, z, I4, 2, DPhiDrl}
   };\
\>", "Text",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}, {
  3.408584461197592*^9, 3.408584542081841*^9}, {3.40858684037824*^9, 
  3.408586889698691*^9}, {3.408625912333675*^9, 3.4086259293924017`*^9}, {
  3.408653564774177*^9, 3.408653597724698*^9}}],

Cell["Setup the Diagonal Hessian rules", "Subsubsection",
 CellChangeTimes->{{3.408655141263528*^9, 3.4086551474565687`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralOneHessianElement", "[", 
    RowBox[{
    "macroPrefix_", ",", " ", "be_", ",", " ", "outputs_", ",", 
     "hessianStructure_", ",", " ", "rawHessianFn_", ",", " ", "names_", ",", 
     " ", "i_", ",", " ", "j_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "   \t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "name1Info", ",", " ", "name2Info", ",", " ", "var1Name", ",", " ", 
       "var2Name", ",", "hessianName", ",", "prefix", ",", " ", "hess"}], 
      "}"}], ",", "\n", "   \t", 
     RowBox[{
      RowBox[{"name1Info", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", 
        RowBox[{"names", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"name2Info", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", 
        RowBox[{"names", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"var1Name", " ", "=", " ", 
       RowBox[{"Name", " ", "/.", " ", "name1Info"}]}], ";", "\n", "   \t", 
      RowBox[{"var2Name", " ", "=", " ", 
       RowBox[{"Name", " ", "/.", " ", "name2Info"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j"}], ",", 
        RowBox[{"prefix", "=", "\"\<d\>\""}], ",", 
        RowBox[{"prefix", "=", "\"\<o\>\""}]}], "]"}], ";", "\n", "   \t", 
      RowBox[{"hessianName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"prefix", "<>", "\"\<h\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "var1Name", "]"}], " ", "<>", " ", 
         RowBox[{"ToString", "[", "var2Name", "]"}]}], "]"}]}], ";", "\n", 
      "   \t", 
      RowBox[{"hess", " ", "=", " ", 
       RowBox[{
        RowBox[{"Evaluate", "[", "rawHessianFn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", " ", 
        RowBox[{"Assign", "[", 
         RowBox[{"hessianName", ",", " ", "hess"}], "]"}]}], "]"}], ";", "\n",
       "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"outputs", ",", " ", "hessianName"}], "]"}], ";", "\n", 
      "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", " ", 
        RowBox[{"HessianAccumulate", "[", 
         RowBox[{
         "macroPrefix", ",", " ", "name1Info", ",", " ", "name2Info", ",", 
          " ", "hessianName"}], "]"}]}], "]"}], ";", "\n", "   \t", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Appended hessian element (\>\"", ",", " ", "j", ",", " ", 
        "\"\<,\>\"", ",", " ", "i", ",", " ", "\"\<) for variable: \>\"", ",",
         " ", 
        RowBox[{"ToString", "[", "hessianName", "]"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{
       RowBox[{"hessianStructure", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"Length", "[", "outputs", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"i", "\[NotEqual]", "j"}], ",", 
        RowBox[{
         RowBox[{"hessianStructure", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{"Length", "[", "outputs", "]"}]}]}], "]"}], ";"}]}], "\n", 
    "   ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralOneHessianElement", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408555575499645*^9, 3.40855562644662*^9}, {
   3.408555698427017*^9, 3.408555752841689*^9}, {3.408555797330433*^9, 
   3.408555805608109*^9}, {3.408556278739255*^9, 3.408556301269991*^9}, {
   3.408558697525703*^9, 3.40855870069838*^9}, {3.4085587655149603`*^9, 
   3.4085587898354597`*^9}, {3.4085609041654263`*^9, 3.408560904844736*^9}, {
   3.4085871740652237`*^9, 3.4085871810977*^9}, {3.408628090342455*^9, 
   3.408628092947421*^9}, {3.4086556756133423`*^9, 3.408655676658729*^9}, {
   3.408655768942697*^9, 3.4086557728143272`*^9}, {3.408655861830427*^9, 
   3.408655884543045*^9}, {3.408655930214017*^9, 3.4086559314530478`*^9}, {
   3.408655992493332*^9, 3.408655993195394*^9}, {3.408656367228681*^9, 
   3.408656385090145*^9}, {3.408656466170966*^9, 3.408656471028996*^9}, {
   3.408659060173934*^9, 3.408659060978992*^9}, {3.408850691207035*^9, 
   3.4088507133591547`*^9}, 3.4088510120827217`*^9, {3.409333477579693*^9, 
   3.409333520693698*^9}, {3.4093344318910427`*^9, 3.409334433652416*^9}, 
   3.4093344648892193`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralDiagonalHessian", "[", 
    RowBox[{
    "macroPrefix_", ",", "be_", ",", "outputs_", ",", "hessianStructure_", 
     ",", "rawHessianFn_", ",", "names_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "d2Edr2", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"AppendDihedralOneHessianElement", "[", 
          RowBox[{
           RowBox[{"macroPrefix", "<>", "\"\<_DIAGONAL\>\""}], ",", "be", ",",
            "outputs", ",", "hessianStructure", ",", "rawHessianFn", ",", 
           "names", ",", "i", ",", "i"}], "]"}], ";"}]}], "\n", "\t", "]"}], 
      ";"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralDiagonalHessian", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.409077919351634*^9, 3.409078031226864*^9}, {
  3.40907835011043*^9, 3.4090783521091347`*^9}, {3.4090783931519957`*^9, 
  3.4090784236570272`*^9}, {3.409333525349918*^9, 3.409333536474777*^9}, {
  3.4112619162551126`*^9, 3.4112619215407352`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "d2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.408656419732316*^9, 3.408656437275282*^9}}],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{3.619557601840439*^9, 3.702654228021493*^9}]
}, Open  ]],

Cell["\<\
For[i = 1, i <= Length[d2Edr2], i++,
  AppendDihedralOneHessianElement[\"DIHEDRAL\", dihedralDiagonalHessianRules, \
dihedralOutputs, d2Edr2, dihedralVarNames, i, i];
  ];\
\>", "Text",
 CellChangeTimes->{{3.408655574169129*^9, 3.408655604152143*^9}, {
   3.4086556809622593`*^9, 3.408655728602399*^9}, {3.408655784550395*^9, 
   3.40865581948155*^9}, {3.4086560642840567`*^9, 3.408656068011984*^9}, 
   3.40865618508574*^9, 3.408656434005369*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "12", "}"}]}], "]"}], ",", 
    RowBox[{"{", "12", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409333587617721*^9, 3.409333598425961*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6195576019285297`*^9, 3.7026542280846157`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralDiagonalHessian", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralDiagonalHessianRules", ",", 
    "dihedralOutputs", ",", "dihedralHessian", ",", "d2Edr2", ",", 
    "dihedralVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4090782650415897`*^9, 3.40907828859654*^9}, 
   3.409079462211437*^9, {3.409333577446553*^9, 3.409333579646331*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx1x1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 1, ",", 1, ") for variable: ", "dhx1x1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228168063*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 2, ") for variable: ", "dhy1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.7026542281689167`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 3, ") for variable: ", "dhz1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.7026542281695967`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx2x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 4, ") for variable: ", "dhx2x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228170277*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 5, ") for variable: ", "dhy2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228170957*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 6, ") for variable: ", "dhz2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.7026542281716347`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx3x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 7, ") for variable: ", "dhx3x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228172333*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 8, ") for variable: ", "dhy3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228172982*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 9, ") for variable: ", "dhz3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.7026542281736298`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx4x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 10, ") for variable: ", "dhx4x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228174279*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 11, ") for variable: ", "dhy4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228174943*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 12, ") for variable: ", "dhz4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 3.702654228175576*^9}]
}, Open  ]],

Cell["Setup the Off Diagonal Hessian rules", "Subsubsection",
 CellChangeTimes->{{3.408655161905715*^9, 3.408655167760612*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
    RowBox[{
    "macroPrefix_", ",", "be_", ",", "outputs_", ",", "hessianStructure_", 
     ",", "rawHessianFn_", ",", "names_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{
          RowBox[{"Length", "[", "d2Edr2", "]"}], "-", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "d2Edr2", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"AppendDihedralOneHessianElement", "[", 
             RowBox[{
              RowBox[{"macroPrefix", "<>", "\"\<_OFF_DIAGONAL\>\""}], ",", 
              "be", ",", "outputs", ",", "hessianStructure", ",", 
              "rawHessianFn", ",", "names", ",", "i", ",", "j"}], "]"}], 
            ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], ";"}]}],
     "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralOffDiagonalHessian", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.409077919351634*^9, 3.409078031226864*^9}, {
   3.40907835011043*^9, 3.4090783521091347`*^9}, {3.4090783931519957`*^9, 
   3.409078469080504*^9}, {3.409078504804676*^9, 3.409078513741704*^9}, {
   3.409079101000098*^9, 3.409079110511812*^9}, 3.409079159511916*^9, {
   3.409333542224677*^9, 3.40933355317448*^9}, {3.411261926206048*^9, 
   3.411261930485607*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.408655226662992*^9, 3.4086552378642597`*^9}, 
   3.409079466777631*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralOffDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralOffDiagonalHessianRules", ",", 
    "dihedralOutputs", ",", "dihedralHessian", ",", "d2Edr2", ",", 
    "dihedralVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.409079093793353*^9, 3.409079142461454*^9}, 
   3.409079468724416*^9, {3.409333563372666*^9, 3.40933356548463*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 1, ") for variable: ", "ohx1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228356614*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 1, ") for variable: ", "ohx1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283573847`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 1, ") for variable: ", "ohx1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228357997*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 1, ") for variable: ", "ohx1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228358618*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 1, ") for variable: ", "ohx1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228359223*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 1, ") for variable: ", "ohx1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228359825*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 1, ") for variable: ", "ohx1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228360426*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 1, ") for variable: ", "ohx1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228361039*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 1, ") for variable: ", "ohx1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228361648*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 1, ") for variable: ", "ohx1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228362254*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 1, ") for variable: ", "ohx1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228362907*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 2, ") for variable: ", "ohy1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228363545*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 2, ") for variable: ", "ohy1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228364163*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 2, ") for variable: ", "ohy1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283647842`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 2, ") for variable: ", "ohy1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228365406*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 2, ") for variable: ", "ohy1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228366026*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 2, ") for variable: ", "ohy1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228366645*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 2, ") for variable: ", "ohy1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228367264*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 2, ") for variable: ", "ohy1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228367885*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 2, ") for variable: ", "ohy1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228368506*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 2, ") for variable: ", "ohy1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228369154*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 3, ") for variable: ", "ohz1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.70265422836976*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 3, ") for variable: ", "ohz1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228370364*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 3, ") for variable: ", "ohz1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228371003*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 3, ") for variable: ", "ohz1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228371608*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 3, ") for variable: ", "ohz1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228372212*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 3, ") for variable: ", "ohz1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283728113`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 3, ") for variable: ", "ohz1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228373414*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 3, ") for variable: ", "ohz1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228374031*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 3, ") for variable: ", "ohz1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228374619*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 4, ") for variable: ", "ohx2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228375209*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 4, ") for variable: ", "ohx2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228375798*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 4, ") for variable: ", "ohx2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283763847`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 4, ") for variable: ", "ohx2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228376967*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 4, ") for variable: ", "ohx2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228377554*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 4, ") for variable: ", "ohx2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.70265422837814*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 4, ") for variable: ", "ohx2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283787317`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 4, ") for variable: ", "ohx2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283793573`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 5, ") for variable: ", "ohy2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228379959*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 5, ") for variable: ", "ohy2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283805656`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 5, ") for variable: ", "ohy2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228381167*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 5, ") for variable: ", "ohy2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283817472`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 5, ") for variable: ", "ohy2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228382324*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 5, ") for variable: ", "ohy2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283828993`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 5, ") for variable: ", "ohy2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283834753`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 6, ") for variable: ", "ohz2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.70265422838405*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 6, ") for variable: ", "ohz2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228384622*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 6, ") for variable: ", "ohz2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283851957`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 6, ") for variable: ", "ohz2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283857803`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 6, ") for variable: ", "ohz2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228386354*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 6, ") for variable: ", "ohz2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228386932*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 7, ") for variable: ", "ohx3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228387546*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 7, ") for variable: ", "ohx3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228388693*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 7, ") for variable: ", "ohx3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228389752*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 7, ") for variable: ", "ohx3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228390801*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 7, ") for variable: ", "ohx3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228391618*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 8, ") for variable: ", "ohy3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228392426*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 8, ") for variable: ", "ohy3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283932343`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 8, ") for variable: ", "ohy3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228394042*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 8, ") for variable: ", "ohy3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283947678`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 9, ") for variable: ", "ohz3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228395442*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 9, ") for variable: ", "ohz3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.70265422839611*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 9, ") for variable: ", "ohz3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228396782*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 10, ") for variable: ", "ohx4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228397449*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 10, ") for variable: ", "ohx4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.7026542283981247`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 11, ") for variable: ", "ohy4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 3.702654228398736*^9}]
}, Open  ]],

Cell["\<\
For[i = 1, i <= Length[d2Edr2] - 1, i++,
  For[j = i + 1, j <= Length[d2Edr2], j++,
    AppendDihedralOneHessianElement[\"DIHEDRAL\", \
dihedralOffDiagonalHessianRules, dihedralOutputs, d2Edr2, dihedralVarNames, \
i, j];
    ];
  ];\
\>", "Text",
 CellChangeTimes->{{3.408850582947207*^9, 3.408850616970339*^9}, {
  3.4088508906927147`*^9, 3.408850891296979*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dihedralAllRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralSetupRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralEnergyRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_FORCE //[\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcForce ) {\>\"", " ", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralGradientRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcDiagonalHessian) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_OFF_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcOffDiagonalHessian) { \>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralOffDiagonalHessianRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcOffDiagonalHessian*/\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif // DIHEDRAL_CALC_OFF_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcDiagonalHessian*/\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif // DIHEDRAL_CALC_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcForce*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<#endif // DIHEDRAL_CALC_FORCE ]\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4086549503985653`*^9, 3.4086551302470093`*^9}, {
   3.41017847632253*^9, 3.41017848542352*^9}, {3.4109617838377123`*^9, 
   3.410961860520269*^9}, 3.411198044265443*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralOutputs", ",", "DihedralDeviation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.411198046297284*^9, 3.411198058910133*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralFlattenedRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "dihedralAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4086552646330976`*^9, 3.40865527457828*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralOutputs", ",", "Phi"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.409361157868669*^9, 3.40936116476217*^9}, {
  3.409361694727602*^9, 3.409361722609562*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Dihedral\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "\"\<NotUsed\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "dihedralHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "dihedralFlattenedRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "dihedralInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "dihedralOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028819578140697`*^9, 3.4028819673432083`*^9}, 
   3.402914765609372*^9, 3.402914809575083*^9, 3.402966487087537*^9, {
   3.405598673911619*^9, 3.4055986829522657`*^9}, {3.405636326678927*^9, 
   3.4056363391829853`*^9}, {3.4056363705989532`*^9, 3.40563641434286*^9}, {
   3.405637128541765*^9, 3.405637129513829*^9}, {3.405637696845604*^9, 
   3.405637711676909*^9}, {3.4076800511983557`*^9, 3.407680055922863*^9}, 
   3.4077635803880997`*^9, {3.4086552573076477`*^9, 3.4086552800537786`*^9}, {
   3.409333629383656*^9, 3.409333638096027*^9}, 3.409338350030931*^9, {
   3.4110665533637333`*^9, 3.411066563651474*^9}, {3.4110670008789177`*^9, 
   3.411067001966928*^9}, 3.411074014162706*^9, {3.4110757545928717`*^9, 
   3.41107575829285*^9}, {3.411076165330535*^9, 3.411076201362154*^9}, 
   3.411079386355109*^9, {3.411201512045719*^9, 3.411201514689584*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlusOptimize", " ", "=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimesOptimize", " ", "=", " ", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408659099769362*^9, 3.408659106874506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "dihedralPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790475095104*^9, 3.408790482262748*^9}, {3.408844157019621*^9, 
   3.4088441576915627`*^9}, 3.409338346791582*^9, 3.4110670800538588`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralPack", "=", 
   RowBox[{"packOptimize", "[", "dihedralPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4029667486164722`*^9, 3.40296675299512*^9}, {
   3.405593795731063*^9, 3.405593801151153*^9}, {3.405598686856411*^9, 
   3.405598689575983*^9}, {3.407559220509287*^9, 3.40755922087429*^9}, {
   3.409338347441646*^9, 3.409338348066732*^9}, 3.411066680434393*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "dihedralPack", "]"}]], "Input",
 CellChangeTimes->{{3.4029672273918953`*^9, 3.402967239081615*^9}, 
   3.409338349079673*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{349., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"Dihedral\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "6", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "fx4", ",", "fy4", ",", "fz4", ",", "dhx1x1", ",", "dhy1y1", 
                ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", 
                ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "dhx4x4", 
                ",", "dhy4y4", ",", 
                RowBox[{"\[LeftSkeleton]", "44", "\[RightSkeleton]"}], ",", 
                "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
                "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", 
                "ohx3y3", ",", "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", 
                "ohx3z4", ",", "ohy3z3", ",", "ohy3x4", ",", "ohy3y4", ",", 
                "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", "ohz3z4", ",", 
                "ohx4y4", ",", "ohx4z4", ",", "ohy4z4", ",", 
                "DihedralDeviation"}], "}"}]}]}], "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{62., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 400, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{67., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 400, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{104., {3., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 400, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{92., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[400]]], "Output",
 CellChangeTimes->{3.619557708558012*^9, 3.702654229388871*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["An improved improper restraint with no discontinuities", "Subtitle",
 CellChangeTimes->{
  3.402881806378004*^9, {3.4029555772158318`*^9, 3.4029555790467377`*^9}, {
   3.408232598628756*^9, 3.408232608931699*^9}, {3.408394177272849*^9, 
   3.408394195246855*^9}, {3.408394233695057*^9, 3.408394251155362*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(K);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(U);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(L);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.410178119207843*^9, 3.410178147107234*^9}, {
  3.410178361408951*^9, 3.4101784213739767`*^9}, {3.410178549883905*^9, 
  3.410178572636623*^9}, {3.410178617530715*^9, 3.4101786338189297`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "dihedralVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<IMPROPER_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"improperRestraintSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4101781215075903`*^9, 
  3.4101781485693007`*^9}, {3.4101785528826838`*^9, 3.410178573744811*^9}, {
  3.4101792846240253`*^9, 3.41017928624059*^9}}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.7026542294945183`*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.702654229495941*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.702654229496933*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.7026542294978952`*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.702654229498848*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.702654229499791*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.70265422950077*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.7026542295017557`*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.702654229502747*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x4,I4,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.702654229503736*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y4,I4,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.7026542295047417`*^9}],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z4,I4,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 3.7026542295057297`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"improperRestraintSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 3.4101781294677153`*^9, 3.410178556859849*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(K);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(U);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(L);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I4);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x2,I2,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y2,I2,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z2,I2,2);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x3,I3,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y3,I3,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z3,I3,2);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x4,I4,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y4,I4,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z4,I4,2);\"\>", 
        "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195577088290787`*^9, 3.702654229570565*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"Phi", ",", "CosNPhi", ",", "SinNPhi"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4096020423340673`*^9, 3.409602048564129*^9}}],

Cell["Here is what it looks like", "Subsection",
 CellChangeTimes->{{3.408394253503767*^9, 3.408394256644514*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rad", "[", "h_", "]"}], " ", ":=", " ", 
  RowBox[{"h", "*", "0.0174533"}]}]], "Input",
 CellChangeTimes->{{3.408379663202251*^9, 3.4083796716685553`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Cos", "[", 
     RowBox[{"phi", "//", "rad"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", "0", ",", "180"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408378919735092*^9, 3.408378935271121*^9}, {
  3.408380328431974*^9, 3.408380332205256*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 180}, {0., 1.999999999999178}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.619557709001719*^9, 3.702654229755558*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawRestraintFn", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"phi", "-", "L"}], 
          RowBox[{"U", "-", "L"}]], "360"}], ")"}], "//", "rad"}], "]"}]}], 
    ")"}], "3"]}]], "Input",
 CellChangeTimes->{{3.408381041037016*^9, 3.408381047574959*^9}, {
   3.408381126025282*^9, 3.408381140009428*^9}, 3.4083811802826347`*^9, {
   3.408382087079472*^9, 3.408382093477792*^9}, {3.4107425907005043`*^9, 
   3.410742601107795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"otherRestraintFn", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"phi", ">=", "L"}], ",", "phi", ",", 
             RowBox[{"phi", "+", "360"}]}], "]"}], "-", "L"}], 
          RowBox[{"U", "+", "360", "-", "L"}]], "360"}], ")"}], "//", "rad"}],
       "]"}]}], ")"}], "3"]}]], "Input",
 CellChangeTimes->{{3.4083839535091343`*^9, 3.408384002209145*^9}, 
   3.408384868148151*^9, {3.408385072766967*^9, 3.40838509727969*^9}, {
   3.41074260364859*^9, 3.410742611409767*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGreaterThanU", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"phi", "<", "L"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"phi", ">", "U"}], ")"}]}], ",", "\[IndentingNewLine]", "0.0",
       ",", "\[IndentingNewLine]", 
      RowBox[{"otherRestraintFn", "[", 
       RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzVHykOlHykvHGaLdbCB6w4sOfhB97voWMP3ujZQz
iH5QqQem5W86J4HoGzyxYFpQ+vkEEM33RH8KiDZi7l8CoqXlnVaA6JK2W2tB
NL/r+3Ugum1C5BEQffUu/zEQPefC2asgOieC5S6IlmCu+QGieUL9foJoocC1
+j+B9HPps2B6W1GhDZi+PtEWRKuF/3MB0bIK19xBdJdPdjmIvhGhVQGiL8X1
tIBoiznxE0D0kdfMi0D0jJs7wXRAx55dIPpDa89uEH3m1aYjIDrs8jYw/Ucl
9TaIbmmaC6bzrb48AtGl3449BtHnDK9+AtFVjtqfQXSZ0//fINr+xLJ/IPqT
6hHV30Ca9/0JML3rzA4TEP3l2BkwDQAtjuAH
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LLessThanU", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"phi", "<", "L"}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{"phi", ">", "U"}], ")"}]}], ",", "0.0", ",", 
    RowBox[{"rawRestraintFn", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4083794838010674`*^9, 3.408379510179747*^9}, {
   3.40837954800559*^9, 3.4083795537915277`*^9}, {3.408379591053768*^9, 
   3.408379609151863*^9}, {3.408380072427807*^9, 3.408380084038293*^9}, {
   3.408380801830942*^9, 3.4083808020178556`*^9}, {3.408380892929167*^9, 
   3.408380903510066*^9}, {3.40838093570116*^9, 3.408380952776126*^9}, 
   3.408381110884235*^9, {3.408381147964313*^9, 3.408381160493845*^9}, {
   3.408382074281019*^9, 3.408382075515924*^9}, {3.408382148928997*^9, 
   3.4083821543894453`*^9}, {3.408386474756736*^9, 3.4083864752867823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"restraint", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"L", "<", "U"}], ",", 
    RowBox[{"LLessThanU", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}], ",", 
    RowBox[{"LGreaterThanU", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.408379613903246*^9, 3.408379652122449*^9}, {
   3.4083799622060347`*^9, 3.40837996705472*^9}, {3.408380347444665*^9, 
   3.408380349218028*^9}, {3.4083821789176483`*^9, 3.408382184335189*^9}, {
   3.4083822984696627`*^9, 3.408382304371964*^9}, {3.408382558553754*^9, 
   3.40838256003996*^9}, 3.408382835315847*^9, {3.4083864547284946`*^9, 
   3.408386460962118*^9}, {3.408386608420443*^9, 3.408386610693832*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "130"}], ",", "130"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408386509199087*^9, 3.408386533235841*^9}, {
  3.4083866445198183`*^9, 3.408386645343155*^9}, {3.4083942073600607`*^9, 
  3.4083942100202312`*^9}, {3.4090761945848093`*^9, 3.4090761959218693`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
V3U=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{-180, 180}, {0., 7.999997299159923}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.619557709326335*^9, 3.702654230217071*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", "140", ",", "100"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40838654200467*^9, 3.408386559808093*^9}, 
   3.4083866014963923`*^9, {3.4083877949092627`*^9, 3.408387811796521*^9}, {
   3.408394216546843*^9, 3.408394221870363*^9}, 3.409076226910532*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
ZIP4Nn7Tv+5x5uuOi1Q4LD/s4yIwpj/dct6TuEwFu71xm+ZfD+kTSqkTBtnL
PnySf4y/Tz8+POuwyS0qeMgLHv42+VTfvPSr0HAhFVx3bg9hWmF97lFUGf6A
CpmS9f1lAiX69WsTD8rWUWHo3J0Ih5oc/VCLIe7qJipc0ulM+TaVpK8XqlFI
6aCCCSs2dGA+VP9Hcbjj7HMqGMl8CGOSD+mXfOxavDBAhalu1t0wDit9L/F1
N9WGqaB9vU5Wc8sm/Y1mPhatE1TYP3zeUGl6addo0ONvrFkqCG6SmKB8f7gr
p1A4g+M3FSRUPZ3mD+jvcnlP253FsRfY/v8jJVryeSffP/ft4Uh8JfzPNvdy
BoXX/bPAu29Rhar//ETYcLOFxj/DiY9BkeifNQyUJOcP/LPwq1z7gYx/7uT7
sRCY889n9ffkiN35Z44bo9PWVf/8zVMl4fHLf+7lvP0kT3Tff07Zck/fJ+Gf
Gw+NT51L+edvWarZeVf/mSyUyzFw558FZq617Gn559MlF2xl2Jz/s5fWcVaL
zz+b7tSLl3Xc/5+pH0LUn+92+c8hIUuzLSKu/1mxMnz1oe//bKSakLXj5z+7
pV/REFj85/zAB3b3OWn/WX3HZOpvkX/WrXYiJW79Z+tadY0qr38+prbr8Tnf
f068ambnEvDPvcFMP87Qf/4+6cPVF0GDnAHP3IU3IrvED4Sl5kfRQKpky9S2
C0W7dDrOqwTF0aAi0dOO2TO3i6qfUWkVT4M30CTQ0K2kf6rglpl8Eg3SSdmX
HYpN9K/Ilr/5dokGqZE1bcJ9DP3a+HqPpnQaJOX47qqWCdIf/PNsMe0qDf6e
5f1QwJuov+T5Nv5INg0O99I4Bbiu68sPjsvp36QB2VPDf8fVYn0D659Fgvk0
sL2/IvwLuU6fUce1+8NdGnxWDErT1GjTj1Rf01NWtLye25e23br6Qj8vU54R
U0qDa8oib2pU3+u3rFb/vreCBpHC7cxN+8f1P4fujFKroYHmVJ9Ozb1Zfb6v
puJLdTQYF37/Z//NRf1NBym3uutpMFXlOGPNXEFYPmPo3mymQfCH+YXjgQKE
F/JpDWijgflEf6RuzBriQlHoPrNOGuRe3ctv7iJFFJPOT0j30EDj9cem2PPr
iJ4Ll4OnXtCgXKzrbuhqFWJ2KW/V49c0cHhpGGn/dTMh6l2WmfyWBnsslti6
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
40SbyWX0//93gupTRRHl1ZfR/wHZghvj
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6195577094822683`*^9, 3.702654230265823*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", "140", ",", "140"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40838654200467*^9, 3.408386559808093*^9}, 
   3.4083866014963923`*^9, {3.4083877949092627`*^9, 3.408387811796521*^9}, {
   3.408394216546843*^9, 3.408394221870363*^9}, {3.408396473391996*^9, 
   3.4083964740904493`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwtm3k4ld/XxkWDEGXMeDKEytRgjGcv8zzP8xnNSZKpqJRC8TWThGQsCqlM
aZdSJElFIiEUSUJRkff8ruv961yfa6/z7LXv+177Of8cSephOwYrCwuLNRsL
y/8+g0py5tZO+mBzjiHtAc0kRDVvPBpxwge/PU11VCxNQi7z73/NRvpg+Lqu
eHzbBaQPEqsfjvhgUw2HqqTvF5DIUMnmFpoPLpWcOifYkow6+OqkIo19cG7a
k6vl3amotel16Xd9H9yxrsEftqahespPeV/wwZXvc2rL7dJQ0S0NZSdNZn1Q
vNvUQBqKNH9w8MAeH9wbp/gheD4dyZ7pcpjjZtbf+8yvZZmFxHbP9vty+mD/
it4LJflZiPcVj/vHTT5Y4/tx+dWZLLQqYU/pZvHBaQ8txE+nZqM3TQOHquYZ
2L31TQ73pxx0Zn7ynF8fA3/urF4Vb8hDkZfYOUZ6Gbho4S3yF7qMgmF3svNL
Bq7c+Wnbk4jLyC3lUIbRMwYuH/xFvncwH+3bvVgo08TAVXJkmfaeK2iEsq5x
5AoDux5mJDzLLUKFV07KceUx8MvJZl2TviLkNbCapZ7NwC57s8Rj+a+iIZs/
oSkpDHz2hJ8Pb8ZV9A4tKGifZOCmp2XP2C8Vo1fiE0U5ZAb+OLrD6r+OEpTq
SuNp82Dg+tSyGUW+UmSTNRoz68LANy25FPI9S1E317CboS0Dt367pDi7WIo6
//bxL+gy8MmH0aw5iuXo0cCzBCtpBmap8uSPfFaJTgsYL0WRGJiccUlvkHQd
ge0TRqkoA/92EaLtiryOWp891FvhY2DeUNPk5D03UPO9ppXK9cz+uKb8yq9U
ofqsqpANk3ScWqi6cKfmFiq1TXVpqaBj/5/R7AXWt9H1JKFH8qV0HM5TovH4
/G1U01awJ+sqHV87IvsmAN9GLarV/w7l0fHRGsEz2vvrUa9wZwnpIh336t92
ZSfdQSxjbD/iDtNx0dnshGWee2ij6AW374F0jE+kfzlncw9xOfA+dvej49Jn
Al3FafeQUPuOnAMUOjZ9eSX8nEADUrquozNpR8eypKVxfplG5BEakWiqRscJ
GtxyXJ7NiHrj3/ydfXTcPPFL7V1ZM/Ibj/eQUmbWU/j90I9mdNQpU/mvHB03
2YmWjZ1vQUlatW+rhOn4q/3bhcyW+6iB9avk1lUavj/oU6UmhRF/hldTXxsN
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
BOeLn+a91UxC/weZO6Fb
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.619557709614139*^9, 3.702654230291113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Setup the improper torsion term
We reuse the code for the dihedral term,
specifically we start with:   dihedralCosPhiRules\
\>", "Subsubtitle",
 CellChangeTimes->{{3.402833465987742*^9, 3.402833468829653*^9}, 
   3.4028818063788223`*^9, {3.409076116812584*^9, 3.409076128097849*^9}, {
   3.409076239747479*^9, 3.4090762836308613`*^9}, {3.409076510926963*^9, 
   3.40907651161096*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "Phi", "]"}]], "Input",
 CellChangeTimes->{{3.409106688874969*^9, 3.409106695755435*^9}}],

Cell["\<\
Sum and difference formulas
sin (A + B) = sin A cos B + cos A sin B
sin (A - B) = sin A cos B - cos A sin B
cos (A + B) = cos A cos B - sin A sin B
cos (A - B) = cos A cos B + sin A sin B\
\>", "Text",
 CellChangeTimes->{{3.4029651450204144`*^9, 3.402965152857622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.409076917093985*^9, 3.409076958634542*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "improperRestraintTestRules", " ", "=", " ", "dihedralCosPhiRules"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409076738470045*^9, 3.409076750070456*^9}, 
   3.409077327963084*^9, 3.409077378904018*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<If[CosPhi>0.1,Phi=ArcSin[SinPhi],\n\t\t\t\t\t\
Phi=ArcCos[CosPhi]*Sign[SinPhi]];\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if(CosPhi>0.1){Phi=asin(SinPhi);}else\n\t\t\t\t\t\
{Phi=acos(CosPhi)*SIGN(SinPhi);}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.407764211219077*^9, 3.407764213360669*^9}, {
  3.409076769869112*^9, 3.409076770848304*^9}, {3.4090773287521353`*^9, 
  3.4090773292641153`*^9}, {3.4090773794499187`*^9, 3.409077380038114*^9}}],

Cell["At this point we have calculated Phi", "Subsubsection",
 CellChangeTimes->{{3.40839595538558*^9, 3.408395962392981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"MathCode", "[", "\"\<RestraintActive = False;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"CCode", "[", "\"\<RestraintActive=false;\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40823294634426*^9, 3.408232981251742*^9}, {
  3.4083961835243187`*^9, 3.4083961869992*^9}, {3.408396277468707*^9, 
  3.4083962840727587`*^9}, {3.409076771717814*^9, 3.409076772167429*^9}, {
  3.409077330163266*^9, 3.40907733067619*^9}, {3.409077380424087*^9, 
  3.409077380823999*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"MathCode", "[", "\"\<UShift = 0.0; PhiShift=0.0;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"CCode", "[", "\"\<UShift = 0.0; PhiShift = 0.0;\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.40823294634426*^9, 3.408232981251742*^9}, {
  3.4083961835243187`*^9, 3.4083961869992*^9}, {3.408396277468707*^9, 
  3.4083963406328707`*^9}, {3.408398739549844*^9, 3.408398753555151*^9}, {
  3.409076772817781*^9, 3.4090767733045273`*^9}, {3.409077331126154*^9, 
  3.4090773315631657`*^9}, {3.409077381187399*^9, 3.409077381574326*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<\nIf[ L<U && ((L<=Phi)&&(Phi<=U)), \n\tRestraintActive = True;\n\t\
UShift = 0.0;\n\tPhiShift = 0.0;\n];\n\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", "       ", 
     "\"\<\nif( L<U && (L<Phi)&&(Phi<U) ) {\n\tRestraintActive = true;\n\t\
UShift = 0.0;\n\tPhiShift = 0.0;\n}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408395995514694*^9, 3.4083961575020313`*^9}, {
  3.40839623150076*^9, 3.408396268523843*^9}, {3.408396347318568*^9, 
  3.4083963604662027`*^9}, {3.408396401694859*^9, 3.408396426030796*^9}, {
  3.408398802148634*^9, 3.408398897067815*^9}, {3.408411948774922*^9, 
  3.408411956603603*^9}, {3.409076773968699*^9, 3.409076774680676*^9}, {
  3.409077332094965*^9, 3.409077332682001*^9}, {3.409077381988881*^9, 
  3.409077382400844*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<\nIf[ U<=L && ((Phi<=U)||(Phi>=L)),\n\tRestraintActive = True;\n\t\
UShift = TWOPI;\n\tIf[Phi>=L,\n\t\tPhiShift = 0.0;\n\t,\n\t\tPhiShift = \
TWOPI;\n\t];\n];\>\"", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<\nif ( U<=L && ((Phi<=U)||(Phi>=L))) {\n\tRestraintActive = true;\n\
\tUShift = TWOPI;\n\tif ( Phi>=L ) {\n\t\tPhiShift = 0.0;\n\t} else {\n\t\t\
PhiShift = TWOPI;\n\t}\n}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408398901969885*^9, 3.408399061964635*^9}, {
   3.408411976419505*^9, 3.408412039768778*^9}, {3.408412877808464*^9, 
   3.408412923023285*^9}, 3.40841341881848*^9, {3.409076775331386*^9, 
   3.4090767767311993`*^9}, {3.4090773331812973`*^9, 3.409077334246182*^9}, {
   3.409077382950878*^9, 3.409077383443275*^9}, 3.409593334566361*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MacroCall", "[", 
    RowBox[{"name_", ",", "value_"}], "]"}], " ", ":=", " ", 
   RowBox[{"CCode", "[", 
    RowBox[{"name", "<>", "\"\<(\>\"", "<>", 
     RowBox[{"ToString", "[", "value", "]"}], "<>", "\"\<);\>\""}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.409106221354478*^9, 3.4091062561196136`*^9}}],

Cell["At this point we have the improperRestraintTestRules defined", \
"Subsection",
 CellChangeTimes->{{3.40907742331349*^9, 3.409077435721652*^9}}],

Cell["\<\
AppendTo[improperRestraintEnergyRules, MathCode[\"If[RestraintActive,\"]];
AppendTo[improperRestraintEnergyRules, CCode[\"if(RestraintActive){\"]];\
\>", "Text",
 CellChangeTimes->{{3.408233711153728*^9, 3.408233743197878*^9}, {
  3.408233776071458*^9, 3.408233858000513*^9}, {3.409076777879827*^9, 
  3.409076778342876*^9}, {3.409077337130555*^9, 3.409077337892419*^9}},
 FontColor->RGBColor[0.5, 0, 0.5]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.409077446945375*^9, 3.409077454126092*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"psi", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"Phi", "+", "PhiShift", "-", "L"}], 
    RowBox[{"U", "+", "UShift", "-", "L"}]], "TWOPI"}]}]], "Input",
 CellChangeTimes->{{3.408409533213232*^9, 3.408409539859514*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", "TWOPI"}], 
  RowBox[{
   RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]]], "Output",
 CellChangeTimes->{3.6195577101520967`*^9, 3.702654230755043*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Psi", ",", "psi"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408409505388205*^9, 3.408409552736274*^9}, 
   3.409076779354323*^9, 3.409077472770487*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fnEImproperRestraint", " ", "=", " ", 
  RowBox[{"EraseLinearDihedral", "*", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", "Psi", "]"}]}], ")"}], "3"]}]}]], "Input",
 CellChangeTimes->{{3.408403941701662*^9, 3.408403968202332*^9}, {
   3.408404024019986*^9, 3.408404059591957*^9}, {3.408404153548417*^9, 
   3.408404157132403*^9}, {3.408409602930616*^9, 3.408409625608087*^9}, {
   3.4084096662281218`*^9, 3.408409670138094*^9}, {3.410742630745689*^9, 
   3.410742646028102*^9}, 3.4168718448125772`*^9, {3.416872026444664*^9, 
   3.416872027499926*^9}}],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", "K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", "Psi", "]"}]}], ")"}], "3"]}]], "Output",
 CellChangeTimes->{3.6195577102436533`*^9, 3.702654230942*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "fnEImproperRestraint"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.402966429264083*^9, 3.402966441189411*^9}, {
   3.403180571417967*^9, 3.403180572463499*^9}, {3.4084039245763893`*^9, 
   3.408403932654778*^9}, {3.4084040811681557`*^9, 3.4084040833033333`*^9}, 
   3.408410256995305*^9, 3.409076780512807*^9, 3.409077480920691*^9, {
   3.4091069564798737`*^9, 3.4091069570931683`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<IMPROPER_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40907696160604*^9, 3.409076980846697*^9}, {
   3.409077084100278*^9, 3.4090771173035173`*^9}, 3.4090774838242273`*^9, {
   3.4091069594628*^9, 3.4091069637195263`*^9}}],

Cell["Here we have the improperRestraintEnergyRules defined", "Subsubsection",
 CellChangeTimes->{{3.409077499843992*^9, 3.409077509481435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"improperRestraintInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl", ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "L", ",", "U"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598381722083*^9, 3.4055984189648457`*^9}, {
  3.405603057636241*^9, 3.4056030583078613`*^9}, {3.405690789130921*^9, 
  3.40569079264091*^9}, {3.40823469297507*^9, 3.408234698309352*^9}, {
  3.408404130713231*^9, 3.40840413323258*^9}, {3.408409948237886*^9, 
  3.408409950760854*^9}, {3.4084106111249447`*^9, 3.408410612236628*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4", ",", "K", ",", "L", ",",
    "U"}], "}"}]], "Output",
 CellChangeTimes->{3.6195577105439377`*^9, 3.702654231077735*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fnEImproperRestraintWrtPhi", " ", "=", " ", 
  RowBox[{"fnEImproperRestraint", "/.", 
   RowBox[{"{", 
    RowBox[{"Psi", "\[Rule]", "psi"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.409080225735833*^9, 3.409080251398684*^9}, {
  3.409080307798128*^9, 3.409080316397607*^9}}],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", "K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
        "TWOPI"}], 
       RowBox[{
        RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], 
   "3"]}]], "Output",
 CellChangeTimes->{3.61955771061174*^9, 3.7026542311999474`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dEImproperRestraintDPhi", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"fnEImproperRestraintWrtPhi", ",", "Phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, {3.408234735726048*^9, 3.408234735792594*^9}, {
   3.408234808451262*^9, 3.408234826131146*^9}, {3.408235017977605*^9, 
   3.408235019911381*^9}, {3.408409473916202*^9, 3.408409476824745*^9}, {
   3.408409719718871*^9, 3.408409745680011*^9}, {3.409080325810863*^9, 
   3.409080339546691*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", "EraseLinearDihedral", " ", "K", " ", "TWOPI", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
         "TWOPI"}], 
        RowBox[{
         RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], "2"],
    " ", 
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
      "TWOPI"}], 
     RowBox[{
      RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], 
  RowBox[{
   RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]]], "Output",
 CellChangeTimes->{3.619557710694934*^9, 3.702654231364122*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2EImproperRestraintDPhi2", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"dEImproperRestraintDPhi", ",", "Phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409080408009396*^9, 3.409080435747931*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", "EraseLinearDihedral", " ", "K", " ", 
    SuperscriptBox["TWOPI", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
          "TWOPI"}], 
         RowBox[{
          RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], 
     "2"], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
       "TWOPI"}], 
      RowBox[{
       RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "L"}], "+", "U", "+", "UShift"}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{"6", " ", "EraseLinearDihedral", " ", "K", " ", 
    SuperscriptBox["TWOPI", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
         "TWOPI"}], 
        RowBox[{
         RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
        "TWOPI"}], 
       RowBox[{
        RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "L"}], "+", "U", "+", "UShift"}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.619557710976215*^9, 3.702654231532489*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintVarNames", "=", " ", "dihedralVarNames"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409081708446905*^9, 3.409081716742309*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintGradientRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintGradientRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DEImproperRestraintDPhi", ",", "dEImproperRestraintDPhi"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"improperDPhiDr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendDihedralGradientForce", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", "improperRestraintGradientRules", ",", 
    "improperDPhiDr", ",", " ", "improperRestraintOutputs", ",", " ", 
    "improperRestraintVarNames", ",", " ", "DEImproperRestraintDPhi"}], " ", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4090772445834618`*^9, 3.409077280014042*^9}, {
   3.409077582181634*^9, 3.40907762655396*^9}, {3.409077680041251*^9, 
   3.409077719152259*^9}, {3.4090817215192013`*^9, 3.409081723719063*^9}, {
   3.409083677301668*^9, 3.409083685320488*^9}, {3.4090837232265053`*^9, 
   3.4090837244353943`*^9}, 3.409083791581297*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.7026542316807623`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.7026542316824417`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.702654231683503*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.702654231684558*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.7026542316856117`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.7026542316866703`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.702654231687685*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.702654231688698*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.702654231689711*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.702654231690722*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.7026542316917353`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 3.7026542316927357`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintD2Edr2", " ", "=", " ", 
   RowBox[{
    RowBox[{"OuterVector", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2EImproperRestraintDPhi2", "*", "dPhidr"}], ")"}], ",", 
      "dPhidr"}], "]"}], "+", 
    RowBox[{"dEImproperRestraintDPhi", "*", "d2Phidr2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4090795130053997`*^9, 3.4090795150340977`*^9}, {
   3.4090799996705008`*^9, 3.409080007832756*^9}, 3.409080480832074*^9, {
   3.4090805378299828`*^9, 3.409080545318184*^9}, {3.409081671245607*^9, 
   3.409081673669129*^9}, {3.409081788553329*^9, 3.4090817897038603`*^9}, {
   3.409082362674494*^9, 3.40908237238766*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "improperRestraintD2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.409082375385445*^9, 3.4090823788879213`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557711230071*^9, 3.7026542318136168`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"improperRestraintHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "12", "}"}]}], "]"}], ",", 
    RowBox[{"{", "12", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409333657953597*^9, 3.409333684531035*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.619557711294911*^9, 3.702654231883169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralDiagonalHessian", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", "improperRestraintDiagonalHessianRules",
     ",", "improperRestraintOutputs", ",", "improperRestraintHessian", ",", 
    " ", "improperRestraintD2Edr2", ",", "improperRestraintVarNames"}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.4090782650415897`*^9, 3.40907828859654*^9}, 
   3.409079462211437*^9, {3.409079895499962*^9, 3.409079918497217*^9}, {
   3.4090816795823917`*^9, 3.409081680744109*^9}, {3.4090817363302593`*^9, 
   3.409081738967415*^9}, 3.4090818037299232`*^9, {3.409333674982085*^9, 
   3.409333680318287*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx1x1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 1, ",", 1, ") for variable: ", "dhx1x1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.702654232453677*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 2, ") for variable: ", "dhy1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.7026542324552107`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 3, ") for variable: ", "dhz1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.702654232456298*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx2x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 4, ") for variable: ", "dhx2x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.702654232457344*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 5, ") for variable: ", "dhy2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.702654232458356*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 6, ") for variable: ", "dhz2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.702654232459361*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx3x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 7, ") for variable: ", "dhx3x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.702654232460372*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 8, ") for variable: ", "dhy3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.7026542324614277`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 9, ") for variable: ", "dhz3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.7026542324624357`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx4x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 10, ") for variable: ", "dhx4x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.70265423246345*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 11, ") for variable: ", "dhy4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.70265423246446*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 12, ") for variable: ", "dhz4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 3.7026542324654713`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintOffDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", 
    "improperRestraintOffDiagonalHessianRules", ",", 
    "improperRestraintOutputs", ",", "improperRestraintHessian", ",", 
    "improperRestraintD2Edr2", ",", "improperRestraintVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409079093793353*^9, 3.409079142461454*^9}, 
   3.409079468724416*^9, {3.409081684944087*^9, 3.4090816860820436`*^9}, {
   3.40908174346716*^9, 3.409081806117021*^9}, {3.409333690093843*^9, 
   3.40933369333027*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 1, ") for variable: ", "ohx1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232758369*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 1, ") for variable: ", "ohx1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232759717*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 1, ") for variable: ", "ohx1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.70265423276073*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 1, ") for variable: ", "ohx1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232761712*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 1, ") for variable: ", "ohx1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327626867`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 1, ") for variable: ", "ohx1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327636633`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 1, ") for variable: ", "ohx1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327646437`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 1, ") for variable: ", "ohx1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327656307`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 1, ") for variable: ", "ohx1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327666063`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 1, ") for variable: ", "ohx1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327675743`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 1, ") for variable: ", "ohx1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232768566*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 2, ") for variable: ", "ohy1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327695436`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 2, ") for variable: ", "ohy1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232770557*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 2, ") for variable: ", "ohy1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327715673`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 2, ") for variable: ", "ohy1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232772545*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 2, ") for variable: ", "ohy1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232773491*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 2, ") for variable: ", "ohy1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.70265423277444*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 2, ") for variable: ", "ohy1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232775388*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 2, ") for variable: ", "ohy1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327763367`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 2, ") for variable: ", "ohy1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232777289*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 2, ") for variable: ", "ohy1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327782383`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 3, ") for variable: ", "ohz1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232779192*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 3, ") for variable: ", "ohz1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232780148*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 3, ") for variable: ", "ohz1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232781095*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 3, ") for variable: ", "ohz1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327820473`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 3, ") for variable: ", "ohz1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327830276`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 3, ") for variable: ", "ohz1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327840776`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 3, ") for variable: ", "ohz1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232785097*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 3, ") for variable: ", "ohz1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232786076*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 3, ") for variable: ", "ohz1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.70265423278721*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 4, ") for variable: ", "ohx2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327882843`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 4, ") for variable: ", "ohx2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232789342*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 4, ") for variable: ", "ohx2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232790367*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 4, ") for variable: ", "ohx2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.70265423279137*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 4, ") for variable: ", "ohx2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232792386*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 4, ") for variable: ", "ohx2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232793322*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 4, ") for variable: ", "ohx2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232794262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 4, ") for variable: ", "ohx2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542327952023`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 5, ") for variable: ", "ohy2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232796133*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 5, ") for variable: ", "ohy2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232797104*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 5, ") for variable: ", "ohy2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.70265423279804*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 5, ") for variable: ", "ohy2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232799117*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 5, ") for variable: ", "ohy2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542328004913`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 5, ") for variable: ", "ohy2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232801441*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 5, ") for variable: ", "ohy2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232802475*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 6, ") for variable: ", "ohz2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232803501*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 6, ") for variable: ", "ohz2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232804542*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 6, ") for variable: ", "ohz2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232805595*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 6, ") for variable: ", "ohz2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232806518*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 6, ") for variable: ", "ohz2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542328074293`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 6, ") for variable: ", "ohz2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232808343*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 7, ") for variable: ", "ohx3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232809259*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 7, ") for variable: ", "ohx3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232810182*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 7, ") for variable: ", "ohx3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232811105*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 7, ") for variable: ", "ohx3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232811988*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 7, ") for variable: ", "ohx3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232812883*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 8, ") for variable: ", "ohy3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232813772*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 8, ") for variable: ", "ohy3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232814673*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 8, ") for variable: ", "ohy3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232815566*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 8, ") for variable: ", "ohy3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542328164587`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 9, ") for variable: ", "ohz3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542328173447`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 9, ") for variable: ", "ohz3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232818233*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 9, ") for variable: ", "ohz3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232819126*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 10, ") for variable: ", "ohx4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232820024*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 10, ") for variable: ", "ohx4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.7026542328209877`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 11, ") for variable: ", "ohy4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 3.702654232821888*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InitializeOutputs", "[", "outputs_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "zeroOutputs", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"zeroOutputs", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<= 0.0;\\n\>\""}], 
          "&"}], ",", "outputs"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"StringJoin", "[", "zeroOutputs", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.409596985374069*^9, 3.4095970096100893`*^9}, {
  3.409597043808723*^9, 3.409597093651099*^9}, {3.409597183449415*^9, 
  3.409597247958007*^9}, {3.409598917761016*^9, 3.409598921233493*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintAllRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"improperRestraintAllRules", ",", "improperRestraintSetupRules"}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "out", " ", "setting", " ", "variables", " ", "to", " ", 
    "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"improperRestraintAllRules", ",", 
      RowBox[{"CCode", "[", 
       RowBox[{"InitializeOutputs", "[", "improperRestraintOutputs", "]"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", 
     RowBox[{"InitializeOutputs", "[", "improperRestraintOutputs", "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", "improperRestraintTestRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", "\"\<If[RestraintActive,\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (RestraintActive ) {\>\"", " ", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", "improperRestraintEnergyRules"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef IMPROPER_RESTRAINT_CALC_FORCE //[\>\"", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcForce ) {\>\"", " ", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", "improperRestraintGradientRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#ifdef IMPROPER_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcDiagonalHessian) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", 
    "improperRestraintDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#ifdef IMPROPER_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcOffDiagonalHessian) { \>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", 
    "improperRestraintOffDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcOffDiagonalHessian*/\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#endif //IMPROPER_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcDiagonalHessian*/\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#endif //IMPROPER_RESTRAINT_CALC_DIAGONAL_HESSIAN ]\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcForce*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif //IMPROPER_RESTRAINT_CALC_FORCE ]\>\"", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*RestraintActive*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MacroCall", "[", 
     RowBox[{"\"\<IMPROPER_RESTRAINT_PHI_SET\>\"", ",", "Phi"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintOutputs", ",", "Phi"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", " ", 
    RowBox[{"MathCode", "[", "\"\<]; (*RestraintActive*)\>\"", "]"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.4086549503985653`*^9, 3.4086551302470093`*^9}, {
  3.409081808957452*^9, 3.4090819840158052`*^9}, {3.409108929233745*^9, 
  3.409108935291503*^9}, {3.409515435827023*^9, 3.409515442951703*^9}, {
  3.40953443636611*^9, 3.4095344513393927`*^9}, {3.409593363342606*^9, 
  3.409593368604685*^9}, {3.409596874863688*^9, 3.409596982310606*^9}, {
  3.409598264523089*^9, 3.409598269822241*^9}, {3.409598926402801*^9, 
  3.4095990222756443`*^9}, {3.4101789103021584`*^9, 3.410178923187131*^9}, {
  3.410961601455715*^9, 3.410961738638186*^9}, {3.485015325952389*^9, 
  3.485015357288415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintFlattenedRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "improperRestraintAllRules", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4086552646330976`*^9, 3.40865527457828*^9}, {
  3.4090820029448643`*^9, 3.4090820118089657`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["improperRestraintOutputs"], "Input",
 CellChangeTimes->{{3.407761664825244*^9, 3.4077616727209597`*^9}, {
   3.4084101627937202`*^9, 3.408410164951118*^9}, 3.4090777912493277`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", "fx4", ",", "fy4", ",", 
   "fz4", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", 
   "dhx4x4", ",", "dhy4y4", ",", "dhz4z4", ",", "ohx1y1", ",", "ohx1z1", ",", 
   "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohx1x3", ",", "ohx1y3", ",", 
   "ohx1z3", ",", "ohx1x4", ",", "ohx1y4", ",", "ohx1z4", ",", "ohy1z1", ",", 
   "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohy1x3", ",", "ohy1y3", ",", 
   "ohy1z3", ",", "ohy1x4", ",", "ohy1y4", ",", "ohy1z4", ",", "ohz1x2", ",", 
   "ohz1y2", ",", "ohz1z2", ",", "ohz1x3", ",", "ohz1y3", ",", "ohz1z3", ",", 
   "ohz1x4", ",", "ohz1y4", ",", "ohz1z4", ",", "ohx2y2", ",", "ohx2z2", ",", 
   "ohx2x3", ",", "ohx2y3", ",", "ohx2z3", ",", "ohx2x4", ",", "ohx2y4", ",", 
   "ohx2z4", ",", "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", ",", "ohy2z3", ",", 
   "ohy2x4", ",", "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
   "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", "ohx3y3", ",", 
   "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", "ohx3z4", ",", "ohy3z3", ",", 
   "ohy3x4", ",", "ohy3y4", ",", "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", 
   "ohz3z4", ",", "ohx4y4", ",", "ohx4z4", ",", "ohy4z4", ",", "Phi"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557712095818*^9, 3.7026542347973833`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<ImproperRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "improperRestraintHessian"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "improperRestraintFlattenedRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "improperRestraintInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "improperRestraintOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028819578140697`*^9, 3.4028819673432083`*^9}, 
   3.402914765609372*^9, 3.402914809575083*^9, 3.402966487087537*^9, {
   3.405598673911619*^9, 3.4055986829522657`*^9}, {3.405636326678927*^9, 
   3.4056363391829853`*^9}, {3.4056363705989532`*^9, 3.40563641434286*^9}, {
   3.405637128541765*^9, 3.405637129513829*^9}, {3.405637696845604*^9, 
   3.405637711676909*^9}, {3.4076800511983557`*^9, 3.407680055922863*^9}, 
   3.4077635803880997`*^9, {3.408410168114626*^9, 3.4084101962575283`*^9}, 
   3.4090768093248034`*^9, {3.4090820295356092`*^9, 3.409082037972199*^9}, {
   3.409333700219658*^9, 3.409333707443859*^9}, {3.411066597262484*^9, 
   3.411066604438355*^9}, {3.411067020063253*^9, 3.411067022495068*^9}, 
   3.41107402025056*^9, {3.411075766096381*^9, 3.4110757699989357`*^9}, {
   3.41107622587714*^9, 3.4110762393701963`*^9}, 3.4110765760400867`*^9, 
   3.411079392129137*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "writeOutputVariablesForDebugging", "[", "improperRestraintPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, {3.409085616705697*^9, 3.409085625514409*^9}, 
   3.411067087382237*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintPack", "=", 
   RowBox[{"packOptimize", "[", "improperRestraintPack0", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4029667486164722`*^9, 3.40296675299512*^9}, {
   3.405593795731063*^9, 3.405593801151153*^9}, {3.405598686856411*^9, 
   3.405598689575983*^9}, {3.407559220509287*^9, 3.40755922087429*^9}, {
   3.408410200560124*^9, 3.4084102194557743`*^9}, {3.408410654126341*^9, 
   3.408410655532649*^9}, 3.4110666488712482`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "improperRestraintPack", "]"}]], "Input",
 CellChangeTimes->{{3.4029672273918953`*^9, 3.402967239081615*^9}, {
  3.4084102236314163`*^9, 3.40841022587131*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{349., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"ImproperRestraint\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "5", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "fx4", ",", "fy4", ",", "fz4", ",", "dhx1x1", ",", "dhy1y1", 
                ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", 
                ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "dhx4x4", 
                ",", "dhy4y4", ",", 
                RowBox[{"\[LeftSkeleton]", "44", "\[RightSkeleton]"}], ",", 
                "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
                "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", 
                "ohx3y3", ",", "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", 
                "ohx3z4", ",", "ohy3z3", ",", "ohy3x4", ",", "ohy3y4", ",", 
                "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", "ohz3z4", ",", 
                "ohx4y4", ",", "ohx4z4", ",", "ohy4z4", ",", "Phi"}], 
               "}"}]}]}], "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{62., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 487, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{67., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 487, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{104., {3., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 487, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{92., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[487]]], "Output",
 CellChangeTimes->{3.619557817043065*^9, 3.702654236182584*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Chiral Restraint
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.410959008646387*^9, 3.4109590179061737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"va", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vc", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vd", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x4", ",", " ", "y4", ",", " ", "z4"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, {
  3.410959023856037*^9, 3.41095903888342*^9}, {3.410959358432473*^9, 
  3.410959366366046*^9}, {3.41096049070288*^9, 3.410960503950835*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ac", ",", "bc", ",", "dc"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ac", " ", "=", " ", 
   RowBox[{"va", "-", "vc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"vb", " ", "-", " ", "vc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc", " ", "=", " ", 
   RowBox[{"vd", " ", "-", " ", "vc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.410959054691805*^9, 3.410959104500534*^9}, 
   3.4109591733772783`*^9, {3.410960420959537*^9, 3.410960459261435*^9}, {
   3.410960505510457*^9, 3.4109605135183067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "K", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410959126465396*^9, 3.410959130081745*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chiralRestraintTestFn", " ", "=", "  ", 
  RowBox[{"K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"ac", ",", "bc"}], "]"}], ".", "dc"}], 
       RowBox[{
        RowBox[{"vecLen", "[", "ac", "]"}], 
        RowBox[{"vecLen", "[", "bc", "]"}], 
        RowBox[{"vecLen", "[", "dc", "]"}]}]], "+", "CO"}], ")"}], 
    "3"]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.4109591109262114`*^9, 
   3.410959234749806*^9}, {3.410960461630476*^9, 3.4109604710300083`*^9}, {
   3.4111342198342657`*^9, 3.411134220288424*^9}, {3.411139922041378*^9, 
   3.411139941967361*^9}, 3.411140010178594*^9, {3.411921311733358*^9, 
   3.411921327948023*^9}}],

Cell[BoxData[
 RowBox[{"K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"CO", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y3"}], "+", "y4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2", " ", "z1"}], "-", 
           RowBox[{"x3", " ", "z1"}], "-", 
           RowBox[{"x1", " ", "z2"}], "+", 
           RowBox[{"x3", " ", "z2"}], "+", 
           RowBox[{"x1", " ", "z3"}], "-", 
           RowBox[{"x2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x3"}], "+", "x4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "y2"}], " ", "z1"}], "+", 
           RowBox[{"y3", " ", "z1"}], "+", 
           RowBox[{"y1", " ", "z2"}], "-", 
           RowBox[{"y3", " ", "z2"}], "-", 
           RowBox[{"y1", " ", "z3"}], "+", 
           RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "x2"}], " ", "y1"}], "+", 
           RowBox[{"x3", " ", "y1"}], "+", 
           RowBox[{"x1", " ", "y2"}], "-", 
           RowBox[{"x3", " ", "y2"}], "-", 
           RowBox[{"x1", " ", "y3"}], "+", 
           RowBox[{"x2", " ", "y3"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z3"}], "+", "z4"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x2", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y2", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z2", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x3"}], "+", "x4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y3"}], "+", "y4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z3"}], "+", "z4"}], ")"}], "2"]}]]}], ")"}]}]}], 
    ")"}], "3"]}]], "Output",
 CellChangeTimes->{3.619557817496393*^9, 3.702654236760476*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintEnergyFn", " ", "=", " ", "chiralRestraintTestFn"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.411134222633911*^9, 3.411134230842989*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"va", ",", "vb", ",", "vc", ",", "vd"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.410959244997628*^9, 3.410959246043676*^9}, {
  3.410975381434297*^9, 3.410975391272737*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]], "Output",
 CellChangeTimes->{3.619557817564983*^9, 3.702654236872802*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 3.401714291927002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x4", ",", "x", ",", "I4", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y4", ",", "y", ",", "I4", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "z", ",", "I4", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.4109592547618723`*^9, 3.4109592880721416`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(K);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(CO);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.41095930653111*^9, 3.410959308338553*^9}, {3.410959446914455*^9, 
  3.410959448076516*^9}, {3.4109594887222424`*^9, 3.4109595065938807`*^9}, {
  3.430307504520461*^9, 3.4303075090533123`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "str"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "chiralRestraintVarNames", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", " ", "=", " ", 
         RowBox[{"\"\<CHIRAL_RESTRAINT_SET_POSITION(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"chiralRestraintSetupRules", ",", 
          RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4109593095964613`*^9, 3.410959312139323*^9}, 
   3.410959448741249*^9, {3.41100557090314*^9, 3.411005579300394*^9}}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.70265423702346*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237024294*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.7026542370249577`*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237025612*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237026272*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237026927*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237027589*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237028215*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.70265423702884*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x4,I4,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237029469*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y4,I4,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237030099*^9}],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z4,I4,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 3.702654237030725*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chiralRestraintSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410959313257309*^9, {
   3.410959597371963*^9, 3.410959602050107*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(K);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(CO);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I4);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z2,I2,2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x3,I3,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y3,I3,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z3,I3,2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x4,I4,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y4,I4,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z4,I4,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557817729368*^9, 3.7026542370838137`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chiralRestraintTestRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"chiralRestraintTestRules", ",", 
     RowBox[{"Assign", "[", 
      RowBox[{"ChiralTest", ",", "chiralRestraintTestFn"}], "]"}]}], "]"}], 
   ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"We", " ", "will", " ", "test", " ", "the", " ", "Energy"}], ",", 
    " ", 
    RowBox[{
    "if", " ", "its", " ", "greater", " ", "than", " ", "zero", " ", "then", 
     " ", "the", " ", "restraint", " ", "is", " ", "active"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chiralRestraintEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<Energy=ChiralTest;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"MathCode", "[", "\"\<Energy = ChiralTest;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<CHIRAL_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.410959314804584*^9, 
   3.4109593175472317`*^9}, 3.410959449531116*^9, {3.410959545429446*^9, 
   3.410959610720241*^9}, {3.410959644694853*^9, 3.410959691985753*^9}, {
   3.411134257170401*^9, 3.411134294169005*^9}, {3.411135094096856*^9, 
   3.4111350954424562`*^9}, {3.411135402551195*^9, 3.411135431190372*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintTestRules"], "Input",
 CellChangeTimes->{{3.411135069369252*^9, 3.4111350725038767`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"CO", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y3"}], "+", "y4"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "z1"}], "-", 
             RowBox[{"x3", " ", "z1"}], "-", 
             RowBox[{"x1", " ", "z2"}], "+", 
             RowBox[{"x3", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "z3"}], "-", 
             RowBox[{"x2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x3"}], "+", "x4"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "y2"}], " ", "z1"}], "+", 
             RowBox[{"y3", " ", "z1"}], "+", 
             RowBox[{"y1", " ", "z2"}], "-", 
             RowBox[{"y3", " ", "z2"}], "-", 
             RowBox[{"y1", " ", "z3"}], "+", 
             RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "x2"}], " ", "y1"}], "+", 
             RowBox[{"x3", " ", "y1"}], "+", 
             RowBox[{"x1", " ", "y2"}], "-", 
             RowBox[{"x3", " ", "y2"}], "-", 
             RowBox[{"x1", " ", "y3"}], "+", 
             RowBox[{"x2", " ", "y3"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z3"}], "+", "z4"}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z3"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x2", "-", "x3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y2", "-", "y3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z2", "-", "z3"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x3"}], "+", "x4"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y3"}], "+", "y4"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z3"}], "+", "z4"}], ")"}], "2"]}]]}], ")"}]}]}], 
      ")"}], "3"]}], "\[Rule]", "ChiralTest"}], "}"}]], "Output",
 CellChangeTimes->{3.619557817773321*^9, 3.702654237194832*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintEnergyRules"], "Input",
 CellChangeTimes->{{3.411135079713765*^9, 3.411135082886479*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CCode", "[", "\<\"Energy=ChiralTest;\"\>", "]"}], ",", 
   RowBox[{"MathCode", "[", "\<\"Energy = ChiralTest;\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"CHIRAL_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6195578178104897`*^9, 3.70265423725237*^9}]
}, Open  ]],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 3.408559038294833*^9}}],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.410959318323591*^9}],

Cell[BoxData[
 RowBox[{"K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"CO", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y3"}], "+", "y4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2", " ", "z1"}], "-", 
           RowBox[{"x3", " ", "z1"}], "-", 
           RowBox[{"x1", " ", "z2"}], "+", 
           RowBox[{"x3", " ", "z2"}], "+", 
           RowBox[{"x1", " ", "z3"}], "-", 
           RowBox[{"x2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x3"}], "+", "x4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "y2"}], " ", "z1"}], "+", 
           RowBox[{"y3", " ", "z1"}], "+", 
           RowBox[{"y1", " ", "z2"}], "-", 
           RowBox[{"y3", " ", "z2"}], "-", 
           RowBox[{"y1", " ", "z3"}], "+", 
           RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "x2"}], " ", "y1"}], "+", 
           RowBox[{"x3", " ", "y1"}], "+", 
           RowBox[{"x1", " ", "y2"}], "-", 
           RowBox[{"x3", " ", "y2"}], "-", 
           RowBox[{"x1", " ", "y3"}], "+", 
           RowBox[{"x2", " ", "y3"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z3"}], "+", "z4"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x2", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y2", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z2", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x3"}], "+", "x4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y3"}], "+", "y4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z3"}], "+", "z4"}], ")"}], "2"]}]]}], ")"}]}]}], 
    ")"}], "3"]}]], "Output",
 CellChangeTimes->{3.6195578178536863`*^9, 3.702654237315117*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"chiralRestraintHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "12", "}"}]}], "]"}], ",", 
      RowBox[{"{", "12", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.4109593191865063`*^9, {3.410960717989409*^9, 3.410960719562788*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195578178899717`*^9, 3.702654237382493*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.4109593198653793`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<CHIRAL_RESTRAINT\>\"", ",", "chiralRestraintForceHessianRules", ",", 
    "chiralRestraintOutputs", ",", "chiralRestraintHessian", ",", 
    "chiralRestraintEnergyFn", ",", "chiralRestraintVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.410959320803413*^9, 3.410959324344501*^9}, 
   3.410959451277605*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chiralRestraintHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 3.410959325491352*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"14", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36"},
     {"26", "15", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46"},
     {"27", "37", "16", "47", "48", "49", "50", "51", "52", "53", "54", "55"},
     {"28", "38", "47", "17", "56", "57", "58", "59", "60", "61", "62", "63"},
     {"29", "39", "48", "56", "18", "64", "65", "66", "67", "68", "69", "70"},
     {"30", "40", "49", "57", "64", "19", "71", "72", "73", "74", "75", "76"},
     {"31", "41", "50", "58", "65", "71", "20", "77", "78", "79", "80", "81"},
     {"32", "42", "51", "59", "66", "72", "77", "21", "82", "83", "84", "85"},
     {"33", "43", "52", "60", "67", "73", "78", "82", "22", "86", "87", "88"},
     {"34", "44", "53", "61", "68", "74", "79", "83", "86", "23", "89", "90"},
     {"35", "45", "54", "62", "69", "75", "80", "84", "87", "89", "24", "91"},
     {"36", "46", "55", "63", "70", "76", "81", "85", "88", "90", "91", "25"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557821410286*^9, 3.702654243482113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4109593272519207`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", "fx4", ",", "fy4", ",", 
   "fz4", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", 
   "dhx4x4", ",", "dhy4y4", ",", "dhz4z4", ",", "ohx1y1", ",", "ohx1z1", ",", 
   "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohx1x3", ",", "ohx1y3", ",", 
   "ohx1z3", ",", "ohx1x4", ",", "ohx1y4", ",", "ohx1z4", ",", "ohy1z1", ",", 
   "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohy1x3", ",", "ohy1y3", ",", 
   "ohy1z3", ",", "ohy1x4", ",", "ohy1y4", ",", "ohy1z4", ",", "ohz1x2", ",", 
   "ohz1y2", ",", "ohz1z2", ",", "ohz1x3", ",", "ohz1y3", ",", "ohz1z3", ",", 
   "ohz1x4", ",", "ohz1y4", ",", "ohz1z4", ",", "ohx2y2", ",", "ohx2z2", ",", 
   "ohx2x3", ",", "ohx2y3", ",", "ohx2z3", ",", "ohx2x4", ",", "ohx2y4", ",", 
   "ohx2z4", ",", "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", ",", "ohy2z3", ",", 
   "ohy2x4", ",", "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
   "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", "ohx3y3", ",", 
   "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", "ohx3z4", ",", "ohy3z3", ",", 
   "ohy3x4", ",", "ohy3y4", ",", "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", 
   "ohz3z4", ",", "ohx4y4", ",", "ohx4z4", ",", "ohy4z4"}], "}"}]], "Output",
 CellChangeTimes->{3.619557821455429*^9, 3.702654243553838*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 3.401714390085981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintAllRules", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintSetupRules"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "out", " ", "setting", " ", "variables", " ", "to", " ", 
    "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"chiralRestraintAllRules", ",", 
      RowBox[{"CCode", "[", 
       RowBox[{"InitializeOutputs", "[", "chiralRestraintOutputs", "]"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintTestRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", "\"\<If[ChiralTest>0.0,\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (ChiralTest>0.0 ) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintEnergyRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "chiralRestraintAllRules", ",", "chiralRestraintForceHessianRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*ChiralTest>0.0*/\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.410959332300748*^9, 3.410959333098225*^9}, {3.4109598627158747`*^9, 
   3.410960066783773*^9}, {3.4109601095200453`*^9, 3.410960125598184*^9}, {
   3.411134307132209*^9, 3.41113432360879*^9}, {3.485015368183762*^9, 
   3.4850153836885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "chiralRestraintAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.4109593336854553`*^9, 3.410959334074417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintInput", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"va", ",", "vb", ",", "vc", ",", "vd", ",", "K", ",", "CO"}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.410959334338519*^9, {
   3.4109593725101748`*^9, 3.410959398697234*^9}, {3.410976480390479*^9, 
   3.410976484490128*^9}, {3.411921363503119*^9, 3.411921363833495*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<ChiralRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"va", ",", "vb", ",", "vc", ",", "vd"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "chiralRestraintHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "chiralRestraintRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "chiralRestraintInput"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "chiralRestraintOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.410959334749442*^9, 3.4109593365958223`*^9}, {3.4109594055611277`*^9, 
   3.410959422169114*^9}, {3.4109764723057404`*^9, 3.410976477991148*^9}, {
   3.4110666202631207`*^9, 3.4110666262635813`*^9}, {3.411067029087072*^9, 
   3.411067031094479*^9}, 3.411074026391202*^9, {3.411075777240587*^9, 
   3.411075781101914*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "writeOutputVariablesForDebugging", "[", "chiralRestraintPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, {3.410959339196207*^9, 
   3.410959340137948*^9}, 3.41106704496288*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "chiralRestraintPack0", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, {3.410959341804433*^9, 
   3.410959345050294*^9}, 3.411066639651175*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "chiralRestraintPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 3.4109593459079313`*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{349., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"ChiralRestraint\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "5", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "fx4", ",", "fy4", ",", "fz4", ",", "dhx1x1", ",", "dhy1y1", 
                ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", 
                ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "dhx4x4", 
                ",", "dhy4y4", ",", 
                RowBox[{"\[LeftSkeleton]", "43", "\[RightSkeleton]"}], ",", 
                "ohy2x4", ",", "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", 
                "ohz2y3", ",", "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", 
                "ohz2z4", ",", "ohx3y3", ",", "ohx3z3", ",", "ohx3x4", ",", 
                "ohx3y4", ",", "ohx3z4", ",", "ohy3z3", ",", "ohy3x4", ",", 
                "ohy3y4", ",", "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", 
                "ohz3z4", ",", "ohx4y4", ",", "ohx4z4", ",", "ohy4z4"}], 
               "}"}]}]}], "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{62., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 540, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{67., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 540, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{104., {3., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 540, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{92., {1., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[540]]], "Output",
 CellChangeTimes->{3.619557895888568*^9, 3.702654244200876*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cartesian anchor term.  
Anchor atoms at a specific position with a harmonic potential
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.413903156136791*^9, 3.413903180058527*^9}, {
   3.413903223172472*^9, 3.4139032263211527`*^9}, 3.414009285999349*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "ka"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}, {
   3.413903983939694*^9, 3.413903984536366*^9}, 3.414009246563033*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bx", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xa", ",", " ", "ya", ",", " ", "za"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, 
   3.413903311971038*^9, {3.413903346593233*^9, 3.4139033527796583`*^9}, {
   3.413903458114628*^9, 3.4139034691386337`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorDeviation", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"bx", "-", "ba"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"bx", "-", "ba"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
   3.411152033364759*^9, 3.411152034157058*^9}, 3.4139031925379553`*^9, {
   3.4139033180069942`*^9, 3.41390332309116*^9}, {3.413903471689744*^9, 
   3.4139034758767776`*^9}, {3.413904038061068*^9, 3.4139040413677464`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorEnergyFn", " ", "=", "  ", 
  RowBox[{"ka", "  ", 
   RowBox[{"(", "anchorDeviation", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.413903193205619*^9, 3.413903194259962*^9}, 3.413904044615448*^9, 
   3.414009238387752*^9, 3.416871858821822*^9, 3.4168720341302967`*^9}],

Cell[BoxData[
 RowBox[{"ka", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.619557895970714*^9, 3.70265424444268*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "bx", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{3.413903342754142*^9, 3.4139034818315573`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]], "Output",
 CellChangeTimes->{3.61955789601539*^9, 3.7026542445017433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 3.401714291927002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, 3.41390319489956*^9, {3.413903336781911*^9, 
   3.4139033375178556`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(ka);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(xa);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(ya);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(za);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}, {3.413903195586742*^9, 3.413903197762012*^9}, {
  3.4139032725347033`*^9, 3.4139032733978243`*^9}, {3.413903365080594*^9, 
  3.413903400308832*^9}, {3.413903434469326*^9, 3.413903453516231*^9}, {
  3.414020790309948*^9, 3.4140208145575933`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "anchorVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<ANCHOR_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"anchorSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4139031985252733`*^9, 3.41390319966262*^9}, 
   3.413903273923324*^9, {3.41402126078249*^9, 3.414021262410028*^9}}],

Cell[BoxData["\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557896104176*^9, 3.702654244640542*^9}],

Cell[BoxData["\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557896104176*^9, 3.702654244641432*^9}],

Cell[BoxData["\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557896104176*^9, 3.702654244642146*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.413903199910615*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ka);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(xa);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ya);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(za);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195578961563883`*^9, 3.702654244700347*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anchorOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"AnchorDeviation", ",", "anchorDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "anchorEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<ANCHOR_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 3.411152028421866*^9}, {3.413903200311384*^9, 
   3.413903202186616*^9}, {3.4139032744344463`*^9, 3.413903295296754*^9}, {
   3.4140207972347403`*^9, 3.4140207987706137`*^9}}]
}, Open  ]],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 3.408559038294833*^9}}],

Cell[CellGroupData[{

Cell[BoxData["anchorEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.413903202602512*^9}],

Cell[BoxData[
 RowBox[{"ka", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6195578962098007`*^9, 3.702654244775423*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"anchorHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.413903202921104*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557896235428*^9, 3.702654244832032*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.413903203137519*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<ANCHOR_RESTRAINT\>\"", ",", "anchorForceHessianRules", ",", 
    "anchorOutputs", ",", "anchorHessian", ",", "anchorEnergyFn", ",", 
    "anchorVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.413903203356204*^9, 3.4139032050483017`*^9}, 
   3.413903275122141*^9, {3.414021270983808*^9, 3.414021272512858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 3.4139032057904243`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"5", "8", "9", "0", "0", "0"},
     {"8", "6", "10", "0", "0", "0"},
     {"9", "10", "7", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195578966966763`*^9, 3.7026542457761507`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["anchorOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4139032064409513`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "dhx1x1", ",", "dhy1y1", 
   ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", ",", "ohy1z1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557896721417*^9, 3.7026542458344584`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 3.401714390085981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "anchorSetupRules", ",", "\[IndentingNewLine]", "anchorEnergyRules", ",", 
     "\[IndentingNewLine]", "anchorForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.4139032071864157`*^9, 3.413903208348619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "anchorAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.41390320889892*^9, 3.413903209224545*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 3.411210898002816*^9}, 
   3.413903209717396*^9, {3.4139040641107597`*^9, 3.413904066184003*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ka);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(xa);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ya);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(za);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z1", "-", "za"}], ")"}], "2"]}], "\[Rule]", 
        "AnchorDeviation"}]},
      {
       RowBox[{
        RowBox[{"ka", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}], "\[Rule]", 
        "Energy"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_FORCE //[\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka", " ", 
         RowBox[{"(", 
          RowBox[{"x1", "-", "xa"}], ")"}]}], "\[Rule]", "gx1"}]},
      {
       RowBox[{
        RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka", " ", 
         RowBox[{"(", 
          RowBox[{"y1", "-", "ya"}], ")"}]}], "\[Rule]", "gy1"}]},
      {
       RowBox[{
        RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka", " ", 
         RowBox[{"(", 
          RowBox[{"z1", "-", "za"}], ")"}]}], "\[Rule]", "gz1"}]},
      {
       RowBox[{
        RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka"}], "\[Rule]", "dhx1x1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka"}], "\[Rule]", "dhy1y1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka"}], "\[Rule]", "dhz1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}]},
      {
       RowBox[{"0", "\[Rule]", "ohx1y1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
1, ohx1y1);\"\>", "]"}]},
      {
       RowBox[{"0", "\[Rule]", "ohx1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
2, ohx1z1);\"\>", "]"}]},
      {
       RowBox[{"0", "\[Rule]", "ohy1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, \
2, ohy1z1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN \
]*/\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_FORCE ]*/\"\>", 
        "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557896789295*^9, 3.702654246027568*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "xa", ",", "ya", ",", "za", ",", "ka"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.413903210219502*^9, {
   3.413903523135522*^9, 3.4139035304924097`*^9}, {3.414009254249028*^9, 
   3.4140092544270477`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorOutputs", ",", "AnchorDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 3.411152052756624*^9}, 
   3.413903210688085*^9, 3.413903296414403*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<AnchorRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "anchorHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "anchorRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "anchorInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "anchorOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9, {3.4139032111233997`*^9, 3.413903213486709*^9}, 
   3.413903298323092*^9, 3.413903540538962*^9, {3.4140187475989857`*^9, 
   3.41401874899977*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "anchorPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 3.4110670621890917`*^9, 
   3.413903214952401*^9}],

Cell["\<\
anchorPack = Block[{PrintTemporary = Print}, packOptimize[anchorPack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.413903215882161*^9, 
   3.4139032166104527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "anchorPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}, {3.4139032174258947`*^9, 3.413903217685163*^9}}]
}, Open  ]],

Cell["\<\
Ignore errors in packGraph[anchorPack], I forget what it doesn't like but it \
is something non-essential\
\>", "Text",
 CellChangeTimes->{{3.416873887395665*^9, 3.4168738997477922`*^9}, {
  3.416873947718832*^9, 3.416873957966881*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "anchorPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 3.413903219466408*^9}],

Cell[BoxData[
 RowBox[{"packGraph", "[", 
  RowBox[{"packOptimize", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\<\"AnchorRestraint\"\>"}], ",", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\<\"\"\>"}], ",", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     RowBox[{"HessianStructure", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "8", ",", "9", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "6", ",", "10", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9", ",", "10", ",", "7", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"Rules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ka);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(xa);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ya);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(za);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "za"}], ")"}], "2"]}], "\[Rule]", 
         "AnchorDeviation"}], ",", 
        RowBox[{
         RowBox[{"ka", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}], "\[Rule]", 
         "Energy"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_FORCE //[\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka", " ", 
          RowBox[{"(", 
           RowBox[{"x1", "-", "xa"}], ")"}]}], "\[Rule]", "gx1"}], ",", 
        RowBox[{
         RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka", " ", 
          RowBox[{"(", 
           RowBox[{"y1", "-", "ya"}], ")"}]}], "\[Rule]", "gy1"}], ",", 
        RowBox[{
         RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka", " ", 
          RowBox[{"(", 
           RowBox[{"z1", "-", "za"}], ")"}]}], "\[Rule]", "gz1"}], ",", 
        RowBox[{
         RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"2", " ", "ka"}], "\[Rule]", "dhx1x1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka"}], "\[Rule]", "dhy1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka"}], "\[Rule]", "dhz1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\"\>",
          "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], ",", 
        RowBox[{"0", "\[Rule]", "ohx1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 1, ohx1y1);\"\>", "]"}], ",", 
        RowBox[{"0", "\[Rule]", "ohx1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 2, ohx1z1);\"\>", "]"}], ",", 
        RowBox[{"0", "\[Rule]", "ohy1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 2, ohy1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\
\>", "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_FORCE ]*/\"\>", 
         "]"}]}], "}"}]}], ",", 
     RowBox[{"Input", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "xa", ",", "ya", ",", "za", ",", 
        "ka"}], "}"}]}], ",", 
     RowBox[{"Output", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "dhx1x1", ",", 
        "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", ",", "ohy1z1", 
        ",", "AnchorDeviation"}], "}"}]}]}], "}"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.619557898358202*^9, 3.702654246279891*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Fixed non-bonding terms
\t- Van der Waals and Electrostatic interactions with atoms that are fixed in \
space.
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 3.402672664963516*^9}, {
  3.4868991702894497`*^9, 3.4868991807145767`*^9}, {3.494844072016407*^9, 
  3.494844075959107*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", " ", 
    "evdw", ",", " ", "eeel", ",", "fixedNonBondEquation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
   3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
   3.402741179258795*^9}, {3.486899212216976*^9, 3.4868992150663013`*^9}, 
   3.486899587515778*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xf", ",", " ", "yf", ",", " ", "zf"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 3.402652572153042*^9}, {3.4868992274659967`*^9, 
  3.4868992304790297`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "dA", ",", "dC", ",", "dQ1Q2"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 3.4111751886209507`*^9}, {
   3.486900028093594*^9, 3.4869000289927797`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", "dA", ",",
    "dC", ",", "dQ1Q2"}], "}"}]], "Output",
 CellChangeTimes->{3.619557898437707*^9, 3.7026542463777514`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondDistance", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
   3.411197578518401*^9, 3.411197589788989*^9}, 3.486899591964513*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"efvdwEquation", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["dA", 
     SuperscriptBox["fixedNonBondDistance", "12"]], "-", 
    FractionBox["dC", 
     SuperscriptBox["fixedNonBondDistance", "6"]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 3.416871995722517*^9, {
   3.486899247667407*^9, 3.4868992682932787`*^9}, {3.4868995931240263`*^9, 
   3.486899593780075*^9}, 3.48689979376054*^9, {3.4868998240834837`*^9, 
   3.4868998427714367`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{3.619557898511396*^9, 3.702654246489319*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"efeelEquation", " ", "=", " ", 
  RowBox[{"(", 
   FractionBox["dQ1Q2", "fixedNonBondDistance"], ")"}]}]], "Input",
 CellChangeTimes->{{3.4026534322622623`*^9, 3.402653496407857*^9}, {
   3.4026535524322023`*^9, 3.402653641591628*^9}, {3.4026779483394947`*^9, 
   3.402677953362184*^9}, {3.4026781314714537`*^9, 3.4026781348802843`*^9}, {
   3.40274101413416*^9, 3.402741050316153*^9}, {3.407556736609376*^9, 
   3.4075567425681257`*^9}, {3.407557208386277*^9, 3.407557225106896*^9}, {
   3.408662115934063*^9, 3.408662119317389*^9}, 3.411081885331176*^9, {
   3.411197627982712*^9, 3.411197630382259*^9}, 3.416871999453731*^9, {
   3.486899263067898*^9, 3.486899266017837*^9}, 3.486899595492217*^9, 
   3.486899792235376*^9, 3.4868998451487417`*^9, 3.4868998890096083`*^9}],

Cell[BoxData[
 FractionBox["dQ1Q2", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]]], "Output",
 CellChangeTimes->{3.619557898569434*^9, 3.702654246552062*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondEquation", " ", "=", " ", 
  RowBox[{"efvdwEquation", " ", "+", " ", "efeelEquation"}]}]], "Input",
 CellChangeTimes->{{3.4027412120076227`*^9, 3.402741220906414*^9}, {
   3.4086620876703787`*^9, 3.408662102195766*^9}, 3.486899597487871*^9, {
   3.486899797160198*^9, 3.486899798372685*^9}, {3.486899829491583*^9, 
   3.4868998481540203`*^9}, 3.486899889928892*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]], "+", 
  FractionBox["dQ1Q2", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]]}]], "Output",
 CellChangeTimes->{3.619557898598501*^9, 3.7026542466421556`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "ba", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{3.486899549784584*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]], "Output",
 CellChangeTimes->{3.619557898620987*^9, 3.702654246821478*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 3.401714933019302*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, {3.408564450747929*^9, 3.408564451541582*^9}, {
   3.486899474762479*^9, 3.486899475750346*^9}, 3.486899598225782*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixedNonBondSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(xf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(yf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(zf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dQ1Q2);\>\"", "]"}]}], "]"}],
   ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dA);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dC);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
   3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
   3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
   3.486899598988052*^9, 3.48689960053936*^9}, {3.486899642233687*^9, 
   3.486899655633342*^9}, 3.4868997620139523`*^9, {3.4869001020979548`*^9, 
   3.486900107535079*^9}, {3.487026123015799*^9, 3.487026151511093*^9}, {
   3.487026191456916*^9, 3.487026218196006*^9}, {3.48702895046251*^9, 
   3.487028956387195*^9}, {3.4872610348815603`*^9, 3.487261040187768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "fixedNonBondVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<FNONBOND_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"fixedNonBondSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
   3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4868996013404512`*^9, 
   3.4868996039384813`*^9}, 3.486900098021953*^9}],

Cell[BoxData["\<\"FNONBOND_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557898723919*^9, 3.7026542469379883`*^9}],

Cell[BoxData["\<\"FNONBOND_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557898723919*^9, 3.702654246938787*^9}],

Cell[BoxData["\<\"FNONBOND_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557898723919*^9, 3.7026542469394283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 3.486899605018564*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(xf);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(yf);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(zf);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dA);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dC);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"FNONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"FNONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"FNONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557898753703*^9, 3.7026542469995317`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixedNonBondEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fixedNonBondOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"NonbondDistance", ",", "fixedNonBondDistance"}], "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Efvdw", ",", "efvdwEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND_EFVDW\>\"", ",", "Efvdw"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Efeel", ",", "efeelEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND_EFEEL\>\"", ",", "Efeel"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", 
      RowBox[{"Efvdw", "+", "Efeel"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Efvdw"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Efeel"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}, {3.4868996061093397`*^9, 3.4868996113673363`*^9}, 
   3.486899830710224*^9, {3.486899890910192*^9, 3.48689995929298*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 3.409334145792842*^9}, 
   3.486899612009248*^9, {3.4868999652909813`*^9, 3.486899969952155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557898799706*^9, 3.702654247247113*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 3.410177986821323*^9}, 
   3.486899612569351*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<FNONBOND\>\"", ",", "fixedNonBondForceHessianRules", ",", 
    "fixedNonBondOutputs", ",", "fixedNonBondHessian", ",", 
    "fixedNonBondEquation", ",", "fixedNonBondVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
   3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
   3.410177993430345*^9}, {3.486899613226053*^9, 3.486899615580276*^9}, 
   3.486899978015726*^9}],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 3.4017149467691317`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"fixedNonBondOutputs", ",", "fixedNonbondDistance"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
   3.4111976578180523`*^9, 3.411197662226531*^9}, 3.486899616345285*^9, {
   3.486899992027813*^9, 3.486899992728018*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "Efvdw", ",", "Efeel", ",", "fx1", ",", "fy1", ",", "fz1", 
   ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", 
   ",", "ohy1z1", ",", "fixedNonbondDistance"}], "}"}]], "Output",
 CellChangeTimes->{3.619557899210888*^9, 3.7026542506937523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9, 3.486899617019046*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Energy", ",", "Efvdw", ",", "Efeel", ",", "fx1", ",", "fy1", ",", "fz1", 
     ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", ",", 
     "ohx1z1", ",", "ohy1z1", ",", "fixedNonbondDistance"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.6195578992368727`*^9, 3.7026542507493057`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "fixedNonBondSetupRules", ",", "fixedNonBondEnergyRules", ",", 
      "fixedNonBondForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 3.410178019066489*^9}, {
  3.486899617618881*^9, 3.4868996194608173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fnbPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<FixedNonbond\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "fixedNonBondEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "fixedNonBondHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "fixedNonBondRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "fixedNonBondInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "fixedNonBondOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9, {3.486899620515873*^9, 3.486899622563909*^9}, {
   3.48690000448034*^9, 3.4869000046048727`*^9}, {3.486900045658348*^9, 
   3.4869000846709013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "fnbPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 3.4110670742215853`*^9, 3.4869000687187243`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "fnbPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 3.411066673303035*^9, 
   3.486900070218787*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "nbPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 3.4055995100170727`*^9}}],

Cell[BoxData[
 RowBox[{"packGraph", "[", 
  RowBox[{"packOptimize", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\<\"FixedNonbond\"\>"}], ",", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\<\"\"\>"}], ",", 
     RowBox[{"EnergyFunction", "\[Rule]", 
      RowBox[{
       FractionBox["dA", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
       FractionBox["dC", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]], "+", 
       FractionBox["dQ1Q2", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]]}]}], ",", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     RowBox[{"HessianStructure", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "10", ",", "11", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "8", ",", "12", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "12", ",", "9", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"Rules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(xf);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(yf);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(zf);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(I1);\"\>", "]"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dA);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dC);\"\>", "]"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}], ",", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]], "\[Rule]", 
         "NonbondDistance"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["dA", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
          FractionBox["dC", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]]}], 
         "\[Rule]", "Efvdw"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_EFVDW_ENERGY_ACCUMULATE(Efvdw);\"\>", 
         "]"}], ",", 
        RowBox[{
         FractionBox["dQ1Q2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]], "\[Rule]", 
         "Efeel"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_EFEEL_ENERGY_ACCUMULATE(Efeel);\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{"Efeel", "+", "Efvdw"}], "\[Rule]", "Energy"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_ENERGY_ACCUMULATE(Energy);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"#ifdef FNONBOND_CALC_FORCE //[\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gx1"}], ",", 
        RowBox[{
         RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gy1"}], ",", 
        RowBox[{
         RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gz1"}], ",", 
        RowBox[{
         RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef FNONBOND_CALC_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhx1x1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhy1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "+", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "dhz1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef FNONBOND_CALC_OFF_DIAGONAL_HESSIAN //[\"\>",
          "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* FNONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* FNONBOND_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* FNONBOND_CALC_FORCE ]*/\"\>", "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"Input", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", "dA",
         ",", "dC", ",", "dQ1Q2"}], "}"}]}], ",", 
     RowBox[{"Output", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Energy", ",", "Efvdw", ",", "Efeel", ",", "fx1", ",", "fy1", ",", 
        "fz1", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", 
        ",", "ohx1z1", ",", "ohy1z1", ",", "fixedNonbondDistance"}], 
       "}"}]}]}], "}"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.619557903681158*^9, 3.7026542512962523`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowToolbars->"RulerBar",
Evaluator->"Local",
CellGrouping->Manual,
WindowSize->{1003, 818},
WindowMargins->{{3, Automatic}, {60, Automatic}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 210, 5, 99, "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[802, 31, 222, 4, 61, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1027, 37, 303, 4, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1367, 46, 504, 8, 61, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1874, 56, 302, 4, 36, "Output"]
}, Open  ]],
Cell[2191, 63, 92, 1, 35, "Input"],
Cell[2286, 66, 215, 3, 62, "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2504, 71, 152, 2, 61, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2693, 78, 236, 5, 135, "Subtitle"],
Cell[2932, 85, 216, 5, 36, "Input"],
Cell[3151, 92, 392, 11, 57, "Input"],
Cell[3546, 105, 133, 1, 54, "Subsection"],
Cell[3682, 108, 410, 12, 27, "Input"],
Cell[CellGroupData[{
Cell[4117, 124, 595, 10, 36, "Input"],
Cell[4715, 136, 740, 23, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5492, 164, 148, 4, 35, "Input"],
Cell[5643, 170, 306, 6, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5986, 181, 181, 2, 54, "Subsection"],
Cell[6170, 185, 994, 25, 183, "Input"],
Cell[7167, 212, 1044, 26, 120, "Input"],
Cell[CellGroupData[{
Cell[8236, 242, 1438, 34, 162, "Input"],
Cell[9677, 278, 250, 3, 27, "Print"],
Cell[9930, 283, 250, 3, 27, "Print"],
Cell[10183, 288, 248, 3, 27, "Print"],
Cell[10434, 293, 248, 3, 27, "Print"],
Cell[10685, 298, 250, 3, 27, "Print"],
Cell[10938, 303, 250, 3, 27, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11225, 311, 191, 3, 35, "Input"],
Cell[11419, 316, 1637, 40, 248, "Output"]
}, Open  ]],
Cell[13071, 359, 1904, 40, 141, "Input"]
}, Open  ]],
Cell[14990, 402, 224, 3, 54, "Subsection"],
Cell[CellGroupData[{
Cell[15239, 409, 111, 1, 28, "Input"],
Cell[15353, 412, 733, 23, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16123, 440, 377, 11, 35, "Input"],
Cell[16503, 453, 955, 24, 160, "Output"]
}, Open  ]],
Cell[17473, 480, 187, 4, 35, "Input"],
Cell[17663, 486, 436, 9, 57, "Input"],
Cell[CellGroupData[{
Cell[18124, 499, 190, 3, 35, "Input"],
Cell[18317, 504, 991, 24, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19345, 533, 106, 1, 35, "Input"],
Cell[19454, 536, 660, 11, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20151, 552, 123, 1, 54, "Subsection"],
Cell[20277, 555, 422, 9, 99, "Input"],
Cell[20702, 566, 205, 4, 35, "Input"],
Cell[CellGroupData[{
Cell[20932, 574, 104, 1, 35, "Input"],
Cell[21039, 577, 66509, 2105, 5091, "Output"]
}, Open  ]],
Cell[87563, 2685, 335, 8, 36, "Input"],
Cell[87901, 2695, 197, 4, 35, "Input"],
Cell[88101, 2701, 250, 4, 85, "Subsection"],
Cell[88354, 2707, 1771, 31, 196, "Input"],
Cell[CellGroupData[{
Cell[90150, 2742, 257, 5, 36, "Input"],
Cell[90410, 2749, 416, 9, 27, "Print"],
Cell[90829, 2760, 394, 8, 27, "Print"],
Cell[91226, 2770, 392, 8, 27, "Print"],
Cell[91621, 2780, 386, 8, 27, "Print"]
}, Open  ]],
Cell[92022, 2791, 434, 7, 37, "Text"],
Cell[92459, 2800, 139, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[92623, 2805, 526, 9, 27, "Input"],
Cell[93152, 2816, 466, 12, 79, "Print"],
Cell[93621, 2830, 408, 11, 35, "Print"],
Cell[94032, 2843, 407, 11, 35, "Print"],
Cell[94442, 2856, 165, 2, 26, "Print"],
Cell[94610, 2860, 168, 2, 26, "Print"],
Cell[94781, 2864, 396, 5, 65, "Print"],
Cell[95180, 2871, 171, 2, 26, "Print"],
Cell[95354, 2875, 160, 2, 26, "Print"],
Cell[95517, 2879, 924, 16, 92, "Message"],
Cell[96444, 2897, 165, 2, 26, "Print"],
Cell[96612, 2901, 168, 2, 26, "Print"],
Cell[96783, 2905, 396, 5, 65, "Print"],
Cell[97182, 2912, 171, 2, 26, "Print"],
Cell[97356, 2916, 165, 2, 26, "Print"],
Cell[97524, 2920, 168, 2, 26, "Print"],
Cell[97695, 2924, 398, 5, 65, "Print"],
Cell[98096, 2931, 171, 2, 26, "Print"],
Cell[98270, 2935, 165, 2, 26, "Print"],
Cell[98438, 2939, 210, 3, 26, "Print"],
Cell[98651, 2944, 396, 5, 65, "Print"],
Cell[99050, 2951, 226, 3, 103, "Print"],
Cell[99279, 2956, 5468, 83, 5010, "Print"],
Cell[104750, 3041, 210, 3, 26, "Print"],
Cell[104963, 3046, 396, 5, 65, "Print"],
Cell[105362, 3053, 227, 3, 103, "Print"],
Cell[105592, 3058, 5472, 79, 5504, "Print"],
Cell[111067, 3139, 165, 2, 26, "Print"],
Cell[111235, 3143, 210, 3, 26, "Print"],
Cell[111448, 3148, 396, 5, 65, "Print"],
Cell[111847, 3155, 227, 3, 103, "Print"],
Cell[112077, 3160, 5475, 79, 5504, "Print"],
Cell[117555, 3241, 210, 3, 26, "Print"],
Cell[117768, 3246, 398, 5, 65, "Print"],
Cell[118169, 3253, 226, 3, 103, "Print"],
Cell[118398, 3258, 5473, 79, 5504, "Print"],
Cell[123874, 3339, 358, 7, 27, "Print"],
Cell[124235, 3348, 344, 7, 27, "Print"]
}, {32}]]
}, Open  ]],
Cell[124604, 3359, 671, 12, 206, "Subsection"],
Cell[CellGroupData[{
Cell[125300, 3375, 185, 3, 27, "Input"],
Cell[125488, 3380, 24654, 442, 245, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150191, 3828, 214, 6, 62, "Subtitle"],
Cell[150408, 3836, 363, 8, 36, "Input"],
Cell[150774, 3846, 606, 17, 78, "Input"],
Cell[CellGroupData[{
Cell[151405, 3867, 396, 9, 36, "Input"],
Cell[151804, 3878, 244, 5, 36, "Output"]
}, Open  ]],
Cell[152063, 3886, 203, 6, 36, "Input"],
Cell[CellGroupData[{
Cell[152291, 3896, 949, 23, 99, "Input"],
Cell[153243, 3921, 1466, 51, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154746, 3977, 440, 8, 36, "Input"],
Cell[155189, 3987, 146, 3, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155372, 3995, 246, 5, 36, "Input"],
Cell[155621, 4002, 1687, 54, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157345, 4061, 276, 6, 35, "Input"],
Cell[157624, 4069, 222, 5, 36, "Output"]
}, Open  ]],
Cell[157861, 4077, 98, 1, 54, "Subsection"],
Cell[157962, 4080, 1380, 34, 238, "Input"],
Cell[159345, 4116, 1256, 31, 141, "Input"],
Cell[CellGroupData[{
Cell[160626, 4151, 1472, 34, 162, "Input"],
Cell[162101, 4187, 128, 1, 27, "Print"],
Cell[162232, 4190, 128, 1, 27, "Print"],
Cell[162363, 4193, 126, 1, 27, "Print"],
Cell[162492, 4196, 126, 1, 27, "Print"],
Cell[162621, 4199, 126, 1, 27, "Print"],
Cell[162750, 4202, 128, 1, 27, "Print"],
Cell[162881, 4205, 126, 1, 27, "Print"],
Cell[163010, 4208, 128, 1, 27, "Print"],
Cell[163141, 4211, 126, 1, 27, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163304, 4217, 212, 3, 36, "Input"],
Cell[163519, 4222, 1835, 46, 336, "Output"]
}, Open  ]],
Cell[165369, 4271, 175, 4, 36, "Input"],
Cell[CellGroupData[{
Cell[165569, 4279, 302, 8, 36, "Input"],
Cell[165874, 4289, 1377, 39, 78, "Output"]
}, Open  ]],
Cell[167266, 4331, 2900, 62, 225, "Input"],
Cell[170169, 4395, 441, 10, 78, "Input"],
Cell[CellGroupData[{
Cell[170635, 4409, 109, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[170769, 4414, 116, 2, 36, "Input"],
Cell[170888, 4418, 92, 1, 35, "Output"]
}, Open  ]],
Cell[170995, 4422, 311, 8, 36, "Input"],
Cell[171309, 4432, 242, 5, 36, "Input"],
Cell[CellGroupData[{
Cell[171576, 4441, 182, 3, 36, "Input"],
Cell[171761, 4446, 1143, 21, 134, "Output"]
}, Open  ]],
Cell[172919, 4470, 1596, 29, 225, "Input"],
Cell[174518, 4501, 255, 5, 36, "Input"],
Cell[174776, 4508, 374, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[175175, 4519, 136, 2, 36, "Input"],
Cell[175314, 4523, 5477, 142, 221, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180852, 4672, 286, 6, 171, "Subtitle"],
Cell[181141, 4680, 385, 8, 45, "Input"],
Cell[181529, 4690, 441, 12, 71, "Input"],
Cell[CellGroupData[{
Cell[181995, 4706, 481, 9, 45, "Input"],
Cell[182479, 4717, 230, 5, 70, "Output"]
}, Open  ]],
Cell[182724, 4725, 412, 11, 45, "Input"],
Cell[CellGroupData[{
Cell[183161, 4740, 605, 12, 75, "Input"],
Cell[183769, 4754, 854, 28, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184660, 4787, 646, 10, 75, "Input"],
Cell[185309, 4799, 404, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185750, 4817, 247, 4, 45, "Input"],
Cell[186000, 4823, 1189, 40, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187226, 4868, 148, 4, 43, "Input"],
Cell[187377, 4874, 185, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187599, 4883, 94, 1, 67, "Subsection"],
Cell[187696, 4886, 1040, 25, 228, "Input"],
Cell[188739, 4913, 1383, 31, 202, "Input"],
Cell[CellGroupData[{
Cell[190147, 4948, 1535, 35, 176, "Input"],
Cell[191685, 4985, 128, 1, 70, "Print"],
Cell[191816, 4988, 128, 1, 70, "Print"],
Cell[191947, 4991, 128, 1, 70, "Print"],
Cell[192078, 4994, 128, 1, 70, "Print"],
Cell[192209, 4997, 128, 1, 70, "Print"],
Cell[192340, 5000, 130, 1, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192507, 5006, 240, 4, 45, "Input"],
Cell[192750, 5012, 1604, 40, 70, "Output"]
}, Open  ]],
Cell[194369, 5055, 3048, 74, 333, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197454, 5134, 308, 8, 51, "Input"],
Cell[197765, 5144, 734, 21, 70, "Output"]
}, Open  ]],
Cell[198514, 5168, 184, 4, 51, "Input"],
Cell[198701, 5174, 436, 9, 82, "Input"],
Cell[CellGroupData[{
Cell[199162, 5187, 111, 1, 65, "Subsection"],
Cell[CellGroupData[{
Cell[199298, 5192, 230, 4, 51, "Input"],
Cell[199531, 5198, 597, 10, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200165, 5213, 164, 3, 51, "Input"],
Cell[200332, 5218, 743, 16, 70, "Output"]
}, Open  ]],
Cell[201090, 5237, 321, 8, 51, "Input"],
Cell[201414, 5247, 1574, 30, 320, "Input"],
Cell[202991, 5279, 304, 6, 51, "Input"],
Cell[CellGroupData[{
Cell[203320, 5289, 418, 7, 51, "Input"],
Cell[203741, 5298, 92, 1, 51, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203870, 5304, 137, 2, 51, "Input"],
Cell[204010, 5308, 81318, 2208, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[285389, 7523, 129, 2, 62, "Subtitle"],
Cell[CellGroupData[{
Cell[285543, 7529, 136, 2, 62, "Subtitle"],
Cell[285682, 7533, 399, 8, 51, "Input"],
Cell[286084, 7543, 1147, 31, 171, "Input"],
Cell[287234, 7576, 245, 7, 51, "Input"],
Cell[287482, 7585, 589, 13, 112, "Input"],
Cell[288074, 7600, 353, 7, 51, "Input"],
Cell[288430, 7609, 274, 7, 51, "Input"],
Cell[288707, 7618, 297, 7, 82, "Input"],
Cell[289007, 7627, 331, 7, 82, "Input"],
Cell[289341, 7636, 2111, 46, 438, "Input"],
Cell[291455, 7684, 2080, 52, 320, "Input"],
Cell[CellGroupData[{
Cell[293560, 7740, 1594, 36, 201, "Input"],
Cell[295157, 7778, 128, 1, 70, "Print"],
Cell[295288, 7781, 128, 1, 70, "Print"],
Cell[295419, 7784, 128, 1, 70, "Print"],
Cell[295550, 7787, 130, 1, 70, "Print"],
Cell[295683, 7790, 127, 1, 70, "Print"],
Cell[295813, 7793, 128, 1, 70, "Print"],
Cell[295944, 7796, 127, 1, 70, "Print"],
Cell[296074, 7799, 128, 1, 70, "Print"],
Cell[296205, 7802, 130, 1, 70, "Print"],
Cell[296338, 7805, 130, 1, 70, "Print"],
Cell[296471, 7808, 127, 1, 70, "Print"],
Cell[296601, 7811, 130, 1, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296768, 7817, 265, 4, 51, "Input"],
Cell[297036, 7823, 2504, 62, 70, "Output"]
}, Open  ]],
Cell[299555, 7888, 114, 3, 51, "Input"],
Cell[299672, 7893, 950, 24, 141, "Input"],
Cell[300625, 7919, 850, 18, 82, "Input"],
Cell[301478, 7939, 255, 5, 51, "Input"],
Cell[301736, 7946, 367, 8, 51, "Input"],
Cell[302106, 7956, 857, 18, 82, "Input"],
Cell[302966, 7976, 707, 16, 82, "Input"],
Cell[303676, 7994, 588, 13, 82, "Input"],
Cell[304267, 8009, 445, 10, 51, "Input"],
Cell[304715, 8021, 396, 5, 50, "Text"],
Cell[305114, 8028, 325, 6, 50, "Text"],
Cell[305442, 8036, 384, 6, 78, "Text"],
Cell[305829, 8044, 184, 4, 51, "Input"],
Cell[306016, 8050, 992, 20, 82, "Input"],
Cell[307011, 8072, 937, 22, 201, "Input"],
Cell[307951, 8096, 520, 11, 51, "Input"],
Cell[308474, 8109, 279, 7, 166, "Text"],
Cell[308756, 8118, 728, 15, 82, "Input"],
Cell[309487, 8135, 304, 7, 51, "Input"],
Cell[CellGroupData[{
Cell[309816, 8146, 309, 5, 51, "Input"],
Cell[310128, 8153, 297, 6, 70, "Output"]
}, Open  ]],
Cell[310440, 8162, 673, 10, 50, "Text"],
Cell[311116, 8174, 1248, 29, 171, "Input"],
Cell[CellGroupData[{
Cell[312389, 8207, 474, 11, 51, "Input"],
Cell[312866, 8220, 325, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313228, 8231, 283, 6, 51, "Input"],
Cell[313514, 8239, 299, 6, 70, "Output"]
}, Open  ]],
Cell[313828, 8248, 619, 11, 51, "Input"],
Cell[CellGroupData[{
Cell[314472, 8263, 163, 3, 51, "Input"],
Cell[314638, 8268, 111, 2, 70, "Output"]
}, Open  ]],
Cell[314764, 8273, 452, 10, 51, "Input"],
Cell[315219, 8285, 577, 13, 85, "Input"],
Cell[315799, 8300, 1047, 29, 88, "Input"],
Cell[316849, 8331, 1015, 27, 88, "Input"],
Cell[317867, 8360, 477, 11, 85, "Input"],
Cell[318347, 8373, 216, 5, 51, "Input"],
Cell[318566, 8380, 4496, 93, 558, "Code"],
Cell[323065, 8475, 2141, 51, 351, "Code"],
Cell[CellGroupData[{
Cell[325231, 8530, 688, 12, 82, "Input"],
Cell[325922, 8544, 288, 6, 70, "Print"],
Cell[326213, 8552, 289, 6, 70, "Print"],
Cell[326505, 8560, 291, 6, 70, "Print"],
Cell[326799, 8568, 289, 6, 70, "Print"],
Cell[327091, 8576, 288, 6, 70, "Print"],
Cell[327382, 8584, 289, 6, 70, "Print"],
Cell[327674, 8592, 291, 6, 70, "Print"],
Cell[327968, 8600, 289, 6, 70, "Print"],
Cell[328260, 8608, 291, 6, 70, "Print"],
Cell[328554, 8616, 289, 6, 70, "Print"],
Cell[328846, 8624, 289, 6, 70, "Print"],
Cell[329138, 8632, 291, 6, 70, "Print"]
}, Open  ]],
Cell[329444, 8641, 174, 3, 47, "Subsubsection"],
Cell[CellGroupData[{
Cell[329643, 8648, 129, 2, 38, "Input"],
Cell[329775, 8652, 97, 1, 70, "Output"]
}, Open  ]],
Cell[329887, 8656, 127, 1, 128, "Section"],
Cell[330017, 8659, 283, 7, 70, "Code"],
Cell[330303, 8668, 3294, 75, 410, "Code"],
Cell[333600, 8745, 798, 18, 172, "Code"],
Cell[334401, 8765, 2253, 56, 320, "Input"],
Cell[336657, 8823, 357, 10, 51, "Input"],
Cell[CellGroupData[{
Cell[337039, 8837, 162, 3, 51, "Input"],
Cell[337204, 8842, 1083, 25, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338324, 8872, 1172, 33, 152, "Input"],
Cell[339499, 8907, 507, 9, 70, "Print"],
Cell[340009, 8918, 507, 9, 70, "Print"],
Cell[340519, 8929, 507, 9, 70, "Print"],
Cell[341029, 8940, 509, 9, 70, "Print"],
Cell[341541, 8951, 507, 9, 70, "Print"],
Cell[342051, 8962, 507, 9, 70, "Print"],
Cell[342561, 8973, 507, 9, 70, "Print"],
Cell[343071, 8984, 507, 9, 70, "Print"],
Cell[343581, 8995, 507, 9, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344125, 9009, 246, 6, 82, "Input"],
Cell[344374, 9017, 155, 3, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344566, 9025, 1122, 33, 152, "Input"],
Cell[345691, 9060, 509, 9, 70, "Print"],
Cell[346203, 9071, 507, 9, 70, "Print"],
Cell[346713, 9082, 507, 9, 70, "Print"],
Cell[347223, 9093, 509, 9, 70, "Print"],
Cell[347735, 9104, 509, 9, 70, "Print"],
Cell[348247, 9115, 506, 9, 70, "Print"],
Cell[348756, 9126, 507, 9, 70, "Print"],
Cell[349266, 9137, 507, 9, 70, "Print"],
Cell[349776, 9148, 506, 9, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350319, 9162, 1659, 47, 213, "Input"],
Cell[351981, 9211, 507, 9, 70, "Print"],
Cell[352491, 9222, 507, 9, 70, "Print"],
Cell[353001, 9233, 507, 9, 70, "Print"],
Cell[353511, 9244, 507, 9, 70, "Print"],
Cell[354021, 9255, 507, 9, 70, "Print"],
Cell[354531, 9266, 507, 9, 70, "Print"],
Cell[355041, 9277, 507, 9, 70, "Print"],
Cell[355551, 9288, 507, 9, 70, "Print"],
Cell[356061, 9299, 507, 9, 70, "Print"]
}, Open  ]],
Cell[356583, 9311, 187, 4, 47, "Subsubsection"],
Cell[CellGroupData[{
Cell[356795, 9319, 1482, 40, 241, "Input"],
Cell[358280, 9361, 506, 9, 70, "Print"],
Cell[358789, 9372, 508, 9, 70, "Print"],
Cell[359300, 9383, 508, 9, 70, "Print"],
Cell[359811, 9394, 506, 9, 70, "Print"],
Cell[360320, 9405, 508, 9, 70, "Print"],
Cell[360831, 9416, 506, 9, 70, "Print"],
Cell[361340, 9427, 506, 9, 70, "Print"],
Cell[361849, 9438, 506, 9, 70, "Print"],
Cell[362358, 9449, 506, 9, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362901, 9463, 530, 14, 82, "Input"],
Cell[CellGroupData[{
Cell[363456, 9481, 141, 3, 51, "Input"],
Cell[363600, 9486, 509, 9, 70, "Print"],
Cell[364112, 9497, 507, 9, 70, "Print"],
Cell[364622, 9508, 507, 9, 70, "Print"],
Cell[365132, 9519, 509, 9, 70, "Print"],
Cell[365644, 9530, 507, 9, 70, "Print"],
Cell[366154, 9541, 506, 9, 70, "Print"],
Cell[366663, 9552, 507, 9, 70, "Print"],
Cell[367173, 9563, 509, 9, 70, "Print"],
Cell[367685, 9574, 507, 9, 70, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[368241, 9589, 3402, 97, 371, "Input"],
Cell[CellGroupData[{
Cell[371668, 9690, 160, 4, 51, "Input"],
Cell[371831, 9696, 509, 9, 70, "Print"],
Cell[372343, 9707, 509, 9, 70, "Print"],
Cell[372855, 9718, 511, 9, 70, "Print"],
Cell[373369, 9729, 511, 9, 70, "Print"],
Cell[373883, 9740, 509, 9, 70, "Print"],
Cell[374395, 9751, 509, 9, 70, "Print"],
Cell[374907, 9762, 509, 9, 70, "Print"],
Cell[375419, 9773, 509, 9, 70, "Print"],
Cell[375931, 9784, 509, 9, 70, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[376489, 9799, 143, 2, 51, "Input"],
Cell[376635, 9803, 141, 3, 70, "Output"]
}, Open  ]],
Cell[376791, 9809, 176, 3, 47, "Subsubsection"],
Cell[CellGroupData[{
Cell[376992, 9816, 695, 17, 38, "Input"],
Cell[377690, 9835, 1418, 34, 70, "Output"]
}, Open  ]],
Cell[379123, 9872, 153, 2, 47, "Subsubsection"],
Cell[379279, 9876, 247, 5, 38, "Input"],
Cell[CellGroupData[{
Cell[379551, 9885, 190, 3, 51, "Input"],
Cell[379744, 9890, 138, 3, 70, "Output"]
}, Open  ]],
Cell[379897, 9896, 151, 2, 47, "Subsubsection"],
Cell[380051, 9900, 407, 9, 38, "Input"],
Cell[CellGroupData[{
Cell[380483, 9913, 187, 3, 51, "Input"],
Cell[380673, 9918, 139, 3, 70, "Output"]
}, Open  ]],
Cell[380827, 9924, 145, 1, 47, "Subsubsection"],
Cell[CellGroupData[{
Cell[380997, 9929, 168, 3, 38, "Input"],
Cell[381168, 9934, 1437, 37, 70, "Output"],
Cell[382608, 9973, 672, 12, 51, "Input"],
Cell[383283, 9987, 190, 4, 172, "Section"],
Cell[383476, 9993, 330, 8, 38, "Input"],
Cell[383809, 10003, 458, 12, 51, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[384304, 10020, 134, 2, 51, "Input"],
Cell[384441, 10024, 139, 3, 70, "Output"]
}, Open  ]],
Cell[384595, 10030, 138, 1, 47, "Subsubsection"],
Cell[384736, 10033, 789, 21, 422, "Text"],
Cell[385528, 10056, 125, 1, 47, "Subsubsection"],
Cell[385656, 10059, 4544, 97, 546, "Code"],
Cell[390203, 10158, 1345, 31, 232, "Code"],
Cell[CellGroupData[{
Cell[391573, 10193, 130, 2, 51, "Input"],
Cell[391706, 10197, 93, 1, 70, "Output"]
}, Open  ]],
Cell[391814, 10201, 457, 9, 108, "Text"],
Cell[CellGroupData[{
Cell[392296, 10214, 309, 8, 51, "Input"],
Cell[392608, 10224, 2161, 51, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[394806, 10280, 496, 10, 112, "Input"],
Cell[395305, 10292, 455, 9, 70, "Print"],
Cell[395763, 10303, 457, 9, 70, "Print"],
Cell[396223, 10314, 457, 9, 70, "Print"],
Cell[396683, 10325, 455, 9, 70, "Print"],
Cell[397141, 10336, 455, 9, 70, "Print"],
Cell[397599, 10347, 457, 9, 70, "Print"],
Cell[398059, 10358, 455, 9, 70, "Print"],
Cell[398517, 10369, 455, 9, 70, "Print"],
Cell[398975, 10380, 457, 9, 70, "Print"],
Cell[399435, 10391, 459, 9, 70, "Print"],
Cell[399897, 10402, 459, 9, 70, "Print"],
Cell[400359, 10413, 459, 9, 70, "Print"]
}, Open  ]],
Cell[400833, 10425, 127, 1, 47, "Subsubsection"],
Cell[400963, 10428, 1886, 44, 278, "Code"],
Cell[402852, 10474, 120, 2, 51, "Input"],
Cell[CellGroupData[{
Cell[402997, 10480, 503, 10, 112, "Input"],
Cell[403503, 10492, 453, 9, 70, "Print"],
Cell[403959, 10503, 455, 9, 70, "Print"],
Cell[404417, 10514, 453, 9, 70, "Print"],
Cell[404873, 10525, 453, 9, 70, "Print"],
Cell[405329, 10536, 453, 9, 70, "Print"],
Cell[405785, 10547, 453, 9, 70, "Print"],
Cell[406241, 10558, 453, 9, 70, "Print"],
Cell[406697, 10569, 453, 9, 70, "Print"],
Cell[407153, 10580, 455, 9, 70, "Print"],
Cell[407611, 10591, 455, 9, 70, "Print"],
Cell[408069, 10602, 455, 9, 70, "Print"],
Cell[408527, 10613, 453, 9, 70, "Print"],
Cell[408983, 10624, 453, 9, 70, "Print"],
Cell[409439, 10635, 455, 9, 70, "Print"],
Cell[409897, 10646, 453, 9, 70, "Print"],
Cell[410353, 10657, 453, 9, 70, "Print"],
Cell[410809, 10668, 453, 9, 70, "Print"],
Cell[411265, 10679, 453, 9, 70, "Print"],
Cell[411721, 10690, 455, 9, 70, "Print"],
Cell[412179, 10701, 455, 9, 70, "Print"],
Cell[412637, 10712, 455, 9, 70, "Print"],
Cell[413095, 10723, 452, 9, 70, "Print"],
Cell[413550, 10734, 453, 9, 70, "Print"],
Cell[414006, 10745, 453, 9, 70, "Print"],
Cell[414462, 10756, 453, 9, 70, "Print"],
Cell[414918, 10767, 453, 9, 70, "Print"],
Cell[415374, 10778, 455, 9, 70, "Print"],
Cell[415832, 10789, 455, 9, 70, "Print"],
Cell[416290, 10800, 455, 9, 70, "Print"],
Cell[416748, 10811, 455, 9, 70, "Print"],
Cell[417206, 10822, 453, 9, 70, "Print"],
Cell[417662, 10833, 453, 9, 70, "Print"],
Cell[418118, 10844, 455, 9, 70, "Print"],
Cell[418576, 10855, 453, 9, 70, "Print"],
Cell[419032, 10866, 453, 9, 70, "Print"],
Cell[419488, 10877, 454, 9, 70, "Print"],
Cell[419945, 10888, 457, 9, 70, "Print"],
Cell[420405, 10899, 457, 9, 70, "Print"],
Cell[420865, 10910, 453, 9, 70, "Print"],
Cell[421321, 10921, 455, 9, 70, "Print"],
Cell[421779, 10932, 453, 9, 70, "Print"],
Cell[422235, 10943, 455, 9, 70, "Print"],
Cell[422693, 10954, 455, 9, 70, "Print"],
Cell[423151, 10965, 457, 9, 70, "Print"],
Cell[423611, 10976, 457, 9, 70, "Print"],
Cell[424071, 10987, 452, 9, 70, "Print"],
Cell[424526, 10998, 453, 9, 70, "Print"],
Cell[424982, 11009, 455, 9, 70, "Print"],
Cell[425440, 11020, 457, 9, 70, "Print"],
Cell[425900, 11031, 455, 9, 70, "Print"],
Cell[426358, 11042, 455, 9, 70, "Print"],
Cell[426816, 11053, 453, 9, 70, "Print"],
Cell[427272, 11064, 453, 9, 70, "Print"],
Cell[427728, 11075, 455, 9, 70, "Print"],
Cell[428186, 11086, 455, 9, 70, "Print"],
Cell[428644, 11097, 455, 9, 70, "Print"],
Cell[429102, 11108, 453, 9, 70, "Print"],
Cell[429558, 11119, 457, 9, 70, "Print"],
Cell[430018, 11130, 455, 9, 70, "Print"],
Cell[430476, 11141, 457, 9, 70, "Print"],
Cell[430936, 11152, 455, 9, 70, "Print"],
Cell[431394, 11163, 454, 9, 70, "Print"],
Cell[431851, 11174, 455, 9, 70, "Print"],
Cell[432309, 11185, 457, 9, 70, "Print"],
Cell[432769, 11196, 459, 9, 70, "Print"],
Cell[433231, 11207, 457, 9, 70, "Print"]
}, Open  ]],
Cell[433703, 11219, 373, 10, 166, "Text"],
Cell[434079, 11231, 3407, 90, 557, "Input"],
Cell[437489, 11323, 202, 5, 51, "Input"],
Cell[437694, 11330, 215, 4, 51, "Input"],
Cell[437912, 11336, 374, 9, 112, "Input"],
Cell[438289, 11347, 1954, 36, 320, "Input"],
Cell[440246, 11385, 257, 6, 82, "Input"],
Cell[440506, 11393, 332, 6, 51, "Input"],
Cell[440841, 11401, 414, 7, 51, "Input"],
Cell[CellGroupData[{
Cell[441280, 11412, 167, 3, 51, "Input"],
Cell[441450, 11417, 5494, 142, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[446993, 11565, 315, 4, 62, "Subtitle"],
Cell[447311, 11571, 1965, 49, 183, "Input"],
Cell[CellGroupData[{
Cell[449301, 11624, 1711, 37, 141, "Input"],
Cell[451015, 11663, 141, 1, 27, "Print"],
Cell[451159, 11666, 139, 1, 27, "Print"],
Cell[451301, 11669, 139, 1, 27, "Print"],
Cell[451443, 11672, 141, 1, 27, "Print"],
Cell[451587, 11675, 139, 1, 27, "Print"],
Cell[451729, 11678, 139, 1, 27, "Print"],
Cell[451871, 11681, 138, 1, 27, "Print"],
Cell[452012, 11684, 141, 1, 27, "Print"],
Cell[452156, 11687, 139, 1, 27, "Print"],
Cell[452298, 11690, 139, 1, 27, "Print"],
Cell[452440, 11693, 141, 1, 27, "Print"],
Cell[452584, 11696, 141, 1, 27, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[452762, 11702, 296, 4, 35, "Input"],
Cell[453061, 11708, 2758, 87, 446, "Output"]
}, Open  ]],
Cell[455834, 11798, 192, 4, 35, "Input"],
Cell[456029, 11804, 114, 1, 54, "Subsection"],
Cell[456146, 11807, 190, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[456361, 11815, 345, 9, 35, "Input"],
Cell[456709, 11826, 5315, 94, 302, "Output"]
}, Open  ]],
Cell[462039, 11923, 669, 18, 60, "Input"],
Cell[462711, 11943, 787, 21, 60, "Input"],
Cell[463501, 11966, 1086, 26, 141, "Input"],
Cell[464590, 11994, 992, 20, 36, "Input"],
Cell[465585, 12016, 806, 16, 36, "Input"],
Cell[CellGroupData[{
Cell[466416, 12036, 485, 11, 35, "Input"],
Cell[466904, 12049, 16502, 278, 308, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483443, 12332, 507, 11, 36, "Input"],
Cell[483953, 12345, 17891, 299, 305, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[501881, 12649, 537, 12, 36, "Input"],
Cell[502421, 12663, 18182, 304, 305, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[520640, 12972, 394, 8, 87, "Subsubtitle"],
Cell[521037, 12982, 126, 2, 35, "Input"],
Cell[521166, 12986, 279, 7, 132, "Text"],
Cell[521448, 12995, 185, 4, 35, "Input"],
Cell[521636, 13001, 240, 6, 35, "Input"],
Cell[521879, 13009, 748, 18, 99, "Input"],
Cell[522630, 13029, 126, 1, 43, "Subsubsection"],
Cell[522759, 13032, 705, 15, 49, "Input"],
Cell[523467, 13049, 767, 15, 57, "Input"],
Cell[524237, 13066, 1042, 22, 288, "Input"],
Cell[525282, 13090, 1054, 21, 435, "Input"],
Cell[526339, 13113, 362, 9, 62, "Code"],
Cell[526704, 13124, 149, 2, 54, "Subsection"],
Cell[526856, 13128, 416, 7, 56, "Text"],
Cell[527275, 13137, 189, 4, 36, "Input"],
Cell[CellGroupData[{
Cell[527489, 13145, 255, 6, 59, "Input"],
Cell[527747, 13153, 287, 8, 56, "Output"]
}, Open  ]],
Cell[528049, 13164, 309, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[528383, 13175, 629, 12, 39, "Input"],
Cell[529015, 13189, 249, 6, 39, "Output"]
}, Open  ]],
Cell[529279, 13198, 560, 11, 36, "Input"],
Cell[529842, 13211, 562, 13, 57, "Input"],
Cell[530407, 13226, 144, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[530576, 13231, 618, 11, 28, "Input"],
Cell[531197, 13244, 292, 6, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[531526, 13255, 301, 6, 35, "Input"],
Cell[531830, 13263, 490, 15, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[532357, 13283, 834, 13, 35, "Input"],
Cell[533194, 13298, 865, 27, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[534096, 13330, 225, 4, 35, "Input"],
Cell[534324, 13336, 1866, 59, 136, "Output"]
}, Open  ]],
Cell[536205, 13398, 180, 4, 35, "Input"],
Cell[CellGroupData[{
Cell[536410, 13406, 1159, 24, 120, "Input"],
Cell[537572, 13432, 291, 6, 26, "Print"],
Cell[537866, 13440, 291, 6, 26, "Print"],
Cell[538160, 13448, 289, 6, 26, "Print"],
Cell[538452, 13456, 289, 6, 26, "Print"],
Cell[538744, 13464, 291, 6, 26, "Print"],
Cell[539038, 13472, 291, 6, 26, "Print"],
Cell[539332, 13480, 289, 6, 26, "Print"],
Cell[539624, 13488, 289, 6, 26, "Print"],
Cell[539916, 13496, 289, 6, 26, "Print"],
Cell[540208, 13504, 289, 6, 26, "Print"],
Cell[540500, 13512, 291, 6, 26, "Print"],
Cell[540794, 13520, 291, 6, 26, "Print"]
}, Open  ]],
Cell[541100, 13529, 682, 14, 35, "Input"],
Cell[CellGroupData[{
Cell[541807, 13547, 153, 2, 35, "Input"],
Cell[541963, 13551, 141, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[542141, 13559, 318, 8, 35, "Input"],
Cell[542462, 13569, 2157, 51, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[544656, 13625, 754, 14, 78, "Input"],
Cell[545413, 13641, 453, 9, 26, "Print"],
Cell[545869, 13652, 455, 9, 26, "Print"],
Cell[546327, 13663, 453, 9, 26, "Print"],
Cell[546783, 13674, 453, 9, 26, "Print"],
Cell[547239, 13685, 453, 9, 26, "Print"],
Cell[547695, 13696, 453, 9, 26, "Print"],
Cell[548151, 13707, 453, 9, 26, "Print"],
Cell[548607, 13718, 455, 9, 26, "Print"],
Cell[549065, 13729, 455, 9, 26, "Print"],
Cell[549523, 13740, 456, 9, 26, "Print"],
Cell[549982, 13751, 456, 9, 26, "Print"],
Cell[550441, 13762, 459, 9, 26, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[550937, 13776, 684, 14, 78, "Input"],
Cell[551624, 13792, 453, 9, 26, "Print"],
Cell[552080, 13803, 453, 9, 26, "Print"],
Cell[552536, 13814, 452, 9, 26, "Print"],
Cell[552991, 13825, 453, 9, 26, "Print"],
Cell[553447, 13836, 455, 9, 26, "Print"],
Cell[553905, 13847, 455, 9, 26, "Print"],
Cell[554363, 13858, 455, 9, 26, "Print"],
Cell[554821, 13869, 455, 9, 26, "Print"],
Cell[555279, 13880, 457, 9, 26, "Print"],
Cell[555739, 13891, 457, 9, 26, "Print"],
Cell[556199, 13902, 455, 9, 26, "Print"],
Cell[556657, 13913, 455, 9, 26, "Print"],
Cell[557115, 13924, 453, 9, 26, "Print"],
Cell[557571, 13935, 455, 9, 26, "Print"],
Cell[558029, 13946, 453, 9, 26, "Print"],
Cell[558485, 13957, 453, 9, 26, "Print"],
Cell[558941, 13968, 452, 9, 26, "Print"],
Cell[559396, 13979, 453, 9, 26, "Print"],
Cell[559852, 13990, 457, 9, 26, "Print"],
Cell[560312, 14001, 455, 9, 26, "Print"],
Cell[560770, 14012, 457, 9, 26, "Print"],
Cell[561230, 14023, 453, 9, 26, "Print"],
Cell[561686, 14034, 453, 9, 26, "Print"],
Cell[562142, 14045, 453, 9, 26, "Print"],
Cell[562598, 14056, 455, 9, 26, "Print"],
Cell[563056, 14067, 455, 9, 26, "Print"],
Cell[563514, 14078, 455, 9, 26, "Print"],
Cell[563972, 14089, 455, 9, 26, "Print"],
Cell[564430, 14100, 455, 9, 26, "Print"],
Cell[564888, 14111, 454, 9, 26, "Print"],
Cell[565345, 14122, 455, 9, 26, "Print"],
Cell[565803, 14133, 453, 9, 26, "Print"],
Cell[566259, 14144, 453, 9, 26, "Print"],
Cell[566715, 14155, 452, 9, 26, "Print"],
Cell[567170, 14166, 453, 9, 26, "Print"],
Cell[567626, 14177, 455, 9, 26, "Print"],
Cell[568084, 14188, 455, 9, 26, "Print"],
Cell[568542, 14199, 457, 9, 26, "Print"],
Cell[569002, 14210, 453, 9, 26, "Print"],
Cell[569458, 14221, 453, 9, 26, "Print"],
Cell[569914, 14232, 452, 9, 26, "Print"],
Cell[570369, 14243, 453, 9, 26, "Print"],
Cell[570825, 14254, 457, 9, 26, "Print"],
Cell[571285, 14265, 455, 9, 26, "Print"],
Cell[571743, 14276, 455, 9, 26, "Print"],
Cell[572201, 14287, 453, 9, 26, "Print"],
Cell[572657, 14298, 453, 9, 26, "Print"],
Cell[573113, 14309, 453, 9, 26, "Print"],
Cell[573569, 14320, 455, 9, 26, "Print"],
Cell[574027, 14331, 457, 9, 26, "Print"],
Cell[574487, 14342, 455, 9, 26, "Print"],
Cell[574945, 14353, 453, 9, 26, "Print"],
Cell[575401, 14364, 453, 9, 26, "Print"],
Cell[575857, 14375, 455, 9, 26, "Print"],
Cell[576315, 14386, 455, 9, 26, "Print"],
Cell[576773, 14397, 455, 9, 26, "Print"],
Cell[577231, 14408, 453, 9, 26, "Print"],
Cell[577687, 14419, 455, 9, 26, "Print"],
Cell[578145, 14430, 455, 9, 26, "Print"],
Cell[578603, 14441, 457, 9, 26, "Print"],
Cell[579063, 14452, 457, 9, 26, "Print"],
Cell[579523, 14463, 455, 9, 26, "Print"],
Cell[579981, 14474, 455, 9, 26, "Print"],
Cell[580439, 14485, 457, 9, 26, "Print"],
Cell[580899, 14496, 459, 9, 26, "Print"],
Cell[581361, 14507, 457, 9, 26, "Print"]
}, Open  ]],
Cell[581833, 14519, 886, 20, 120, "Code"],
Cell[582722, 14541, 6122, 158, 603, "Input"],
Cell[588847, 14701, 289, 6, 35, "Input"],
Cell[CellGroupData[{
Cell[589161, 14711, 194, 2, 35, "Input"],
Cell[589358, 14715, 1534, 22, 141, "Output"]
}, Open  ]],
Cell[590907, 14740, 1937, 35, 204, "Input"],
Cell[592847, 14777, 370, 8, 36, "Input"],
Cell[593220, 14787, 489, 9, 35, "Input"],
Cell[CellGroupData[{
Cell[593734, 14800, 200, 3, 35, "Input"],
Cell[593937, 14805, 5488, 142, 200, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[599498, 14955, 174, 5, 99, "Subtitle"],
Cell[599675, 14962, 216, 5, 51, "Input"],
Cell[599894, 14969, 862, 23, 141, "Input"],
Cell[600759, 14994, 642, 15, 141, "Input"],
Cell[601404, 15011, 142, 3, 51, "Input"],
Cell[CellGroupData[{
Cell[601571, 15018, 993, 22, 93, "Input"],
Cell[602567, 15042, 2829, 85, 70, "Output"]
}, Open  ]],
Cell[605411, 15130, 188, 4, 51, "Input"],
Cell[CellGroupData[{
Cell[605624, 15138, 285, 6, 51, "Input"],
Cell[605912, 15146, 256, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[606205, 15156, 103, 1, 65, "Subsection"],
Cell[606311, 15159, 1736, 43, 438, "Input"],
Cell[608050, 15204, 1663, 43, 231, "Input"],
Cell[CellGroupData[{
Cell[609738, 15251, 1876, 41, 260, "Input"],
Cell[611617, 15294, 136, 1, 70, "Print"],
Cell[611756, 15297, 137, 1, 70, "Print"],
Cell[611896, 15300, 139, 1, 70, "Print"],
Cell[612038, 15303, 137, 1, 70, "Print"],
Cell[612178, 15306, 137, 1, 70, "Print"],
Cell[612318, 15309, 137, 1, 70, "Print"],
Cell[612458, 15312, 137, 1, 70, "Print"],
Cell[612598, 15315, 137, 1, 70, "Print"],
Cell[612738, 15318, 136, 1, 70, "Print"],
Cell[612877, 15321, 137, 1, 70, "Print"],
Cell[613017, 15324, 137, 1, 70, "Print"],
Cell[613157, 15327, 137, 1, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[613331, 15333, 272, 4, 51, "Input"],
Cell[613606, 15339, 2514, 72, 70, "Output"]
}, Open  ]],
Cell[616135, 15414, 2766, 58, 290, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[618938, 15477, 118, 1, 51, "Input"],
Cell[619059, 15480, 3057, 87, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[622153, 15572, 118, 1, 51, "Input"],
Cell[622274, 15575, 361, 8, 70, "Output"]
}, Open  ]],
Cell[622650, 15586, 156, 2, 65, "Subsection"],
Cell[CellGroupData[{
Cell[622831, 15592, 145, 2, 38, "Input"],
Cell[622979, 15596, 2831, 85, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625847, 15686, 461, 12, 51, "Input"],
Cell[626311, 15700, 1421, 28, 70, "Output"]
}, Open  ]],
Cell[627747, 15731, 223, 5, 51, "Input"],
Cell[627973, 15738, 563, 11, 82, "Input"],
Cell[CellGroupData[{
Cell[628561, 15753, 221, 3, 51, "Input"],
Cell[628785, 15758, 1563, 28, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[630385, 15791, 142, 2, 51, "Input"],
Cell[630530, 15795, 1517, 21, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[632084, 15821, 123, 1, 65, "Subsection"],
Cell[632210, 15824, 2168, 53, 320, "Input"],
Cell[634381, 15879, 272, 5, 51, "Input"],
Cell[634656, 15886, 523, 10, 51, "Input"],
Cell[635182, 15898, 1848, 34, 290, "Input"],
Cell[637033, 15934, 315, 7, 51, "Input"],
Cell[637351, 15943, 492, 9, 51, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[637880, 15957, 218, 3, 51, "Input"],
Cell[638101, 15962, 5489, 142, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[643639, 16110, 316, 7, 135, "Subtitle"],
Cell[643958, 16119, 303, 7, 51, "Input"],
Cell[644264, 16128, 518, 13, 82, "Input"],
Cell[644785, 16143, 514, 11, 51, "Input"],
Cell[CellGroupData[{
Cell[645324, 16158, 638, 10, 51, "Input"],
Cell[645965, 16170, 414, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[646416, 16188, 188, 4, 51, "Input"],
Cell[646607, 16194, 151, 3, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[646795, 16202, 103, 1, 65, "Subsection"],
Cell[646901, 16205, 726, 17, 171, "Input"],
Cell[647630, 16224, 1509, 38, 201, "Input"],
Cell[CellGroupData[{
Cell[649164, 16266, 1562, 35, 201, "Input"],
Cell[650729, 16303, 137, 1, 70, "Print"],
Cell[650869, 16306, 137, 1, 70, "Print"],
Cell[651009, 16309, 137, 1, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[651183, 16315, 213, 3, 51, "Input"],
Cell[651399, 16320, 1479, 42, 70, "Output"]
}, Open  ]],
Cell[652893, 16365, 2056, 42, 201, "Input"]
}, Open  ]],
Cell[654964, 16410, 156, 2, 65, "Subsection"],
Cell[CellGroupData[{
Cell[655145, 16416, 136, 2, 38, "Input"],
Cell[655284, 16420, 417, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[655738, 16438, 402, 12, 51, "Input"],
Cell[656143, 16452, 837, 22, 70, "Output"]
}, Open  ]],
Cell[656995, 16477, 212, 5, 51, "Input"],
Cell[657210, 16484, 563, 10, 82, "Input"],
Cell[CellGroupData[{
Cell[657798, 16498, 214, 3, 51, "Input"],
Cell[658015, 16503, 843, 22, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[658895, 16530, 133, 2, 51, "Input"],
Cell[659031, 16534, 270, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[659338, 16545, 123, 1, 65, "Subsection"],
Cell[659464, 16548, 470, 10, 141, "Input"],
Cell[659937, 16560, 251, 5, 51, "Input"],
Cell[CellGroupData[{
Cell[660213, 16569, 209, 3, 51, "Input"],
Cell[660425, 16574, 6030, 195, 70, "Output"]
}, Open  ]],
Cell[666470, 16772, 449, 10, 51, "Input"],
Cell[666922, 16784, 243, 5, 51, "Input"],
Cell[667168, 16791, 1886, 33, 290, "Input"],
Cell[669057, 16826, 282, 6, 51, "Input"],
Cell[669342, 16834, 484, 8, 50, "Text"],
Cell[669829, 16844, 572, 9, 51, "Input"]
}, Open  ]],
Cell[670416, 16856, 246, 5, 50, "Text"],
Cell[CellGroupData[{
Cell[670687, 16865, 207, 3, 51, "Input"],
Cell[670897, 16870, 7294, 193, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[678240, 17069, 431, 9, 171, "Subtitle"],
Cell[678674, 17080, 469, 10, 51, "Input"],
Cell[679146, 17092, 494, 13, 82, "Input"],
Cell[CellGroupData[{
Cell[679665, 17109, 538, 10, 51, "Input"],
Cell[680206, 17121, 228, 5, 70, "Output"]
}, Open  ]],
Cell[680449, 17129, 440, 11, 51, "Input"],
Cell[CellGroupData[{
Cell[680914, 17144, 795, 15, 90, "Input"],
Cell[681712, 17161, 852, 28, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[682601, 17194, 798, 12, 87, "Input"],
Cell[683402, 17208, 405, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[683844, 17226, 401, 6, 51, "Input"],
Cell[684248, 17234, 1189, 40, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[685474, 17279, 164, 4, 51, "Input"],
Cell[685641, 17285, 150, 3, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[685828, 17293, 94, 1, 65, "Subsection"],
Cell[685925, 17296, 777, 17, 171, "Input"],
Cell[686705, 17315, 2098, 46, 290, "Input"],
Cell[CellGroupData[{
Cell[688828, 17365, 1640, 36, 201, "Input"],
Cell[690471, 17403, 131, 1, 70, "Print"],
Cell[690605, 17406, 129, 1, 70, "Print"],
Cell[690737, 17409, 131, 1, 70, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[690905, 17415, 267, 4, 51, "Input"],
Cell[691175, 17421, 1551, 39, 70, "Output"]
}, Open  ]],
Cell[692741, 17463, 3249, 75, 378, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[696027, 17543, 387, 9, 51, "Input"],
Cell[696417, 17554, 734, 21, 70, "Output"]
}, Open  ]],
Cell[697166, 17578, 215, 5, 51, "Input"],
Cell[697384, 17585, 540, 11, 82, "Input"],
Cell[CellGroupData[{
Cell[697949, 17600, 111, 1, 65, "Subsection"],
Cell[CellGroupData[{
Cell[698085, 17605, 316, 6, 51, "Input"],
Cell[698404, 17613, 328, 6, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[698769, 17624, 191, 3, 51, "Input"],
Cell[698963, 17629, 469, 12, 70, "Output"]
}, Open  ]],
Cell[699447, 17644, 392, 9, 51, "Input"],
Cell[699842, 17655, 1725, 33, 320, "Input"],
Cell[701570, 17690, 329, 6, 51, "Input"],
Cell[701902, 17698, 445, 8, 51, "Input"],
Cell[CellGroupData[{
Cell[702372, 17710, 137, 2, 51, "Input"],
Cell[702512, 17714, 31879, 860, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
