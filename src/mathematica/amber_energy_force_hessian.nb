(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    804790,      17785]
NotebookOptionsPosition[    733178,      16871]
NotebookOutlinePosition[    733854,      16896]
CellTagsIndexPosition[    733811,      16893]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Generate optimized energy, gradient, and Hessian expressions for molecular \
mechanics.\
\>", "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.402914001047615*^9},ExpressionUUID->"b0fd39df-8862-4179-a880-\
dbe2092c9a61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675593015943*^9, 3.40267560234683*^9}, 
   3.402675719919037*^9, 3.402914001047728*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"c70641c7-1b5d-410e-ad0a-56f59ac2d689"],

Cell[BoxData["\<\"/Users/meister\"\>"], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.774618684573675*^9, 3.774791723128336*^9, {3.780926550413712*^9, 
   3.780926550805985*^9}, 3.780935946856204*^9, {3.781518011260487*^9, 
   3.7815180116328373`*^9}, {3.894645851191424*^9, 3.894645853721836*^9}},
 CellLabel->"Out[20]=",ExpressionUUID->"b8d14ea6-aee7-4174-a27e-7f2f8fc0de53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/meister/Development/cando/extensions/cando/include/cando/chem/\
energy_functions/\>\"", "]"}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675724744155*^9, 3.402675744579932*^9}, {
   3.4026757812426653`*^9, 3.402675795163514*^9}, 3.4029140010477962`*^9, {
   3.404776927640129*^9, 3.4047769282020483`*^9}, {3.485009516098822*^9, 
   3.4850095173434477`*^9}, {3.619556879758088*^9, 3.6195568829874687`*^9}, {
   3.7026648712565193`*^9, 3.702664872815674*^9}, {3.7809265423187447`*^9, 
   3.780926543584301*^9}, {3.780944859091173*^9, 3.780944904216384*^9}, {
   3.8946458653781567`*^9, 3.894645866645886*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2d137b9b-ea88-410b-9968-95caebda6207"],

Cell[BoxData["\<\"/Users/meister/Development/cando/extensions/cando/include/\
cando/chem/energy_functions\"\>"], "Output",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7809265504817944`*^9, 3.780926550859933*^9}, 
   3.780935946976534*^9, {3.7809448927238617`*^9, 3.7809449045911207`*^9}, {
   3.781518011319745*^9, 3.781518011664873*^9}, 3.894645874188086*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"68097b85-431a-4b1c-8f39-d83d8efdb4b2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.408659022451297*^9, 
  3.408659024556794*^9}},ExpressionUUID->"56979870-3ed4-4d4e-af8e-\
a63b4ff23368"],

Cell["Setup to generate code that is embedded within CANDO", "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.402914001047846*^9, {3.494842902549116*^9, 3.494842937561069*^9}, 
   3.894645879760284*^9},ExpressionUUID->"13656531-838c-4e7a-a5ac-\
d7f574743d13"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<optimizeExpressions`\>\"", "]"}]], "Code",
 CellChangeTimes->{{3.4055916304006453`*^9, 
  3.405591641125656*^9}},ExpressionUUID->"49c3f62a-426b-40d8-ad03-\
a51a7d875bc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Bond stretch term between two atoms with coordinates {x1,y1,z1} and {x2,y2,z2}
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.4948432970798798`*^9, 
   3.494843313989492*^9}},ExpressionUUID->"40c497cd-8ecb-4a12-a19e-\
90050870a153"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 
  3.403184184931066*^9}},ExpressionUUID->"a3598273-c222-436b-9d94-\
ca29ebbf3a24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 
  3.4026520109900312`*^9}},ExpressionUUID->"58e0eab9-be8c-43e5-82a3-\
ad8adbb63338"],

Cell["Define the Hooks law bond stretch potential", "Subsection",
 CellChangeTimes->{{3.494843329696516*^9, 
  3.4948433485250063`*^9}},ExpressionUUID->"3879886e-f184-4d74-93af-\
6e49da00fb72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchDeviation", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"bb", "-", "ba"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"bb", "-", "ba"}], ")"}]}], "]"}], "-", "r0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
  3.411152033364759*^9, 
  3.411152034157058*^9}},ExpressionUUID->"495fb4b5-85f0-462f-aac7-\
785188d5dabc"],

Cell[BoxData[
 RowBox[{"stretchEnergyFn", " ", "=", "  ", 
  RowBox[{"kb", "  ", 
   RowBox[{
    RowBox[{"(", "stretchDeviation", ")"}], "^", "2.0"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.416871725859004*^9, 3.416871727438574*^9}, 
   3.416872040224017*^9},ExpressionUUID->"4e665c6e-c0f4-4ca4-833d-\
8dc01f25a9b8"],

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input",ExpressionUUID->\
"d49fcc02-7be5-4d13-bb3a-5b4b3983e308"],

Cell[CellGroupData[{

Cell["Assemble the energy function rules to expand", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 3.401714291927002*^9}, {
  3.494843844071973*^9, 
  3.494843851677432*^9}},ExpressionUUID->"76c2ef4b-da46-4f83-b9d7-\
f91a9c19990f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}},ExpressionUUID->"446f8cb2-7ee6-4b8d-884e-\
be17a694418a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stretchSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(kb);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(r0);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}},ExpressionUUID->"abcb48bc-d911-47a2-92e5-\
016ff7afb1b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "stretchVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<STRETCH_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"stretchSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}},ExpressionUUID->"0bbb2f4a-d376-457f-894a-\
dcf14cdf7f4d"],

Cell[BoxData[
 RowBox[{"stretchSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
  3.41017756267308*^9, 
  3.4101775644454517`*^9}},ExpressionUUID->"56551ce3-b9df-432e-b5e3-\
f2b5d6f01a87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stretchEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stretchOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"StretchDeviation", ",", "stretchDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "stretchEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<STRETCH\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 
   3.411152028421866*^9}},ExpressionUUID->"d2ec2e96-4d08-4a2b-9b30-\
b2997f4c3329"]
}, Open  ]],

Cell["Append the Gradient and Hessian rules", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 3.408559038294833*^9}, {3.494843872271369*^9, 
  3.4948438859081783`*^9}},ExpressionUUID->"ed8cec90-4c0a-47d9-9f0f-\
1990a0389f2f"],

Cell[BoxData["stretchEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 
  3.4085602170434313`*^9}},ExpressionUUID->"07b80f7a-8e11-48e8-95f4-\
52af32d2333f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"stretchHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 
  3.409332795387742*^9}},ExpressionUUID->"63510d04-307f-48f5-b131-\
93115a1e8bfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 
  3.410177080322625*^9}},ExpressionUUID->"1d7c25b0-fdd8-4f33-81d8-\
92b1808f75e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<STRETCH\>\"", ",", "stretchForceHessianRules", ",", "stretchOutputs", 
    ",", "stretchHessian", ",", "stretchEnergyFn", ",", "stretchVarNames"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
  3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
  3.410177087548172*^9}},ExpressionUUID->"1ca74e93-7a67-4d46-a40b-\
bafa109761de"],

Cell[BoxData[
 RowBox[{"stretchHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
  3.40933303751335*^9, 
  3.4093330391745863`*^9}},ExpressionUUID->"85b973da-3bee-4bad-afca-\
ddd60139d234"],

Cell[BoxData["stretchOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 
  3.408559359276013*^9}},ExpressionUUID->"806ee8fc-0086-468d-8963-\
65f7bd951e4c"],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"962d4dfb-fe35-420f-b0a2-\
e2747b27b8a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "stretchSetupRules", ",", "\[IndentingNewLine]", "stretchEnergyRules", 
     ",", "\[IndentingNewLine]", "stretchForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 
   3.410958727655569*^9},ExpressionUUID->"c35375c0-5832-4e1b-8621-\
e85aed162528"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "stretchAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 
  3.410958744314476*^9}},ExpressionUUID->"52064099-ffa3-4627-80f8-\
c2c37f91a2f8"],

Cell[BoxData["stretchRules"], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 
  3.411210898002816*^9}},ExpressionUUID->"b1a40249-4327-451e-bdb0-\
e7f8cabf6dd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "r0", 
     ",", "kb"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
  3.408556502824588*^9, 
  3.4085565040993557`*^9}},ExpressionUUID->"1410c9bd-0156-4261-9767-\
d7b16ffc7251"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchOutputs", ",", "StretchDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 
  3.411152052756624*^9}},ExpressionUUID->"faf75be5-87ba-4164-babb-\
9d8d83ab387c"],

Cell["\<\
Assemble the rules, the name of the energy term, the independant variable \
names, etc. into what passes for a structure in Mathematica (I call it a Pack)\
\>", "Subsection",
 CellChangeTimes->{{3.494843911918105*^9, 
  3.494844017248684*^9}},ExpressionUUID->"7a30b210-9d08-4aa3-9dbe-\
0c1bec4ec4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Stretch\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "stretchHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "stretchRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "stretchInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "stretchOutputs"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9},ExpressionUUID->"e7c04b05-4842-4c2d-8283-\
54f03f84cc79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "stretchPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 
   3.4110670621890917`*^9},ExpressionUUID->"0398e0a1-c5f2-4b1c-b25d-\
c1ef738c0fb1"],

Cell["\<\
stretchPack = Block[{PrintTemporary = Print}, packOptimize[stretchPack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 
   3.4110728451363277`*^9}},ExpressionUUID->"95dc914b-df9d-44ae-9c6d-\
67f1919fbd54"],

Cell["Put the pedal to the metal and generate \"C\" code.", "Subsection",
 CellChangeTimes->{{3.494844094666773*^9, 
  3.494844119787055*^9}},ExpressionUUID->"47d94349-2f0d-408a-90da-\
4fb017e5e65a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "stretchPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}},ExpressionUUID->"59c99ea9-0cd8-47be-9284-\
c22abf527e8b"]
}, Open  ]],

Cell["\<\
Draw an evaluation tree for the optimized \"C\" code.  It doesn' t do \
anything useful but it looks impressive - I have got to print some of these \
on large format posters.

Inputs (independent variables and parameters) are on the left and drawn in \
Black, and outputs are on the right and also drawn in Black. Computationally \
expensive functions are highlighted in red, Plus functions are blue and Times \
functions are green.\
\>", "Subsection",
 CellChangeTimes->{{3.494844130294557*^9, 3.494844200819201*^9}, {
  3.494844239453156*^9, 3.494844307388302*^9}, {3.494844349909049*^9, 
  3.494844362349473*^9}, {3.494844417981534*^9, 
  3.49484444617253*^9}},ExpressionUUID->"d85419f9-f6ab-47b9-9980-\
3a9d88d220c3"],

Cell[BoxData[
 RowBox[{"packGraph", "[", "stretchPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
  3.4085648880849*^9, 
  3.408564889562644*^9}},ExpressionUUID->"da94a614-58b0-482f-9c2c-\
09b6822c7db4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Angle bend term using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " generated gradient/Hessian expansion"
}], "Subtitle",
 CellChangeTimes->{{3.494844035232679*^9, 
  3.494844038080626*^9}},ExpressionUUID->"3740d397-c035-493d-b12d-\
221dd6531450"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", 
    ",", "y3", ",", "z3", ",", "ab", ",", "cb", ",", "ba", ",", "bb", ",", 
    "bc"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.402652780531734*^9, 3.402652792729147*^9}, {
  3.405593978391768*^9, 
  3.405593979390263*^9}},ExpressionUUID->"ae82f043-635a-4d1d-b26f-\
56323efddcd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40265249626128*^9, 3.4026525067255383`*^9}, {
  3.402652543649145*^9, 
  3.4026526050967493`*^9}},ExpressionUUID->"9f3f81f9-7c35-431b-b26e-\
614d1fa0da83"],

Cell[BoxData[
 RowBox[{"angleInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "bc", ",", 
     RowBox[{"{", 
      RowBox[{"t0", ",", "kt"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4055966209501877`*^9, 3.405596670762001*^9}, {
  3.405596704315874*^9, 3.405596706769898*^9}, {3.410178228193839*^9, 
  3.410178228313593*^9}},ExpressionUUID->"eac7cb44-7298-4b7c-99b7-\
738e18279309"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecLen", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"ca2b6acb-001f-461b-b16b-4b42d9f59874"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", "=", " ", 
   RowBox[{"ba", " ", "-", " ", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cb", " ", "=", " ", 
   RowBox[{"bc", " ", "-", " ", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotNormAbNormCb", "=", " ", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{"ab", ",", "cb"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vecLen", "[", "ab", "]"}], 
      RowBox[{"vecLen", "[", "cb", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fnThetaDev", " ", "=", " ", 
  RowBox[{
   RowBox[{"ArcCos", "[", "dotNormAbNormCb", "]"}], "-", "t0"}]}]}], "Input",
 CellChangeTimes->{{3.405593952552783*^9, 3.4055939691503*^9}, {
   3.410366657579863*^9, 3.41036669377003*^9}, 3.410366728321971*^9, {
   3.41038785424853*^9, 3.410387855638277*^9}, {3.410392048482498*^9, 
   3.4103920758498573`*^9}, {3.4103921152109213`*^9, 
   3.4103921313864594`*^9}},ExpressionUUID->"3b1a5463-33ea-40ec-a8d1-\
ed75e741b211"],

Cell[BoxData[
 RowBox[{"angleEnergyFn", " ", "=", "  ", 
  RowBox[{"kt", " ", 
   RowBox[{
    RowBox[{"(", "thetaDev", ")"}], "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.403186067709779*^9, 3.40318606785948*^9}, {
   3.403215088875318*^9, 3.4032150908565807`*^9}, {3.407556644898531*^9, 
   3.407556646619691*^9}, {3.4101782310204906`*^9, 3.41017823112637*^9}, {
   3.4168717384493732`*^9, 3.416871739535102*^9}, 
   3.416872046887182*^9},ExpressionUUID->"4803ac6a-5532-4fae-9264-\
76732195b8b4"],

Cell[BoxData[
 RowBox[{"angleEnergyFn", " ", "=", " ", 
  RowBox[{"angleEnergyFn", "/.", 
   RowBox[{"{", 
    RowBox[{"thetaDev", "\[Rule]", "fnThetaDev"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.403215209201358*^9, 
  3.4032152152672787`*^9}},ExpressionUUID->"11dcc23a-07fc-49aa-b476-\
99a82ff9dd1f"],

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "bc"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.406839124224272*^9, 3.406839125529244*^9}, {
  3.4068391856032763`*^9, 
  3.406839188261937*^9}},ExpressionUUID->"91ca3e6e-d35d-4d29-973c-\
65b1b23c74ae"],

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.4017146731336727`*^9, 
  3.4017146744551163`*^9}},ExpressionUUID->"d01e3804-0121-42fb-b752-\
462ad3907501"],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 
  3.408563013307331*^9}},ExpressionUUID->"4a1098bb-6683-4b4b-bbc6-\
193f7b6583ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(kt);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(t0);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I1);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I2);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I3);\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410178179796535*^9, 
  3.410178203278604*^9}, {3.4101782360285482`*^9, 
  3.410178236128345*^9}},ExpressionUUID->"bc48386f-00e3-481f-8f93-\
7f02d8708878"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "angleVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<ANGLE_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"angleSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 
  3.410177806677978*^9}},ExpressionUUID->"71ebd469-15e6-4c29-ba8d-\
cbccedf421ea"],

Cell[BoxData[
 RowBox[{"angleSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 
   3.410177784928906*^9},ExpressionUUID->"2d433e6a-3b2c-4143-8ac4-\
c0af017d427a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408587821227968*^9, 
  3.4085878252235737`*^9}},ExpressionUUID->"bf10f6b1-dbdb-4070-a279-\
631cc559be3d"],

Cell[BoxData[
 RowBox[{"angleHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "9", "}"}]}], "]"}], ",", 
    RowBox[{"{", "9", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.40933335742642*^9, 
  3.40933336900301*^9}},ExpressionUUID->"e0399880-1939-4a57-8e96-\
973795f918fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DotNormAbNormCb", ",", "dotNormAbNormCb"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"AngleDeviation", ",", "fnThetaDev"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<bool IllegalAngle=false;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if(fabs(DotNormAbNormCb)>(1.0-VERYSMALL)) IllegalAngle=true;\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "angleEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<ANGLE\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408563249888267*^9, 
   3.408563318638526*^9}, {3.4085635055620623`*^9, 3.408563506089058*^9}, {
   3.409106851769322*^9, 3.409106882056981*^9}, {3.409333352642502*^9, 
   3.40933335434091*^9}, {3.4101778333157253`*^9, 3.410177835865591*^9}, {
   3.410177870714059*^9, 3.410177885725202*^9}, {3.410366745442485*^9, 
   3.4103668611031027`*^9}, {3.410387627352058*^9, 3.410387662996006*^9}, {
   3.410388393326111*^9, 3.4103883934847193`*^9}, {3.4103920130578737`*^9, 
   3.410392015575086*^9}, {3.410392087452957*^9, 3.4103920915966787`*^9}, {
   3.410392140741385*^9, 3.41039215558921*^9}, 3.410743057646208*^9, {
   3.411174874722517*^9, 3.411174878860882*^9}, {3.411174974239976*^9, 
   3.4111749916562967`*^9}, {3.41119932577212*^9, 
   3.4111993265205603`*^9}},ExpressionUUID->"84dbbe44-5859-46c4-80dd-\
23eba52707cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<ANGLE\>\"", ",", "angleForceHessianRules", ",", "angleOutputs", ",", 
    "angleHessian", ",", "angleEnergyFn", ",", "angleVarNames"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177889712893*^9, 
  3.410177894565605*^9}},ExpressionUUID->"33044a73-602b-403b-828c-\
e24f272955ff"],

Cell[CellGroupData[{

Cell["Collect and simplify", "Subsection",
 CellChangeTimes->{{3.4017146838017387`*^9, 
  3.40171468680226*^9}},ExpressionUUID->"8d6cdac2-cc26-4c0d-ac4a-\
8b0ff426ee18"],

Cell[BoxData[
 RowBox[{"Length", "[", "angleEnergyRules", "]"}]], "Input",
 CellChangeTimes->{
  3.410177837451532*^9},ExpressionUUID->"601d371d-06ac-4299-9ce7-\
fca9f62e056b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "angleSetupRules", ",", "angleEnergyRules", ",", 
      "angleForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.410177844659294*^9, 
  3.410177860940928*^9}},ExpressionUUID->"d71a2f28-d191-440f-8517-\
468c91233049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleOutputs", ",", "AngleDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411175001078189*^9, 3.411175017147767*^9}, {
  3.411199340815207*^9, 
  3.411199341516654*^9}},ExpressionUUID->"414db486-17cf-4e8a-92b3-\
a4e9e36ec83c"],

Cell[BoxData[
 RowBox[{"angleOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.40683925297971*^9, 3.406839254423614*^9}, {
  3.407733474203383*^9, 
  3.407733475711347*^9}},ExpressionUUID->"75729371-1f94-4886-b8b8-\
b77b5f14cfd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglePack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Angle\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "angleEnergyFn"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", " ", "\[Rule]", " ", "angleHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "angleRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "angleInputs"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "angleOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402880698908718*^9, 3.402880718144539*^9}, {
   3.405596810467842*^9, 3.405596826860199*^9}, {3.4056361468455667`*^9, 
   3.405636199543017*^9}, {3.407679917652017*^9, 3.407679931016655*^9}, 
   3.407763159631695*^9, {3.409333420940812*^9, 3.40933342773901*^9}, {
   3.410177864101145*^9, 3.410177865400531*^9}, {3.411066512729656*^9, 
   3.411066516761778*^9}, {3.41106697034696*^9, 3.411066970912582*^9}, {
   3.411073962997476*^9, 3.411073966619384*^9}, {3.411075733472687*^9, 
   3.411075737805724*^9}, {3.411076079199256*^9, 3.411076112584221*^9}, 
   3.411079373612965*^9},ExpressionUUID->"f5a8d9b0-8db4-4f49-84eb-\
ce2bd28e5834"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "anglePack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.4087904395372047`*^9, 3.408790444006906*^9}, 
   3.411067068587775*^9},ExpressionUUID->"9b6f394b-9f14-469f-90d3-\
6465f824448f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglePack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "anglePack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402959459618227*^9, 3.402959463819249*^9}, {
   3.405593701662167*^9, 3.405593708470829*^9}, {3.405596867763544*^9, 
   3.405596869120884*^9}, {3.407559212533072*^9, 3.407559212922392*^9}, 
   3.4110666677440443`*^9},ExpressionUUID->"b673f5bb-2f7e-4566-95b1-\
308c52e10579"],

Cell[BoxData[
 RowBox[{"packGraph", "[", "anglePack", "]"}]], "Input",
 CellChangeTimes->{{3.402959492934514*^9, 
  3.402959496895535*^9}},ExpressionUUID->"f51f5e46-cfff-4566-b8cb-\
a9dcb4a268b2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Non-bonding terms
\t- Van der Waals and Electrostatic interactions.
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 
  3.402672664963516*^9}},ExpressionUUID->"99c9a3d5-8c1b-4271-8e48-\
b57be111d080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "dA", 
    ",", " ", "dC", ",", " ", "dQ1Q2", ",", " ", "distanceSquared", ",", 
    "nonbondDistance", ",", " ", "evdw", ",", " ", "eeel", ",", 
    "nonbondEquation", ",", "PBX", ",", "PBY", ",", "PBZ", ",", "gx1", ",", 
    "gy1", ",", "gz1", ",", "gx2", ",", "gy2", ",", "gz2", ",", "fx1", ",", 
    "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", "fz2"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
  3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
  3.402741179258795*^9}, {3.774790817496912*^9, 3.774790831577991*^9}, {
  3.7815183709476633`*^9, 3.781518411408566*^9}, {3.7815192917739573`*^9, 
  3.781519298030895*^9}, {3.7815202764073467`*^9, 
  3.7815202920063133`*^9}},ExpressionUUID->"48e9b2b3-a257-4ce2-ad6c-\
beeb5cf6f06b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 
  3.402652572153042*^9}},ExpressionUUID->"76eda1be-78ff-42d5-9611-\
741db42b0cf7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonBondInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "dA", ",", "dC", ",", "dQ1Q2"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 
   3.4111751886209507`*^9}},ExpressionUUID->"5800d749-c9ad-45e4-84cd-\
f6a8a4cce3f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "dA", ",",
    "dC", ",", "dQ1Q2"}], "}"}]], "Output",
 CellChangeTimes->{3.780926556709195*^9, 3.7809267517709846`*^9, 
  3.7809269190042553`*^9, 3.780928020805747*^9, 3.780928077826428*^9, 
  3.78092834554729*^9, 3.780928465218691*^9, 3.780929128836433*^9, 
  3.780929229591942*^9, 3.780935947417955*^9, 3.780936199735284*^9, 
  3.780944796536189*^9, 3.780944909072832*^9, 3.781519339466641*^9, 
  3.781519465453019*^9, 3.781519542256578*^9, 3.7815196604250927`*^9, 
  3.781519798552368*^9, 3.781520297052354*^9, 
  3.781522715781843*^9},ExpressionUUID->"957c3bb5-7c31-4fc5-b201-\
0600cb8aee19"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deltaX", " ", "=", " ", 
   RowBox[{
    RowBox[{"bb", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "-", 
    RowBox[{"ba", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaY", " ", "=", " ", 
   RowBox[{
    RowBox[{"bb", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "-", 
    RowBox[{"ba", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaZ", " ", "=", " ", 
   RowBox[{
    RowBox[{"bb", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "-", 
    RowBox[{"ba", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.780920724501801*^9, 3.7809207548155327`*^9}, {
  3.7809208194838963`*^9, 3.7809208374117603`*^9}, {3.7809213619891577`*^9, 
  3.780921367491825*^9}, {3.780922082473507*^9, 3.78092209832279*^9}, {
  3.780922188072029*^9, 3.780922191339725*^9}, {3.780924848008692*^9, 
  3.78092485830682*^9}, {3.781518249218337*^9, 
  3.781518262823091*^9}},ExpressionUUID->"3be9cd52-872d-4a49-b010-\
eed5e31db5ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ddx", " ", "=", " ", 
   RowBox[{"PBX", "[", "deltaX", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddy", " ", "=", " ", 
   RowBox[{"PBY", "[", "deltaY", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ddz", " ", "=", " ", 
   RowBox[{"PBZ", "[", "deltaZ", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.780924871039298*^9, 
  3.7809248979713306`*^9}},ExpressionUUID->"b7d95fe9-9e6a-4b89-8406-\
cf27452e4ba9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PBX", "'"}], "[", "x_", "]"}], " ", ":=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PBY", "'"}], "[", "x_", "]"}], " ", ":=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PBZ", "'"}], "[", "x_", "]"}], " ", ":=", " ", "1"}], 
  ";"}]}], "Input",ExpressionUUID->"1df4f7ef-c456-4e20-a537-284b728469c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"distanceSquared", " ", "=", " ", 
  RowBox[{
   RowBox[{"ddx", "*", "ddx"}], "+", 
   RowBox[{"ddy", "*", "ddy"}], "+", 
   RowBox[{"ddz", "*", "ddz"}]}]}]], "Input",
 CellChangeTimes->{{3.781518076372891*^9, 3.78151809375278*^9}, 
   3.78151831920844*^9, {3.781519361555169*^9, 
   3.781519371091302*^9}},ExpressionUUID->"5933a60e-14a0-42ff-81ab-\
bdfa68cf0c55"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"PBX", "[", 
    RowBox[{
     RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"PBY", "[", 
    RowBox[{
     RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"PBZ", "[", 
    RowBox[{
     RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.78151948841695*^9, 3.7815195485851727`*^9, 
  3.781519660559826*^9, 3.7815197986595707`*^9, 3.781520297161193*^9, 
  3.781522715900543*^9},ExpressionUUID->"7d2b8ac4-9b56-4c4e-b00d-\
a74091692875"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondDistance", " ", "=", " ", 
  RowBox[{"Sqrt", "[", "distanceSquared", "]"}]}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
   3.411197578518401*^9, 3.411197589788989*^9}, {3.7809208460671387`*^9, 
   3.780920865547496*^9}, {3.780921373125165*^9, 3.780921394640828*^9}, {
   3.780922194362948*^9, 3.780922204878215*^9}, {3.780924903438052*^9, 
   3.7809249169975843`*^9}, {3.7809250506229763`*^9, 
   3.7809250611808043`*^9}, {3.781518297231223*^9, 3.781518321366275*^9}, 
   3.781519495754019*^9},ExpressionUUID->"b36654fb-48ad-4f60-95e5-\
e46a9c8fa8a9"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"PBY", "[", 
     RowBox[{
      RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"PBZ", "[", 
     RowBox[{
      RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.781519496064987*^9, 3.781519550601678*^9, 
  3.781519660616048*^9, 3.78151979872985*^9, 3.7815202972131577`*^9, 
  3.781522715957254*^9},ExpressionUUID->"112528e0-caec-470c-8bf9-\
d01bf59e6cb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evdwEquation", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["dA", 
     SuperscriptBox["nonbondDistance", "12"]], "-", 
    FractionBox["dC", 
     SuperscriptBox["nonbondDistance", "6"]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 
   3.416871995722517*^9},ExpressionUUID->"e4ecce2d-11d5-4b85-bf6e-\
1c511eb237d1"],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], 
    "3"]]}]], "Output",
 CellChangeTimes->{3.780926556766597*^9, 3.780926751908362*^9, 
  3.780926919135029*^9, 3.7809280209269333`*^9, 3.780928077964336*^9, 
  3.7809283456605167`*^9, 3.78092846533235*^9, 3.7809291290084133`*^9, 
  3.7809292297610483`*^9, 3.7809359475756063`*^9, 3.780936199878108*^9, 
  3.780944796676839*^9, 3.780944909175324*^9, 3.781519501140484*^9, 
  3.781519553113057*^9, 3.781519660675488*^9, 3.781519798809717*^9, 
  3.781520297282194*^9, 
  3.7815227160259247`*^9},ExpressionUUID->"9d08e572-7b99-4b46-bc1c-\
edf3d64cde0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eeelEquation", " ", "=", " ", 
  RowBox[{"(", 
   FractionBox["dQ1Q2", "nonbondDistance"], ")"}]}]], "Input",
 CellChangeTimes->{{3.4026534322622623`*^9, 3.402653496407857*^9}, {
   3.4026535524322023`*^9, 3.402653641591628*^9}, {3.4026779483394947`*^9, 
   3.402677953362184*^9}, {3.4026781314714537`*^9, 3.4026781348802843`*^9}, {
   3.40274101413416*^9, 3.402741050316153*^9}, {3.407556736609376*^9, 
   3.4075567425681257`*^9}, {3.407557208386277*^9, 3.407557225106896*^9}, {
   3.408662115934063*^9, 3.408662119317389*^9}, 3.411081885331176*^9, {
   3.411197627982712*^9, 3.411197630382259*^9}, 
   3.416871999453731*^9},ExpressionUUID->"d57a3757-ab4e-45e7-89a8-\
13fcf89aaab6"],

Cell[BoxData[
 FractionBox["dQ1Q2", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"PBX", "[", 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"PBY", "[", 
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"PBZ", "[", 
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}]]]], "Output",
 CellChangeTimes->{3.780926556820374*^9, 3.780926751977495*^9, 
  3.7809269192114353`*^9, 3.7809280209916162`*^9, 3.780928078046918*^9, 
  3.780928345714436*^9, 3.7809284653787813`*^9, 3.780929129089121*^9, 
  3.780929229843583*^9, 3.780935947657263*^9, 3.7809361999410963`*^9, 
  3.7809447967516193`*^9, 3.780944909231134*^9, 3.78151950776829*^9, 
  3.781519560916519*^9, 3.781519660734394*^9, 3.7815197988891563`*^9, 
  3.7815202973620462`*^9, 
  3.7815227161279984`*^9},ExpressionUUID->"2e547006-1761-4908-adb3-\
16b060b491a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondEquation", " ", "=", " ", 
  RowBox[{"evdwEquation", " ", "+", " ", "eeelEquation"}]}]], "Input",
 CellChangeTimes->{{3.4027412120076227`*^9, 3.402741220906414*^9}, {
  3.4086620876703787`*^9, 
  3.408662102195766*^9}},ExpressionUUID->"9bbdfa5d-e675-4352-a694-\
e98112f9445d"],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "3"]], "+", 
  FractionBox["dQ1Q2", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"PBX", "[", 
       RowBox[{
        RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"PBY", "[", 
       RowBox[{
        RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"PBZ", "[", 
       RowBox[{
        RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}]]]}]], "Output",
 CellChangeTimes->{3.780926556881501*^9, 3.7809267520518208`*^9, 
  3.780926919299748*^9, 3.780928021070907*^9, 3.780928078146236*^9, 
  3.780928345782587*^9, 3.780928465452674*^9, 3.7809291291721277`*^9, 
  3.7809292299311123`*^9, 3.7809359477370043`*^9, 3.78093620002391*^9, 
  3.78094479683667*^9, 3.7809449092767773`*^9, 3.781519510565617*^9, 
  3.781519571317513*^9, 3.781519660797351*^9, 3.781519798969303*^9, 
  3.781520297421359*^9, 
  3.781522716208685*^9},ExpressionUUID->"dd7eaa6d-80a6-41c7-903c-\
8d980d4aed44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input",ExpressionUUID->\
"42be9b2f-6ceb-4fb4-8b88-a37428204869"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7809265569424467`*^9, 3.7809267521531277`*^9, 
  3.780926919400226*^9, 3.78092802115171*^9, 3.7809280782258253`*^9, 
  3.780928345843046*^9, 3.780928465551189*^9, 3.780929129254285*^9, 
  3.7809292300113707`*^9, 3.780935947816638*^9, 3.7809362001184893`*^9, 
  3.780944796917156*^9, 3.780944909331366*^9, 3.781519578840838*^9, 
  3.781519660876753*^9, 3.781519799049683*^9, 3.781520297479785*^9, 
  3.781522716268927*^9},ExpressionUUID->"9560e881-b965-482c-9cf0-\
7fc26a328cf4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gx1", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"nonbondEquation", ",", " ", "x1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7815195970083*^9, 3.7815195981173277`*^9}, {
   3.781519668410584*^9, 3.781519676964076*^9}, 3.781520262212016*^9, {
   3.781522503546514*^9, 
   3.781522503550324*^9}},ExpressionUUID->"f7e4707e-7c41-4aca-adc4-\
9d588e8f629c"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"12", " ", "dA", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "7"]], "-", 
  FractionBox[
   RowBox[{"6", " ", "dC", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "4"]], "+", 
  FractionBox[
   RowBox[{"dQ1Q2", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{
  3.781522858545685*^9},ExpressionUUID->"ea6b81df-9a10-415b-be5e-\
e0be2cd9c21d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fx1", " ", "=", " ", 
  RowBox[{"-", " ", "gx1"}]}]], "Input",
 CellChangeTimes->{{3.781519686821206*^9, 3.7815196894406567`*^9}, 
   3.781520262215139*^9, {3.78152250355182*^9, 
   3.781522503553029*^9}},ExpressionUUID->"dd649c5c-b84f-4fec-9923-\
3ae3a9fc8cf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"12", " ", "dA", " ", 
     RowBox[{"PBX", "[", 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"PBX", "[", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"PBY", "[", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"PBZ", "[", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "7"]]}], 
  "+", 
  FractionBox[
   RowBox[{"6", " ", "dC", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "4"]], "-", 
  FractionBox[
   RowBox[{"dQ1Q2", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{
  3.781522858649487*^9},ExpressionUUID->"bf69c842-1ca2-428e-8ef0-\
57aea12cc46f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gx2", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"nonbondEquation", ",", " ", "x2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7815195970083*^9, 3.7815195981173277`*^9}, {
   3.781519668410584*^9, 3.781519676964076*^9}, 3.781520262212016*^9, {
   3.781522503546514*^9, 3.781522503550324*^9}, {3.7815226066365757`*^9, 
   3.781522608552788*^9}},ExpressionUUID->"3d2aca5a-00fa-431f-9eaf-\
77af83fffc39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"12", " ", "dA", " ", 
     RowBox[{"PBX", "[", 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"PBX", "[", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"PBY", "[", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"PBZ", "[", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "7"]]}], 
  "+", 
  FractionBox[
   RowBox[{"6", " ", "dC", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "4"]], "-", 
  FractionBox[
   RowBox[{"dQ1Q2", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{
  3.781522858728064*^9},ExpressionUUID->"b044838c-36be-4b5d-b39c-\
2531c04c0f7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fx2", " ", "=", " ", 
  RowBox[{"-", " ", "gx2"}]}]], "Input",
 CellChangeTimes->{{3.781522615257032*^9, 
  3.78152261982759*^9}},ExpressionUUID->"b956ad0d-7062-4d75-8177-\
e7a64dccf2b2"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"12", " ", "dA", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "7"]], "-", 
  FractionBox[
   RowBox[{"6", " ", "dC", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], "4"]], "+", 
  FractionBox[
   RowBox[{"dQ1Q2", " ", 
    RowBox[{"PBX", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"PBX", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBY", "[", 
        RowBox[{
         RowBox[{"-", "y1"}], "+", "y2"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"PBZ", "[", 
        RowBox[{
         RowBox[{"-", "z1"}], "+", "z2"}], "]"}], "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]]}]], "Output",
 CellChangeTimes->{
  3.7815228588067217`*^9},ExpressionUUID->"612b8a33-eb77-427e-8ea7-\
9e07fbf93707"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x1", " ", "=", " ", "2.8"}], ";", " ", 
  RowBox[{"y1", " ", "=", " ", "0.0"}], ";", " ", 
  RowBox[{"z1", " ", "=", " ", "0.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"x2", " ", "=", " ", 
   RowBox[{"-", "2.9"}]}], ";", " ", 
  RowBox[{"y2", " ", "=", " ", "0.0"}], ";", " ", 
  RowBox[{"z2", " ", "=", " ", "0.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PBX", "[", "a_", "]"}], " ", "=", " ", "a"}], ";", " ", 
  RowBox[{
   RowBox[{"PBY", "[", "a_", "]"}], " ", "=", " ", "a"}], ";", " ", 
  RowBox[{
   RowBox[{"PBZ", "[", "a_", "]"}], " ", "=", " ", "a"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dQ1Q2", " ", "=", " ", "0.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dA", " ", "=", " ", 
   RowBox[{"3.156", "*", 
    RowBox[{"10", "^", "12"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dC", " ", "=", " ", 
   RowBox[{"1.736512", "*", 
    RowBox[{"10", "^", "6"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7815183921518307`*^9, 3.781518454889724*^9}, {
   3.781519286215425*^9, 3.78151933182628*^9}, 3.781519453963153*^9, {
   3.7815195252838583`*^9, 3.781519532337062*^9}, 3.781519764639015*^9, {
   3.7815225035544147`*^9, 
   3.7815225035556507`*^9}},ExpressionUUID->"dd0a4412-8ddd-4889-8039-\
ed1c5b9eb855"],

Cell[CellGroupData[{

Cell[BoxData["nonbondEquation"], "Input",
 CellChangeTimes->{{3.781519698334396*^9, 3.7815197004101877`*^9}, 
   3.781519764639361*^9, {3.781522503557337*^9, 
   3.781522503558758*^9}},ExpressionUUID->"87bbdaad-8b1a-4a26-870f-\
09875f3e02d4"],

Cell[BoxData["2632.479119248932`"], "Output",
 CellChangeTimes->{
  3.7815228589067574`*^9},ExpressionUUID->"f9477404-1dfa-4b58-8737-\
cc6b48c8dee6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["fx1"], "Input",
 CellChangeTimes->{{3.781519703357469*^9, 3.781519703831881*^9}, {
  3.7815197450775013`*^9, 3.7815197646399384`*^9}, {3.7815225035625353`*^9, 
  3.781522503563732*^9}, {3.7815225490754223`*^9, 
  3.781522552756001*^9}},ExpressionUUID->"ec9ad749-e978-4461-aa01-\
d7781715dca3"],

Cell[BoxData["5595.358584159733`"], "Output",
 CellChangeTimes->{
  3.781522858988928*^9},ExpressionUUID->"3d9b7261-37ba-41bd-8f3b-\
82d906d560c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["fx2"], "Input",
 CellChangeTimes->{{3.78152262247856*^9, 
  3.7815226230627832`*^9}},ExpressionUUID->"c0d16d0c-051f-4af8-81a3-\
0f1836a4f3eb"],

Cell[BoxData[
 RowBox[{"-", "5595.358584159733`"}]], "Output",
 CellChangeTimes->{
  3.781522859066519*^9},ExpressionUUID->"4d44dfb2-8b22-4fc5-a716-\
c1e1c02cd407"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 
  3.401714933019302*^9}},ExpressionUUID->"9afa1783-4c40-4de2-aa4b-\
1145622413f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408564450747929*^9, 
  3.408564451541582*^9}},ExpressionUUID->"6b90835a-5cbe-4a58-9285-\
2a21c24094a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonbondSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dQ1Q2);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dA);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dC);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
  3.487025950138463*^9, 3.487025960189999*^9}, {3.487026052805409*^9, 
  3.487026058323876*^9}, {3.487032089923287*^9, 
  3.487032096633906*^9}},ExpressionUUID->"cfe6e606-fba1-48ea-bf9a-\
562e67f5ca83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "nonbondVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<NONBOND_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"nonbondSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 
  3.4101779539373293`*^9}},ExpressionUUID->"0e70dbf2-9ac3-4e19-8d86-\
51d956144364"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.780926557026971*^9, 3.7809267522712*^9, 
  3.780926919541565*^9, 3.780928021249503*^9, 3.78092807832502*^9, 
  3.7809283459392967`*^9, 3.7809284656378613`*^9, 3.78092912945761*^9, 
  3.7809292301274843`*^9, 3.780935947938057*^9, 3.780936200284636*^9, 
  3.780944797037328*^9, 3.78094490943125*^9, 3.781519799343711*^9, 
  3.781520297552343*^9, 
  3.781522716527821*^9},ExpressionUUID->"828251f2-b7cc-42c7-a393-\
340a61693761"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.780926557026971*^9, 3.7809267522712*^9, 
  3.780926919541565*^9, 3.780928021249503*^9, 3.78092807832502*^9, 
  3.7809283459392967`*^9, 3.7809284656378613`*^9, 3.78092912945761*^9, 
  3.7809292301274843`*^9, 3.780935947938057*^9, 3.780936200284636*^9, 
  3.780944797037328*^9, 3.78094490943125*^9, 3.781519799343711*^9, 
  3.781520297552343*^9, 
  3.781522716539345*^9},ExpressionUUID->"0ab42c07-b94d-4325-8b59-\
e8821fd3a1d9"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.780926557026971*^9, 3.7809267522712*^9, 
  3.780926919541565*^9, 3.780928021249503*^9, 3.78092807832502*^9, 
  3.7809283459392967`*^9, 3.7809284656378613`*^9, 3.78092912945761*^9, 
  3.7809292301274843`*^9, 3.780935947938057*^9, 3.780936200284636*^9, 
  3.780944797037328*^9, 3.78094490943125*^9, 3.781519799343711*^9, 
  3.781520297552343*^9, 
  3.781522716546816*^9},ExpressionUUID->"6790db43-f140-4749-b770-\
9761c9056c5b"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.780926557026971*^9, 3.7809267522712*^9, 
  3.780926919541565*^9, 3.780928021249503*^9, 3.78092807832502*^9, 
  3.7809283459392967`*^9, 3.7809284656378613`*^9, 3.78092912945761*^9, 
  3.7809292301274843`*^9, 3.780935947938057*^9, 3.780936200284636*^9, 
  3.780944797037328*^9, 3.78094490943125*^9, 3.781519799343711*^9, 
  3.781520297552343*^9, 
  3.781522716556282*^9},ExpressionUUID->"64183308-818d-4d07-8f68-\
932c3ac20fdf"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.780926557026971*^9, 3.7809267522712*^9, 
  3.780926919541565*^9, 3.780928021249503*^9, 3.78092807832502*^9, 
  3.7809283459392967`*^9, 3.7809284656378613`*^9, 3.78092912945761*^9, 
  3.7809292301274843`*^9, 3.780935947938057*^9, 3.780936200284636*^9, 
  3.780944797037328*^9, 3.78094490943125*^9, 3.781519799343711*^9, 
  3.781520297552343*^9, 
  3.781522716563691*^9},ExpressionUUID->"2f0e7915-256e-4c92-9a0f-\
01f5c4b6ebed"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.780926557026971*^9, 3.7809267522712*^9, 
  3.780926919541565*^9, 3.780928021249503*^9, 3.78092807832502*^9, 
  3.7809283459392967`*^9, 3.7809284656378613`*^9, 3.78092912945761*^9, 
  3.7809292301274843`*^9, 3.780935947938057*^9, 3.780936200284636*^9, 
  3.780944797037328*^9, 3.78094490943125*^9, 3.781519799343711*^9, 
  3.781520297552343*^9, 
  3.781522716570754*^9},ExpressionUUID->"96cd5c87-a8f8-4e35-b267-\
d034293fb241"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9},ExpressionUUID->"1bd7bda5-b589-44c1-b96b-\
7a2d936004ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dA);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dC);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.780926557119523*^9, 3.780926752376314*^9, 
  3.780926919661775*^9, 3.7809280213716087`*^9, 3.780928078446322*^9, 
  3.780928346043239*^9, 3.780928465734064*^9, 3.780929129573079*^9, 
  3.7809292302596617`*^9, 3.780935948037105*^9, 3.78093620040368*^9, 
  3.780944797158523*^9, 3.780944909511058*^9, 3.781519799452248*^9, 
  3.7815202976397543`*^9, 
  3.781522716649715*^9},ExpressionUUID->"b22d6899-4b6c-47aa-9be7-\
818ce5fde576"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonbondEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonbondOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DeltaX", ",", "deltaX"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DeltaY", ",", "deltaY"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DeltaZ", ",", "deltaZ"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DistanceSquared", ",", "distanceSquared"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<BAIL_OUT_IF_CUTOFF(DistanceSquared)\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Evdw", ",", "evdwEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND_EVDW\>\"", ",", "Evdw"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Eeel", ",", "eeelEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND_EEEL\>\"", ",", "Eeel"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", 
      RowBox[{"Evdw", "+", "Eeel"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "DeltaX"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "DeltaY"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "DeltaZ"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Evdw"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Eeel"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}, {3.780926904705009*^9, 3.780926915600004*^9}, {
   3.780944783113442*^9, 3.780944792801734*^9}, {3.7815183366497993`*^9, 
   3.781518356450881*^9}},ExpressionUUID->"5748ff68-db34-4ac3-8279-\
3935f5c793f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 
  3.409334145792842*^9}},ExpressionUUID->"c39169d8-f987-4798-9872-\
debd8e68fb62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7809265572000437`*^9, 3.780926752470871*^9, 
  3.7809269197821693`*^9, 3.780928021512999*^9, 3.78092807856861*^9, 
  3.780928346138074*^9, 3.7809284658292227`*^9, 3.78092912968371*^9, 
  3.780929230410882*^9, 3.780935948136084*^9, 3.780936200502945*^9, 
  3.780944797297296*^9, 3.780944909574699*^9, 3.7815197996730328`*^9, 
  3.7815202977213917`*^9, 
  3.781522716783176*^9},ExpressionUUID->"cf831e40-d392-4b0a-860d-\
0b4f09cafe91"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 
  3.410177986821323*^9}},ExpressionUUID->"a0dc323a-6098-4665-a3b2-\
b2894ff60fe3"],

Cell["\<\
AppendGradientForceAndHessian[\"NONBOND\", nonbondForceHessianRules, \
nonbondOutputs, nonbondHessian, nonbondEquation, nonbondVarNames];\
\>", "Text",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
   3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
   3.410177993430345*^9}, 
   3.780927996917322*^9},ExpressionUUID->"14519ff6-cd03-428c-a2a7-\
0052c1a28a48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<NONBOND\>\"", ",", "nonbondForceHessianRules", ",", "nonbondOutputs", 
    ",", "nonbondHessian", ",", "nonbondEquation", ",", "nonbondVarNames"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
   3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
   3.410177993430345*^9}, {3.780921820310665*^9, 3.780921826141823*^9}, 
   3.780921935979871*^9, 3.780922415935417*^9, {3.7809258490923853`*^9, 
   3.7809258564453287`*^9}, {3.7809280002700253`*^9, 3.780928013726637*^9}, {
   3.780928073316613*^9, 3.780928073583609*^9}, 3.780929223912319*^9, {
   3.780944768405443*^9, 
   3.780944776402252*^9}},ExpressionUUID->"14519ff6-cd03-428c-a2a7-\
0052c1a28a48"],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 
  3.4017149467691317`*^9}},ExpressionUUID->"eea4db31-b283-4483-bfd5-\
f544a1e8a9ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"nonbondOutputs", ",", "NonbondDistance"}], "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
  3.4111976578180523`*^9, 
  3.411197662226531*^9}},ExpressionUUID->"3ef28021-744f-462f-9833-\
3dc13a7cca68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "DeltaX", ",", "DeltaY", ",", "DeltaZ", ",", "Energy", ",", "Evdw", ",", 
   "Eeel", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", 
   "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", 
   "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", 
   "ohx2z2", ",", "ohy2z2", ",", "NonbondDistance"}], "}"}]], "Output",
 CellChangeTimes->{3.7809265592291813`*^9, 3.780926755392572*^9, 
  3.780926922482809*^9, 3.780928021625882*^9, 3.780928080556851*^9, 
  3.780928348143249*^9, 3.780928467866991*^9, 3.780929131888207*^9, 
  3.780929233020479*^9, 3.780935950098855*^9, 3.780936202602854*^9, 
  3.780944799636751*^9, 3.780944911074315*^9, 3.78151980192603*^9, 
  3.781520299776154*^9, 
  3.781522718736031*^9},ExpressionUUID->"7857db04-7240-4ff0-9a69-\
2d8fc579049b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9},ExpressionUUID->"3b2f49e2-f3f0-4ed2-85a8-\
7c9e56a5bb10"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "DeltaX", ",", "DeltaY", ",", "DeltaZ", ",", "Energy", ",", "Evdw", ",", 
     "Eeel", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
     "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
     "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", 
     ",", "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", "ohy1x2", ",", 
     "ohy1y2", ",", "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", 
     ",", "ohx2y2", ",", "ohx2z2", ",", "ohy2z2", ",", "NonbondDistance"}], 
    "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.780926559300969*^9, 3.7809267554769297`*^9, 
  3.780926922562552*^9, 3.7809280217145777`*^9, 3.780928080628806*^9, 
  3.780928348198745*^9, 3.780928467934885*^9, 3.7809291319707336`*^9, 
  3.780929233099309*^9, 3.780935950176908*^9, 3.780936202683071*^9, 
  3.780944799719797*^9, 3.7809449111308928`*^9, 3.781519801979911*^9, 
  3.781520299831707*^9, 
  3.7815227188086042`*^9},ExpressionUUID->"b20ab8a7-3abd-4033-8575-\
07c42aebdd6b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "nonbondSetupRules", ",", "nonbondEnergyRules", ",", 
      "nonbondForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 
  3.410178019066489*^9}},ExpressionUUID->"de43ee89-e248-48fd-8059-\
1ee8fd91895e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Nonbond\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "nonbondEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "nonbondHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "nonbondRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "nonBondInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "nonbondOutputs"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9},ExpressionUUID->"dd3522e4-5433-4f76-b0ea-\
909c66a95f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "nbPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 
   3.4110670742215853`*^9},ExpressionUUID->"0591fea1-e58a-4be8-a173-\
76d21f2b1c8f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing finite difference debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Nonbond_debugFiniteDifference.cc\"\>"}],
  SequenceForm[
  "Writing finite difference debug code to: ", 
   "_Nonbond_debugFiniteDifference.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.78092655938754*^9, 3.780926755599687*^9, 
  3.7809269226859303`*^9, 3.7809280218680058`*^9, 3.780928080729287*^9, 
  3.780928348285722*^9, 3.780928468050495*^9, 3.780929132090889*^9, 
  3.780929233197509*^9, 3.780935950297217*^9, 3.780936202785598*^9, 
  3.7809447998213387`*^9, 3.780944911195014*^9, 3.7815198020726347`*^9, 
  3.781520299918396*^9, 
  3.781522718910058*^9},ExpressionUUID->"c662669e-0a31-4341-9ac1-\
0bf2e5974682"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing debug variable declares to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Nonbond_debugEvalDeclares.cc\"\>"}],
  SequenceForm[
  "Writing debug variable declares to: ", "_Nonbond_debugEvalDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.78092655938754*^9, 3.780926755599687*^9, 
  3.7809269226859303`*^9, 3.7809280218680058`*^9, 3.780928080729287*^9, 
  3.780928348285722*^9, 3.780928468050495*^9, 3.780929132090889*^9, 
  3.780929233197509*^9, 3.780935950297217*^9, 3.780936202785598*^9, 
  3.7809447998213387`*^9, 3.780944911195014*^9, 3.7815198020726347`*^9, 
  3.781520299918396*^9, 
  3.781522718919347*^9},ExpressionUUID->"be704d18-2fa4-45d3-b683-\
84f465cfa98a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing xml output debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Nonbond_debugEvalSerialize.cc\"\>"}],
  SequenceForm[
  "Writing xml output debug code to: ", "_Nonbond_debugEvalSerialize.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.78092655938754*^9, 3.780926755599687*^9, 
  3.7809269226859303`*^9, 3.7809280218680058`*^9, 3.780928080729287*^9, 
  3.780928348285722*^9, 3.780928468050495*^9, 3.780929132090889*^9, 
  3.780929233197509*^9, 3.780935950297217*^9, 3.780936202785598*^9, 
  3.7809447998213387`*^9, 3.780944911195014*^9, 3.7815198020726347`*^9, 
  3.781520299918396*^9, 
  3.781522718924554*^9},ExpressionUUID->"5f753cba-43e0-48e7-85f1-\
fa431bca6c05"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing set variables debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Nonbond_debugEvalSet.cc\"\>"}],
  SequenceForm[
  "Writing set variables debug code to: ", "_Nonbond_debugEvalSet.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.78092655938754*^9, 3.780926755599687*^9, 
  3.7809269226859303`*^9, 3.7809280218680058`*^9, 3.780928080729287*^9, 
  3.780928348285722*^9, 3.780928468050495*^9, 3.780929132090889*^9, 
  3.780929233197509*^9, 3.780935950297217*^9, 3.780936202785598*^9, 
  3.7809447998213387`*^9, 3.780944911195014*^9, 3.7815198020726347`*^9, 
  3.781520299918396*^9, 
  3.781522718929467*^9},ExpressionUUID->"f5b3466e-5f23-4ed4-bdc6-\
7307eefbb95e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "nbPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 
   3.411066673303035*^9},ExpressionUUID->"4560ee6b-0061-424d-b437-\
02fc7d3e4433"],

Cell[BoxData[
 StyleBox["\<\"Set TimesSimplify and PlusSimplify to turn these \
simplifications off and on\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->24,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522719007592*^9},ExpressionUUID->"8eb2bad4-9816-447b-80f1-\
d6a05967690a"],

Cell[BoxData[
 StyleBox["\<\"PlusOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522719016717*^9},ExpressionUUID->"bca06915-0af5-43cc-b4b1-\
a6feac6d1c5c"],

Cell[BoxData[
 StyleBox["\<\"TimesOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522719021761*^9},ExpressionUUID->"727cc927-aa9b-44a0-88c6-\
a24925196440"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522727670553*^9},ExpressionUUID->"8573d7a4-907c-49ce-9a2e-\
0a34c47fd935"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522727676*^9},ExpressionUUID->"e3e76b41-efe8-4c0e-b60d-7dc0d436a7ba"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522727682819*^9},ExpressionUUID->"d165254f-c58a-46d8-ba0f-\
a747e47be998"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522727688314*^9},ExpressionUUID->"899b3563-8953-4b93-a5c2-\
8fcdd7cadc7d"],

Cell[BoxData["\<\"Collecting terms\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.7815227277516747`*^9},ExpressionUUID->"befc0cee-1d89-4d9e-be56-\
fcca4c26705e"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], ":", 
  " ", "\<\"Tag \[NoBreak]\\!\\(\\*RowBox[{\\\"Times\\\"}]\\)\[NoBreak] in \
\[NoBreak]\\!\\(\\*RowBox[{\\\"Null\\\", \\\" \\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Name\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"Nonbond\\\\\\\"\\\"}], \\\",\\\", RowBox[{\\\"AdditionalCDeclares\
\\\", \\\"\[Rule]\\\", \\\"\\\\\\\"\\\\\\\"\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"Input\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"x1\\\", \\\",\\\", \\\"y1\\\", \\\",\\\", \\\"z1\\\", \\\",\\\", \
\\\"x2\\\", \\\",\\\", \\\"y2\\\", \\\",\\\", \\\"z2\\\", \\\",\\\", \\\"dA\\\
\", \\\",\\\", \\\"dC\\\", \\\",\\\", \\\"dQ1Q2\\\"}], \\\"}\\\"}]}], \\\",\\\
\", RowBox[{\\\"Output\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"DeltaX\\\", \\\",\\\", \\\"DeltaY\\\", \\\",\\\", \\\"DeltaZ\\\", \
\\\",\\\", \\\"Energy\\\", \\\",\\\", \\\"Evdw\\\", \\\",\\\", \\\"Eeel\\\", \
\\\",\\\", \\\"fx1\\\", \\\",\\\", \\\"fy1\\\", \\\",\\\", \\\"fz1\\\", \\\",\
\\\", \\\"fx2\\\", \\\",\\\", \\\"fy2\\\", \\\",\\\", \\\"fz2\\\", \\\",\\\", \
\\\"dhx1x1\\\", \\\",\\\", \\\"dhy1y1\\\", \\\",\\\", \\\"dhz1z1\\\", \\\",\\\
\", \\\"dhx2x2\\\", \\\",\\\", \\\"dhy2y2\\\", \\\",\\\", \\\"dhz2z2\\\", \
\\\",\\\", \\\"ohx1y1\\\", \\\",\\\", \\\"ohx1z1\\\", \\\",\\\", \\\"ohx1x2\\\
\", \\\",\\\", \\\"ohx1y2\\\", \\\",\\\", \\\"ohx1z2\\\", \\\",\\\", \
\\\"ohy1z1\\\", \\\",\\\", \\\"ohy1x2\\\", \\\",\\\", \\\"ohy1y2\\\", \\\",\\\
\", \\\"ohy1z2\\\", \\\",\\\", \\\"ohz1x2\\\", \\\",\\\", \\\"ohz1y2\\\", \
\\\",\\\", \\\"ohz1z2\\\", \\\",\\\", \\\"ohx2y2\\\", \\\",\\\", \\\"ohx2z2\\\
\", \\\",\\\", \\\"ohy2z2\\\", \\\",\\\", \\\"NonbondDistance\\\"}], \
\\\"}\\\"}]}]}], \\\"}\\\"}]}]\\)\[NoBreak] is Protected. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.780926568189004*^9, 3.780926766661644*^9, 
  3.780926933843408*^9, 3.780928024071746*^9, 3.780928088713044*^9, 
  3.7809283588119164`*^9, 3.7809284778626127`*^9, 3.780929142856489*^9, 
  3.780929244036914*^9, 3.780935959114752*^9, 3.780936212270543*^9, 
  3.780944809343563*^9, 3.780944917275691*^9, 3.7815198056010313`*^9, 
  3.781520308848228*^9, 
  3.781522727758614*^9},ExpressionUUID->"567340a3-41a5-4d38-b799-\
37419256eabb"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522736471373*^9},ExpressionUUID->"4ecb9d45-6407-4610-8ee5-\
117978a62f1c"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522736476746*^9},ExpressionUUID->"2f3227d4-81dd-40ad-b725-\
4b06a72c8ed2"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522736483615*^9},ExpressionUUID->"4e550026-9c62-4481-9e23-\
ca6348a86436"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.7815227364891376`*^9},ExpressionUUID->"438e96cb-9457-4f6d-8f32-\
5355fb28861b"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522744694471*^9},ExpressionUUID->"f4ece002-dbf8-4eab-9297-\
ac80a615db13"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522744700356*^9},ExpressionUUID->"6b4e4e13-f8cf-4454-bab8-\
106a2aec3dc9"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522744707402*^9},ExpressionUUID->"698274e4-b9b3-4186-acb8-\
0e000ccdf49c"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.7815227447128696`*^9},ExpressionUUID->"00c0b402-302c-4e54-a4e0-\
dcad25c8e73c"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522752812128*^9},ExpressionUUID->"e24b77cf-4f57-49a6-a37d-\
f1f4aaa2dd65"],

Cell[BoxData["\<\"trivialRules>> triv = {tx172 -> tx163, DistanceSquared -> \
tx166, tx94 -> tx167}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.78152275281754*^9},ExpressionUUID->"e34c8cca-402b-484f-b0a1-aded5ba99e37"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522752822644*^9},ExpressionUUID->"f2594ffb-b311-4cf4-9c1a-\
dc9938120eb2"],

Cell[BoxData["\<\"Trivial rules are being removed: tx172 -> \
tx163\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522752829113*^9},ExpressionUUID->"e5ef3355-58ca-4bf0-96f0-\
8120dfa81ae4"],

Cell[BoxData["\<\"After removal: \
CCode[NONBOND_SET_PARAMETER(I1);]\\n\\nCCode[NONBOND_SET_PARAMETER(I2);]\\n\\\
nCCode[NONBOND_SET_PARAMETER(dQ1Q2);]\\n\\nCCode[NONBOND_SET_PARAMETER(dA);]\\\
n\\nCCode[NONBOND_SET_PARAMETER(dC);]\\n\\nCCode[NONBOND_SET_POSITION(x1,I1,0)\
;]\\n\\nCCode[NONBOND_SET_POSITION(y1,I1,1);]\\n\\nCCode[NONBOND_SET_POSITION(\
z1,I1,2);]\\n\\nCCode[NONBOND_SET_POSITION(x2,I2,0);]\\n\\nCCode[NONBOND_SET_\
POSITION(y2,I2,1);]\\n\\nCCode[NONBOND_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> \
tx81\\n\\ntx81 + x2 -> DeltaX\\n\\n-y1 -> tx82\\n\\ntx82 + y2 -> \
DeltaY\\n\\n-z1 -> tx83\\n\\ntx83 + z2 -> DeltaZ\\n\\nPBX[DeltaX] -> \
tx84\\n\\nPBY[DeltaY] -> tx85\\n\\nPBZ[DeltaZ] -> tx86\\n\\npower2[tx84] -> \
tx87\\n\\npower2[tx85] -> tx88\\n\\npower2[tx86] -> tx89\\n\\ntx87 + tx88 + \
tx89 -> DistanceSquared\\n\\nCCode[BAIL_OUT_IF_CUTOFF(DistanceSquared)]\\n\\\
npowern2[DistanceSquared] -> tx171\\n\\nreciprocal[DistanceSquared] -> \
tx172\\n\\ntx171 tx172 -> tx161\\n\\npower2[tx161] -> tx90\\n\\npower2[tx172] \
-> tx162\\n\\ntx172 -> tx163\\n\\ntx162 tx163 -> tx91\\n\\ndA tx90 -> tx92\\n\
\\n-(dC tx91) -> tx93\\n\\ntx92 + tx93 -> \
Evdw\\n\\nCCode[NONBOND_EVDW_ENERGY_ACCUMULATE(Evdw);]\\n\\nmysqrt[\
DistanceSquared] -> tx164\\n\\nreciprocal[tx164] -> tx94\\n\\ndQ1Q2 tx94 -> \
Eeel\\n\\nCCode[NONBOND_EEEL_ENERGY_ACCUMULATE(Eeel);]\\n\\nEeel + Evdw -> \
Energy\\n\\nCCode[NONBOND_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
NONBOND_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\npower2[tx171] -> \
tx165\\n\\ntx161 tx165 -> tx95\\n\\npower2[tx162] -> \
tx96\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\nreciprocal[tx166] \
-> tx168\\n\\ntx167 tx168 -> tx97\\n\\n12. dA tx84 tx95 -> tx98\\n\\n-6. dC \
tx84 tx96 -> tx99\\n\\ndQ1Q2 tx84 tx97 -> tx100\\n\\ntx100 + tx98 + tx99 -> \
gx1\\n\\n-gx1 -> fx1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n12. dA tx85 tx95 -> tx101\\n\\n-6. dC tx85 tx96 -> tx102\\n\\ndQ1Q2 \
tx85 tx97 -> tx103\\n\\ntx101 + tx102 + tx103 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\n12. dA tx86 tx95 \
-> tx104\\n\\n-6. dC tx86 tx96 -> tx105\\n\\ndQ1Q2 tx86 tx97 -> \
tx106\\n\\ntx104 + tx105 + tx106 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n-tx100 -> \
tx107\\n\\n-12. dA tx84 tx95 -> tx108\\n\\n6. dC tx84 tx96 -> \
tx109\\n\\ntx107 + tx108 + tx109 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\n-tx103 -> \
tx110\\n\\n-12. dA tx85 tx95 -> tx111\\n\\n6. dC tx85 tx96 -> \
tx112\\n\\ntx110 + tx111 + tx112 -> gy2\\n\\n-gy2 -> \
fy2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 1, fy2 );]\\n\\n-tx106 -> \
tx113\\n\\n-12. dA tx86 tx95 -> tx114\\n\\n6. dC tx86 tx96 -> \
tx115\\n\\ntx113 + tx114 + tx115 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
NONBOND_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\npower2[tx165] -> tx116\\n\\ntx161 tx162 -> tx117\\n\\npower2[tx166] \
-> tx169\\n\\nreciprocal[tx169] -> tx170\\n\\ntx167 tx170 -> tx118\\n\\n168 \
dA tx116 tx87 -> tx119\\n\\n-48 dC tx117 tx87 -> tx120\\n\\n3 dQ1Q2 tx118 \
tx87 -> tx121\\n\\n-12. dA tx95 -> tx122\\n\\n6. dC tx96 -> \
tx123\\n\\n-(dQ1Q2 tx97) -> tx124\\n\\ntx119 + tx120 + tx121 + tx122 + tx123 \
+ tx124 -> dhx1x1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
0, dhx1x1);]\\n\\n168 dA tx116 tx88 -> tx125\\n\\n-48 dC tx117 tx88 -> \
tx126\\n\\n3 dQ1Q2 tx118 tx88 -> tx127\\n\\ntx122 + tx123 + tx124 + tx125 + \
tx126 + tx127 -> dhy1y1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);]\\n\\n168 dA tx116 tx89 -> tx128\\n\\n-48 dC tx117 tx89 -> \
tx129\\n\\n3 dQ1Q2 tx118 tx89 -> tx130\\n\\ntx122 + tx123 + tx124 + tx128 + \
tx129 + tx130 -> dhz1z1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, \
I1, 2, dhz1z1);]\\n\\ndhx1x1 -> \
dhx2x2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, dhx2x2);]\
\\n\\ndhy1y1 -> dhy2y2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, \
I2, 1, dhy2y2);]\\n\\ndhz1z1 -> \
dhz2z2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, dhz2z2);]\
\\n\\nCCode[#ifdef NONBOND_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n168 dA tx116 tx84 tx85 -> tx131\\n\\n-48 dC \
tx117 tx84 tx85 -> tx132\\n\\n3 dQ1Q2 tx118 tx84 tx85 -> tx133\\n\\ntx131 + \
tx132 + tx133 -> \
ohx1y1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\n168 dA tx116 tx84 tx86 -> tx134\\n\\n-48 dC tx117 tx84 tx86 -> \
tx135\\n\\n3 dQ1Q2 tx118 tx84 tx86 -> tx136\\n\\ntx134 + tx135 + tx136 -> \
ohx1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-168 dA tx116 tx87 -> tx137\\n\\n48 dC tx117 tx87 -> \
tx138\\n\\n-3 dQ1Q2 tx118 tx87 -> tx139\\n\\n12. dA tx95 -> tx140\\n\\n-6. dC \
tx96 -> tx141\\n\\ndQ1Q2 tx97 -> tx142\\n\\ntx137 + tx138 + tx139 + tx140 + \
tx141 + tx142 -> \
ohx1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\n-168 dA tx116 tx84 tx85 -> tx143\\n\\n48 dC tx117 tx84 tx85 -> \
tx144\\n\\n-3 dQ1Q2 tx118 tx84 tx85 -> tx145\\n\\ntx143 + tx144 + tx145 -> \
ohx1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\n-168 dA tx116 tx84 tx86 -> tx146\\n\\n48 dC tx117 tx84 tx86 -> \
tx147\\n\\n-3 dQ1Q2 tx118 tx84 tx86 -> tx148\\n\\ntx146 + tx147 + tx148 -> \
ohx1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\n168 dA tx116 tx85 tx86 -> tx149\\n\\n-48 dC tx117 tx85 tx86 -> \
tx150\\n\\n3 dQ1Q2 tx118 tx85 tx86 -> tx151\\n\\ntx149 + tx150 + tx151 -> \
ohy1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\n-168 dA tx116 tx88 -> tx152\\n\\n48 dC tx117 tx88 -> \
tx153\\n\\n-3 dQ1Q2 tx118 tx88 -> tx154\\n\\ntx140 + tx141 + tx142 + tx152 + \
tx153 + tx154 -> \
ohy1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\n-168 dA tx116 tx85 tx86 -> tx155\\n\\n48 dC tx117 tx85 tx86 -> \
tx156\\n\\n-3 dQ1Q2 tx118 tx85 tx86 -> tx157\\n\\ntx155 + tx156 + tx157 -> \
ohy1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\n-168 dA tx116 tx89 -> tx158\\n\\n48 dC tx117 tx89 -> \
tx159\\n\\n-3 dQ1Q2 tx118 tx89 -> tx160\\n\\ntx140 + tx141 + tx142 + tx158 + \
tx159 + tx160 -> \
ohz1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
NONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* NONBOND_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* NONBOND_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522752834112*^9},ExpressionUUID->"a3e3418f-2de0-4185-8424-\
b063e1acb6cc"],

Cell[BoxData["\<\"trivialRules>> triv = {tx172 -> tx163, DistanceSquared -> \
tx166, tx94 -> tx167, tzz191 -> tx122, tzz189 -> tx123, tzz188 -> tx140, \
tzz190 -> tx141, tzz187 -> tx142}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522754116395*^9},ExpressionUUID->"e702a8a1-d37b-4b0c-9611-\
23aa1c8f9f73"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522754121907*^9},ExpressionUUID->"2d7e9dba-bf77-43d6-950f-\
297138c8338b"],

Cell[BoxData["\<\"Trivial rules are being removed: tx172 -> \
tx163\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\ntzz191 -> \
tx122\\n\\ntzz189 -> tx123\\n\\ntzz188 -> tx140\\n\\ntzz190 -> \
tx141\\n\\ntzz187 -> tx142\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.7815227541290627`*^9},ExpressionUUID->"10e407c9-b671-48fb-b809-\
c31337bb010b"],

Cell[BoxData["\<\"After removal: \
CCode[NONBOND_SET_PARAMETER(I1);]\\n\\nCCode[NONBOND_SET_PARAMETER(I2);]\\n\\\
nCCode[NONBOND_SET_PARAMETER(dQ1Q2);]\\n\\nCCode[NONBOND_SET_PARAMETER(dA);]\\\
n\\nCCode[NONBOND_SET_PARAMETER(dC);]\\n\\nCCode[NONBOND_SET_POSITION(x1,I1,0)\
;]\\n\\nCCode[NONBOND_SET_POSITION(y1,I1,1);]\\n\\nCCode[NONBOND_SET_POSITION(\
z1,I1,2);]\\n\\nCCode[NONBOND_SET_POSITION(x2,I2,0);]\\n\\nCCode[NONBOND_SET_\
POSITION(y2,I2,1);]\\n\\nCCode[NONBOND_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> \
tx81\\n\\ntx81 + x2 -> DeltaX\\n\\n-y1 -> tx82\\n\\ntx82 + y2 -> \
DeltaY\\n\\n-z1 -> tx83\\n\\ntx83 + z2 -> DeltaZ\\n\\nPBX[DeltaX] -> \
tx84\\n\\nPBY[DeltaY] -> tx85\\n\\nPBZ[DeltaZ] -> tx86\\n\\npower2[tx84] -> \
tx87\\n\\npower2[tx85] -> tx88\\n\\npower2[tx86] -> tx89\\n\\ntx87 + tx88 + \
tx89 -> DistanceSquared\\n\\nCCode[BAIL_OUT_IF_CUTOFF(DistanceSquared)]\\n\\\
npower2[reciprocal[DistanceSquared]] -> \
tx171\\n\\nreciprocal[DistanceSquared] -> tx172\\n\\ntx171 tx172 -> \
tx161\\n\\npower2[tx161] -> tx90\\n\\npower2[tx172] -> tx162\\n\\ntx172 -> \
tx163\\n\\ntx162 tx163 -> tx91\\n\\ndA tx90 -> tx92\\n\\n-(dC tx91) -> \
tx93\\n\\ntx92 + tx93 -> \
Evdw\\n\\nCCode[NONBOND_EVDW_ENERGY_ACCUMULATE(Evdw);]\\n\\nmysqrt[\
DistanceSquared] -> tx164\\n\\nreciprocal[tx164] -> tx94\\n\\ndQ1Q2 tx94 -> \
Eeel\\n\\nCCode[NONBOND_EEEL_ENERGY_ACCUMULATE(Eeel);]\\n\\nEeel + Evdw -> \
Energy\\n\\nCCode[NONBOND_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
NONBOND_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\npower2[tx171] -> \
tx165\\n\\ntx161 tx165 -> tx95\\n\\npower2[tx162] -> \
tx96\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\nreciprocal[tx166] \
-> tx168\\n\\ntx167 tx168 -> tx97\\n\\ndA tx95 -> tzz177\\n\\n12. tzz177 -> \
tzz188\\n\\ntx84 tzz188 -> tx98\\n\\ndC tx96 -> tzz176\\n\\n-6. tzz176 -> \
tzz190\\n\\ntx84 tzz190 -> tx99\\n\\ndQ1Q2 tx97 -> tzz187\\n\\ntx84 tzz187 -> \
tx100\\n\\ntx100 + tx98 + tx99 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ntx85 tzz188 -> \
tx101\\n\\ntx85 tzz190 -> tx102\\n\\ntx85 tzz187 -> tx103\\n\\ntx101 + tx102 \
+ tx103 -> gy1\\n\\n-gy1 -> fy1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 1, \
fy1 );]\\n\\ntx86 tzz188 -> tx104\\n\\ntx86 tzz190 -> tx105\\n\\ntx86 tzz187 \
-> tx106\\n\\ntx104 + tx105 + tx106 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n-tx100 -> \
tx107\\n\\n-12. tzz177 -> tzz191\\n\\ntx84 tzz191 -> tx108\\n\\n6. tzz176 -> \
tzz189\\n\\ntx84 tzz189 -> tx109\\n\\ntx107 + tx108 + tx109 -> gx2\\n\\n-gx2 \
-> fx2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\n-tx103 -> \
tx110\\n\\ntx85 tzz191 -> tx111\\n\\ntx85 tzz189 -> tx112\\n\\ntx110 + tx111 \
+ tx112 -> gy2\\n\\n-gy2 -> fy2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 1, \
fy2 );]\\n\\n-tx106 -> tx113\\n\\ntx86 tzz191 -> tx114\\n\\ntx86 tzz189 -> \
tx115\\n\\ntx113 + tx114 + tx115 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
NONBOND_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\npower2[tx165] -> tx116\\n\\ntx161 tx162 -> tx117\\n\\npower2[tx166] \
-> tx169\\n\\nreciprocal[tx169] -> tx170\\n\\ntx167 tx170 -> tx118\\n\\ndA \
tx116 -> tzz175\\n\\n168 tzz175 -> tzz181\\n\\ntx87 tzz181 -> tx119\\n\\ndC \
tx117 -> tzz174\\n\\n-48 tzz174 -> tzz185\\n\\ntx87 tzz185 -> \
tx120\\n\\ndQ1Q2 tx118 -> tzz173\\n\\n3 tzz173 -> tzz183\\n\\ntx87 tzz183 -> \
tx121\\n\\ntzz191 -> tx122\\n\\ntzz189 -> tx123\\n\\n-tzz187 -> \
tx124\\n\\ntx119 + tx120 + tx121 + tx122 + tx123 + tx124 -> \
dhx1x1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx88 tzz181 -> tx125\\n\\ntx88 tzz185 -> tx126\\n\\ntx88 tzz183 -> \
tx127\\n\\ntx122 + tx123 + tx124 + tx125 + tx126 + tx127 -> \
dhy1y1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx89 tzz181 -> tx128\\n\\ntx89 tzz185 -> tx129\\n\\ntx89 tzz183 -> \
tx130\\n\\ntx122 + tx123 + tx124 + tx128 + tx129 + tx130 -> \
dhz1z1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef NONBOND_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx84 tx85 -> \
tzz180\\n\\ntzz180 tzz181 -> tx131\\n\\ntzz180 tzz185 -> tx132\\n\\ntzz180 \
tzz183 -> tx133\\n\\ntx131 + tx132 + tx133 -> \
ohx1y1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx84 tx86 -> tzz179\\n\\ntzz179 tzz181 -> tx134\\n\\ntzz179 \
tzz185 -> tx135\\n\\ntzz179 tzz183 -> tx136\\n\\ntx134 + tx135 + tx136 -> \
ohx1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-168 tzz175 -> tzz186\\n\\ntx87 tzz186 -> tx137\\n\\n48 tzz174 \
-> tzz182\\n\\ntx87 tzz182 -> tx138\\n\\n-3 tzz173 -> tzz184\\n\\ntx87 tzz184 \
-> tx139\\n\\ntzz188 -> tx140\\n\\ntzz190 -> tx141\\n\\ntzz187 -> \
tx142\\n\\ntx137 + tx138 + tx139 + tx140 + tx141 + tx142 -> \
ohx1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\ntzz180 tzz186 -> tx143\\n\\ntzz180 tzz182 -> tx144\\n\\ntzz180 \
tzz184 -> tx145\\n\\ntx143 + tx144 + tx145 -> \
ohx1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\ntzz179 tzz186 -> tx146\\n\\ntzz179 tzz182 -> tx147\\n\\ntzz179 \
tzz184 -> tx148\\n\\ntx146 + tx147 + tx148 -> \
ohx1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\ntx85 tx86 -> tzz178\\n\\ntzz178 tzz181 -> tx149\\n\\ntzz178 \
tzz185 -> tx150\\n\\ntzz178 tzz183 -> tx151\\n\\ntx149 + tx150 + tx151 -> \
ohy1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx88 tzz186 -> tx152\\n\\ntx88 tzz182 -> tx153\\n\\ntx88 \
tzz184 -> tx154\\n\\ntx140 + tx141 + tx142 + tx152 + tx153 + tx154 -> \
ohy1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\ntzz178 tzz186 -> tx155\\n\\ntzz178 tzz182 -> tx156\\n\\ntzz178 \
tzz184 -> tx157\\n\\ntx155 + tx156 + tx157 -> \
ohy1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx89 tzz186 -> tx158\\n\\ntx89 tzz182 -> tx159\\n\\ntx89 \
tzz184 -> tx160\\n\\ntx140 + tx141 + tx142 + tx158 + tx159 + tx160 -> \
ohz1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
NONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* NONBOND_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* NONBOND_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522754134358*^9},ExpressionUUID->"c5f73333-21af-4c77-b161-\
f99e33d4fd53"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763419086*^9},ExpressionUUID->"a5dc2bf4-61a7-458e-b3b7-\
72db249b32aa"],

Cell[BoxData["\<\"trivialRules>> triv = {tx192 -> tx172, tx172 -> tx163, \
DistanceSquared -> tx166, tx94 -> tx167, tzz191 -> tx122, tzz189 -> tx123, \
tzz188 -> tx140, tzz190 -> tx141, tzz187 -> tx142}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763425304*^9},ExpressionUUID->"6f5404c2-d3c2-4200-b448-\
b02f9a15dfbf"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763432932*^9},ExpressionUUID->"c0e78275-d3de-45c2-b846-\
278fa4e3fe84"],

Cell[BoxData["\<\"Trivial rules are being removed: tx192 -> tx172\\n\\ntx172 \
-> tx163\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\ntzz191 -> \
tx122\\n\\ntzz189 -> tx123\\n\\ntzz188 -> tx140\\n\\ntzz190 -> \
tx141\\n\\ntzz187 -> tx142\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763438868*^9},ExpressionUUID->"7a81c769-3aaa-4146-ad55-\
141ff28928ea"],

Cell[BoxData["\<\"After removal: \
CCode[NONBOND_SET_PARAMETER(I1);]\\n\\nCCode[NONBOND_SET_PARAMETER(I2);]\\n\\\
nCCode[NONBOND_SET_PARAMETER(dQ1Q2);]\\n\\nCCode[NONBOND_SET_PARAMETER(dA);]\\\
n\\nCCode[NONBOND_SET_PARAMETER(dC);]\\n\\nCCode[NONBOND_SET_POSITION(x1,I1,0)\
;]\\n\\nCCode[NONBOND_SET_POSITION(y1,I1,1);]\\n\\nCCode[NONBOND_SET_POSITION(\
z1,I1,2);]\\n\\nCCode[NONBOND_SET_POSITION(x2,I2,0);]\\n\\nCCode[NONBOND_SET_\
POSITION(y2,I2,1);]\\n\\nCCode[NONBOND_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> \
tx81\\n\\ntx81 + x2 -> DeltaX\\n\\n-y1 -> tx82\\n\\ntx82 + y2 -> \
DeltaY\\n\\n-z1 -> tx83\\n\\ntx83 + z2 -> DeltaZ\\n\\nPBX[DeltaX] -> \
tx84\\n\\nPBY[DeltaY] -> tx85\\n\\nPBZ[DeltaZ] -> tx86\\n\\npower2[tx84] -> \
tx87\\n\\npower2[tx85] -> tx88\\n\\npower2[tx86] -> tx89\\n\\ntx87 + tx88 + \
tx89 -> DistanceSquared\\n\\nCCode[BAIL_OUT_IF_CUTOFF(DistanceSquared)]\\n\\\
nreciprocal[DistanceSquared] -> tx192\\n\\npower2[tx192] -> tx171\\n\\ntx192 \
-> tx172\\n\\ntx171 tx172 -> tx161\\n\\npower2[tx161] -> \
tx90\\n\\npower2[tx172] -> tx162\\n\\ntx172 -> tx163\\n\\ntx162 tx163 -> tx91\
\\n\\ndA tx90 -> tx92\\n\\n-(dC tx91) -> tx93\\n\\ntx92 + tx93 -> \
Evdw\\n\\nCCode[NONBOND_EVDW_ENERGY_ACCUMULATE(Evdw);]\\n\\nmysqrt[\
DistanceSquared] -> tx164\\n\\nreciprocal[tx164] -> tx94\\n\\ndQ1Q2 tx94 -> \
Eeel\\n\\nCCode[NONBOND_EEEL_ENERGY_ACCUMULATE(Eeel);]\\n\\nEeel + Evdw -> \
Energy\\n\\nCCode[NONBOND_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
NONBOND_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\npower2[tx171] -> \
tx165\\n\\ntx161 tx165 -> tx95\\n\\npower2[tx162] -> \
tx96\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\nreciprocal[tx166] \
-> tx168\\n\\ntx167 tx168 -> tx97\\n\\ndA tx95 -> tzz177\\n\\n12. tzz177 -> \
tzz188\\n\\ntx84 tzz188 -> tx98\\n\\ndC tx96 -> tzz176\\n\\n-6. tzz176 -> \
tzz190\\n\\ntx84 tzz190 -> tx99\\n\\ndQ1Q2 tx97 -> tzz187\\n\\ntx84 tzz187 -> \
tx100\\n\\ntx100 + tx98 + tx99 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ntx85 tzz188 -> \
tx101\\n\\ntx85 tzz190 -> tx102\\n\\ntx85 tzz187 -> tx103\\n\\ntx101 + tx102 \
+ tx103 -> gy1\\n\\n-gy1 -> fy1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 1, \
fy1 );]\\n\\ntx86 tzz188 -> tx104\\n\\ntx86 tzz190 -> tx105\\n\\ntx86 tzz187 \
-> tx106\\n\\ntx104 + tx105 + tx106 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n-tx100 -> \
tx107\\n\\n-12. tzz177 -> tzz191\\n\\ntx84 tzz191 -> tx108\\n\\n6. tzz176 -> \
tzz189\\n\\ntx84 tzz189 -> tx109\\n\\ntx107 + tx108 + tx109 -> gx2\\n\\n-gx2 \
-> fx2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\n-tx103 -> \
tx110\\n\\ntx85 tzz191 -> tx111\\n\\ntx85 tzz189 -> tx112\\n\\ntx110 + tx111 \
+ tx112 -> gy2\\n\\n-gy2 -> fy2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 1, \
fy2 );]\\n\\n-tx106 -> tx113\\n\\ntx86 tzz191 -> tx114\\n\\ntx86 tzz189 -> \
tx115\\n\\ntx113 + tx114 + tx115 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
NONBOND_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\npower2[tx165] -> tx116\\n\\ntx161 tx162 -> tx117\\n\\npower2[tx166] \
-> tx169\\n\\nreciprocal[tx169] -> tx170\\n\\ntx167 tx170 -> tx118\\n\\ndA \
tx116 -> tzz175\\n\\n168 tzz175 -> tzz181\\n\\ntx87 tzz181 -> tx119\\n\\ndC \
tx117 -> tzz174\\n\\n-48 tzz174 -> tzz185\\n\\ntx87 tzz185 -> \
tx120\\n\\ndQ1Q2 tx118 -> tzz173\\n\\n3 tzz173 -> tzz183\\n\\ntx87 tzz183 -> \
tx121\\n\\ntzz191 -> tx122\\n\\ntzz189 -> tx123\\n\\n-tzz187 -> \
tx124\\n\\ntx119 + tx120 + tx121 + tx122 + tx123 + tx124 -> \
dhx1x1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx88 tzz181 -> tx125\\n\\ntx88 tzz185 -> tx126\\n\\ntx88 tzz183 -> \
tx127\\n\\ntx122 + tx123 + tx124 + tx125 + tx126 + tx127 -> \
dhy1y1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx89 tzz181 -> tx128\\n\\ntx89 tzz185 -> tx129\\n\\ntx89 tzz183 -> \
tx130\\n\\ntx122 + tx123 + tx124 + tx128 + tx129 + tx130 -> \
dhz1z1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef NONBOND_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx84 tx85 -> \
tzz180\\n\\ntzz180 tzz181 -> tx131\\n\\ntzz180 tzz185 -> tx132\\n\\ntzz180 \
tzz183 -> tx133\\n\\ntx131 + tx132 + tx133 -> \
ohx1y1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx84 tx86 -> tzz179\\n\\ntzz179 tzz181 -> tx134\\n\\ntzz179 \
tzz185 -> tx135\\n\\ntzz179 tzz183 -> tx136\\n\\ntx134 + tx135 + tx136 -> \
ohx1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-168 tzz175 -> tzz186\\n\\ntx87 tzz186 -> tx137\\n\\n48 tzz174 \
-> tzz182\\n\\ntx87 tzz182 -> tx138\\n\\n-3 tzz173 -> tzz184\\n\\ntx87 tzz184 \
-> tx139\\n\\ntzz188 -> tx140\\n\\ntzz190 -> tx141\\n\\ntzz187 -> \
tx142\\n\\ntx137 + tx138 + tx139 + tx140 + tx141 + tx142 -> \
ohx1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\ntzz180 tzz186 -> tx143\\n\\ntzz180 tzz182 -> tx144\\n\\ntzz180 \
tzz184 -> tx145\\n\\ntx143 + tx144 + tx145 -> \
ohx1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\ntzz179 tzz186 -> tx146\\n\\ntzz179 tzz182 -> tx147\\n\\ntzz179 \
tzz184 -> tx148\\n\\ntx146 + tx147 + tx148 -> \
ohx1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\ntx85 tx86 -> tzz178\\n\\ntzz178 tzz181 -> tx149\\n\\ntzz178 \
tzz185 -> tx150\\n\\ntzz178 tzz183 -> tx151\\n\\ntx149 + tx150 + tx151 -> \
ohy1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx88 tzz186 -> tx152\\n\\ntx88 tzz182 -> tx153\\n\\ntx88 \
tzz184 -> tx154\\n\\ntx140 + tx141 + tx142 + tx152 + tx153 + tx154 -> \
ohy1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\ntzz178 tzz186 -> tx155\\n\\ntzz178 tzz182 -> tx156\\n\\ntzz178 \
tzz184 -> tx157\\n\\ntx155 + tx156 + tx157 -> \
ohy1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx89 tzz186 -> tx158\\n\\ntx89 tzz182 -> tx159\\n\\ntx89 \
tzz184 -> tx160\\n\\ntx140 + tx141 + tx142 + tx158 + tx159 + tx160 -> \
ohz1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
NONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* NONBOND_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* NONBOND_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763444296*^9},ExpressionUUID->"2968b4be-2a3b-4b06-8470-\
969382e831f7"],

Cell[BoxData["\<\"trivialRules>> triv = {tx192 -> tx172, tx172 -> tx163, \
DistanceSquared -> tx166, tx94 -> tx167, tzz191 -> tx122, tzz189 -> tx123, \
tzz188 -> tx140, tzz190 -> tx141, tzz187 -> tx142}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763814516*^9},ExpressionUUID->"bdad7e70-53e3-42a5-a594-\
fc1fdb5a262f"],

Cell[BoxData["\<\"trivialRules>> outs = {DeltaX, DeltaY, DeltaZ, Energy, \
Evdw, Eeel, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, ohx1y2, ohx1z2, ohy1z1, ohy1x2, \
ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
NonbondDistance}\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763820538*^9},ExpressionUUID->"d9544bd3-7ea9-4071-950e-\
2b91d91fd312"],

Cell[BoxData["\<\"Trivial rules are being removed: tx192 -> tx172\\n\\ntx172 \
-> tx163\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\ntzz191 -> \
tx122\\n\\ntzz189 -> tx123\\n\\ntzz188 -> tx140\\n\\ntzz190 -> \
tx141\\n\\ntzz187 -> tx142\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.7815227638277073`*^9},ExpressionUUID->"8c36a94d-7f40-4ed3-a333-\
c6a364544bb4"],

Cell[BoxData["\<\"After removal: \
CCode[NONBOND_SET_PARAMETER(I1);]\\n\\nCCode[NONBOND_SET_PARAMETER(I2);]\\n\\\
nCCode[NONBOND_SET_PARAMETER(dQ1Q2);]\\n\\nCCode[NONBOND_SET_PARAMETER(dA);]\\\
n\\nCCode[NONBOND_SET_PARAMETER(dC);]\\n\\nCCode[NONBOND_SET_POSITION(x1,I1,0)\
;]\\n\\nCCode[NONBOND_SET_POSITION(y1,I1,1);]\\n\\nCCode[NONBOND_SET_POSITION(\
z1,I1,2);]\\n\\nCCode[NONBOND_SET_POSITION(x2,I2,0);]\\n\\nCCode[NONBOND_SET_\
POSITION(y2,I2,1);]\\n\\nCCode[NONBOND_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> \
tx81\\n\\ntx81 + x2 -> DeltaX\\n\\n-y1 -> tx82\\n\\ntx82 + y2 -> \
DeltaY\\n\\n-z1 -> tx83\\n\\ntx83 + z2 -> DeltaZ\\n\\nPBX[DeltaX] -> \
tx84\\n\\nPBY[DeltaY] -> tx85\\n\\nPBZ[DeltaZ] -> tx86\\n\\npower2[tx84] -> \
tx87\\n\\npower2[tx85] -> tx88\\n\\npower2[tx86] -> tx89\\n\\ntx87 + tx88 + \
tx89 -> DistanceSquared\\n\\nCCode[BAIL_OUT_IF_CUTOFF(DistanceSquared)]\\n\\\
nreciprocal[DistanceSquared] -> tx192\\n\\npower2[tx192] -> tx171\\n\\ntx192 \
-> tx172\\n\\ntx171 tx172 -> tx161\\n\\npower2[tx161] -> \
tx90\\n\\npower2[tx172] -> tx162\\n\\ntx172 -> tx163\\n\\ntx162 tx163 -> tx91\
\\n\\ndA tx90 -> tx92\\n\\n-(dC tx91) -> tx93\\n\\ntx92 + tx93 -> \
Evdw\\n\\nCCode[NONBOND_EVDW_ENERGY_ACCUMULATE(Evdw);]\\n\\nmysqrt[\
DistanceSquared] -> tx164\\n\\nreciprocal[tx164] -> tx94\\n\\ndQ1Q2 tx94 -> \
Eeel\\n\\nCCode[NONBOND_EEEL_ENERGY_ACCUMULATE(Eeel);]\\n\\nEeel + Evdw -> \
Energy\\n\\nCCode[NONBOND_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
NONBOND_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\npower2[tx171] -> \
tx165\\n\\ntx161 tx165 -> tx95\\n\\npower2[tx162] -> \
tx96\\n\\nDistanceSquared -> tx166\\n\\ntx94 -> tx167\\n\\nreciprocal[tx166] \
-> tx168\\n\\ntx167 tx168 -> tx97\\n\\ndA tx95 -> tzz177\\n\\n12. tzz177 -> \
tzz188\\n\\ntx84 tzz188 -> tx98\\n\\ndC tx96 -> tzz176\\n\\n-6. tzz176 -> \
tzz190\\n\\ntx84 tzz190 -> tx99\\n\\ndQ1Q2 tx97 -> tzz187\\n\\ntx84 tzz187 -> \
tx100\\n\\ntx100 + tx98 + tx99 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ntx85 tzz188 -> \
tx101\\n\\ntx85 tzz190 -> tx102\\n\\ntx85 tzz187 -> tx103\\n\\ntx101 + tx102 \
+ tx103 -> gy1\\n\\n-gy1 -> fy1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 1, \
fy1 );]\\n\\ntx86 tzz188 -> tx104\\n\\ntx86 tzz190 -> tx105\\n\\ntx86 tzz187 \
-> tx106\\n\\ntx104 + tx105 + tx106 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n-tx100 -> \
tx107\\n\\n-12. tzz177 -> tzz191\\n\\ntx84 tzz191 -> tx108\\n\\n6. tzz176 -> \
tzz189\\n\\ntx84 tzz189 -> tx109\\n\\ntx107 + tx108 + tx109 -> gx2\\n\\n-gx2 \
-> fx2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\n-tx103 -> \
tx110\\n\\ntx85 tzz191 -> tx111\\n\\ntx85 tzz189 -> tx112\\n\\ntx110 + tx111 \
+ tx112 -> gy2\\n\\n-gy2 -> fy2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 1, \
fy2 );]\\n\\n-tx106 -> tx113\\n\\ntx86 tzz191 -> tx114\\n\\ntx86 tzz189 -> \
tx115\\n\\ntx113 + tx114 + tx115 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[NONBOND_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
NONBOND_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\npower2[tx165] -> tx116\\n\\ntx161 tx162 -> tx117\\n\\npower2[tx166] \
-> tx169\\n\\nreciprocal[tx169] -> tx170\\n\\ntx167 tx170 -> tx118\\n\\ndA \
tx116 -> tzz175\\n\\n168 tzz175 -> tzz181\\n\\ntx87 tzz181 -> tx119\\n\\ndC \
tx117 -> tzz174\\n\\n-48 tzz174 -> tzz185\\n\\ntx87 tzz185 -> \
tx120\\n\\ndQ1Q2 tx118 -> tzz173\\n\\n3 tzz173 -> tzz183\\n\\ntx87 tzz183 -> \
tx121\\n\\ntzz191 -> tx122\\n\\ntzz189 -> tx123\\n\\n-tzz187 -> \
tx124\\n\\ntx123 + tx124 -> tzz195\\n\\ntx122 + tzz195 -> tzz196\\n\\ntx119 + \
tx120 + tx121 + tzz196 -> \
dhx1x1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx88 tzz181 -> tx125\\n\\ntx88 tzz185 -> tx126\\n\\ntx88 tzz183 -> \
tx127\\n\\ntx125 + tx126 + tx127 + tzz196 -> \
dhy1y1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx89 tzz181 -> tx128\\n\\ntx89 tzz185 -> tx129\\n\\ntx89 tzz183 -> \
tx130\\n\\ntx128 + tx129 + tx130 + tzz196 -> \
dhz1z1\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef NONBOND_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx84 tx85 -> \
tzz180\\n\\ntzz180 tzz181 -> tx131\\n\\ntzz180 tzz185 -> tx132\\n\\ntzz180 \
tzz183 -> tx133\\n\\ntx131 + tx132 + tx133 -> \
ohx1y1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx84 tx86 -> tzz179\\n\\ntzz179 tzz181 -> tx134\\n\\ntzz179 \
tzz185 -> tx135\\n\\ntzz179 tzz183 -> tx136\\n\\ntx134 + tx135 + tx136 -> \
ohx1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-168 tzz175 -> tzz186\\n\\ntx87 tzz186 -> tx137\\n\\n48 tzz174 \
-> tzz182\\n\\ntx87 tzz182 -> tx138\\n\\n-3 tzz173 -> tzz184\\n\\ntx87 tzz184 \
-> tx139\\n\\ntzz188 -> tx140\\n\\ntzz190 -> tx141\\n\\ntzz187 -> \
tx142\\n\\ntx141 + tx142 -> tzz193\\n\\ntx140 + tzz193 -> tzz194\\n\\ntx137 + \
tx138 + tx139 + tzz194 -> \
ohx1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\ntzz180 tzz186 -> tx143\\n\\ntzz180 tzz182 -> tx144\\n\\ntzz180 \
tzz184 -> tx145\\n\\ntx143 + tx144 + tx145 -> \
ohx1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\ntzz179 tzz186 -> tx146\\n\\ntzz179 tzz182 -> tx147\\n\\ntzz179 \
tzz184 -> tx148\\n\\ntx146 + tx147 + tx148 -> \
ohx1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\ntx85 tx86 -> tzz178\\n\\ntzz178 tzz181 -> tx149\\n\\ntzz178 \
tzz185 -> tx150\\n\\ntzz178 tzz183 -> tx151\\n\\ntx149 + tx150 + tx151 -> \
ohy1z1\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx88 tzz186 -> tx152\\n\\ntx88 tzz182 -> tx153\\n\\ntx88 \
tzz184 -> tx154\\n\\ntx152 + tx153 + tx154 + tzz194 -> \
ohy1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\ntzz178 tzz186 -> tx155\\n\\ntzz178 tzz182 -> tx156\\n\\ntzz178 \
tzz184 -> tx157\\n\\ntx155 + tx156 + tx157 -> \
ohy1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx89 tzz186 -> tx158\\n\\ntx89 tzz182 -> tx159\\n\\ntx89 \
tzz184 -> tx160\\n\\ntx158 + tx159 + tx160 + tzz194 -> \
ohz1z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
NONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* NONBOND_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* NONBOND_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763833584*^9},ExpressionUUID->"4e97b824-be79-4902-af29-\
306db74a3bdc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing declares to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Nonbond_termDeclares.cc\"\>"}],
  SequenceForm["Writing declares to file: ", "_Nonbond_termDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.7815227638994226`*^9},ExpressionUUID->"c50f2f83-a9fe-4e18-9292-\
b125867b8216"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing code to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Nonbond_termCode.cc\"\>"}],
  SequenceForm["Writing code to file: ", "_Nonbond_termCode.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.780926559459586*^9, 3.780926755697248*^9, 
  3.7809269228235083`*^9, 3.780928021971789*^9, 3.7809280808296022`*^9, 
  3.7809283483844624`*^9, 3.780928468155408*^9, 3.780929132243751*^9, 
  3.7809292333147*^9, 3.780935950376235*^9, 3.7809362028839207`*^9, 
  3.780944799917222*^9, 3.780944911271611*^9, 3.781519802147163*^9, 
  3.7815203000220337`*^9, 
  3.781522763907292*^9},ExpressionUUID->"f0276488-57ba-441d-a2ab-\
bfcba95311d7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.494844329106917*^9, 
  3.494844338578497*^9}},ExpressionUUID->"0d9147ea-7b39-4a9a-9019-\
a788b08a9021"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "nbPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 
  3.4055995100170727`*^9}},ExpressionUUID->"e46929c0-07ce-4709-bcda-\
8c7ac12b8862"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 71.25}, {0.03, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 71.25}, {0.13, 71.25}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 71.25}, {0.03, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 213.75}, {0.03, 203.57142857142856`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 213.75}, {0.13, 213.75}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 213.75}, {0.03, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 356.25}, {0.03, 366.4285714285714}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 356.25}, {0.13, 356.25}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.17, 356.25}, {0.03, 447.85714285714283`}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.27, 71.25}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.27, 213.75}, {0.22999999999999998`, 213.75}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.27, 356.25}, {0.22999999999999998`, 356.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 40.71428571428571}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 122.14285714285714`}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 203.57142857142856`}, {0.33, 356.25}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 142.5}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 142.5}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 142.5}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.5700000000000001, 57.}, {0.53, 142.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 47.5}, {0.63, 57.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 142.5}, {0.63, 57.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 28.5}, {0.73, 47.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 28.5}, {0.73, 142.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 31.666666666666664`}, {0.8300000000000001, 28.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 85.5}, {0.73, 142.5}}]}, 
   {GrayLevel[0], LineBox[{{0.77, 142.5}, {0.73, 142.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 95.}, {0.8300000000000001, 85.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 95.}, {0.8300000000000001, 142.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 31.666666666666664`}, {0.8300000000000001, 199.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 31.666666666666664`}, {0.9300000000000002, 
     31.666666666666664`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 95.}, {0.8300000000000001, 256.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 95.}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.07, 16.764705882352942`}, {1.03, 31.666666666666664`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.07, 16.764705882352942`}, {1.03, 95.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.5700000000000001, 171.}, {0.53, 142.5}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.67, 237.5}, {0.63, 171.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 313.5}, {0.63, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 313.5}, {0.73, 237.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 5.}, {0.8300000000000001, 313.5}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 5.}, {1.1300000000000001`, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 370.50000000000006`}, {0.73, 47.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 158.33333333333331`}, {0.8300000000000001, 28.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 158.33333333333331`}, {0.8300000000000001, 
     370.50000000000006`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 221.66666666666663`}, {0.8300000000000001, 85.5}}]}, 
   {GrayLevel[0], LineBox[{{0.5700000000000001, 399.}, {0.53, 142.5}}]}, 
   {GrayLevel[0], LineBox[{{0.77, 427.5}, {0.73, 237.5}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.67, 332.5}, {0.63, 399.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 285.}, {0.8300000000000001, 427.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 285.}, {0.73, 332.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 158.33333333333331`}, {0.8300000000000001, 199.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 158.33333333333331`}, {0.9300000000000002, 
     158.33333333333331`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 50.294117647058826`}, {1.03, 158.33333333333331`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 15.}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 15.}, {1.1300000000000001`, 50.294117647058826`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 221.66666666666663`}, {0.8300000000000001, 256.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 221.66666666666663`}, {0.9300000000000002, 
     221.66666666666663`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 83.82352941176471}, {1.03, 221.66666666666663`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 25.}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 25.}, {1.1300000000000001`, 83.82352941176471}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 285.}, {0.63, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 285.}, {0.9300000000000002, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 117.3529411764706}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 117.3529411764706}, {1.03, 285.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 19.}, {1.1300000000000001`, 117.3529411764706}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 19.}, {1.2300000000000002`, 15.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 19.}, {1.2300000000000002`, 25.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 19.}, {1.33, 19.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 35.}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 35.}, {1.1300000000000001`, 50.294117647058826`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 45.}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 45.}, {1.1300000000000001`, 83.82352941176471}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 150.88235294117646`}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 150.88235294117646`}, {1.03, 285.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 56.99999999999999}, {1.2300000000000002`, 35.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 56.99999999999999}, {1.2300000000000002`, 45.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 56.99999999999999}, {1.1300000000000001`, 
     150.88235294117646`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 56.99999999999999}, {1.33, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 55.}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 55.}, {1.1300000000000001`, 50.294117647058826`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 65.}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 65.}, {1.1300000000000001`, 83.82352941176471}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 184.41176470588235`}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 184.41176470588235`}, {1.03, 285.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 95.}, {1.2300000000000002`, 55.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 95.}, {1.2300000000000002`, 65.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 95.}, {1.1300000000000001`, 184.41176470588235`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 95.}, {1.33, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 75.}, {1.1300000000000001`, 117.3529411764706}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 217.94117647058823`}, {1.03, 158.33333333333331`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 85.}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 85.}, {1.1300000000000001`, 217.94117647058823`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 251.47058823529414`}, {1.03, 221.66666666666663`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 95.}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 95.}, {1.1300000000000001`, 251.47058823529414`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 133.}, {1.2300000000000002`, 75.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 133.}, {1.2300000000000002`, 85.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 133.}, {1.2300000000000002`, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 133.}, {1.33, 133.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 105.}, {1.1300000000000001`, 150.88235294117646`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 115.}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 115.}, {1.1300000000000001`, 217.94117647058823`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 125.}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 125.}, {1.1300000000000001`, 251.47058823529414`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 170.99999999999997`}, {1.2300000000000002`, 105.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 170.99999999999997`}, {1.2300000000000002`, 115.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 170.99999999999997`}, {1.2300000000000002`, 125.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 170.99999999999997`}, {1.33, 170.99999999999997`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 135.}, {1.1300000000000001`, 184.41176470588235`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 145.}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 145.}, {1.1300000000000001`, 217.94117647058823`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 155.}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 155.}, {1.1300000000000001`, 251.47058823529414`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 209.}, {1.2300000000000002`, 135.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 209.}, {1.2300000000000002`, 145.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 209.}, {1.2300000000000002`, 155.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 209.}, {1.33, 209.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 348.33333333333326`}, {0.8300000000000001, 
     370.50000000000006`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 411.66666666666663`}, {0.8300000000000001, 28.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 411.66666666666663`}, {0.8300000000000001, 85.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 427.5}, {0.63, 399.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.77, 484.5}, {0.73, 427.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 475.}, {0.8300000000000001, 427.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 475.}, {0.8300000000000001, 484.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 348.33333333333326`}, {0.8300000000000001, 199.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 348.33333333333326`}, {0.9300000000000002, 
     348.33333333333326`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 285.}, {1.03, 348.33333333333326`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 165.}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 165.}, {1.1300000000000001`, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 411.66666666666663`}, {0.8300000000000001, 256.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 411.66666666666663`}, {0.9300000000000002, 
     411.66666666666663`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 318.5294117647059}, {1.03, 411.66666666666663`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 175.}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 175.}, {1.1300000000000001`, 318.5294117647059}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 475.}, {0.63, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 475.}, {0.9300000000000002, 475.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 352.0588235294117}, {1.03, 475.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 185.}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 185.}, {1.1300000000000001`, 352.0588235294117}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.17, 195.}, {1.1300000000000001`, 217.94117647058823`}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.17, 205.}, {1.1300000000000001`, 251.47058823529414`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 385.5882352941177}, {1.03, 285.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 247.}, {1.2300000000000002`, 205.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 247.}, {1.1300000000000001`, 385.5882352941177}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.37, 247.}, {1.2300000000000002`, 195.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.37, 247.}, {1.33, 247.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 40.71428571428571}, {1.2300000000000002`, 165.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 40.71428571428571}, {1.2300000000000002`, 175.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 40.71428571428571}, {1.2300000000000002`, 185.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 40.71428571428571}, {1.4300000000000002`, 247.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 215.}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 215.}, {1.1300000000000001`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 225.}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 225.}, {1.1300000000000001`, 318.5294117647059}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 235.}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 235.}, {1.1300000000000001`, 352.0588235294117}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 122.14285714285714`}, {1.2300000000000002`, 215.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 122.14285714285714`}, {1.2300000000000002`, 225.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 122.14285714285714`}, {1.2300000000000002`, 235.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 122.14285714285714`}, {1.4300000000000002`, 247.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 245.}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 245.}, {1.1300000000000001`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 255.}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 255.}, {1.1300000000000001`, 318.5294117647059}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 265.}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 265.}, {1.1300000000000001`, 352.0588235294117}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 203.57142857142856`}, {1.2300000000000002`, 245.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 203.57142857142856`}, {1.2300000000000002`, 255.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 203.57142857142856`}, {1.2300000000000002`, 265.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 203.57142857142856`}, {1.4300000000000002`, 247.}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.57, 71.25}, {1.5300000000000002`, 40.71428571428571}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.57, 213.75}, {1.5300000000000002`, 122.14285714285714`}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.57, 356.25}, {1.5300000000000002`, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 285.}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 285.}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 275.}, {0.43, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 275.}, {1.1300000000000001`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 285.}, {0.43, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 285.}, {1.1300000000000001`, 318.5294117647059}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 295.}, {0.43, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 295.}, {1.1300000000000001`, 352.0588235294117}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 285.}, {1.2300000000000002`, 275.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 285.}, {1.2300000000000002`, 285.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 285.}, {1.2300000000000002`, 295.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 366.4285714285714}, {0.33, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 366.4285714285714}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 305.}, {0.43, 366.4285714285714}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 305.}, {1.1300000000000001`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 315.}, {0.43, 366.4285714285714}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 315.}, {1.1300000000000001`, 318.5294117647059}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 325.}, {0.43, 366.4285714285714}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 325.}, {1.1300000000000001`, 352.0588235294117}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 323.}, {1.2300000000000002`, 305.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 323.}, {1.2300000000000002`, 315.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 323.}, {1.2300000000000002`, 325.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 419.11764705882354`}, {1.03, 348.33333333333326`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 335.}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 335.}, {1.1300000000000001`, 419.11764705882354`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 452.6470588235294}, {1.03, 411.66666666666663`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 345.}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 345.}, {1.1300000000000001`, 452.6470588235294}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 486.1764705882353}, {1.03, 475.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 355.}, {0.43, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 355.}, {1.1300000000000001`, 486.1764705882353}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.17, 365.}, {1.1300000000000001`, 50.294117647058826`}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.17, 375.}, {1.1300000000000001`, 83.82352941176471}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 519.7058823529412}, {1.03, 285.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 361.}, {1.2300000000000002`, 375.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 361.}, {1.1300000000000001`, 519.7058823529412}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.37, 285.}, {1.2300000000000002`, 365.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.37, 285.}, {1.33, 361.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 285.}, {1.2300000000000002`, 335.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 285.}, {1.2300000000000002`, 345.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 285.}, {1.2300000000000002`, 355.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 285.}, {1.4300000000000002`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 385.}, {0.43, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 385.}, {1.1300000000000001`, 419.11764705882354`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 395.}, {0.43, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 395.}, {1.1300000000000001`, 452.6470588235294}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 405.}, {0.43, 285.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 405.}, {1.1300000000000001`, 486.1764705882353}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 399.}, {1.2300000000000002`, 385.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 399.}, {1.2300000000000002`, 395.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 399.}, {1.2300000000000002`, 405.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 415.}, {0.43, 366.4285714285714}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 415.}, {1.1300000000000001`, 419.11764705882354`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 425.}, {0.43, 366.4285714285714}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 425.}, {1.1300000000000001`, 452.6470588235294}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 435.}, {0.43, 366.4285714285714}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 435.}, {1.1300000000000001`, 486.1764705882353}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 436.99999999999994`}, {1.2300000000000002`, 415.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 436.99999999999994`}, {1.2300000000000002`, 425.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.27, 436.99999999999994`}, {1.2300000000000002`, 435.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 447.85714285714283`}, {0.33, 213.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 447.85714285714283`}, {0.33, 356.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 445.}, {0.43, 447.85714285714283`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 445.}, {1.1300000000000001`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 455.}, {0.43, 447.85714285714283`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 455.}, {1.1300000000000001`, 318.5294117647059}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 465.}, {0.43, 447.85714285714283`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 465.}, {1.1300000000000001`, 352.0588235294117}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 475.}, {1.2300000000000002`, 445.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 475.}, {1.2300000000000002`, 455.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 475.}, {1.2300000000000002`, 465.}}]}, 
   {GrayLevel[0], LineBox[{{1.37, 323.}, {1.33, 399.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 475.}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 475.}, {1.1300000000000001`, 419.11764705882354`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 485.}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 485.}, {1.1300000000000001`, 452.6470588235294}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 495.}, {0.43, 122.14285714285714`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 495.}, {1.1300000000000001`, 486.1764705882353}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 366.4285714285714}, {1.2300000000000002`, 475.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 366.4285714285714}, {1.2300000000000002`, 485.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 366.4285714285714}, {1.2300000000000002`, 495.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 366.4285714285714}, {1.4300000000000002`, 285.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 505.}, {0.43, 447.85714285714283`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 505.}, {1.1300000000000001`, 419.11764705882354`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 515.}, {0.43, 447.85714285714283`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 515.}, {1.1300000000000001`, 452.6470588235294}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 525.}, {0.43, 447.85714285714283`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 525.}, {1.1300000000000001`, 486.1764705882353}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 513.}, {1.2300000000000002`, 505.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 513.}, {1.2300000000000002`, 515.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.27, 513.}, {1.2300000000000002`, 525.}}]}, 
   {GrayLevel[0], LineBox[{{1.37, 361.}, {1.33, 436.99999999999994`}}]}, 
   {GrayLevel[0], LineBox[{{1.37, 399.}, {1.33, 513.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 535.}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 535.}, {1.1300000000000001`, 419.11764705882354`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 545.}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 545.}, {1.1300000000000001`, 452.6470588235294}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 555.}, {0.43, 203.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 555.}, {1.1300000000000001`, 486.1764705882353}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 447.85714285714283`}, {1.2300000000000002`, 535.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 447.85714285714283`}, {1.2300000000000002`, 545.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 447.85714285714283`}, {1.2300000000000002`, 555.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.47, 447.85714285714283`}, {1.4300000000000002`, 285.}}]}, 
   {GrayLevel[0], LineBox[{{1.37, 436.99999999999994`}, {1.33, 285.}}]}, 
   {GrayLevel[0], LineBox[{{1.37, 475.}, {1.33, 323.}}]}, 
   {GrayLevel[0], LineBox[{{1.37, 513.}, {1.33, 475.}}]}, 
   {GrayLevel[0], InsetBox["\<\"x1\"\>", {0., 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx81:Times(-1)\"\>", {0.1, 71.25},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"x2\"\>", {0., 122.14285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"DeltaX:Plus\"\>", {0.2, 71.25},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y1\"\>", {0., 203.57142857142856},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx82:Times(-1)\"\>", {0.1, 213.75},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y2\"\>", {0., 285.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"DeltaY:Plus\"\>", {0.2, 213.75},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z1\"\>", {0., 366.4285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx83:Times(-1)\"\>", {0.1, 356.25},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z2\"\>", {0., 447.85714285714283},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"DeltaZ:Plus\"\>", {0.2, 356.25},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx84:PBX\"\>", {0.30000000000000004, 71.25},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx85:PBY\"\>", {0.30000000000000004, 213.75},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx86:PBZ\"\>", {0.30000000000000004, 356.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx87:power2\"\>", {0.4, 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx88:power2\"\>", {0.4, 122.14285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx89:power2\"\>", {0.4, 203.57142857142856},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"DistanceSquared:Plus\"\>", {0.5, 142.5},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx192:reciprocal\"\>", {0.6000000000000001, 57.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx171:power2\"\>", {0.7000000000000001, 47.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx172:Symbol\"\>", {0.7000000000000001, 142.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx161:Times\"\>", {0.8, 28.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx90:power2\"\>", {0.9, 31.666666666666664},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx162:power2\"\>", {0.8, 85.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx163:Symbol\"\>", {0.8, 142.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx91:Times\"\>", {0.9, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dA\"\>", {0.8, 199.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx92:Times\"\>", {1., 31.666666666666664},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dC\"\>", {0.8, 256.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx93:Times(-1)\"\>", {1., 95.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"Evdw:Plus\"\>", {1.1, 16.764705882352942},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx164:mysqrt\"\>", {0.6000000000000001, 171.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx94:reciprocal\"\>", {0.7000000000000001, 237.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dQ1Q2\"\>", {0.6000000000000001, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"Eeel:Times\"\>", {0.8, 313.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"Energy:Plus\"\>", {1.2000000000000002, 5.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx165:power2\"\>", {0.8, 370.50000000000006},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx95:Times\"\>", {0.9, 158.33333333333331},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx96:power2\"\>", {0.9, 221.66666666666663},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx166:Symbol\"\>", {0.6000000000000001, 399.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx167:Symbol\"\>", {0.8, 427.5},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx168:reciprocal\"\>", {0.7000000000000001, 332.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx97:Times\"\>", {0.9, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz177:Times\"\>", {1., 158.33333333333331},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz188:Times(12.)\"\>", {1.1, 50.294117647058826},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx98:Times\"\>", {1.2000000000000002, 15.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz176:Times\"\>", {1., 221.66666666666663},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz190:Times(-6.)\"\>", {1.1, 83.82352941176471},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx99:Times\"\>", {1.2000000000000002, 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz187:Times\"\>", {1., 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx100:Times\"\>", {1.1, 117.3529411764706},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"gx1:Plus\"\>", {1.3, 19.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx1:Times(-1)\"\>", {1.4000000000000001, 19.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx101:Times\"\>", {1.2000000000000002, 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx102:Times\"\>", {1.2000000000000002, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx103:Times\"\>", {1.1, 150.88235294117646},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"gy1:Plus\"\>", {1.3, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy1:Times(-1)\"\>", {1.4000000000000001, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx104:Times\"\>", {1.2000000000000002, 55.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx105:Times\"\>", {1.2000000000000002, 65.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx106:Times\"\>", {1.1, 184.41176470588235},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"gz1:Plus\"\>", {1.3, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz1:Times(-1)\"\>", {1.4000000000000001, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx107:Times(-1)\"\>", {1.2000000000000002, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz191:Times(-12.)\"\>", {1.1, 217.94117647058823},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx108:Times\"\>", {1.2000000000000002, 85.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz189:Times(6.)\"\>", {1.1, 251.47058823529414},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx109:Times\"\>", {1.2000000000000002, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"gx2:Plus\"\>", {1.3, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx2:Times(-1)\"\>", {1.4000000000000001, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx110:Times(-1)\"\>", {1.2000000000000002, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx111:Times\"\>", {1.2000000000000002, 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx112:Times\"\>", {1.2000000000000002, 125.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"gy2:Plus\"\>", {1.3, 170.99999999999997},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy2:Times(-1)\"\>", {1.4000000000000001, 170.99999999999997},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx113:Times(-1)\"\>", {1.2000000000000002, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx114:Times\"\>", {1.2000000000000002, 145.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx115:Times\"\>", {1.2000000000000002, 155.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"gz2:Plus\"\>", {1.3, 209.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz2:Times(-1)\"\>", {1.4000000000000001, 209.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx116:power2\"\>", {0.9, 348.33333333333326},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx117:Times\"\>", {0.9, 411.66666666666663},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx169:power2\"\>", {0.7000000000000001, 427.5},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx170:reciprocal\"\>", {0.8, 484.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx118:Times\"\>", {0.9, 475.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz175:Times\"\>", {1., 348.33333333333326},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz181:Times(168)\"\>", {1.1, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx119:Times\"\>", {1.2000000000000002, 165.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz174:Times\"\>", {1., 411.66666666666663},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz185:Times(-48)\"\>", {1.1, 318.5294117647059},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx120:Times\"\>", {1.2000000000000002, 175.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz173:Times\"\>", {1., 475.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz183:Times(3)\"\>", {1.1, 352.0588235294117},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx121:Times\"\>", {1.2000000000000002, 185.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx122:Symbol\"\>", {1.2000000000000002, 195.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx123:Symbol\"\>", {1.2000000000000002, 205.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx124:Times(-1)\"\>", {1.1, 385.5882352941177},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tzz195:Plus\"\>", {1.3, 247.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tzz196:Plus\"\>", {1.4000000000000001, 247.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhx1x1:Plus\"\>", {1.5, 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx125:Times\"\>", {1.2000000000000002, 215.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx126:Times\"\>", {1.2000000000000002, 225.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx127:Times\"\>", {1.2000000000000002, 235.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhy1y1:Plus\"\>", {1.5, 122.14285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx128:Times\"\>", {1.2000000000000002, 245.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx129:Times\"\>", {1.2000000000000002, 255.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx130:Times\"\>", {1.2000000000000002, 265.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhz1z1:Plus\"\>", {1.5, 203.57142857142856},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhx2x2:Symbol\"\>", {1.6, 71.25},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhy2y2:Symbol\"\>", {1.6, 213.75},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhz2z2:Symbol\"\>", {1.6, 356.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz180:Times\"\>", {0.4, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx131:Times\"\>", {1.2000000000000002, 275.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx132:Times\"\>", {1.2000000000000002, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx133:Times\"\>", {1.2000000000000002, 295.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y1:Plus\"\>", {1.3, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz179:Times\"\>", {0.4, 366.4285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx134:Times\"\>", {1.2000000000000002, 305.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx135:Times\"\>", {1.2000000000000002, 315.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx136:Times\"\>", {1.2000000000000002, 325.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z1:Plus\"\>", {1.3, 323.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz186:Times(-168)\"\>", {1.1, 419.11764705882354},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx137:Times\"\>", {1.2000000000000002, 335.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz182:Times(48)\"\>", {1.1, 452.6470588235294},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx138:Times\"\>", {1.2000000000000002, 345.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz184:Times(-3)\"\>", {1.1, 486.1764705882353},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx139:Times\"\>", {1.2000000000000002, 355.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx140:Symbol\"\>", {1.2000000000000002, 365.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx141:Symbol\"\>", {1.2000000000000002, 375.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx142:Symbol\"\>", {1.1, 519.7058823529412},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tzz193:Plus\"\>", {1.3, 361.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tzz194:Plus\"\>", {1.4000000000000001, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1x2:Plus\"\>", {1.5, 285.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx143:Times\"\>", {1.2000000000000002, 385.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx144:Times\"\>", {1.2000000000000002, 395.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx145:Times\"\>", {1.2000000000000002, 405.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y2:Plus\"\>", {1.3, 399.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx146:Times\"\>", {1.2000000000000002, 415.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx147:Times\"\>", {1.2000000000000002, 425.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx148:Times\"\>", {1.2000000000000002, 435.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z2:Plus\"\>", {1.3, 436.99999999999994},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz178:Times\"\>", {0.4, 447.85714285714283},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx149:Times\"\>", {1.2000000000000002, 445.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx150:Times\"\>", {1.2000000000000002, 455.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx151:Times\"\>", {1.2000000000000002, 465.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z1:Plus\"\>", {1.3, 475.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy1x2:Symbol\"\>", {1.4000000000000001, 323.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx152:Times\"\>", {1.2000000000000002, 475.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx153:Times\"\>", {1.2000000000000002, 485.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx154:Times\"\>", {1.2000000000000002, 495.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1y2:Plus\"\>", {1.5, 366.4285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx155:Times\"\>", {1.2000000000000002, 505.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx156:Times\"\>", {1.2000000000000002, 515.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx157:Times\"\>", {1.2000000000000002, 525.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z2:Plus\"\>", {1.3, 513.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1x2:Symbol\"\>", {1.4000000000000001, 361.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1y2:Symbol\"\>", {1.4000000000000001, 399.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx158:Times\"\>", {1.2000000000000002, 535.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx159:Times\"\>", {1.2000000000000002, 545.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx160:Times\"\>", {1.2000000000000002, 555.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohz1z2:Plus\"\>", {1.5, 447.85714285714283},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2y2:Symbol\"\>", {1.4000000000000001, 436.99999999999994},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2z2:Symbol\"\>", {1.4000000000000001, 475.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy2z2:Symbol\"\>", {1.4000000000000001, 513.},
     Background->Automatic]}},
  AspectRatio->0.41,
  ImageSize->{1225.5343749999997`, Automatic}]], "Output",
 CellChangeTimes->{3.78092661240168*^9, 3.780926819185948*^9, 
  3.780926984650388*^9, 3.780928034515781*^9, 3.780928125001899*^9, 
  3.7809284080145187`*^9, 3.780928547924119*^9, 3.780929192060339*^9, 
  3.780929284263267*^9, 3.78093599973*^9, 3.780936257338174*^9, 
  3.780944850627388*^9, 3.7809449486105003`*^9, 3.781519974616006*^9, 
  3.7815203562691107`*^9, 
  3.781522769297867*^9},ExpressionUUID->"425a00fa-25b1-4db1-ba30-\
4adb841f4d79"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"````", " ", "bg"}]], "Input",
 CellChangeTimes->{{3.780929039746863*^9, 
  3.7809290413270082`*^9}},ExpressionUUID->"1161a2d9-6795-4769-a7b1-\
c46f0bf22cc3"],

Cell[CellGroupData[{

Cell["Dihedral angle", "Subtitle",
 CellChangeTimes->{
  3.402881806378004*^9, {3.4029555772158318`*^9, 
   3.4029555790467377`*^9}},ExpressionUUID->"2c715488-8574-4dc8-b259-\
e407398884f0"],

Cell[CellGroupData[{

Cell["Setup the torsion term", "Subtitle",
 CellChangeTimes->{{3.402833465987742*^9, 3.402833468829653*^9}, 
   3.4028818063788223`*^9},ExpressionUUID->"04a6cd04-a1ad-4f68-89b0-\
09b82e237d8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"phi", ",", "CosNPhi", ",", "SinNPhi", ",", "Phi"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.402653084688365*^9, 3.402653100998479*^9}, {
   3.402833442487673*^9, 3.4028334501114883`*^9}, 3.402881806379428*^9, {
   3.40296426730527*^9, 3.402964283016556*^9}, 3.405637646867723*^9, {
   3.40960202074789*^9, 
   3.409602031402295*^9}},ExpressionUUID->"48166561-3b1d-4d0c-99e7-\
fbf136785210"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ri", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rj", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rk", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x4", ",", " ", "y4", ",", " ", "z4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl"}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40265249702987*^9, 3.4026525074946632`*^9}, {
   3.402652543668639*^9, 3.4026526354944773`*^9}, 3.402881806379868*^9, {
   3.4029642140397663`*^9, 3.402964261657007*^9}, 3.402968762538885*^9, {
   3.4056376184618797`*^9, 3.4056376382193604`*^9}, {3.408634462799267*^9, 
   3.408634470108696*^9}},ExpressionUUID->"d173f676-d991-422e-925e-\
848a3c01d1c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecLen", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.402881806380116*^9},ExpressionUUID->"6f4603c2-1919-4713-9f3d-\
46f2373773f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"ri", " ", "-", " ", "rj"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", " ", "=", " ", 
   RowBox[{"rj", " ", "-", " ", "rk"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"rl", " ", "-", " ", "rk"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402755487828414*^9, 3.4027555454245787`*^9}, {
   3.4028250971369543`*^9, 3.4028251976062737`*^9}, {3.4028282092482367`*^9, 
   3.402828220149057*^9}, 3.402881806380427*^9, {3.402964299899055*^9, 
   3.402964340775798*^9}},ExpressionUUID->"f1373096-91c6-4ff9-b77d-\
cf67e08b45f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"F", ",", "G"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028282142394447`*^9, 3.402828222806171*^9}, {
   3.402834973364376*^9, 3.402834982337648*^9}, 3.4028818063806667`*^9, 
   3.402955566383662*^9, {3.4029643524819727`*^9, 
   3.4029643605165043`*^9}},ExpressionUUID->"d9f570bf-0939-4b37-8ea1-\
49aa68016099"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"H", ",", "G"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.402828225130542*^9, 3.402881806381667*^9, 3.402955564159459*^9, {
   3.402964370060401*^9, 
   3.402964375836578*^9}},ExpressionUUID->"f79c04a5-5bb8-4d01-bad7-\
24fb62e57685"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lenA", " ", "=", " ", 
   RowBox[{"vecLen", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenB", " ", "=", " ", 
   RowBox[{"vecLen", "[", "B", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403381748201618*^9, 
  3.403381765864654*^9}},ExpressionUUID->"b11908d1-0513-47b9-b2cf-\
7496adc770f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reciprocalLenA", " ", "=", " ", 
   RowBox[{"reciprocal", "[", "lenA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reciprocalLenB", " ", "=", " ", 
   RowBox[{"reciprocal", "[", "lenB", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403382804807138*^9, 
  3.403382828904648*^9}},ExpressionUUID->"1c23c8e9-8c90-42a8-b35e-\
89ecee86aa63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x4", ",", "x", ",", "I4", ",", "0", ",", "DPhiDrl"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y4", ",", "y", ",", "I4", ",", "1", ",", "DPhiDrl"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "z", ",", "I4", ",", "2", ",", "DPhiDrl"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}, {
  3.408584461197592*^9, 3.408584542081841*^9}, {3.40858684037824*^9, 
  3.408586889698691*^9}, {3.408625912333675*^9, 3.4086259293924017`*^9}, {
  3.408653564774177*^9, 
  3.408653597724698*^9}},ExpressionUUID->"d12d2742-bf4e-43cd-8efe-\
d9b2bf9f1ddb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dihedralSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(sinPhase);\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(cosPhase);\>\"", "]"}]}], "]"}],
   ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(V);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(DN);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(IN);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.410178119207843*^9, 3.410178147107234*^9}, {
  3.410178361408951*^9, 3.4101784213739767`*^9}, {3.410178946297854*^9, 
  3.4101789485592403`*^9}},ExpressionUUID->"7ec09b1f-51be-4efa-a5cf-\
4f855bea40b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "dihedralVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<DIHEDRAL_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4101781215075903`*^9, 
  3.4101781485693007`*^9}},ExpressionUUID->"2bb525bc-1b3e-4313-a4d8-\
43596cac591d"],

Cell[BoxData[
 RowBox[{"dihedralSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 
   3.4101781294677153`*^9},ExpressionUUID->"168cbd1f-187a-4c9e-a519-\
380f5029763a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralCosPhiRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",ExpressionUUID->"4d46bed1-9f85-4c46-\
a287-e1c498026f22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"lenA", "\[Rule]", "LenA"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"lenB", "\[Rule]", "LenB"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"reciprocalLenA", "\[Rule]", "ReciprocalLenA"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"reciprocalLenB", "\[Rule]", "ReciprocalLenB"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.403381795133479*^9, 3.403381809347353*^9}, {
  3.4033829211263123`*^9, 3.403382946948868*^9}, {3.408654812106743*^9, 
  3.408654814048378*^9}, {3.408654920425684*^9, 3.408654921999897*^9}, {
  3.409075691562851*^9, 
  3.409075693450658*^9}},ExpressionUUID->"debcb2a5-d54b-4108-a285-\
b9df83d79199"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<if (fabs(LenA)<TENM3) ReciprocalLenA = 0.0;\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<if (fabs(LenB)<TENM3) ReciprocalLenB = 0.0;\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4033818122758904`*^9, 3.403381840232418*^9}, {
  3.4033827438088503`*^9, 3.403382763638501*^9}, {3.4033829548741693`*^9, 
  3.403383007369802*^9}, {3.4055924931110487`*^9, 3.405592500629326*^9}, {
  3.405592532178042*^9, 3.405592534505735*^9}, {3.4086548146190777`*^9, 
  3.408654815130253*^9}, {3.408654922633814*^9, 3.408654923297142*^9}, {
  3.409075693987598*^9, 
  3.4090756946375628`*^9}},ExpressionUUID->"ea90d0af-3dd3-4248-a477-\
5318c4d13a44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"recLenArecLenB", " ", "=", " ", 
   RowBox[{"ReciprocalLenA", "*", "ReciprocalLenB"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403388254532496*^9, 3.403388262628626*^9}, {
  3.403388309891501*^9, 
  3.403388332051207*^9}},ExpressionUUID->"370fcd2f-d37d-408c-ae37-\
9e62e685604c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"recLenArecLenB", "\[Rule]", "RecLenARecLenB"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.403388232755147*^9, 3.403388241973654*^9}, {
   3.403388501153823*^9, 3.403388516222354*^9}, 3.408654816210609*^9, 
   3.408654924312829*^9, 
   3.409075695424748*^9},ExpressionUUID->"c7547eb4-845e-4dc4-a46c-\
8808e81a4a86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"CCode", "[", "\"\<EraseLinearDihedral = 1.0;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if (RecLenARecLenB==0.0) EraseLinearDihedral = 0.0;\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4033919483618107`*^9, 3.403391962642305*^9}, {
   3.403392705555187*^9, 3.4033927065442123`*^9}, 3.405592505204919*^9, 
   3.405593744922014*^9, {3.405601635740213*^9, 3.405601636005928*^9}, 
   3.408465248370534*^9, {3.408654816731285*^9, 3.408654817290806*^9}, {
   3.408654924945858*^9, 3.408654925617879*^9}, {3.409075696112319*^9, 
   3.409075697100321*^9}, {3.4103580164504538`*^9, 
   3.410358022595854*^9}},ExpressionUUID->"32a6a789-05b7-46a9-acfd-\
3c76d8e4754c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"A", ".", "B"}], "*", 
    RowBox[{"(", "RecLenARecLenB", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"vecLen", "[", "G", "]"}], "*", "RecLenARecLenB", "*", 
    RowBox[{"Dot", "[", 
     RowBox[{"A", ",", "H"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402964460638973*^9, 3.4029644979500027`*^9}, 
   3.403138409061648*^9, 3.403138952358144*^9, {3.403381771339631*^9, 
   3.403381781016387*^9}, {3.403382836161371*^9, 3.40338284912206*^9}, {
   3.403388413788684*^9, 3.4033884282841063`*^9}, {3.405601670420813*^9, 
   3.405601670652701*^9}},ExpressionUUID->"66e92952-00d3-41ee-b425-\
43253b008cf9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"cosPhi", "\[Rule]", "CosPhi"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"sinPhi", "\[Rule]", "SinPhi"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.403383084646188*^9, 3.403383094503001*^9}, {
  3.4056016822760763`*^9, 3.405601688783058*^9}, {3.408654818267323*^9, 
  3.40865481882014*^9}, {3.408654926626211*^9, 3.408654927282428*^9}, {
  3.4090757012621*^9, 
  3.409075701874107*^9}},ExpressionUUID->"86a39eaf-6c11-4f07-be79-\
8c82a081ffad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CosPhi=MAX(-1.0,MIN(1.0,CosPhi));\>\"", "]"}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.403389122700157*^9, 3.4033891636404963`*^9}, {
   3.405592510669314*^9, 3.405592526290204*^9}, {3.405603211703527*^9, 
   3.4056032309337063`*^9}, 3.408654819467073*^9, 3.408654927979665*^9, 
   3.4090757033740664`*^9},ExpressionUUID->"f7b5f770-59e8-46ac-982c-\
1bb4f808342f"],

Cell["phi = ArcCos[CosPhi];", "Text",
 CellChangeTimes->{{3.40282522628094*^9, 3.402825239560916*^9}, 
   3.402828109424087*^9, 3.4028818064977922`*^9, 3.402955593607312*^9, {
   3.402966167764285*^9, 3.4029662209128017`*^9}, {3.402969136323854*^9, 
   3.4029691467936563`*^9}, 3.403118920705655*^9, {3.403382875874411*^9, 
   3.403382893266426*^9}, {3.403383072284999*^9, 
   3.403383073172804*^9}},ExpressionUUID->"2bb2c12e-8c52-4e40-9006-\
aa14df8aba28"],

Cell["\<\
AppendTo[dihedralEnergyRules, phi -> Phi]; (* I don't think I need to \
evaluate Phi *)\
\>", "Text",
 CellChangeTimes->{{3.402965641072318*^9, 3.402965644799386*^9}, {
   3.402966337775351*^9, 3.402966341759678*^9}, {3.405601725668915*^9, 
   3.4056017329385233`*^9}, 3.408654821084379*^9, 
   3.4086549288754272`*^9},ExpressionUUID->"7a22154a-cae8-4624-9a16-\
0a71e403dc5a"],

Cell["\<\
At this point we need to calculate SinNPhi and CosNPhi and we use the \
function calculateSinNPhiCosNPhi in both C and Mathematica.Insert function \
sinNPhiCosNPhi[N, &sinNPhi, &cosNPhi, sinPhi, cosPhi] into evaluation\
\>", "Text",
 CellChangeTimes->{{3.403169337342634*^9, 3.4031693991609783`*^9}, {
   3.4031694370531073`*^9, 3.403169446972969*^9}, 
   3.405602925754593*^9},ExpressionUUID->"26faa9f2-ab5f-49ae-b942-\
980e9ac4d4aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralEnergyRules", " ", "=", " ", "dihedralCosPhiRules"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4090757099968023`*^9, 
  3.409075717160824*^9}},ExpressionUUID->"c18dffc4-bef2-44f6-bad3-\
27591dea4f8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "MathCode", "[", "\"\<CosNPhi = mathCosNPhi[IN,SinPhi,CosPhi];\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "MathCode", "[", "\"\<SinNPhi = mathSinNPhi[IN,SinPhi,CosPhi];\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.405602524021294*^9, 3.4056025656526947`*^9}, {
  3.40560260894772*^9, 3.40560261252293*^9}, {3.4056026493129673`*^9, 
  3.4056026535224733`*^9}, {3.405602967032895*^9, 3.405603034772718*^9}, {
  3.405603082328196*^9, 3.405603085028963*^9}, {3.405603291979817*^9, 
  3.405603295480481*^9}, {3.405636297453783*^9, 3.4056363006503143`*^9}, {
  3.405689828587071*^9, 3.405689830571216*^9}, {3.405690580000684*^9, 
  3.405690585973423*^9}, {3.408654825235148*^9, 3.4086548259385366`*^9}, {
  3.4086549296133757`*^9, 
  3.408654930210107*^9}},ExpressionUUID->"5ccfd4d3-ee22-478b-ae97-\
d3a55f5e0442"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralEnergyRules", ",", 
       RowBox[{
       "MathCode", "[", 
        "\"\<If[CosPhi>0.1,Phi=ArcSin[SinPhi],\n\t\t\t\t\t\
Phi=ArcCos[CosPhi]*Sign[SinPhi]];\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralEnergyRules", ",", 
       RowBox[{
       "CCode", "[", 
        "\"\<if(CosPhi>0.1){Phi=asin(SinPhi);}else\n\t\t\t\t\t\
{Phi=acos(CosPhi)*SIGN(SinPhi);}\>\"", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.407764211219077*^9, 3.407764213360669*^9}, {
  3.409076769869112*^9, 3.409076770848304*^9}, {3.4090773287521353`*^9, 
  3.4090773292641153`*^9}, {3.4090773794499187`*^9, 3.409077380038114*^9}, {
  3.409361613956606*^9, 
  3.409361646817099*^9}},ExpressionUUID->"186f3d6c-ef4e-4cff-b476-\
54eecbd918ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<sinNPhiCosNPhi(IN, &SinNPhi, &CosNPhi, SinPhi, CosPhi);\>\"", 
     "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4031695628011417`*^9, 3.403169583242929*^9}, {
   3.403170106527663*^9, 3.403170113631514*^9}, 3.403171032582622*^9, {
   3.403174922877117*^9, 3.403174926106832*^9}, {3.405592540417914*^9, 
   3.405592544481194*^9}, 3.4086548276018343`*^9, 
   3.408654930937489*^9},ExpressionUUID->"1e2d2d99-5518-4d52-ba69-\
bfaf22cda31b"],

Cell["\<\
Sum and difference formulas
sin (A + B) = sin A cos B + cos A sin B
sin (A - B) = sin A cos B - cos A sin B
cos (A + B) = cos A cos B - sin A sin B
cos (A - B) = cos A cos B + sin A sin B\
\>", "Text",
 CellChangeTimes->{{3.4029651450204144`*^9, 
  3.402965152857622*^9}},ExpressionUUID->"9b22137e-6645-4778-a8f4-\
e5c118342aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosNPhiPhase", " ", "=", 
   RowBox[{
    RowBox[{"CosNPhi", "*", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", "*", "sinPhase"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinNPhiPhase", "=", 
   RowBox[{
    RowBox[{"SinNPhi", "*", "cosPhase"}], "-", 
    RowBox[{"CosNPhi", "*", "sinPhase"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403139078293602*^9, 3.4031391381942577`*^9}, {
  3.403139212082849*^9, 3.4031392263073587`*^9}, {3.403169453484665*^9, 
  3.403169458640418*^9}, {3.403172460862658*^9, 3.40317246375632*^9}, {
  3.403392657908375*^9, 3.4033926638482733`*^9}, {3.405602017427895*^9, 
  3.405602050542378*^9}, {3.407679968844823*^9, 
  3.407680033912936*^9}},ExpressionUUID->"c61cd9aa-05f8-451d-afc9-\
a2aa733c5363"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dihedralDeviation", " ", "=", " ", 
    RowBox[{"1.0", "+", "cosNPhiPhase"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"between", " ", "0.0", " ", "and", " ", "2.0"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.411197914354374*^9, 
  3.4111979407786827`*^9}},ExpressionUUID->"56e0d398-20da-4c24-a55a-\
956be9d66f62"],

Cell[BoxData[
 RowBox[{"fnETorsion", " ", "=", " ", 
  RowBox[{"EraseLinearDihedral", " ", "*", " ", "V", " ", 
   RowBox[{"(", "dihedralDeviation", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.405602085801338*^9, 3.405602087655345*^9}, 
   3.4096015455999117`*^9, {3.411197947482793*^9, 
   3.411197949874654*^9}},ExpressionUUID->"9bed52e1-37e9-449f-b571-\
b64ae2d2130b"],

Cell["\<\
fnETorsion = EraseLinearDihedral * V (1.0 + Cos[DN Phi - phase]);\
\>", "Text",
 CellChangeTimes->{{3.402664776710464*^9, 3.4026647964202747`*^9}, {
   3.402741579461403*^9, 3.402741589532634*^9}, {3.4027540176742983`*^9, 
   3.402754019034227*^9}, 3.402754202717703*^9, {3.4028278800721903`*^9, 
   3.402827880421856*^9}, {3.402833328460658*^9, 3.402833328801766*^9}, 
   3.402833524934355*^9, {3.402833585431164*^9, 3.4028335857684526`*^9}, 
   3.402881806518937*^9, 3.4029662365236692`*^9, 3.402966333014995*^9, {
   3.403170907390308*^9, 3.403170917454175*^9}, {3.403391977060162*^9, 
   3.403391981586698*^9}, {3.403392611162285*^9, 
   3.4033926122962713`*^9}},ExpressionUUID->"aa8e8216-8ac0-4e2a-af79-\
dca7d0934cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DihedralDeviation", ",", "dihedralDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"fnETorsion", "\[Rule]", "Energy"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<DIHEDRAL\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dihedralOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.402966429264083*^9, 3.402966441189411*^9}, {
  3.403180571417967*^9, 3.403180572463499*^9}, {3.408588700097761*^9, 
  3.408588806889308*^9}, {3.408654830951703*^9, 3.408654831761635*^9}, {
  3.4086549320244093`*^9, 3.4086549327532454`*^9}, {3.409106916232429*^9, 
  3.409106923925405*^9}, {3.409108094891713*^9, 3.409108096587041*^9}, {
  3.411197956372534*^9, 
  3.4111979918487797`*^9}},ExpressionUUID->"a9184859-c949-4e9f-88c7-\
1e2e39d34984"],

Cell[BoxData[
 RowBox[{"dihedralInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl", ",", 
     RowBox[{"{", 
      RowBox[{
      "V", ",", "DN", ",", "IN", ",", "cosPhase", ",", " ", "sinPhase"}], 
      "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598381722083*^9, 3.4055984189648457`*^9}, {
  3.405603057636241*^9, 3.4056030583078613`*^9}, {3.405690789130921*^9, 
  3.40569079264091*^9}},ExpressionUUID->"3445692b-c03d-4399-acb3-\
cd95d571d5bd"],

Cell[BoxData[
 RowBox[{"dihedralEnergyFn", " ", "=", " ", 
  RowBox[{"fnETorsion", "/.", 
   RowBox[{"{", 
    RowBox[{"Phi", "\[Rule]", "phi"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.403216193482387*^9, 3.403216216011763*^9}, {
  3.4032164096112223`*^9, 
  3.403216415920596*^9}},ExpressionUUID->"9f07ce97-a97b-4cc8-9e6c-\
70537fa3669b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dETorsiondPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "EraseLinearDihedral"}], "*", "V", "*", "DN", "*", 
    "sinNPhiPhase"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, 3.416871814458685*^9, 
   3.416872019347313*^9},ExpressionUUID->"67b5d60b-cd3a-4513-93fa-\
6dbbe68dd7c7"],

Cell[BoxData[
 RowBox[{"dihedralGradientRules", " ", "=", " ", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.408654769261054*^9, 
  3.408654775197638*^9}},ExpressionUUID->"36e3cb19-be19-40a3-86e7-\
a6678a3d4a19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralGradientRules", ",", " ", 
    RowBox[{"Assign", "[", 
     RowBox[{"DeDPhi", ",", " ", "dETorsiondPhi"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.403119298187716*^9, 3.403119313404195*^9}, {
   3.403119766211968*^9, 3.4031197683762083`*^9}, 3.408583034341649*^9, {
   3.408583127586095*^9, 3.4085831347382*^9}, {3.408654883213402*^9, 
   3.408654886361278*^9}},ExpressionUUID->"79b09721-d056-44ac-929c-\
712efbaf3908"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDri", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"A", ".", "A"}]]}], "A"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408582505876679*^9, 3.4085825260019217`*^9}, {
   3.408582666908884*^9, 3.4085826685540457`*^9}, {3.408582953793984*^9, 
   3.40858295864988*^9}, {3.408583027864543*^9, 3.408583040966227*^9}, 
   3.408583191274479*^9, {3.40858326860931*^9, 3.4085832687611732`*^9}, {
   3.408626032409171*^9, 
   3.408626033373294*^9}},ExpressionUUID->"1a06cf2d-48c0-452c-882b-\
c830661e46e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrj", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"A", ".", "A"}]], "A"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"F", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"A", ".", "A"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "A"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"H", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"B", ".", "B"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "B"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4085825280925817`*^9, 3.4085825309826937`*^9}, 
   3.408582577839138*^9, {3.4085826709324503`*^9, 3.408582715459239*^9}, {
   3.408582926123191*^9, 3.408582929442951*^9}, {3.408583042966744*^9, 
   3.4085830443033247`*^9}, {3.408583194635971*^9, 3.408583194955699*^9}, {
   3.408583270147748*^9, 3.408583270323516*^9}, {3.408626035616419*^9, 
   3.408626042918641*^9}},ExpressionUUID->"a7cd9709-264e-4fc1-bf3a-\
9a397dda670c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrk", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"H", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"B", ".", "B"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "B"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"F", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"A", ".", "A"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "A"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"B", ".", "B"}]], "B"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085828262895317`*^9, 3.408582843568289*^9}, {
  3.4085828906122704`*^9, 3.408582896089611*^9}, {3.4085829396988707`*^9, 
  3.4085829428671217`*^9}, {3.408583046239622*^9, 3.4085830475434027`*^9}, {
  3.408583197915868*^9, 3.408583198955614*^9}, {3.4085832717315197`*^9, 
  3.408583271883222*^9}, {3.408626045600368*^9, 
  3.4086260528864803`*^9}},ExpressionUUID->"09d44404-3c78-40a6-aa12-\
aa361d490dc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrl", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"vecLen", "[", "G", "]"}], 
      RowBox[{"B", ".", "B"}]], "B"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408582881233783*^9, 3.4085828856608562`*^9}, {
  3.408582948194116*^9, 3.4085829506817493`*^9}, {3.408583050590252*^9, 
  3.408583051838098*^9}, {3.40858320066665*^9, 3.408583201666376*^9}, {
  3.408583273650627*^9, 
  3.408583273778283*^9}},ExpressionUUID->"1248b998-e90a-44e4-9d7d-\
584802f1c348"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhidr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408626318970158*^9, 3.408626321691942*^9}, {
  3.408653535566351*^9, 
  3.408653537581769*^9}},ExpressionUUID->"37d3e421-ee2c-4e0d-9293-\
8cff263da424"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendOneDihedralGradientForce", "[", 
    RowBox[{
    "rawMacroPrefix_", ",", "be_", ",", "dPhidr_", ",", "outputs_", ",", 
     "rawNameInfo_", ",", "rawdEdPhi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fn", ",", "gradName", ",", "zforceName", ",", "nameRules", ",", "\n", 
       "\t", 
       RowBox[{"dEdPhi", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawdEdPhi", "]"}]}], ",", "\n", "\t", 
       RowBox[{"nameInfo", "=", 
        RowBox[{"Evaluate", "[", "rawNameInfo", "]"}]}], ",", "\n", "\t", 
       RowBox[{"macroPrefix", "=", 
        RowBox[{"Evaluate", "[", "rawMacroPrefix", "]"}]}], ",", "var"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"nameRules", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", "nameInfo", "]"}]}], ";", "\n", "\t", 
      RowBox[{"var", " ", "=", " ", 
       RowBox[{"Name", "/.", "nameRules"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"gradName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<g\>\"", "<>", 
         RowBox[{"ToString", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"zforceName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<f\>\"", "<>", 
         RowBox[{"ToString", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"fn", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Func", "/.", "nameRules"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Offset", "/.", "nameRules"}], ")"}], "+", "1"}], "]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"dPhidr", ",", "fn"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"Assign", "[", 
         RowBox[{"gradName", ",", 
          RowBox[{"fn", "*", "dEdPhi"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"Assign", "[", 
         RowBox[{"zforceName", ",", 
          RowBox[{"-", "gradName"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"ForceAccumulate", "[", 
         RowBox[{"macroPrefix", ",", "nameRules", ",", "zforceName"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"outputs", ",", "zforceName"}], "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendOneDihedralGradientForce", ",", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408583442273871*^9, 3.40858347975031*^9}, {
   3.408583509820074*^9, 3.408583633252095*^9}, {3.408583848031049*^9, 
   3.408583860112351*^9}, {3.4085840615783367`*^9, 3.408584074466069*^9}, {
   3.408585289468058*^9, 3.408585296407564*^9}, {3.408586346355459*^9, 
   3.408586397442857*^9}, {3.408586551965033*^9, 3.40858656097042*^9}, {
   3.408586661640358*^9, 3.4085866701015673`*^9}, {3.408586723624707*^9, 
   3.408586762807335*^9}, {3.408586957277357*^9, 3.408586960316139*^9}, {
   3.408587490456483*^9, 3.408587497630123*^9}, {3.4085885065212183`*^9, 
   3.408588518784276*^9}, {3.408626242208082*^9, 3.40862626034951*^9}, {
   3.4086268358875427`*^9, 3.40862683796587*^9}, {3.408628276023779*^9, 
   3.408628277246122*^9}, {3.408628754748343*^9, 3.4086287554412327`*^9}, {
   3.408629317810897*^9, 3.40862932003971*^9}, {3.408629434381608*^9, 
   3.408629465997069*^9}, {3.4086297839355583`*^9, 3.408629799055213*^9}, {
   3.4086298969824553`*^9, 3.408629947960977*^9}, {3.408629990536791*^9, 
   3.4086300132964287`*^9}, 3.4086301209959106`*^9, {3.408630182148696*^9, 
   3.408630186363256*^9}, {3.408630225944582*^9, 3.408630291379216*^9}, {
   3.408630611862846*^9, 3.408630612733583*^9}, {3.408630750709251*^9, 
   3.408630764213498*^9}, {3.408630802985215*^9, 3.408630809271747*^9}, {
   3.408632107394019*^9, 3.40863211369786*^9}, {3.4086537003532047`*^9, 
   3.408653755712685*^9}, {3.408653792483273*^9, 3.408653811300997*^9}, {
   3.4086540934716377`*^9, 3.408654094356517*^9}, {3.408654124753436*^9, 
   3.4086541807725286`*^9}, {3.40865545878123*^9, 3.408655487290687*^9}, {
   3.411067845895697*^9, 
   3.411067854808709*^9}},ExpressionUUID->"c20950c1-b387-4d71-aafc-\
9c39dd9774c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralGradientForce", "[", 
    RowBox[{
    "rawMacroPrefix_", ",", "be_", ",", "dPhidr_", ",", "outputs_", ",", 
     "rawNames_", ",", "rawdEdPhi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"macroPrefix", "=", 
        RowBox[{"Evaluate", "[", "rawMacroPrefix", "]"}]}], ",", "\n", "\t", 
       RowBox[{"dEdPhi", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawdEdPhi", "]"}]}], ",", "\n", "\t", 
       RowBox[{"names", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawNames", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "names", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Appending gradient force for name: \>\"", ",", " ", 
           RowBox[{
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"AppendOneDihedralGradientForce", "[", 
          RowBox[{
          "macroPrefix", ",", "be", ",", "dPhidr", ",", "outputs", ",", 
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "dEdPhi"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralGradientForce", ",", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvcOdzS869aWjjoR5IIj292mKANFi/owxIHpiIm9o
DJCuYhCMANEd0i05IDpAsyQfRNfw5ZeB6M25JRUg+kDnmloQ/fRiRj2IzpZ+
fwdE65RPvguid/htuRkLpFue378Fol1udT8C0UkxSo9BtNVZV+cCIN24JN4d
REtd0XAvBNLrlvuA6Xu+XiUg+oW9UTmI3s17ohpEz9R+DqajVvA8BdFGa1ne
guhtt1/8BdGtv2f/A9HOn79wFAFpVo5YARC9LyJGBkS/+2ulAKKVN/zXANFT
Olg1QXSLz6GltSD/pymsB9Gpj3Y8ANHzbwg8AdEAikqcuQ==
  "],ExpressionUUID->"e09ad023-a5ad-4301-8f5e-341d1cf22154"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendDihedralGradientForce", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralGradientRules", ",", "dPhidr", ",", 
    "dihedralOutputs", ",", "dihedralVarNames", ",", "DeDPhi"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408583158451829*^9, 3.408583204297793*^9}, {
   3.408583250507711*^9, 3.4085832774018927`*^9}, {3.4085860684090223`*^9, 
   3.408586084549323*^9}, {3.4085861890242767`*^9, 3.408586192646565*^9}, 
   3.408625788717267*^9, {3.408626324346002*^9, 3.4086263256575327`*^9}, {
   3.408626862127885*^9, 3.408626863302903*^9}, {3.408653540706973*^9, 
   3.408653549608212*^9}, {3.4086547771718388`*^9, 
   3.408654780018731*^9}},ExpressionUUID->"982a06ab-e132-4674-9a95-\
3d0ee3e9e8c2"],

Cell["\<\
Now dPhidr contains the vector derivative of Phi wrt every component in (r)\
\>", "Subsubsection",
 CellChangeTimes->{{3.408653888574654*^9, 
  3.408653908030429*^9}},ExpressionUUID->"09c0c0f8-cd97-40d3-a1a1-\
f921d3e1174e"],

Cell[BoxData[
 RowBox[{"Length", "[", "dPhidr", "]"}]], "Input",
 CellChangeTimes->{{3.40865419380256*^9, 
  3.408654215591751*^9}},ExpressionUUID->"b79d8e5b-16e9-4c78-8a2f-\
438ee6aaa943"],

Cell["Calculate the Second derivatives of d2Edr2", "Section",
 CellChangeTimes->{{3.408638468118968*^9, 
  3.408638485233533*^9}},ExpressionUUID->"e6ce6857-cc90-4239-a1df-\
e442a8d52a2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OuterVector", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "a", ",", "b"}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.4086496700448513`*^9, 
  3.408649688184026*^9}},ExpressionUUID->"ae4993fa-865f-4f84-b943-\
fb64b4319906"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OverlayMatrix", "[", 
    RowBox[{"phiMatrix_", ",", "xo_", ",", "yo_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xa", ",", "ya"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", 
        RowBox[{"x", "\[LessEqual]", "3"}], ",", 
        RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"y", "=", "1"}], ",", 
           RowBox[{"y", "\[LessEqual]", "3"}], ",", 
           RowBox[{"y", "++"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"xa", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xo", "-", "1"}], ")"}], "*", "3"}], "+", "x"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"ya", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"yo", "-", "1"}], ")"}], "*", "3"}], "+", "y"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Filling matrix[\>\"", ",", "xa", ",", "\"\<,\>\"", ",", 
              "ya", ",", "\"\<] := mat[\>\"", ",", "x", ",", "\"\<,\>\"", ",",
               "y", ",", "\"\<];\>\""}], "]"}], ";", "\[IndentingNewLine]", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"phiMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"xa", ",", "ya"}], "]"}], "]"}], "=", " ", 
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "x", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xa", "\[NotEqual]", "ya"}], ",", 
              RowBox[{
               RowBox[{"phiMatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"ya", ",", "xa"}], "]"}], "]"}], "=", " ", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], "[", 
                RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"OverlayMatrix", ",", "HoldFirst"}], "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.4085956931446743`*^9, 3.408595765358075*^9}, {
   3.408595994831271*^9, 3.408596075787022*^9}, {3.408596527240266*^9, 
   3.4085965346782017`*^9}, {3.408596636857461*^9, 3.4085966739671087`*^9}, {
   3.4085967280507107`*^9, 3.408596734282061*^9}, {3.408597028304843*^9, 
   3.408597028648077*^9}, {3.408600049585248*^9, 3.408600050238905*^9}, {
   3.4086001540863256`*^9, 3.40860015575526*^9}, {3.408650868168599*^9, 
   3.408650874342412*^9}, {3.409176994256433*^9, 3.409176998128837*^9}, {
   3.40917705911803*^9, 3.4091770600650053`*^9}, 3.409177469431367*^9, {
   3.409194918943551*^9, 3.409195004699732*^9}, {3.409196900262257*^9, 
   3.4091969757737427`*^9}},ExpressionUUID->"fbbf1644-2eee-4c9c-9740-\
8c12eb5090da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OverlaySymmetricMatrix", "[", 
    RowBox[{"phiMatrix_", ",", "xo_", ",", "yo_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"OverlayMatrix", "[", 
       RowBox[{"phiMatrix", ",", "xo", ",", "yo", ",", "mat"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"OverlaySymmetricMatrix", ",", "HoldFirst"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408597009173896*^9, 3.408597090552865*^9}, {
  3.408600053806898*^9, 3.408600054390049*^9}, {3.408650877237729*^9, 
  3.4086508834211607`*^9}, {3.4091969226416397`*^9, 
  3.409196923185772*^9}},ExpressionUUID->"818ef731-d807-4f6c-8612-\
26a3c53915c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"According", " ", "to", " ", "the", " ", "paper"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "what", " ", "the", " ", "Outer", " ", "product", 
     " ", "of", " ", "two", " ", "matrices", " ", "should", " ", "be"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixOuter", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "a", "]"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "b", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "a", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "a", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", 
               RowBox[{"b", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.408646334685039*^9, 3.408646348937072*^9}, {
  3.408646393499062*^9, 3.408646441191723*^9}, {3.4086464941951*^9, 
  3.408646501455883*^9}, {3.408646567290539*^9, 3.408646603288045*^9}, {
  3.408646734480702*^9, 
  3.408646748040139*^9}},ExpressionUUID->"97454f10-3f99-4bb2-808a-\
4931900b2926"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhi2dFGHdFGH", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "9", "}"}]}], "]"}], ",", 
     RowBox[{"{", "9", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408650916620843*^9, 3.4086509484346237`*^9}, 
   3.408651027715415*^9},ExpressionUUID->"af4f7656-b332-4a0f-8933-\
d23cb6e32181"],

Cell[BoxData[
 RowBox[{"dPhi2dFGHdFGH", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40865095085678*^9, 3.408650959889976*^9}, 
   3.408651029835174*^9},ExpressionUUID->"80c7660e-d278-4017-9f6f-\
b049c02bf4be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "32"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dFdF", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OuterVector", "[", 
         RowBox[{"A", ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "A"}], "]"}]}], "]"}], "+", 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "A"}], "]"}], ",", "A"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "1", ",", "dPhi2dFdF"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408649591846072*^9, 3.408649725124913*^9}, 
   3.40864990872332*^9, {3.408650410732383*^9, 3.408650413905846*^9}, {
   3.409174396822336*^9, 3.409174400831032*^9}, {3.409174874841948*^9, 
   3.409174875243573*^9}},ExpressionUUID->"8155b724-a0ae-457b-be3d-\
e25534053b96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.40936184075718*^9, 3.409361845493381*^9}, {
  3.409362483405528*^9, 
  3.4093624844665956`*^9}},ExpressionUUID->"697f1200-5fee-42fa-a65d-\
f95674684066"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "33"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dHdH", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"-", 
        RowBox[{"vecLen", "[", "G", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B", ".", "B"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"B", ".", "B"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OuterVector", "[", 
         RowBox[{"B", ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "B"}], "]"}]}], "]"}], "+", 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "B"}], "]"}], ",", "B"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "3", ",", "3", ",", "dPhi2dHdH"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408649892341941*^9, 3.408649947886446*^9}, {
  3.408650378644896*^9, 3.40865040833183*^9}, {3.409174866931617*^9, 
  3.409174867233015*^9}},ExpressionUUID->"e4d1d576-8adc-4ffa-b70b-\
89ed9d802766"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Equation", " ", "38"}], ",", " ", 
    RowBox[{
    "this", " ", "one", " ", "has", " ", "the", " ", "weird", " ", 
     "subscripts", " ", "but", " ", 
     RowBox[{"I", "'"}], "m", " ", "just", " ", "going", " ", "to", " ", 
     "assume", " ", "its", " ", "simple"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dFdG", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{"vecLen", "[", "G", "]"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"G", ".", "G"}], ")"}], 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"A", ",", "F"}], "]"}], 
           RowBox[{"(*", "F", "*)"}], ",", "A"}], 
          RowBox[{"(*", "G", "*)"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"F", ".", "G"}], ")"}], 
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", 
           RowBox[{"(*", "F", "*)"}], ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"A", ",", "G"}], "]"}]}], 
          RowBox[{"(*", "G", "*)"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "2", ",", "dPhi2dFdG"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408650421678527*^9, 3.408650598200132*^9}, {
  3.409174836771996*^9, 
  3.409174837132331*^9}},ExpressionUUID->"2419fd9f-db58-42d0-85ba-\
9a7247fff49a"],

Cell["\<\
Equation (39), this one needs to be transposed wrt the equation described in \
the paper.\
\>", "Subsubsection",
 CellChangeTimes->{{3.409498511759589*^9, 
  3.40949854269335*^9}},ExpressionUUID->"7ef8a81a-c07c-4f1d-9829-\
b42d5a4420a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhi2dGdH", " ", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"(", 
        RowBox[{"B", ".", "B"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"B", ".", "B"}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", ".", "G"}], ")"}], 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"B", ",", "H"}], "]"}], 
          RowBox[{"(*", "H", "*)"}], ",", "B"}], 
         RowBox[{"(*", "G", "*)"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"H", ".", "G"}], ")"}], 
        RowBox[{"OuterVector", "[", 
         RowBox[{"B", 
          RowBox[{"(*", "H", "*)"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"B", ",", "G"}], "]"}]}], 
         RowBox[{"(*", "G", "*)"}], "]"}]}]}], ")"}]}], "]"}]}], ";", 
  RowBox[{"OverlaySymmetricMatrix", "[", 
   RowBox[{"dPhi2dFGHdFGH", ",", "2", ",", "3", ",", "dPhi2dGdH"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.40865064540567*^9, 3.408650762067699*^9}, 
   3.4091748525583963`*^9, 3.4093531703199453`*^9, 3.409353656265156*^9, 
   3.409355906322811*^9, {3.409356672901971*^9, 3.409356682609378*^9}, 
   3.409357158267292*^9, {3.409357736245742*^9, 3.409357739845209*^9}, {
   3.4094984946855507`*^9, 
   3.409498508997938*^9}},ExpressionUUID->"0a1d5a51-b369-4814-aaab-\
f6ff43fb0093"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "40"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dPhi2dFdH", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.408650327222185*^9, 3.408650362439267*^9}, {
  3.409174826448645*^9, 3.409174826884821*^9}, {3.4093412251438437`*^9, 
  3.409341230236353*^9}},ExpressionUUID->"fc58003b-c069-4e3f-93e0-\
26ad1d1726ea"],

Cell[BoxData[
 RowBox[{"OverlaySymmetricMatrix", "[", 
  RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "3", ",", "dPhi2dFdH"}], 
  "]"}]], "Input",ExpressionUUID->"a9bcd4dd-adbd-41c2-a342-2dabdf4bd00b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "44"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dPhi2dGdG", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"vecLen", "[", "G", "]"}], "3"], ")"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "A"}], "]"}], ",", "A"}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "A"}], "]"}]}], "]"}]}], ")"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"F", ".", "G"}], ")"}], 
        RowBox[{
         RowBox[{"vecLen", "[", "G", "]"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"F", ",", "A"}], "]"}]}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"F", ",", "A"}], "]"}], ",", "A"}], "]"}]}], ")"}]}], 
      ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"2", 
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"vecLen", "[", "G", "]"}], "3"], ")"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "B"}], "]"}], ",", "B"}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "B"}], "]"}]}], "]"}]}], ")"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"H", ".", "G"}], ")"}]}], 
        RowBox[{
         RowBox[{"vecLen", "[", "G", "]"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"H", ",", "B"}], "]"}]}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"H", ",", "B"}], "]"}], ",", "B"}], "]"}]}], ")"}]}], 
      ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4086499523593807`*^9, 3.408650321250239*^9}, {
  3.408650365353183*^9, 3.408650375568879*^9}, {3.4091748106831207`*^9, 
  3.4091748168818808`*^9}, {3.409175136588516*^9, 3.4091752082194633`*^9}, {
  3.409175244309362*^9, 3.409175247198543*^9}, {3.409175357119368*^9, 
  3.40917538223105*^9}, {3.40917613547653*^9, 3.4091761385193377`*^9}, {
  3.409177065118088*^9, 3.4091770663792353`*^9}, {3.409177454434731*^9, 
  3.409177458268008*^9}, {3.409341216600507*^9, 
  3.40934122099883*^9}},ExpressionUUID->"311ac420-578d-4b74-91b8-\
b211053c896e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OverlaySymmetricMatrix", "[", 
   RowBox[{"dPhi2dFGHdFGH", ",", "2", ",", "2", ",", "dPhi2dGdG"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"a256f25f-84e0-47ed-a790-c7b12f18325e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dPhi2dFGHdFGH", "]"}]], "Input",
 CellChangeTimes->{{3.408651792060197*^9, 
  3.4086517978656282`*^9}},ExpressionUUID->"77802582-5735-4d6f-9e69-\
436c6f8e4697"],

Cell["\<\
At this point (dPhi2dFGHdFGH) should represent the first term in equation 29 \
\>", "Subsubsection",
 CellChangeTimes->{{3.408651738274075*^9, 
  3.408651769106864*^9}},ExpressionUUID->"4cd4bd7b-1050-48fc-bb39-\
da6b322c36ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dFGHdr", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"F", ",", "G", ",", "H"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl"}], "}"}], "]"}], 
       "}"}]}], "]"}]}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.408591384187497*^9, 3.4085914854368362`*^9}, {
   3.408591781261639*^9, 3.408591823963297*^9}, 3.408597322574074*^9, {
   3.4086384990450077`*^9, 3.4086385101740522`*^9}, {3.409362248899851*^9, 
   3.409362263073306*^9}, 
   3.409362549838602*^9},ExpressionUUID->"c87ee2ff-3b45-40eb-80bf-\
7517f1956a50"],

Cell["Let' s try a scalar product between dPhi2dFGHdFGH and dFGHdr", \
"Subsubsection",
 CellChangeTimes->{{3.408651818318852*^9, 
  3.408651834507773*^9}},ExpressionUUID->"84ff1a83-79bc-4815-bcc9-\
bd989d07957a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralProd1", " ", "=", " ", 
   RowBox[{"dPhi2dFGHdFGH", ".", "dFGHdr"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408651845045583*^9, 3.4086518659143333`*^9}, {
  3.409339111432386*^9, 
  3.409339112905542*^9}},ExpressionUUID->"d54bbfcc-bb19-4018-8b6b-\
f8907422029d"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dihedralProd1", "]"}]], "Input",
 CellChangeTimes->{{3.408651870376741*^9, 3.408651872801318*^9}, {
  3.409339115543014*^9, 
  3.409339117067672*^9}},ExpressionUUID->"25080c3e-fc56-45e0-b4b0-\
cca4bf869951"],

Cell["Now try a matrix outer product between (prod1) and dFGHdr.", \
"Subsubsection",
 CellChangeTimes->{{3.408651883486541*^9, 
  3.408651897034092*^9}},ExpressionUUID->"c617accd-a743-4794-b1bc-\
f304fb024346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Phidr2", " ", "=", " ", 
   RowBox[{"MatrixOuter", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "dihedralProd1", "]"}], ",", 
     RowBox[{"Transpose", "[", "dFGHdr", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408651904044354*^9, 3.408651936666416*^9}, {
  3.408652075768901*^9, 3.408652083457493*^9}, {3.409339121243396*^9, 
  3.409339123792976*^9}},ExpressionUUID->"a173a9b2-e17c-4c46-b2a7-\
8701e2a61f81"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2Phidr2", "]"}]], "Input",
 CellChangeTimes->{{3.408652112695722*^9, 3.408652116232728*^9}, {
  3.4091963372082033`*^9, 
  3.409196338965362*^9}},ExpressionUUID->"c8f1936f-f3ba-4a5a-84b2-\
85adc3176359"],

Cell["d2Phidr2 Should contain the product of equation 29", "Subsubsection",
 CellChangeTimes->{{3.4086520902119923`*^9, 
  3.4086521017608767`*^9}},ExpressionUUID->"76961292-be05-4504-abd4-\
0bbee05f532d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "dFGHdr", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.408648903929661*^9, 
  3.4086489127940187`*^9}},ExpressionUUID->"c096a14b-20ca-4bf9-9e4f-\
f2572a8defad"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dETorsiondPhi", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "EraseLinearDihedral"}], "*", "dihedralScale", "*", "V", 
     "*", "DN", "*", "sinNPhiPhase"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, {3.408653407072007*^9, 
   3.408653409365189*^9}},ExpressionUUID->"a0f5de58-4205-4238-a1e2-\
0d4db4f8bc50"],

Cell["\<\
Assemble equation 28, the final equation for the second derivative, it should \
be a 12x12 matrix\
\>", "Section",
 CellChangeTimes->{{3.408654462449683*^9, 
  3.408654491289156*^9}},ExpressionUUID->"c58c016a-b440-4836-a571-\
255ff16af27f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2EdPhi2", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "V"}], "*", "DN", "*", "DN", "*", "cosNPhiPhase"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408653336194317*^9, 3.408653358981037*^9}, {
  3.408653422437386*^9, 3.408653431132839*^9}, {3.408654249922738*^9, 
  3.4086542980744057`*^9}},ExpressionUUID->"dfcb5487-80d0-4a7f-b413-\
cd6e8cd164ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Edr2", " ", "=", " ", 
   RowBox[{
    RowBox[{"OuterVector", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2EdPhi2", "*", "dPhidr"}], ")"}], ",", "dPhidr"}], "]"}], 
    "+", 
    RowBox[{"DeDPhi", "*", "d2Phidr2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408653271521331*^9, 3.4086532779472837`*^9}, {
  3.4086534333111267`*^9, 3.408653436052641*^9}, {3.4086543078086443`*^9, 
  3.4086543833682623`*^9}},ExpressionUUID->"e1c5ecac-1834-40ab-826f-\
a79b1c2e853d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.408654332976136*^9, 
  3.408654336760715*^9}},ExpressionUUID->"e61b8955-ba8a-44ce-8444-\
1c01fe1e9009"],

Cell["Assemble the names of the second derivatives ", "Subsubsection",
 CellChangeTimes->{{3.4086545923916807`*^9, 
  3.408654601424361*^9}},ExpressionUUID->"a7b8e041-80a8-45cc-a9dd-\
69a8bf0c75b5"],

Cell["\<\
dihedralVarNames = { 
   {x1, x, I1, 0, DPhiDri},
   {y1, y, I1, 1, DPhiDri},
   {z1, z, I1, 2, DPhiDri},
   {x2, x, I2, 0, DPhiDrj},
   {y2, y, I2, 1, DPhiDrj},
   {z2, z, I2, 2, DPhiDrj},
   {x3, x, I3, 0, DPhiDrk},
   {y3, y, I3, 1, DPhiDrk},
   {z3, z, I3, 2, DPhiDrk},
   {x4, x, I4, 0, DPhiDrl},
   {y4, y, I4, 1, DPhiDrl},
   {z4, z, I4, 2, DPhiDrl}
   };\
\>", "Text",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}, {
  3.408584461197592*^9, 3.408584542081841*^9}, {3.40858684037824*^9, 
  3.408586889698691*^9}, {3.408625912333675*^9, 3.4086259293924017`*^9}, {
  3.408653564774177*^9, 
  3.408653597724698*^9}},ExpressionUUID->"ace1dd46-998a-4f42-96ae-\
3cb13cd1784d"],

Cell["Setup the Diagonal Hessian rules", "Subsubsection",
 CellChangeTimes->{{3.408655141263528*^9, 
  3.4086551474565687`*^9}},ExpressionUUID->"79385e94-e374-4bf9-983d-\
6de23ed3a597"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralOneHessianElement", "[", 
    RowBox[{
    "macroPrefix_", ",", " ", "be_", ",", " ", "outputs_", ",", 
     "hessianStructure_", ",", " ", "rawHessianFn_", ",", " ", "names_", ",", 
     " ", "i_", ",", " ", "j_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "   \t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "name1Info", ",", " ", "name2Info", ",", " ", "var1Name", ",", " ", 
       "var2Name", ",", "hessianName", ",", "prefix", ",", " ", "hess"}], 
      "}"}], ",", "\n", "   \t", 
     RowBox[{
      RowBox[{"name1Info", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", 
        RowBox[{"names", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"name2Info", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", 
        RowBox[{"names", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"var1Name", " ", "=", " ", 
       RowBox[{"Name", " ", "/.", " ", "name1Info"}]}], ";", "\n", "   \t", 
      RowBox[{"var2Name", " ", "=", " ", 
       RowBox[{"Name", " ", "/.", " ", "name2Info"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j"}], ",", 
        RowBox[{"prefix", "=", "\"\<d\>\""}], ",", 
        RowBox[{"prefix", "=", "\"\<o\>\""}]}], "]"}], ";", "\n", "   \t", 
      RowBox[{"hessianName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"prefix", "<>", "\"\<h\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "var1Name", "]"}], " ", "<>", " ", 
         RowBox[{"ToString", "[", "var2Name", "]"}]}], "]"}]}], ";", "\n", 
      "   \t", 
      RowBox[{"hess", " ", "=", " ", 
       RowBox[{
        RowBox[{"Evaluate", "[", "rawHessianFn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", " ", 
        RowBox[{"Assign", "[", 
         RowBox[{"hessianName", ",", " ", "hess"}], "]"}]}], "]"}], ";", "\n",
       "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"outputs", ",", " ", "hessianName"}], "]"}], ";", "\n", 
      "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", " ", 
        RowBox[{"HessianAccumulate", "[", 
         RowBox[{
         "macroPrefix", ",", " ", "name1Info", ",", " ", "name2Info", ",", 
          " ", "hessianName"}], "]"}]}], "]"}], ";", "\n", "   \t", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Appended hessian element (\>\"", ",", " ", "j", ",", " ", 
        "\"\<,\>\"", ",", " ", "i", ",", " ", "\"\<) for variable: \>\"", ",",
         " ", 
        RowBox[{"ToString", "[", "hessianName", "]"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{
       RowBox[{"hessianStructure", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"Length", "[", "outputs", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"i", "\[NotEqual]", "j"}], ",", 
        RowBox[{
         RowBox[{"hessianStructure", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{"Length", "[", "outputs", "]"}]}]}], "]"}], ";"}]}], "\n", 
    "   ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralOneHessianElement", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408555575499645*^9, 3.40855562644662*^9}, {
   3.408555698427017*^9, 3.408555752841689*^9}, {3.408555797330433*^9, 
   3.408555805608109*^9}, {3.408556278739255*^9, 3.408556301269991*^9}, {
   3.408558697525703*^9, 3.40855870069838*^9}, {3.4085587655149603`*^9, 
   3.4085587898354597`*^9}, {3.4085609041654263`*^9, 3.408560904844736*^9}, {
   3.4085871740652237`*^9, 3.4085871810977*^9}, {3.408628090342455*^9, 
   3.408628092947421*^9}, {3.4086556756133423`*^9, 3.408655676658729*^9}, {
   3.408655768942697*^9, 3.4086557728143272`*^9}, {3.408655861830427*^9, 
   3.408655884543045*^9}, {3.408655930214017*^9, 3.4086559314530478`*^9}, {
   3.408655992493332*^9, 3.408655993195394*^9}, {3.408656367228681*^9, 
   3.408656385090145*^9}, {3.408656466170966*^9, 3.408656471028996*^9}, {
   3.408659060173934*^9, 3.408659060978992*^9}, {3.408850691207035*^9, 
   3.4088507133591547`*^9}, 3.4088510120827217`*^9, {3.409333477579693*^9, 
   3.409333520693698*^9}, {3.4093344318910427`*^9, 3.409334433652416*^9}, 
   3.4093344648892193`*^9},ExpressionUUID->"2c720dce-a8ae-47ab-8c31-\
8d7b2d33de18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralDiagonalHessian", "[", 
    RowBox[{
    "macroPrefix_", ",", "be_", ",", "outputs_", ",", "hessianStructure_", 
     ",", "rawHessianFn_", ",", "names_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "d2Edr2", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"AppendDihedralOneHessianElement", "[", 
          RowBox[{
           RowBox[{"macroPrefix", "<>", "\"\<_DIAGONAL\>\""}], ",", "be", ",",
            "outputs", ",", "hessianStructure", ",", "rawHessianFn", ",", 
           "names", ",", "i", ",", "i"}], "]"}], ";"}]}], "\n", "\t", "]"}], 
      ";"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralDiagonalHessian", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.409077919351634*^9, 3.409078031226864*^9}, {
  3.40907835011043*^9, 3.4090783521091347`*^9}, {3.4090783931519957`*^9, 
  3.4090784236570272`*^9}, {3.409333525349918*^9, 3.409333536474777*^9}, {
  3.4112619162551126`*^9, 
  3.4112619215407352`*^9}},ExpressionUUID->"8d7b5ad7-c356-4422-8d36-\
2926e3135c02"],

Cell[BoxData[
 RowBox[{"Length", "[", "d2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.408656419732316*^9, 
  3.408656437275282*^9}},ExpressionUUID->"67bd358d-da44-40c7-a97a-\
0ae034977f1e"],

Cell["\<\
For[i = 1, i <= Length[d2Edr2], i++,
  AppendDihedralOneHessianElement[\"DIHEDRAL\", dihedralDiagonalHessianRules, \
dihedralOutputs, d2Edr2, dihedralVarNames, i, i];
  ];\
\>", "Text",
 CellChangeTimes->{{3.408655574169129*^9, 3.408655604152143*^9}, {
   3.4086556809622593`*^9, 3.408655728602399*^9}, {3.408655784550395*^9, 
   3.40865581948155*^9}, {3.4086560642840567`*^9, 3.408656068011984*^9}, 
   3.40865618508574*^9, 
   3.408656434005369*^9},ExpressionUUID->"30f7b878-2fa4-4b9b-8d42-\
b82983000d9c"],

Cell[BoxData[
 RowBox[{"dihedralHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "12", "}"}]}], "]"}], ",", 
    RowBox[{"{", "12", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409333587617721*^9, 
  3.409333598425961*^9}},ExpressionUUID->"4ecbe97e-c997-414e-8512-\
f83cc0cbdbca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralDiagonalHessian", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralDiagonalHessianRules", ",", 
    "dihedralOutputs", ",", "dihedralHessian", ",", "d2Edr2", ",", 
    "dihedralVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4090782650415897`*^9, 3.40907828859654*^9}, 
   3.409079462211437*^9, {3.409333577446553*^9, 
   3.409333579646331*^9}},ExpressionUUID->"bfda6e6a-3078-4804-977a-\
134934e70666"],

Cell["Setup the Off Diagonal Hessian rules", "Subsubsection",
 CellChangeTimes->{{3.408655161905715*^9, 
  3.408655167760612*^9}},ExpressionUUID->"27a8054e-cdbe-4ff5-98a1-\
d930da91445a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
    RowBox[{
    "macroPrefix_", ",", "be_", ",", "outputs_", ",", "hessianStructure_", 
     ",", "rawHessianFn_", ",", "names_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{
          RowBox[{"Length", "[", "d2Edr2", "]"}], "-", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "d2Edr2", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"AppendDihedralOneHessianElement", "[", 
             RowBox[{
              RowBox[{"macroPrefix", "<>", "\"\<_OFF_DIAGONAL\>\""}], ",", 
              "be", ",", "outputs", ",", "hessianStructure", ",", 
              "rawHessianFn", ",", "names", ",", "i", ",", "j"}], "]"}], 
            ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], ";"}]}],
     "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralOffDiagonalHessian", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.409077919351634*^9, 3.409078031226864*^9}, {
   3.40907835011043*^9, 3.4090783521091347`*^9}, {3.4090783931519957`*^9, 
   3.409078469080504*^9}, {3.409078504804676*^9, 3.409078513741704*^9}, {
   3.409079101000098*^9, 3.409079110511812*^9}, 3.409079159511916*^9, {
   3.409333542224677*^9, 3.40933355317448*^9}, {3.411261926206048*^9, 
   3.411261930485607*^9}},ExpressionUUID->"07797665-0d89-4c61-9c8c-\
d75c71ae3df6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.408655226662992*^9, 3.4086552378642597`*^9}, 
   3.409079466777631*^9},ExpressionUUID->"f346a6f9-76ba-45b3-a7c7-\
b0dc460203a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralOffDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralOffDiagonalHessianRules", ",", 
    "dihedralOutputs", ",", "dihedralHessian", ",", "d2Edr2", ",", 
    "dihedralVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.409079093793353*^9, 3.409079142461454*^9}, 
   3.409079468724416*^9, {3.409333563372666*^9, 
   3.40933356548463*^9}},ExpressionUUID->"68f064d4-1e6e-4980-94a2-\
5720704abaa8"],

Cell["\<\
For[i = 1, i <= Length[d2Edr2] - 1, i++,
  For[j = i + 1, j <= Length[d2Edr2], j++,
    AppendDihedralOneHessianElement[\"DIHEDRAL\", \
dihedralOffDiagonalHessianRules, dihedralOutputs, d2Edr2, dihedralVarNames, \
i, j];
    ];
  ];\
\>", "Text",
 CellChangeTimes->{{3.408850582947207*^9, 3.408850616970339*^9}, {
  3.4088508906927147`*^9, 
  3.408850891296979*^9}},ExpressionUUID->"2e2bc07e-e2ad-49f6-a4b6-\
9e9eb76ff002"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dihedralAllRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralSetupRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralEnergyRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_FORCE //[\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcForce ) {\>\"", " ", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralGradientRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcDiagonalHessian) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_OFF_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcOffDiagonalHessian) { \>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralOffDiagonalHessianRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcOffDiagonalHessian*/\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif // DIHEDRAL_CALC_OFF_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcDiagonalHessian*/\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif // DIHEDRAL_CALC_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcForce*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<#endif // DIHEDRAL_CALC_FORCE ]\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4086549503985653`*^9, 3.4086551302470093`*^9}, {
   3.41017847632253*^9, 3.41017848542352*^9}, {3.4109617838377123`*^9, 
   3.410961860520269*^9}, 
   3.411198044265443*^9},ExpressionUUID->"cfca20f3-afbb-4b20-bd91-\
2a15bbbb4491"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralOutputs", ",", "DihedralDeviation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.411198046297284*^9, 
  3.411198058910133*^9}},ExpressionUUID->"e1d9f5be-fe48-49f3-9f92-\
76f8c880d9fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralFlattenedRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "dihedralAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4086552646330976`*^9, 
  3.40865527457828*^9}},ExpressionUUID->"b22fda30-cd35-4302-afa2-\
c83af9e27620"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralOutputs", ",", "Phi"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.409361157868669*^9, 3.40936116476217*^9}, {
  3.409361694727602*^9, 
  3.409361722609562*^9}},ExpressionUUID->"ae140613-cb79-4cbd-878c-\
04eb13252ece"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Dihedral\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "\"\<NotUsed\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "dihedralHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "dihedralFlattenedRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "dihedralInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "dihedralOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028819578140697`*^9, 3.4028819673432083`*^9}, 
   3.402914765609372*^9, 3.402914809575083*^9, 3.402966487087537*^9, {
   3.405598673911619*^9, 3.4055986829522657`*^9}, {3.405636326678927*^9, 
   3.4056363391829853`*^9}, {3.4056363705989532`*^9, 3.40563641434286*^9}, {
   3.405637128541765*^9, 3.405637129513829*^9}, {3.405637696845604*^9, 
   3.405637711676909*^9}, {3.4076800511983557`*^9, 3.407680055922863*^9}, 
   3.4077635803880997`*^9, {3.4086552573076477`*^9, 3.4086552800537786`*^9}, {
   3.409333629383656*^9, 3.409333638096027*^9}, 3.409338350030931*^9, {
   3.4110665533637333`*^9, 3.411066563651474*^9}, {3.4110670008789177`*^9, 
   3.411067001966928*^9}, 3.411074014162706*^9, {3.4110757545928717`*^9, 
   3.41107575829285*^9}, {3.411076165330535*^9, 3.411076201362154*^9}, 
   3.411079386355109*^9, {3.411201512045719*^9, 
   3.411201514689584*^9}},ExpressionUUID->"e9e88c15-0168-4b53-8b95-\
08cf9433142e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlusOptimize", " ", "=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimesOptimize", " ", "=", " ", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408659099769362*^9, 
  3.408659106874506*^9}},ExpressionUUID->"3405d47b-5a59-45ba-9417-\
50a514d54119"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "dihedralPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790475095104*^9, 3.408790482262748*^9}, {3.408844157019621*^9, 
   3.4088441576915627`*^9}, 3.409338346791582*^9, 
   3.4110670800538588`*^9},ExpressionUUID->"5b66b768-1150-4143-8054-\
c0104b392102"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralPack", "=", 
   RowBox[{"packOptimize", "[", "dihedralPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4029667486164722`*^9, 3.40296675299512*^9}, {
   3.405593795731063*^9, 3.405593801151153*^9}, {3.405598686856411*^9, 
   3.405598689575983*^9}, {3.407559220509287*^9, 3.40755922087429*^9}, {
   3.409338347441646*^9, 3.409338348066732*^9}, 
   3.411066680434393*^9},ExpressionUUID->"0c4d1f08-177a-4f78-9b86-\
929c095bcc20"],

Cell[BoxData[
 RowBox[{"packGraph", "[", "dihedralPack", "]"}]], "Input",
 CellChangeTimes->{{3.4029672273918953`*^9, 3.402967239081615*^9}, 
   3.409338349079673*^9},ExpressionUUID->"0ff1f008-d4fc-4f35-a176-\
b34fec49f697"]
}, Closed]],

Cell[CellGroupData[{

Cell["An improved improper restraint with no discontinuities", "Subtitle",
 CellChangeTimes->{
  3.402881806378004*^9, {3.4029555772158318`*^9, 3.4029555790467377`*^9}, {
   3.408232598628756*^9, 3.408232608931699*^9}, {3.408394177272849*^9, 
   3.408394195246855*^9}, {3.408394233695057*^9, 
   3.408394251155362*^9}},ExpressionUUID->"6294fc58-93c7-413b-bfd3-\
f8035c6e9d8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(K);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(U);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(L);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.410178119207843*^9, 3.410178147107234*^9}, {
  3.410178361408951*^9, 3.4101784213739767`*^9}, {3.410178549883905*^9, 
  3.410178572636623*^9}, {3.410178617530715*^9, 
  3.4101786338189297`*^9}},ExpressionUUID->"f86a40de-3ba0-4293-8b41-\
ed5344aef4c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "dihedralVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<IMPROPER_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"improperRestraintSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4101781215075903`*^9, 
  3.4101781485693007`*^9}, {3.4101785528826838`*^9, 3.410178573744811*^9}, {
  3.4101792846240253`*^9, 
  3.41017928624059*^9}},ExpressionUUID->"835b3b05-90de-48c6-9009-\
ce83d26b2cd4"],

Cell[BoxData[
 RowBox[{"improperRestraintSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 3.4101781294677153`*^9, 
   3.410178556859849*^9},ExpressionUUID->"de8f2c6f-2735-409a-9f5d-\
4d826e94cfd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"Phi", ",", "CosNPhi", ",", "SinNPhi"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4096020423340673`*^9, 
  3.409602048564129*^9}},ExpressionUUID->"095fcc8e-d676-42e2-9add-\
ee433dc19a10"],

Cell["Here is what it looks like", "Subsection",
 CellChangeTimes->{{3.408394253503767*^9, 
  3.408394256644514*^9}},ExpressionUUID->"36c4f395-0f02-4352-9d3d-\
4dec7b6332f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rad", "[", "h_", "]"}], " ", ":=", " ", 
  RowBox[{"h", "*", "0.0174533"}]}]], "Input",
 CellChangeTimes->{{3.408379663202251*^9, 
  3.4083796716685553`*^9}},ExpressionUUID->"9a9ae81a-f2b8-4496-acec-\
180c9d217d3b"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Cos", "[", 
     RowBox[{"phi", "//", "rad"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", "0", ",", "180"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408378919735092*^9, 3.408378935271121*^9}, {
  3.408380328431974*^9, 
  3.408380332205256*^9}},ExpressionUUID->"116db58d-4626-4f3e-9560-\
6802e8f20566"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawRestraintFn", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"phi", "-", "L"}], 
          RowBox[{"U", "-", "L"}]], "360"}], ")"}], "//", "rad"}], "]"}]}], 
    ")"}], "3"]}]], "Input",
 CellChangeTimes->{{3.408381041037016*^9, 3.408381047574959*^9}, {
   3.408381126025282*^9, 3.408381140009428*^9}, 3.4083811802826347`*^9, {
   3.408382087079472*^9, 3.408382093477792*^9}, {3.4107425907005043`*^9, 
   3.410742601107795*^9}},ExpressionUUID->"9a9ce9d8-0b9b-4f31-b895-\
4b75a5802870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"otherRestraintFn", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"phi", ">=", "L"}], ",", "phi", ",", 
             RowBox[{"phi", "+", "360"}]}], "]"}], "-", "L"}], 
          RowBox[{"U", "+", "360", "-", "L"}]], "360"}], ")"}], "//", "rad"}],
       "]"}]}], ")"}], "3"]}]], "Input",
 CellChangeTimes->{{3.4083839535091343`*^9, 3.408384002209145*^9}, 
   3.408384868148151*^9, {3.408385072766967*^9, 3.40838509727969*^9}, {
   3.41074260364859*^9, 
   3.410742611409767*^9}},ExpressionUUID->"00883389-7ed5-41bf-924c-\
be0b364281ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGreaterThanU", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"phi", "<", "L"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"phi", ">", "U"}], ")"}]}], ",", "\[IndentingNewLine]", "0.0",
       ",", "\[IndentingNewLine]", 
      RowBox[{"otherRestraintFn", "[", 
       RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzVHykOlHykvHGaLdbCB6w4sOfhB97voWMP3ujZQz
iH5QqQem5W86J4HoGzyxYFpQ+vkEEM33RH8KiDZi7l8CoqXlnVaA6JK2W2tB
NL/r+3Ugum1C5BEQffUu/zEQPefC2asgOieC5S6IlmCu+QGieUL9foJoocC1
+j+B9HPps2B6W1GhDZi+PtEWRKuF/3MB0bIK19xBdJdPdjmIvhGhVQGiL8X1
tIBoiznxE0D0kdfMi0D0jJs7wXRAx55dIPpDa89uEH3m1aYjIDrs8jYw/Ucl
9TaIbmmaC6bzrb48AtGl3449BtHnDK9+AtFVjtqfQXSZ0//fINr+xLJ/IPqT
6hHV30Ca9/0JML3rzA4TEP3l2BkwDQAtjuAH
  "],ExpressionUUID->"6676b413-f633-44a6-ae0b-3dba93ea9113"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LLessThanU", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"phi", "<", "L"}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{"phi", ">", "U"}], ")"}]}], ",", "0.0", ",", 
    RowBox[{"rawRestraintFn", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4083794838010674`*^9, 3.408379510179747*^9}, {
   3.40837954800559*^9, 3.4083795537915277`*^9}, {3.408379591053768*^9, 
   3.408379609151863*^9}, {3.408380072427807*^9, 3.408380084038293*^9}, {
   3.408380801830942*^9, 3.4083808020178556`*^9}, {3.408380892929167*^9, 
   3.408380903510066*^9}, {3.40838093570116*^9, 3.408380952776126*^9}, 
   3.408381110884235*^9, {3.408381147964313*^9, 3.408381160493845*^9}, {
   3.408382074281019*^9, 3.408382075515924*^9}, {3.408382148928997*^9, 
   3.4083821543894453`*^9}, {3.408386474756736*^9, 
   3.4083864752867823`*^9}},ExpressionUUID->"6fc2c491-dcac-4859-8c59-\
7015d47007fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"restraint", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"L", "<", "U"}], ",", 
    RowBox[{"LLessThanU", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}], ",", 
    RowBox[{"LGreaterThanU", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.408379613903246*^9, 3.408379652122449*^9}, {
   3.4083799622060347`*^9, 3.40837996705472*^9}, {3.408380347444665*^9, 
   3.408380349218028*^9}, {3.4083821789176483`*^9, 3.408382184335189*^9}, {
   3.4083822984696627`*^9, 3.408382304371964*^9}, {3.408382558553754*^9, 
   3.40838256003996*^9}, 3.408382835315847*^9, {3.4083864547284946`*^9, 
   3.408386460962118*^9}, {3.408386608420443*^9, 
   3.408386610693832*^9}},ExpressionUUID->"27aea4b1-e160-427b-827c-\
afc057e87392"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "130"}], ",", "130"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408386509199087*^9, 3.408386533235841*^9}, {
  3.4083866445198183`*^9, 3.408386645343155*^9}, {3.4083942073600607`*^9, 
  3.4083942100202312`*^9}, {3.4090761945848093`*^9, 
  3.4090761959218693`*^9}},ExpressionUUID->"b306c8be-0667-41d7-ae6e-\
38be3c2a1d50"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", "140", ",", "100"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40838654200467*^9, 3.408386559808093*^9}, 
   3.4083866014963923`*^9, {3.4083877949092627`*^9, 3.408387811796521*^9}, {
   3.408394216546843*^9, 3.408394221870363*^9}, 
   3.409076226910532*^9},ExpressionUUID->"7a260924-3134-42b2-8ac6-\
7a700cd51442"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", "140", ",", "140"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40838654200467*^9, 3.408386559808093*^9}, 
   3.4083866014963923`*^9, {3.4083877949092627`*^9, 3.408387811796521*^9}, {
   3.408394216546843*^9, 3.408394221870363*^9}, {3.408396473391996*^9, 
   3.4083964740904493`*^9}},ExpressionUUID->"517c0ba0-5bd6-47e0-9d06-\
c0742b3470d6"],

Cell[CellGroupData[{

Cell["\<\
Setup the improper torsion term
We reuse the code for the dihedral term,
specifically we start with:   dihedralCosPhiRules\
\>", "Subsubtitle",
 CellChangeTimes->{{3.402833465987742*^9, 3.402833468829653*^9}, 
   3.4028818063788223`*^9, {3.409076116812584*^9, 3.409076128097849*^9}, {
   3.409076239747479*^9, 3.4090762836308613`*^9}, {3.409076510926963*^9, 
   3.40907651161096*^9}},ExpressionUUID->"0492afaf-a27f-46bb-9a09-\
ebdaede94796"],

Cell[BoxData[
 RowBox[{"Clear", "[", "Phi", "]"}]], "Input",
 CellChangeTimes->{{3.409106688874969*^9, 
  3.409106695755435*^9}},ExpressionUUID->"88289d8c-6ce2-487c-b772-\
c03b2405f5f2"],

Cell["\<\
Sum and difference formulas
sin (A + B) = sin A cos B + cos A sin B
sin (A - B) = sin A cos B - cos A sin B
cos (A + B) = cos A cos B - sin A sin B
cos (A - B) = cos A cos B + sin A sin B\
\>", "Text",
 CellChangeTimes->{{3.4029651450204144`*^9, 
  3.402965152857622*^9}},ExpressionUUID->"6f34dfaa-a4e5-45d0-9d62-\
e25af533992c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.409076917093985*^9, 
  3.409076958634542*^9}},ExpressionUUID->"d3c28cf4-827b-453c-aa78-\
a90880d6ce7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "improperRestraintTestRules", " ", "=", " ", "dihedralCosPhiRules"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409076738470045*^9, 3.409076750070456*^9}, 
   3.409077327963084*^9, 
   3.409077378904018*^9},ExpressionUUID->"a946248e-5f50-4f44-91d8-\
a729969d255b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<If[CosPhi>0.1,Phi=ArcSin[SinPhi],\n\t\t\t\t\t\
Phi=ArcCos[CosPhi]*Sign[SinPhi]];\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if(CosPhi>0.1){Phi=asin(SinPhi);}else\n\t\t\t\t\t\
{Phi=acos(CosPhi)*SIGN(SinPhi);}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.407764211219077*^9, 3.407764213360669*^9}, {
  3.409076769869112*^9, 3.409076770848304*^9}, {3.4090773287521353`*^9, 
  3.4090773292641153`*^9}, {3.4090773794499187`*^9, 
  3.409077380038114*^9}},ExpressionUUID->"cc00a176-43c6-412b-a3bb-\
3344c68cd8ff"],

Cell["At this point we have calculated Phi", "Subsubsection",
 CellChangeTimes->{{3.40839595538558*^9, 
  3.408395962392981*^9}},ExpressionUUID->"8081db88-88db-4117-840f-\
f1cb021a78d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"MathCode", "[", "\"\<RestraintActive = False;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"CCode", "[", "\"\<RestraintActive=false;\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40823294634426*^9, 3.408232981251742*^9}, {
  3.4083961835243187`*^9, 3.4083961869992*^9}, {3.408396277468707*^9, 
  3.4083962840727587`*^9}, {3.409076771717814*^9, 3.409076772167429*^9}, {
  3.409077330163266*^9, 3.40907733067619*^9}, {3.409077380424087*^9, 
  3.409077380823999*^9}},ExpressionUUID->"d58eeefc-24f9-4db4-8bc2-\
0e4555a37971"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"MathCode", "[", "\"\<UShift = 0.0; PhiShift=0.0;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"CCode", "[", "\"\<UShift = 0.0; PhiShift = 0.0;\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.40823294634426*^9, 3.408232981251742*^9}, {
  3.4083961835243187`*^9, 3.4083961869992*^9}, {3.408396277468707*^9, 
  3.4083963406328707`*^9}, {3.408398739549844*^9, 3.408398753555151*^9}, {
  3.409076772817781*^9, 3.4090767733045273`*^9}, {3.409077331126154*^9, 
  3.4090773315631657`*^9}, {3.409077381187399*^9, 
  3.409077381574326*^9}},ExpressionUUID->"8f9716d6-4ad4-4289-a6bf-\
471898ff94eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<\nIf[ L<U && ((L<=Phi)&&(Phi<=U)), \n\tRestraintActive = True;\n\t\
UShift = 0.0;\n\tPhiShift = 0.0;\n];\n\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", "       ", 
     "\"\<\nif( L<U && (L<Phi)&&(Phi<U) ) {\n\tRestraintActive = true;\n\t\
UShift = 0.0;\n\tPhiShift = 0.0;\n}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408395995514694*^9, 3.4083961575020313`*^9}, {
  3.40839623150076*^9, 3.408396268523843*^9}, {3.408396347318568*^9, 
  3.4083963604662027`*^9}, {3.408396401694859*^9, 3.408396426030796*^9}, {
  3.408398802148634*^9, 3.408398897067815*^9}, {3.408411948774922*^9, 
  3.408411956603603*^9}, {3.409076773968699*^9, 3.409076774680676*^9}, {
  3.409077332094965*^9, 3.409077332682001*^9}, {3.409077381988881*^9, 
  3.409077382400844*^9}},ExpressionUUID->"1fc63750-b30f-491c-b764-\
c3a834d9ebe7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<\nIf[ U<=L && ((Phi<=U)||(Phi>=L)),\n\tRestraintActive = True;\n\t\
UShift = TWOPI;\n\tIf[Phi>=L,\n\t\tPhiShift = 0.0;\n\t,\n\t\tPhiShift = \
TWOPI;\n\t];\n];\>\"", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<\nif ( U<=L && ((Phi<=U)||(Phi>=L))) {\n\tRestraintActive = true;\n\
\tUShift = TWOPI;\n\tif ( Phi>=L ) {\n\t\tPhiShift = 0.0;\n\t} else {\n\t\t\
PhiShift = TWOPI;\n\t}\n}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408398901969885*^9, 3.408399061964635*^9}, {
   3.408411976419505*^9, 3.408412039768778*^9}, {3.408412877808464*^9, 
   3.408412923023285*^9}, 3.40841341881848*^9, {3.409076775331386*^9, 
   3.4090767767311993`*^9}, {3.4090773331812973`*^9, 3.409077334246182*^9}, {
   3.409077382950878*^9, 3.409077383443275*^9}, 
   3.409593334566361*^9},ExpressionUUID->"b4a4b86f-dd27-4989-9eb9-\
73c6f4edaf8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MacroCall", "[", 
    RowBox[{"name_", ",", "value_"}], "]"}], " ", ":=", " ", 
   RowBox[{"CCode", "[", 
    RowBox[{"name", "<>", "\"\<(\>\"", "<>", 
     RowBox[{"ToString", "[", "value", "]"}], "<>", "\"\<);\>\""}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.409106221354478*^9, 
  3.4091062561196136`*^9}},ExpressionUUID->"2558cbdc-f926-492f-8450-\
cdf5703327e6"],

Cell["At this point we have the improperRestraintTestRules defined", \
"Subsection",
 CellChangeTimes->{{3.40907742331349*^9, 
  3.409077435721652*^9}},ExpressionUUID->"2db8ce0c-0fa9-470e-946d-\
b2c5a16aeef0"],

Cell["\<\
AppendTo[improperRestraintEnergyRules, MathCode[\"If[RestraintActive,\"]];
AppendTo[improperRestraintEnergyRules, CCode[\"if(RestraintActive){\"]];\
\>", "Text",
 CellChangeTimes->{{3.408233711153728*^9, 3.408233743197878*^9}, {
  3.408233776071458*^9, 3.408233858000513*^9}, {3.409076777879827*^9, 
  3.409076778342876*^9}, {3.409077337130555*^9, 3.409077337892419*^9}},
 FontColor->RGBColor[
  0.5, 0, 0.5],ExpressionUUID->"abd73772-a9c2-41b8-a7fe-c4ad8aba99b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.409077446945375*^9, 
  3.409077454126092*^9}},ExpressionUUID->"06b305c9-f063-4556-89bb-\
e2c1fa78e4fb"],

Cell[BoxData[
 RowBox[{"psi", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"Phi", "+", "PhiShift", "-", "L"}], 
    RowBox[{"U", "+", "UShift", "-", "L"}]], "TWOPI"}]}]], "Input",
 CellChangeTimes->{{3.408409533213232*^9, 
  3.408409539859514*^9}},ExpressionUUID->"b89ec56d-ef0d-4e23-9a04-\
f081ace5174a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Psi", ",", "psi"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408409505388205*^9, 3.408409552736274*^9}, 
   3.409076779354323*^9, 
   3.409077472770487*^9},ExpressionUUID->"24b01632-4f8e-4c84-84e2-\
1cd93c5d242e"],

Cell[BoxData[
 RowBox[{"fnEImproperRestraint", " ", "=", " ", 
  RowBox[{"EraseLinearDihedral", "*", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", "Psi", "]"}]}], ")"}], "3"]}]}]], "Input",
 CellChangeTimes->{{3.408403941701662*^9, 3.408403968202332*^9}, {
   3.408404024019986*^9, 3.408404059591957*^9}, {3.408404153548417*^9, 
   3.408404157132403*^9}, {3.408409602930616*^9, 3.408409625608087*^9}, {
   3.4084096662281218`*^9, 3.408409670138094*^9}, {3.410742630745689*^9, 
   3.410742646028102*^9}, 3.4168718448125772`*^9, {3.416872026444664*^9, 
   3.416872027499926*^9}},ExpressionUUID->"41edba45-7fc6-4a4a-aa9c-\
649c63bb203b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "fnEImproperRestraint"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.402966429264083*^9, 3.402966441189411*^9}, {
   3.403180571417967*^9, 3.403180572463499*^9}, {3.4084039245763893`*^9, 
   3.408403932654778*^9}, {3.4084040811681557`*^9, 3.4084040833033333`*^9}, 
   3.408410256995305*^9, 3.409076780512807*^9, 3.409077480920691*^9, {
   3.4091069564798737`*^9, 
   3.4091069570931683`*^9}},ExpressionUUID->"4a8151f5-cb64-4cb7-bf25-\
32e1180ac46c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<IMPROPER_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40907696160604*^9, 3.409076980846697*^9}, {
   3.409077084100278*^9, 3.4090771173035173`*^9}, 3.4090774838242273`*^9, {
   3.4091069594628*^9, 
   3.4091069637195263`*^9}},ExpressionUUID->"df2714fc-1093-484f-a66d-\
c8be0175df42"],

Cell["Here we have the improperRestraintEnergyRules defined", "Subsubsection",
 CellChangeTimes->{{3.409077499843992*^9, 
  3.409077509481435*^9}},ExpressionUUID->"b00a03b7-7880-439a-beb6-\
7dd5c00b8a05"],

Cell[BoxData[
 RowBox[{"improperRestraintInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl", ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "L", ",", "U"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598381722083*^9, 3.4055984189648457`*^9}, {
  3.405603057636241*^9, 3.4056030583078613`*^9}, {3.405690789130921*^9, 
  3.40569079264091*^9}, {3.40823469297507*^9, 3.408234698309352*^9}, {
  3.408404130713231*^9, 3.40840413323258*^9}, {3.408409948237886*^9, 
  3.408409950760854*^9}, {3.4084106111249447`*^9, 
  3.408410612236628*^9}},ExpressionUUID->"c25f6040-1a79-49f1-9e9f-\
cffcc60e7376"],

Cell[BoxData[
 RowBox[{"fnEImproperRestraintWrtPhi", " ", "=", " ", 
  RowBox[{"fnEImproperRestraint", "/.", 
   RowBox[{"{", 
    RowBox[{"Psi", "\[Rule]", "psi"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.409080225735833*^9, 3.409080251398684*^9}, {
  3.409080307798128*^9, 
  3.409080316397607*^9}},ExpressionUUID->"724303b8-d74c-4dfe-8f3e-\
dd160b80c0d5"],

Cell[BoxData[
 RowBox[{"dEImproperRestraintDPhi", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"fnEImproperRestraintWrtPhi", ",", "Phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, {3.408234735726048*^9, 3.408234735792594*^9}, {
   3.408234808451262*^9, 3.408234826131146*^9}, {3.408235017977605*^9, 
   3.408235019911381*^9}, {3.408409473916202*^9, 3.408409476824745*^9}, {
   3.408409719718871*^9, 3.408409745680011*^9}, {3.409080325810863*^9, 
   3.409080339546691*^9}},ExpressionUUID->"1fe6106e-de71-49f7-a2c1-\
eaf6d4ec420f"],

Cell[BoxData[
 RowBox[{"d2EImproperRestraintDPhi2", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"dEImproperRestraintDPhi", ",", "Phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409080408009396*^9, 
  3.409080435747931*^9}},ExpressionUUID->"2910f3f5-58f4-4e2d-972b-\
4959237de5fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintVarNames", "=", " ", "dihedralVarNames"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409081708446905*^9, 
  3.409081716742309*^9}},ExpressionUUID->"0b799d17-b79c-4581-9ab9-\
d4a12de264b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintGradientRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintGradientRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DEImproperRestraintDPhi", ",", "dEImproperRestraintDPhi"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"improperDPhiDr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendDihedralGradientForce", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", "improperRestraintGradientRules", ",", 
    "improperDPhiDr", ",", " ", "improperRestraintOutputs", ",", " ", 
    "improperRestraintVarNames", ",", " ", "DEImproperRestraintDPhi"}], " ", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4090772445834618`*^9, 3.409077280014042*^9}, {
   3.409077582181634*^9, 3.40907762655396*^9}, {3.409077680041251*^9, 
   3.409077719152259*^9}, {3.4090817215192013`*^9, 3.409081723719063*^9}, {
   3.409083677301668*^9, 3.409083685320488*^9}, {3.4090837232265053`*^9, 
   3.4090837244353943`*^9}, 
   3.409083791581297*^9},ExpressionUUID->"594b4891-4211-450b-98d7-\
71de46981d6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintD2Edr2", " ", "=", " ", 
   RowBox[{
    RowBox[{"OuterVector", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2EImproperRestraintDPhi2", "*", "dPhidr"}], ")"}], ",", 
      "dPhidr"}], "]"}], "+", 
    RowBox[{"dEImproperRestraintDPhi", "*", "d2Phidr2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4090795130053997`*^9, 3.4090795150340977`*^9}, {
   3.4090799996705008`*^9, 3.409080007832756*^9}, 3.409080480832074*^9, {
   3.4090805378299828`*^9, 3.409080545318184*^9}, {3.409081671245607*^9, 
   3.409081673669129*^9}, {3.409081788553329*^9, 3.4090817897038603`*^9}, {
   3.409082362674494*^9, 
   3.40908237238766*^9}},ExpressionUUID->"8e6abcd4-fb7e-4029-abb2-\
45c4666bea00"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "improperRestraintD2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.409082375385445*^9, 
  3.4090823788879213`*^9}},ExpressionUUID->"88ceb5f1-c2c5-40fc-b989-\
a3842fbdfb3a"],

Cell[BoxData[
 RowBox[{"improperRestraintHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "12", "}"}]}], "]"}], ",", 
    RowBox[{"{", "12", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409333657953597*^9, 
  3.409333684531035*^9}},ExpressionUUID->"3f66efb8-cc7b-4d9d-9b46-\
7dfbaa7fdbcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralDiagonalHessian", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", "improperRestraintDiagonalHessianRules",
     ",", "improperRestraintOutputs", ",", "improperRestraintHessian", ",", 
    " ", "improperRestraintD2Edr2", ",", "improperRestraintVarNames"}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.4090782650415897`*^9, 3.40907828859654*^9}, 
   3.409079462211437*^9, {3.409079895499962*^9, 3.409079918497217*^9}, {
   3.4090816795823917`*^9, 3.409081680744109*^9}, {3.4090817363302593`*^9, 
   3.409081738967415*^9}, 3.4090818037299232`*^9, {3.409333674982085*^9, 
   3.409333680318287*^9}},ExpressionUUID->"a9e7fd83-df64-4891-944a-\
1c00bdef6d8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintOffDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", 
    "improperRestraintOffDiagonalHessianRules", ",", 
    "improperRestraintOutputs", ",", "improperRestraintHessian", ",", 
    "improperRestraintD2Edr2", ",", "improperRestraintVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409079093793353*^9, 3.409079142461454*^9}, 
   3.409079468724416*^9, {3.409081684944087*^9, 3.4090816860820436`*^9}, {
   3.40908174346716*^9, 3.409081806117021*^9}, {3.409333690093843*^9, 
   3.40933369333027*^9}},ExpressionUUID->"baa34df7-eac0-4a3c-bf0a-\
841d6356b87d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InitializeOutputs", "[", "outputs_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "zeroOutputs", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"zeroOutputs", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<= 0.0;\\n\>\""}], 
          "&"}], ",", "outputs"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"StringJoin", "[", "zeroOutputs", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.409596985374069*^9, 3.4095970096100893`*^9}, {
  3.409597043808723*^9, 3.409597093651099*^9}, {3.409597183449415*^9, 
  3.409597247958007*^9}, {3.409598917761016*^9, 
  3.409598921233493*^9}},ExpressionUUID->"1dc963d6-f3c6-4a07-a2ed-\
fadac30c734f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintAllRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"improperRestraintAllRules", ",", "improperRestraintSetupRules"}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "out", " ", "setting", " ", "variables", " ", "to", " ", 
    "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"improperRestraintAllRules", ",", 
      RowBox[{"CCode", "[", 
       RowBox[{"InitializeOutputs", "[", "improperRestraintOutputs", "]"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", 
     RowBox[{"InitializeOutputs", "[", "improperRestraintOutputs", "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", "improperRestraintTestRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", "\"\<If[RestraintActive,\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (RestraintActive ) {\>\"", " ", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", "improperRestraintEnergyRules"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef IMPROPER_RESTRAINT_CALC_FORCE //[\>\"", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcForce ) {\>\"", " ", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", "improperRestraintGradientRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#ifdef IMPROPER_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcDiagonalHessian) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", 
    "improperRestraintDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#ifdef IMPROPER_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcOffDiagonalHessian) { \>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", 
    "improperRestraintOffDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcOffDiagonalHessian*/\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#endif //IMPROPER_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcDiagonalHessian*/\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#endif //IMPROPER_RESTRAINT_CALC_DIAGONAL_HESSIAN ]\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcForce*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif //IMPROPER_RESTRAINT_CALC_FORCE ]\>\"", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*RestraintActive*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MacroCall", "[", 
     RowBox[{"\"\<IMPROPER_RESTRAINT_PHI_SET\>\"", ",", "Phi"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintOutputs", ",", "Phi"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", " ", 
    RowBox[{"MathCode", "[", "\"\<]; (*RestraintActive*)\>\"", "]"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.4086549503985653`*^9, 3.4086551302470093`*^9}, {
  3.409081808957452*^9, 3.4090819840158052`*^9}, {3.409108929233745*^9, 
  3.409108935291503*^9}, {3.409515435827023*^9, 3.409515442951703*^9}, {
  3.40953443636611*^9, 3.4095344513393927`*^9}, {3.409593363342606*^9, 
  3.409593368604685*^9}, {3.409596874863688*^9, 3.409596982310606*^9}, {
  3.409598264523089*^9, 3.409598269822241*^9}, {3.409598926402801*^9, 
  3.4095990222756443`*^9}, {3.4101789103021584`*^9, 3.410178923187131*^9}, {
  3.410961601455715*^9, 3.410961738638186*^9}, {3.485015325952389*^9, 
  3.485015357288415*^9}},ExpressionUUID->"8abdfec6-cd5c-4542-ba2d-\
cb8cecc20f18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintFlattenedRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "improperRestraintAllRules", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4086552646330976`*^9, 3.40865527457828*^9}, {
  3.4090820029448643`*^9, 
  3.4090820118089657`*^9}},ExpressionUUID->"006a7203-5bc5-4d07-837c-\
6594d827b962"],

Cell[BoxData["improperRestraintOutputs"], "Input",
 CellChangeTimes->{{3.407761664825244*^9, 3.4077616727209597`*^9}, {
   3.4084101627937202`*^9, 3.408410164951118*^9}, 
   3.4090777912493277`*^9},ExpressionUUID->"9c2bb84b-96f9-4522-951e-\
1a1c518c535b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<ImproperRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "improperRestraintHessian"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "improperRestraintFlattenedRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "improperRestraintInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "improperRestraintOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028819578140697`*^9, 3.4028819673432083`*^9}, 
   3.402914765609372*^9, 3.402914809575083*^9, 3.402966487087537*^9, {
   3.405598673911619*^9, 3.4055986829522657`*^9}, {3.405636326678927*^9, 
   3.4056363391829853`*^9}, {3.4056363705989532`*^9, 3.40563641434286*^9}, {
   3.405637128541765*^9, 3.405637129513829*^9}, {3.405637696845604*^9, 
   3.405637711676909*^9}, {3.4076800511983557`*^9, 3.407680055922863*^9}, 
   3.4077635803880997`*^9, {3.408410168114626*^9, 3.4084101962575283`*^9}, 
   3.4090768093248034`*^9, {3.4090820295356092`*^9, 3.409082037972199*^9}, {
   3.409333700219658*^9, 3.409333707443859*^9}, {3.411066597262484*^9, 
   3.411066604438355*^9}, {3.411067020063253*^9, 3.411067022495068*^9}, 
   3.41107402025056*^9, {3.411075766096381*^9, 3.4110757699989357`*^9}, {
   3.41107622587714*^9, 3.4110762393701963`*^9}, 3.4110765760400867`*^9, 
   3.411079392129137*^9},ExpressionUUID->"f997ec67-1942-403e-a9f4-\
5d6e140b6d4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "writeOutputVariablesForDebugging", "[", "improperRestraintPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, {3.409085616705697*^9, 3.409085625514409*^9}, 
   3.411067087382237*^9},ExpressionUUID->"88b074e4-54dd-4e2b-bad9-\
ea91168a7288"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintPack", "=", 
   RowBox[{"packOptimize", "[", "improperRestraintPack0", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4029667486164722`*^9, 3.40296675299512*^9}, {
   3.405593795731063*^9, 3.405593801151153*^9}, {3.405598686856411*^9, 
   3.405598689575983*^9}, {3.407559220509287*^9, 3.40755922087429*^9}, {
   3.408410200560124*^9, 3.4084102194557743`*^9}, {3.408410654126341*^9, 
   3.408410655532649*^9}, 
   3.4110666488712482`*^9},ExpressionUUID->"46a79b8d-1e2e-4535-ba78-\
012f08930ac0"],

Cell[BoxData[
 RowBox[{"packGraph", "[", "improperRestraintPack", "]"}]], "Input",
 CellChangeTimes->{{3.4029672273918953`*^9, 3.402967239081615*^9}, {
  3.4084102236314163`*^9, 
  3.40841022587131*^9}},ExpressionUUID->"2a284c8e-4f9e-49f4-930c-\
443e7a9801d2"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Chiral Restraint
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.410959008646387*^9, 
   3.4109590179061737`*^9}},ExpressionUUID->"8eff8c93-b291-4cb0-9b17-\
7199246e51d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 
  3.403184184931066*^9}},ExpressionUUID->"d9b7948b-774f-4824-9b60-\
dd99d81dc301"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"va", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vc", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vd", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x4", ",", " ", "y4", ",", " ", "z4"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, {
  3.410959023856037*^9, 3.41095903888342*^9}, {3.410959358432473*^9, 
  3.410959366366046*^9}, {3.41096049070288*^9, 
  3.410960503950835*^9}},ExpressionUUID->"0f08a473-a77c-4983-a9fe-\
f066073c6889"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ac", ",", "bc", ",", "dc"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ac", " ", "=", " ", 
   RowBox[{"va", "-", "vc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"vb", " ", "-", " ", "vc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc", " ", "=", " ", 
   RowBox[{"vd", " ", "-", " ", "vc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.410959054691805*^9, 3.410959104500534*^9}, 
   3.4109591733772783`*^9, {3.410960420959537*^9, 3.410960459261435*^9}, {
   3.410960505510457*^9, 
   3.4109605135183067`*^9}},ExpressionUUID->"1b5613f7-9999-40e8-9a1b-\
8dd9afcb6daf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "K", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410959126465396*^9, 
  3.410959130081745*^9}},ExpressionUUID->"82c0e2c9-adb8-4d29-a03b-\
298588339569"],

Cell[BoxData[
 RowBox[{"chiralRestraintTestFn", " ", "=", "  ", 
  RowBox[{"K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"ac", ",", "bc"}], "]"}], ".", "dc"}], 
       RowBox[{
        RowBox[{"vecLen", "[", "ac", "]"}], 
        RowBox[{"vecLen", "[", "bc", "]"}], 
        RowBox[{"vecLen", "[", "dc", "]"}]}]], "+", "CO"}], ")"}], 
    "3"]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.4109591109262114`*^9, 
   3.410959234749806*^9}, {3.410960461630476*^9, 3.4109604710300083`*^9}, {
   3.4111342198342657`*^9, 3.411134220288424*^9}, {3.411139922041378*^9, 
   3.411139941967361*^9}, 3.411140010178594*^9, {3.411921311733358*^9, 
   3.411921327948023*^9}},ExpressionUUID->"0598a9a2-9737-43e0-86c2-\
d657b3486f10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintEnergyFn", " ", "=", " ", "chiralRestraintTestFn"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.411134222633911*^9, 
  3.411134230842989*^9}},ExpressionUUID->"bc5287ed-a6e8-45ab-901e-\
e489e9525923"],

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"va", ",", "vb", ",", "vc", ",", "vd"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.410959244997628*^9, 3.410959246043676*^9}, {
  3.410975381434297*^9, 
  3.410975391272737*^9}},ExpressionUUID->"3a6e0aa1-a05a-4b66-a123-\
ad1af56a4132"],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 
  3.401714291927002*^9}},ExpressionUUID->"2e11cee1-5a1a-4cfb-9daf-\
d12953e14247"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x4", ",", "x", ",", "I4", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y4", ",", "y", ",", "I4", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "z", ",", "I4", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.4109592547618723`*^9, 
  3.4109592880721416`*^9}},ExpressionUUID->"2a0cd881-05a5-4cbf-bcf9-\
331914dde335"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(K);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(CO);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.41095930653111*^9, 3.410959308338553*^9}, {3.410959446914455*^9, 
  3.410959448076516*^9}, {3.4109594887222424`*^9, 3.4109595065938807`*^9}, {
  3.430307504520461*^9, 
  3.4303075090533123`*^9}},ExpressionUUID->"ef2df254-04a0-405b-80b4-\
73e467060be2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "str"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "chiralRestraintVarNames", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", " ", "=", " ", 
         RowBox[{"\"\<CHIRAL_RESTRAINT_SET_POSITION(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"chiralRestraintSetupRules", ",", 
          RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4109593095964613`*^9, 3.410959312139323*^9}, 
   3.410959448741249*^9, {3.41100557090314*^9, 
   3.411005579300394*^9}},ExpressionUUID->"8d9c1630-18cf-4acf-95fa-\
6725807f7890"],

Cell[BoxData[
 RowBox[{"chiralRestraintSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410959313257309*^9, {
   3.410959597371963*^9, 
   3.410959602050107*^9}},ExpressionUUID->"8c67aaa1-28c3-4dea-b832-\
1cc4a7c7e851"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chiralRestraintTestRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"chiralRestraintTestRules", ",", 
     RowBox[{"Assign", "[", 
      RowBox[{"ChiralTest", ",", "chiralRestraintTestFn"}], "]"}]}], "]"}], 
   ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"We", " ", "will", " ", "test", " ", "the", " ", "Energy"}], ",", 
    " ", 
    RowBox[{
    "if", " ", "its", " ", "greater", " ", "than", " ", "zero", " ", "then", 
     " ", "the", " ", "restraint", " ", "is", " ", "active"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chiralRestraintEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<Energy=ChiralTest;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"MathCode", "[", "\"\<Energy = ChiralTest;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<CHIRAL_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.410959314804584*^9, 
   3.4109593175472317`*^9}, 3.410959449531116*^9, {3.410959545429446*^9, 
   3.410959610720241*^9}, {3.410959644694853*^9, 3.410959691985753*^9}, {
   3.411134257170401*^9, 3.411134294169005*^9}, {3.411135094096856*^9, 
   3.4111350954424562`*^9}, {3.411135402551195*^9, 
   3.411135431190372*^9}},ExpressionUUID->"7ca4aa3f-9612-4a74-a023-\
640a1363418a"]
}, Open  ]],

Cell[BoxData["chiralRestraintTestRules"], "Input",
 CellChangeTimes->{{3.411135069369252*^9, 
  3.4111350725038767`*^9}},ExpressionUUID->"4921a7bc-f8ea-4c3c-acec-\
c55baca17f9e"],

Cell[BoxData["chiralRestraintEnergyRules"], "Input",
 CellChangeTimes->{{3.411135079713765*^9, 
  3.411135082886479*^9}},ExpressionUUID->"481536ab-85bd-482a-97ce-\
22ea51eeb596"],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 
  3.408559038294833*^9}},ExpressionUUID->"4ef27c07-ee8e-4cee-8fe9-\
e5efaf3cfd75"],

Cell[BoxData["chiralRestraintEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.410959318323591*^9},ExpressionUUID->"94317aa6-0b03-47ef-8eba-\
a96962bf3937"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"chiralRestraintHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "12", "}"}]}], "]"}], ",", 
      RowBox[{"{", "12", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.4109593191865063`*^9, {3.410960717989409*^9, 
   3.410960719562788*^9}},ExpressionUUID->"9c0ffe86-94ca-49d6-ba4c-\
7a16bd99a8d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.4109593198653793`*^9},ExpressionUUID->"eed2827b-c4c2-40ac-8d06-\
c3f32cb0fe02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<CHIRAL_RESTRAINT\>\"", ",", "chiralRestraintForceHessianRules", ",", 
    "chiralRestraintOutputs", ",", "chiralRestraintHessian", ",", 
    "chiralRestraintEnergyFn", ",", "chiralRestraintVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.410959320803413*^9, 3.410959324344501*^9}, 
   3.410959451277605*^9},ExpressionUUID->"18bf73ed-011e-4d62-8661-\
97de2962c28e"],

Cell[BoxData[
 RowBox[{"chiralRestraintHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 
   3.410959325491352*^9},ExpressionUUID->"3579a211-b219-427c-a8d3-\
2e2a49232288"],

Cell[BoxData["chiralRestraintOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4109593272519207`*^9},ExpressionUUID->"abdbc1c0-1f0f-4a9a-af20-\
8267acb8e44f"],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"97ea9cdc-80ab-43bd-ae91-\
5478f81d636f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintAllRules", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintSetupRules"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "out", " ", "setting", " ", "variables", " ", "to", " ", 
    "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"chiralRestraintAllRules", ",", 
      RowBox[{"CCode", "[", 
       RowBox[{"InitializeOutputs", "[", "chiralRestraintOutputs", "]"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintTestRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", "\"\<If[ChiralTest>0.0,\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (ChiralTest>0.0 ) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintEnergyRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "chiralRestraintAllRules", ",", "chiralRestraintForceHessianRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*ChiralTest>0.0*/\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.410959332300748*^9, 3.410959333098225*^9}, {3.4109598627158747`*^9, 
   3.410960066783773*^9}, {3.4109601095200453`*^9, 3.410960125598184*^9}, {
   3.411134307132209*^9, 3.41113432360879*^9}, {3.485015368183762*^9, 
   3.4850153836885*^9}},ExpressionUUID->"04ed4df2-046d-4f8f-bdd7-\
d96cb606975d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "chiralRestraintAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.4109593336854553`*^9, 
  3.410959334074417*^9}},ExpressionUUID->"08ae4ef2-8503-453a-95f2-\
17ae3af1ae68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintInput", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"va", ",", "vb", ",", "vc", ",", "vd", ",", "K", ",", "CO"}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.410959334338519*^9, {
   3.4109593725101748`*^9, 3.410959398697234*^9}, {3.410976480390479*^9, 
   3.410976484490128*^9}, {3.411921363503119*^9, 
   3.411921363833495*^9}},ExpressionUUID->"7aee63a8-8c6f-4f95-ae72-\
75d7f5a8e959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<ChiralRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"va", ",", "vb", ",", "vc", ",", "vd"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "chiralRestraintHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "chiralRestraintRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "chiralRestraintInput"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "chiralRestraintOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.410959334749442*^9, 3.4109593365958223`*^9}, {3.4109594055611277`*^9, 
   3.410959422169114*^9}, {3.4109764723057404`*^9, 3.410976477991148*^9}, {
   3.4110666202631207`*^9, 3.4110666262635813`*^9}, {3.411067029087072*^9, 
   3.411067031094479*^9}, 3.411074026391202*^9, {3.411075777240587*^9, 
   3.411075781101914*^9}},ExpressionUUID->"c145ce0d-1735-4fc7-a475-\
9cda3f545571"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "writeOutputVariablesForDebugging", "[", "chiralRestraintPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, {3.410959339196207*^9, 
   3.410959340137948*^9}, 
   3.41106704496288*^9},ExpressionUUID->"a8eddba7-569c-4584-bcbf-\
e1a79d33794d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "chiralRestraintPack0", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, {3.410959341804433*^9, 
   3.410959345050294*^9}, 
   3.411066639651175*^9},ExpressionUUID->"622eeef3-ba27-43e4-a2f3-\
1472ced362ad"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"packGraph", "[", "chiralRestraintPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 
   3.4109593459079313`*^9},ExpressionUUID->"65a3ea34-3ede-44da-9f37-\
973bd9a24806"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cartesian anchor term.  
Anchor atoms at a specific position with a harmonic potential
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.413903156136791*^9, 3.413903180058527*^9}, {
   3.413903223172472*^9, 3.4139032263211527`*^9}, 
   3.414009285999349*^9},ExpressionUUID->"e1911cd3-0e16-4ce7-89eb-\
7925443f20a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "ka"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}, {
   3.413903983939694*^9, 3.413903984536366*^9}, 
   3.414009246563033*^9},ExpressionUUID->"216f22c8-83eb-4f7b-829e-\
16a5b07ceaf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bx", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xa", ",", " ", "ya", ",", " ", "za"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, 
   3.413903311971038*^9, {3.413903346593233*^9, 3.4139033527796583`*^9}, {
   3.413903458114628*^9, 
   3.4139034691386337`*^9}},ExpressionUUID->"957c5682-b448-4275-93a1-\
5fea2f3d7431"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorDeviation", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"bx", "-", "ba"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"bx", "-", "ba"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
   3.411152033364759*^9, 3.411152034157058*^9}, 3.4139031925379553`*^9, {
   3.4139033180069942`*^9, 3.41390332309116*^9}, {3.413903471689744*^9, 
   3.4139034758767776`*^9}, {3.413904038061068*^9, 
   3.4139040413677464`*^9}},ExpressionUUID->"0f2cb3fb-5e2a-423b-a49e-\
7bd83017c0f3"],

Cell[BoxData[
 RowBox[{"anchorEnergyFn", " ", "=", "  ", 
  RowBox[{"ka", "  ", 
   RowBox[{"(", "anchorDeviation", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.413903193205619*^9, 3.413903194259962*^9}, 3.413904044615448*^9, 
   3.414009238387752*^9, 3.416871858821822*^9, 
   3.4168720341302967`*^9},ExpressionUUID->"84596d0c-af08-4482-b3eb-\
660f5b099729"],

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "bx", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{3.413903342754142*^9, 
  3.4139034818315573`*^9},ExpressionUUID->"60ed279c-0020-40ec-849d-\
2a9046d0cbcb"],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 
  3.401714291927002*^9}},ExpressionUUID->"b630c207-9811-4dbf-a935-\
44cc6da0b53f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, 3.41390319489956*^9, {3.413903336781911*^9, 
   3.4139033375178556`*^9}},ExpressionUUID->"b6c4f516-a68b-4dc8-86f8-\
6b0c609f2e87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(ka);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(xa);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(ya);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(za);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}, {3.413903195586742*^9, 3.413903197762012*^9}, {
  3.4139032725347033`*^9, 3.4139032733978243`*^9}, {3.413903365080594*^9, 
  3.413903400308832*^9}, {3.413903434469326*^9, 3.413903453516231*^9}, {
  3.414020790309948*^9, 
  3.4140208145575933`*^9}},ExpressionUUID->"a9cfde97-ddb6-4908-8a33-\
448455ede328"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "anchorVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<ANCHOR_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"anchorSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4139031985252733`*^9, 3.41390319966262*^9}, 
   3.413903273923324*^9, {3.41402126078249*^9, 
   3.414021262410028*^9}},ExpressionUUID->"e088c280-1e67-49f8-a3d6-\
dc5054ccce1f"],

Cell[BoxData[
 RowBox[{"anchorSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 
   3.413903199910615*^9},ExpressionUUID->"6e3a1361-6e11-418f-86ae-\
32d90ce468cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anchorOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"AnchorDeviation", ",", "anchorDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "anchorEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<ANCHOR_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 3.411152028421866*^9}, {3.413903200311384*^9, 
   3.413903202186616*^9}, {3.4139032744344463`*^9, 3.413903295296754*^9}, {
   3.4140207972347403`*^9, 
   3.4140207987706137`*^9}},ExpressionUUID->"a40b46e8-8d16-464f-aee4-\
0bd267e62af8"]
}, Open  ]],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 
  3.408559038294833*^9}},ExpressionUUID->"690ceaa6-7f80-4d08-a085-\
d1355e1abf45"],

Cell[BoxData["anchorEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.413903202602512*^9},ExpressionUUID->"4eaf5511-f42c-4baf-998c-\
b0c82ead7bd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"anchorHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.413903202921104*^9},ExpressionUUID->"1386436e-e2c5-4667-87d0-\
8456c6abeee6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.413903203137519*^9},ExpressionUUID->"b68e0a34-bca3-43ee-acab-\
bef2a6e2892a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<ANCHOR_RESTRAINT\>\"", ",", "anchorForceHessianRules", ",", 
    "anchorOutputs", ",", "anchorHessian", ",", "anchorEnergyFn", ",", 
    "anchorVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.413903203356204*^9, 3.4139032050483017`*^9}, 
   3.413903275122141*^9, {3.414021270983808*^9, 
   3.414021272512858*^9}},ExpressionUUID->"a4eea477-b970-450a-ac49-\
e462576267c4"],

Cell[BoxData[
 RowBox[{"anchorHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 
   3.4139032057904243`*^9},ExpressionUUID->"9b582343-aad8-406b-8acb-\
61b7bc63b91e"],

Cell[BoxData["anchorOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4139032064409513`*^9},ExpressionUUID->"8e679f38-fa53-4896-96c7-\
5208e3185127"],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"54bf2ce1-a97b-42d8-ac9b-\
f9b8c5d266d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "anchorSetupRules", ",", "\[IndentingNewLine]", "anchorEnergyRules", ",", 
     "\[IndentingNewLine]", "anchorForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.4139032071864157`*^9, 
   3.413903208348619*^9}},ExpressionUUID->"f2b20cb6-1ad4-4ce2-a374-\
9521872030cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "anchorAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.41390320889892*^9, 
  3.413903209224545*^9}},ExpressionUUID->"4d5bfe03-8d22-48c2-8e2f-\
fee5e1105709"],

Cell[BoxData[
 RowBox[{"anchorRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 3.411210898002816*^9}, 
   3.413903209717396*^9, {3.4139040641107597`*^9, 
   3.413904066184003*^9}},ExpressionUUID->"294dc2ea-bc6e-4f72-823d-\
041a33df6363"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "xa", ",", "ya", ",", "za", ",", "ka"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.413903210219502*^9, {
   3.413903523135522*^9, 3.4139035304924097`*^9}, {3.414009254249028*^9, 
   3.4140092544270477`*^9}},ExpressionUUID->"ffeb086d-42cc-4124-a1cb-\
dd098c459d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorOutputs", ",", "AnchorDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 3.411152052756624*^9}, 
   3.413903210688085*^9, 
   3.413903296414403*^9},ExpressionUUID->"5bf34cf6-a3f5-42ae-9674-\
896e8f83c2c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<AnchorRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "anchorHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "anchorRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "anchorInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "anchorOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9, {3.4139032111233997`*^9, 3.413903213486709*^9}, 
   3.413903298323092*^9, 3.413903540538962*^9, {3.4140187475989857`*^9, 
   3.41401874899977*^9}},ExpressionUUID->"15794cbd-d819-4d9c-82f4-\
b172fc964652"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "anchorPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 3.4110670621890917`*^9, 
   3.413903214952401*^9},ExpressionUUID->"c02aa680-e3c7-4ae4-b996-\
c0691378d843"],

Cell["\<\
anchorPack = Block[{PrintTemporary = Print}, packOptimize[anchorPack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.413903215882161*^9, 
   3.4139032166104527`*^9}},ExpressionUUID->"01f4c3ba-a397-4574-a553-\
a150aaca596a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "anchorPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}, {3.4139032174258947`*^9, 
   3.413903217685163*^9}},ExpressionUUID->"2ec0963f-6f13-4043-9c58-\
b09df6efdce1"]
}, Open  ]],

Cell["\<\
Ignore errors in packGraph[anchorPack], I forget what it doesn't like but it \
is something non-essential\
\>", "Text",
 CellChangeTimes->{{3.416873887395665*^9, 3.4168738997477922`*^9}, {
  3.416873947718832*^9, 
  3.416873957966881*^9}},ExpressionUUID->"aa084058-801a-4bc7-986f-\
2b5f5ca6b07d"],

Cell[BoxData[
 RowBox[{"packGraph", "[", "anchorPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 
   3.413903219466408*^9},ExpressionUUID->"10510d75-92c9-492e-bb5a-\
e7c15906dd0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Fixed non-bonding terms
\t- Van der Waals and Electrostatic interactions with atoms that are fixed in \
space.
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 3.402672664963516*^9}, {
  3.4868991702894497`*^9, 3.4868991807145767`*^9}, {3.494844072016407*^9, 
  3.494844075959107*^9}},ExpressionUUID->"028542b0-9e01-4307-97e6-\
99990bb77936"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", " ", 
    "evdw", ",", " ", "eeel", ",", "fixedNonBondEquation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
   3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
   3.402741179258795*^9}, {3.486899212216976*^9, 3.4868992150663013`*^9}, 
   3.486899587515778*^9},ExpressionUUID->"d45b0108-56bb-4fca-b48f-\
2ac5299781fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xf", ",", " ", "yf", ",", " ", "zf"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 3.402652572153042*^9}, {3.4868992274659967`*^9, 
  3.4868992304790297`*^9}},ExpressionUUID->"35bd7349-9cf0-41e4-b3b9-\
b4e82c85baec"],

Cell[BoxData[
 RowBox[{"fixedNonBondInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "dA", ",", "dC", ",", "dQ1Q2"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 3.4111751886209507`*^9}, {
   3.486900028093594*^9, 
   3.4869000289927797`*^9}},ExpressionUUID->"b968ff22-b750-4d22-930f-\
2e5aeaea0053"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondDistance", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
   3.411197578518401*^9, 3.411197589788989*^9}, 
   3.486899591964513*^9},ExpressionUUID->"5175a19b-cadc-4cf9-a2ea-\
2e6ff34f9a37"],

Cell[BoxData[
 RowBox[{"efvdwEquation", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["dA", 
     SuperscriptBox["fixedNonBondDistance", "12"]], "-", 
    FractionBox["dC", 
     SuperscriptBox["fixedNonBondDistance", "6"]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 3.416871995722517*^9, {
   3.486899247667407*^9, 3.4868992682932787`*^9}, {3.4868995931240263`*^9, 
   3.486899593780075*^9}, 3.48689979376054*^9, {3.4868998240834837`*^9, 
   3.4868998427714367`*^9}},ExpressionUUID->"0656a7b9-dff3-4051-9108-\
426d8947cded"],

Cell[BoxData[
 RowBox[{"efeelEquation", " ", "=", " ", 
  RowBox[{"(", 
   FractionBox["dQ1Q2", "fixedNonBondDistance"], ")"}]}]], "Input",
 CellChangeTimes->{{3.4026534322622623`*^9, 3.402653496407857*^9}, {
   3.4026535524322023`*^9, 3.402653641591628*^9}, {3.4026779483394947`*^9, 
   3.402677953362184*^9}, {3.4026781314714537`*^9, 3.4026781348802843`*^9}, {
   3.40274101413416*^9, 3.402741050316153*^9}, {3.407556736609376*^9, 
   3.4075567425681257`*^9}, {3.407557208386277*^9, 3.407557225106896*^9}, {
   3.408662115934063*^9, 3.408662119317389*^9}, 3.411081885331176*^9, {
   3.411197627982712*^9, 3.411197630382259*^9}, 3.416871999453731*^9, {
   3.486899263067898*^9, 3.486899266017837*^9}, 3.486899595492217*^9, 
   3.486899792235376*^9, 3.4868998451487417`*^9, 
   3.4868998890096083`*^9},ExpressionUUID->"ecbcb2b6-aa93-4c3a-b8c2-\
e4bd24114318"],

Cell[BoxData[
 RowBox[{"fixedNonBondEquation", " ", "=", " ", 
  RowBox[{"efvdwEquation", " ", "+", " ", "efeelEquation"}]}]], "Input",
 CellChangeTimes->{{3.4027412120076227`*^9, 3.402741220906414*^9}, {
   3.4086620876703787`*^9, 3.408662102195766*^9}, 3.486899597487871*^9, {
   3.486899797160198*^9, 3.486899798372685*^9}, {3.486899829491583*^9, 
   3.4868998481540203`*^9}, 
   3.486899889928892*^9},ExpressionUUID->"03211933-86df-447e-9097-\
fe0d5177abcf"],

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "ba", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.486899549784584*^9},ExpressionUUID->"b36739b1-2872-4a36-93cd-\
8f386123e486"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 
  3.401714933019302*^9}},ExpressionUUID->"0a514688-2796-42a4-8d97-\
e99b96ec4515"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, {3.408564450747929*^9, 3.408564451541582*^9}, {
   3.486899474762479*^9, 3.486899475750346*^9}, 
   3.486899598225782*^9},ExpressionUUID->"1bc1c738-9349-49fb-a281-\
14abdbe3c3b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixedNonBondSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(xf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(yf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(zf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dQ1Q2);\>\"", "]"}]}], "]"}],
   ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dA);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dC);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
   3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
   3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
   3.486899598988052*^9, 3.48689960053936*^9}, {3.486899642233687*^9, 
   3.486899655633342*^9}, 3.4868997620139523`*^9, {3.4869001020979548`*^9, 
   3.486900107535079*^9}, {3.487026123015799*^9, 3.487026151511093*^9}, {
   3.487026191456916*^9, 3.487026218196006*^9}, {3.48702895046251*^9, 
   3.487028956387195*^9}, {3.4872610348815603`*^9, 
   3.487261040187768*^9}},ExpressionUUID->"233c2c4b-3120-4b17-b635-\
49ab217c950d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "fixedNonBondVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<FNONBOND_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"fixedNonBondSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
   3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4868996013404512`*^9, 
   3.4868996039384813`*^9}, 
   3.486900098021953*^9},ExpressionUUID->"c3ac488b-12cb-406e-b380-\
02c49e2d9980"],

Cell[BoxData[
 RowBox[{"fixedNonBondSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 
   3.486899605018564*^9},ExpressionUUID->"c37157b1-8af0-450e-b06b-\
949c8f04abe0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixedNonBondEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fixedNonBondOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"NonbondDistance", ",", "fixedNonBondDistance"}], "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Efvdw", ",", "efvdwEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND_EFVDW\>\"", ",", "Efvdw"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Efeel", ",", "efeelEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND_EFEEL\>\"", ",", "Efeel"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", 
      RowBox[{"Efvdw", "+", "Efeel"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Efvdw"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Efeel"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}, {3.4868996061093397`*^9, 3.4868996113673363`*^9}, 
   3.486899830710224*^9, {3.486899890910192*^9, 
   3.48689995929298*^9}},ExpressionUUID->"55b61fed-3600-47b5-9a4a-\
a363e99518b6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"fixedNonBondHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 3.409334145792842*^9}, 
   3.486899612009248*^9, {3.4868999652909813`*^9, 
   3.486899969952155*^9}},ExpressionUUID->"68fa6a2b-5c0b-4a90-828e-\
89fb63d5a696"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 3.410177986821323*^9}, 
   3.486899612569351*^9},ExpressionUUID->"7a226d62-64ac-41c8-9781-\
36fce0c0c137"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<FNONBOND\>\"", ",", "fixedNonBondForceHessianRules", ",", 
    "fixedNonBondOutputs", ",", "fixedNonBondHessian", ",", 
    "fixedNonBondEquation", ",", "fixedNonBondVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
   3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
   3.410177993430345*^9}, {3.486899613226053*^9, 3.486899615580276*^9}, 
   3.486899978015726*^9},ExpressionUUID->"c98df20f-80b3-4514-86ca-\
93bd115476dd"],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 
  3.4017149467691317`*^9}},ExpressionUUID->"1f90bdff-6a7b-4eb0-bd76-\
d26eebfa5627"],

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"fixedNonBondOutputs", ",", "fixedNonbondDistance"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
   3.4111976578180523`*^9, 3.411197662226531*^9}, 3.486899616345285*^9, {
   3.486899992027813*^9, 
   3.486899992728018*^9}},ExpressionUUID->"bd8205e4-3988-425e-8ba3-\
b0246b7cf448"],

Cell[BoxData[
 RowBox[{"fixedNonBondOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9, 
   3.486899617019046*^9},ExpressionUUID->"87c12af7-e8b0-44b7-9f06-\
17b225e6568b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "fixedNonBondSetupRules", ",", "fixedNonBondEnergyRules", ",", 
      "fixedNonBondForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 3.410178019066489*^9}, {
  3.486899617618881*^9, 
  3.4868996194608173`*^9}},ExpressionUUID->"be515830-4a76-44b3-97cb-\
e431b83ecdd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fnbPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<FixedNonbond\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "fixedNonBondEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "fixedNonBondHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "fixedNonBondRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "fixedNonBondInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "fixedNonBondOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9, {3.486899620515873*^9, 3.486899622563909*^9}, {
   3.48690000448034*^9, 3.4869000046048727`*^9}, {3.486900045658348*^9, 
   3.4869000846709013`*^9}},ExpressionUUID->"42f56f94-f1ce-4a55-bb60-\
fbbc45663e12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "fnbPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 3.4110670742215853`*^9, 
   3.4869000687187243`*^9},ExpressionUUID->"736fec4b-5b0b-4e73-8419-\
8d251b781d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "fnbPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 3.411066673303035*^9, 
   3.486900070218787*^9},ExpressionUUID->"bb92f06f-cb0a-4b46-bcbd-\
e1c27bcc98cb"],

Cell[BoxData[
 RowBox[{"packGraph", "[", "nbPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 
  3.4055995100170727`*^9}},ExpressionUUID->"c39afa8d-3ca8-4076-9a52-\
a2899a9a466c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Out of Z-plane energy {x1,y1,z1} - Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.4948432970798798`*^9, 3.494843313989492*^9}, {
   3.7746184239984303`*^9, 
   3.7746184367217083`*^9}},ExpressionUUID->"40c497cd-8ecb-4a12-a19e-\
90050870a153"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}, 
   3.7746184406798897`*^9},ExpressionUUID->"a3598273-c222-436b-9d94-\
ca29ebbf3a24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, 
   3.7746186520505943`*^9},ExpressionUUID->"58e0eab9-be8c-43e5-82a3-\
ad8adbb63338"],

Cell["Define the Hooks law bond oozp potential", "Subsection",
 CellChangeTimes->{{3.494843329696516*^9, 3.4948433485250063`*^9}, 
   3.774618452120893*^9},ExpressionUUID->"3879886e-f184-4d74-93af-\
6e49da00fb72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpDeviation", " ", "=", " ", 
   RowBox[{"ba", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
   3.411152033364759*^9, 3.411152034157058*^9}, 3.774618452903599*^9, {
   3.774618670130414*^9, 
   3.7746186720306377`*^9}},ExpressionUUID->"495fb4b5-85f0-462f-aac7-\
785188d5dabc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"oozpEnergyFn", " ", "=", "  ", 
  RowBox[{"kb", "  ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"oozpDeviation", "-", "za"}], ")"}], "^", "2.0"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.416871725859004*^9, 3.416871727438574*^9}, 3.416872040224017*^9, {
   3.774618453430616*^9, 3.774618454083569*^9}, {3.77462066786065*^9, 
   3.7746206687374983`*^9}, 
   3.774621571464553*^9},ExpressionUUID->"4e665c6e-c0f4-4ca4-833d-\
8dc01f25a9b8"],

Cell[BoxData[
 RowBox[{"kb", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"z1", "-", "za"}], ")"}], "2.`"]}]], "Output",
 CellChangeTimes->{3.774618723485722*^9, 3.7746191150191927`*^9, 
  3.774619181613391*^9, 3.7746206716384783`*^9, 3.7746207221338654`*^9, 
  3.7746215899856243`*^9},ExpressionUUID->"8d304de0-7a15-40b1-a9d3-\
de739ee33339"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "ba", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7746187302973824`*^9, 
  3.774618730756371*^9}},ExpressionUUID->"d49fcc02-7be5-4d13-bb3a-\
5b4b3983e308"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]], "Output",
 CellChangeTimes->{3.774618731913294*^9, 3.7746191150448303`*^9, 
  3.774619181646031*^9, 3.774620679229938*^9, 3.774620722220347*^9, 
  3.7746215900694*^9},ExpressionUUID->"d6e7d04b-1411-43cd-b459-d864f96bcf45"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assemble the energy function rules to expand", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 3.401714291927002*^9}, {
  3.494843844071973*^9, 
  3.494843851677432*^9}},ExpressionUUID->"76c2ef4b-da46-4f83-b9d7-\
f91a9c19990f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, 3.774618454679556*^9, 
   3.7746187404768*^9},ExpressionUUID->"446f8cb2-7ee6-4b8d-884e-be17a694418a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"oozpSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<OOZP_SET_PARAMETER(kb);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<OOZP_SET_PARAMETER(za);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<OOZP_SET_PARAMETER(I1);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<OOZP_SET_PARAMETER(I2);\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
   3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
   3.411080722519088*^9}, {3.774618455017694*^9, 3.774618458629716*^9}, {
   3.77461859566796*^9, 3.774618597209654*^9}, {3.774618817597989*^9, 
   3.7746188188464403`*^9}, {3.7746206330644608`*^9, 3.7746206417824593`*^9}, 
   3.77462157587469*^9},ExpressionUUID->"abcb48bc-d911-47a2-92e5-\
016ff7afb1b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "oozpVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<OOZP_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"oozpVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"oozpVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"oozpVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"oozpSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.7746184593388767`*^9, 3.77461846186845*^9}, 
   3.774618597951931*^9},ExpressionUUID->"0bbb2f4a-d376-457f-894a-\
dcf14cdf7f4d"],

Cell[BoxData["\<\"OOZP_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.774618758457205*^9, 3.774618824558608*^9, 
  3.7746191151081057`*^9, 3.7746191816877127`*^9, 3.774620653234665*^9, 
  3.774620722317197*^9, 
  3.774621590167097*^9},ExpressionUUID->"6983a7e6-ddc8-4ca2-a982-\
bda6a31ea027"],

Cell[BoxData["\<\"OOZP_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.774618758457205*^9, 3.774618824558608*^9, 
  3.7746191151081057`*^9, 3.7746191816877127`*^9, 3.774620653234665*^9, 
  3.774620722317197*^9, 
  3.77462159017422*^9},ExpressionUUID->"7279ae0f-7d9a-4947-b56b-905684f5afb2"],

Cell[BoxData["\<\"OOZP_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.774618758457205*^9, 3.774618824558608*^9, 
  3.7746191151081057`*^9, 3.7746191816877127`*^9, 3.774620653234665*^9, 
  3.774620722317197*^9, 
  3.774621590180828*^9},ExpressionUUID->"03097dad-aff8-4684-9631-\
d6bb759b3464"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"oozpSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 
   3.774618464951071*^9},ExpressionUUID->"56551ce3-b9df-432e-b5e3-\
f2b5d6f01a87"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(kb);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(za);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"OOZP_SET_POSITION(z1,I1,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7746187689173594`*^9, 3.774618828247216*^9, 
  3.774619115145772*^9, 3.774619181723378*^9, 3.7746207223925247`*^9, 
  3.774621590245638*^9},ExpressionUUID->"98865c67-f70e-4587-9a96-\
3ff7fb100164"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"oozpEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"oozpOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "oozpEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<OOZP\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 3.411152028421866*^9}, {3.774618532520569*^9, 
   3.774618536672056*^9}, {3.774618839940138*^9, 3.7746188503130074`*^9}, 
   3.7746234878059187`*^9},ExpressionUUID->"d2ec2e96-4d08-4a2b-9b30-\
b2997f4c3329"]
}, Open  ]],

Cell["Append the Gradient and Hessian rules", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 3.408559038294833*^9}, {3.494843872271369*^9, 
  3.4948438859081783`*^9}},ExpressionUUID->"ed8cec90-4c0a-47d9-9f0f-\
1990a0389f2f"],

Cell[CellGroupData[{

Cell[BoxData["oozpEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.774618537414845*^9},ExpressionUUID->"07b80f7a-8e11-48e8-95f4-\
52af32d2333f"],

Cell[BoxData[
 RowBox[{"kb", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"z1", "-", "za"}], ")"}], "2.`"]}]], "Output",
 CellChangeTimes->{3.774618909023869*^9, 3.774619115191009*^9, 
  3.774619181773769*^9, 3.774620722472691*^9, 
  3.7746215903452682`*^9},ExpressionUUID->"d0938f49-fd67-4548-bedd-\
ad07ee1d2b86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"oozpHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.7746185380108643`*^9, {3.774618921076655*^9, 
   3.774618923349537*^9}},ExpressionUUID->"63510d04-307f-48f5-b131-\
93115a1e8bfe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.774618926698842*^9, 3.7746191152356453`*^9, 
  3.774619181812397*^9, 3.774620722559841*^9, 
  3.774621590429459*^9},ExpressionUUID->"d0e8103c-d11d-42a7-97f0-\
3a875a8ae78a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.774618538583603*^9},ExpressionUUID->"1d7c25b0-fdd8-4f33-81d8-\
92b1808f75e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<OOZP\>\"", ",", "oozpForceHessianRules", ",", "oozpOutputs", ",", 
    "oozpHessian", ",", "oozpEnergyFn", ",", "oozpVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
  3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
  3.410177087548172*^9}, {3.774618539147092*^9, 3.774618541983193*^9}, {
  3.7746189333539467`*^9, 
  3.7746189340041122`*^9}},ExpressionUUID->"1ca74e93-7a67-4d46-a40b-\
bafa109761de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"oozpHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 
   3.774618542770105*^9},ExpressionUUID->"85b973da-3bee-4bad-afca-\
ddd60139d234"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"5", "8", "9"},
     {"8", "6", "10"},
     {"9", "10", "7"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.774618944104607*^9, 3.774619115768619*^9, 
  3.774619182331554*^9, 3.77462072362261*^9, 
  3.7746215914014072`*^9},ExpressionUUID->"60a82c6f-f37f-4351-803f-\
540fcfc39792"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["oozpOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.774618543343361*^9},ExpressionUUID->"806ee8fc-0086-468d-8963-\
65f7bd951e4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "dhx1x1", ",", "dhy1y1", 
   ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", ",", "ohy1z1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.774618983308496*^9, 3.7746191158287983`*^9, 
  3.7746191823906307`*^9, 3.774620723698049*^9, 
  3.7746215914720573`*^9},ExpressionUUID->"90acf8f7-e316-40af-8c72-\
dff5dedff8a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"962d4dfb-fe35-420f-b0a2-\
e2747b27b8a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "oozpSetupRules", ",", "\[IndentingNewLine]", "oozpEnergyRules", ",", 
     "\[IndentingNewLine]", "oozpForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.77461854426694*^9, 
   3.7746185457731743`*^9}},ExpressionUUID->"c35375c0-5832-4e1b-8621-\
e85aed162528"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "oozpAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.774618546336567*^9, 
  3.774618546955262*^9}},ExpressionUUID->"52064099-ffa3-4627-80f8-\
c2c37f91a2f8"],

Cell[CellGroupData[{

Cell[BoxData["oozpRules"], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 3.411210898002816*^9}, 
   3.774618547452433*^9},ExpressionUUID->"b1a40249-4327-451e-bdb0-\
e7f8cabf6dd8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(kb);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(za);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(I1);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_SET_PARAMETER(I2);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_SET_POSITION(x1,I1,0);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_SET_POSITION(y1,I1,1);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_SET_POSITION(z1,I1,2);\"\>", "]"}], ",", 
   RowBox[{"z1", "\[Rule]", "OozpDeviation"}], ",", 
   RowBox[{
    RowBox[{"kb", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "za"}], ")"}], "2.`"]}], "\[Rule]", "Energy"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_ENERGY_ACCUMULATE(Energy);\"\>", "]"}], 
   ",", 
   RowBox[{"CCode", "[", "\<\"#ifdef OOZP_CALC_FORCE //[\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
   RowBox[{"0", "\[Rule]", "gx1"}], ",", 
   RowBox[{
    RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", "]"}],
    ",", 
   RowBox[{"0", "\[Rule]", "gy1"}], ",", 
   RowBox[{
    RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", "]"}],
    ",", 
   RowBox[{
    RowBox[{"2.`", " ", "kb", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "za"}], ")"}], "1.`"]}], "\[Rule]", "gz1"}], ",", 
   RowBox[{
    RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
   RowBox[{"CCode", "[", "\<\"OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", "]"}],
    ",", 
   RowBox[{
   "CCode", "[", "\<\"#ifdef OOZP_CALC_DIAGONAL_HESSIAN //[\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], ",", 
   RowBox[{"0", "\[Rule]", "dhx1x1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);\
\"\>", "]"}], ",", 
   RowBox[{"0", "\[Rule]", "dhy1y1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);\
\"\>", "]"}], ",", 
   RowBox[{
    RowBox[{"2.`", " ", "kb"}], "\[Rule]", "dhz1z1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);\
\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN //[\"\>", "]"}], 
   ",", 
   RowBox[{"CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], 
   ",", 
   RowBox[{"0", "\[Rule]", "ohx1y1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);\"\>", "]"}], ",", 
   RowBox[{"0", "\[Rule]", "ohx1z1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);\"\>", "]"}], ",", 
   RowBox[{"0", "\[Rule]", "ohy1z1"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], 
   ",", 
   RowBox[{
   "CCode", "[", "\<\"#endif /* OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\>", 
    "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"#endif /* OOZP_CALC_DIAGONAL_HESSIAN ]*/\"\>", "]"}], 
   ",", 
   RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
   RowBox[{"CCode", "[", "\<\"#endif /* OOZP_CALC_FORCE ]*/\"\>", "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.774619009314558*^9, 3.774619115908519*^9, 
  3.774619182431162*^9, 3.774620723812337*^9, 
  3.774621591605891*^9},ExpressionUUID->"af6fb70f-bab4-4670-8fa6-\
bde17ff3ed9c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "y1", ",", "z1", ",", "kb", ",", " ", "za"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.7746185479343033`*^9, 
   3.774619023266015*^9, {3.77462071543952*^9, 3.7746207162018023`*^9}, 
   3.7746215868972473`*^9},ExpressionUUID->"1410c9bd-0156-4261-9767-\
d7b16ffc7251"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"oozpOutputs", ",", "OozpDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 3.411152052756624*^9}, 
   3.774618548453013*^9, {3.774618869663763*^9, 
   3.774618872195045*^9}},ExpressionUUID->"faf75be5-87ba-4164-babb-\
9d8d83ab387c"],

Cell["\<\
Assemble the rules, the name of the energy term, the independant variable \
names, etc. into what passes for a structure in Mathematica (I call it a Pack)\
\>", "Subsection",
 CellChangeTimes->{{3.494843911918105*^9, 
  3.494844017248684*^9}},ExpressionUUID->"7a30b210-9d08-4aa3-9dbe-\
0c1bec4ec4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Oozp\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "oozpHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "oozpRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "oozpInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "oozpOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9, {3.774618549079932*^9, 3.774618551028571*^9}, {
   3.774618883862212*^9, 
   3.774618889892412*^9}},ExpressionUUID->"e7c04b05-4842-4c2d-8283-\
54f03f84cc79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "oozpPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 3.4110670621890917`*^9, 
   3.774618551566188*^9},ExpressionUUID->"0398e0a1-c5f2-4b1c-b25d-\
c1ef738c0fb1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing finite difference debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Oozp_debugFiniteDifference.cc\"\>"}],
  SequenceForm[
  "Writing finite difference debug code to: ", 
   "_Oozp_debugFiniteDifference.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774619037027218*^9, 3.7746191160074673`*^9, 
  3.774619182519967*^9, 3.774620723914061*^9, 
  3.77462159175126*^9},ExpressionUUID->"9f1c53ce-2f12-4ea6-8c79-bc0127b19441"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing debug variable declares to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Oozp_debugEvalDeclares.cc\"\>"}],
  SequenceForm[
  "Writing debug variable declares to: ", "_Oozp_debugEvalDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774619037027218*^9, 3.7746191160074673`*^9, 
  3.774619182519967*^9, 3.774620723914061*^9, 
  3.774621591758533*^9},ExpressionUUID->"2b3439ba-d361-4393-814f-\
f85f7225a6ac"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing xml output debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Oozp_debugEvalSerialize.cc\"\>"}],
  SequenceForm[
  "Writing xml output debug code to: ", "_Oozp_debugEvalSerialize.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774619037027218*^9, 3.7746191160074673`*^9, 
  3.774619182519967*^9, 3.774620723914061*^9, 
  3.7746215917639723`*^9},ExpressionUUID->"26bc24b6-d279-4a39-a25c-\
18fcb9fdebb5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing set variables debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Oozp_debugEvalSet.cc\"\>"}],
  SequenceForm[
  "Writing set variables debug code to: ", "_Oozp_debugEvalSet.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774619037027218*^9, 3.7746191160074673`*^9, 
  3.774619182519967*^9, 3.774620723914061*^9, 
  3.774621591768959*^9},ExpressionUUID->"5fd4f1ac-4540-4141-8fcd-\
3da8950446e9"]
}, Open  ]],

Cell["Put the pedal to the metal and generate \"C\" code.", "Subsection",
 CellChangeTimes->{{3.494844094666773*^9, 
  3.494844119787055*^9}},ExpressionUUID->"47d94349-2f0d-408a-90da-\
4fb017e5e65a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"oozpPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "oozpPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}, {3.7746185533000727`*^9, 
   3.774618553840742*^9}},ExpressionUUID->"59c99ea9-0cd8-47be-9284-\
c22abf527e8b"],

Cell[BoxData[
 StyleBox["\<\"Set TimesSimplify and PlusSimplify to turn these \
simplifications off and on\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->24,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215918243713`*^9},ExpressionUUID->"f7b9553d-b6b7-444a-9edd-\
eb9d80009c46"],

Cell[BoxData[
 StyleBox["\<\"PlusOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621591830886*^9},ExpressionUUID->"f6f7c203-e31d-4196-842b-\
8a9e4850f0d0"],

Cell[BoxData[
 StyleBox["\<\"TimesOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621591834867*^9},ExpressionUUID->"f05b42db-fcfc-4098-a85f-\
9d343deae7e0"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215922059526`*^9},ExpressionUUID->"867324c6-1aa7-4157-a852-\
23b7179378a2"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, gy1 \
-> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592211011*^9},ExpressionUUID->"507fe9fa-63ad-4eb5-9653-\
96e3c9896b5d"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215922154818`*^9},ExpressionUUID->"ed5c4d26-8e19-400b-bcd5-\
eb37fbdb3ee8"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ngy1 -> dhx1x1\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.77462159221983*^9},ExpressionUUID->"2d353187-6f7e-4a8d-8507-419c1301bf60"],

Cell[BoxData["\<\"After removal: \
\\nCCode[OOZP_SET_PARAMETER(kb);]\\n\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\\
n\\nCCode[OOZP_SET_PARAMETER(I1);]\\n\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\\
n\\nCCode[OOZP_SET_POSITION(x1,I1,0);]\\n\\n\\nCCode[OOZP_SET_POSITION(y1,I1,\
1);]\\n\\n\\nCCode[OOZP_SET_POSITION(z1,I1,2);]\\n\\n\\nz1 -> \
OozpDeviation\\n\\n\\n-za -> tx1\\n\\n\\nOozpDeviation + tx1 -> tx2\\n\\n   \
2.\\ntx2   -> tx3\\n\\n\\nkb tx3 -> \
Energy\\n\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\n\\nCCode[if ( calcForce ) {]\\n\\n\\n0 -> gx1\\n\\n\
\\n-gx1 -> fx1\\n\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\n\\ngx1 \
-> gy1\\n\\n\\n-gy1 -> fy1\\n\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\
\\n\\n   1.\\ntx2   -> tx4\\n\\n\\n2. kb tx4 -> gz1\\n\\n\\n-gz1 -> fz1\\n\\n\
\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\n\\ngy1 -> dhx1x1\\n\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 0, dhx1x1);]\\n\\n\\ndhx1x1 -> \
dhy1y1\\n\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\n\\n2. kb -> dhz1z1\\n\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
2, I1, 2, dhz1z1);]\\n\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\n\\ndhy1y1 -> \
ohx1y1\\n\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\n\\nohx1y1 -> \
ohx1z1\\n\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n\\nohx1z1 -> \
ohy1z1\\n\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\n\\nCCode[} /*if calcOffDiagonalHessian */ \
]\\n\\n\\nCCode[#endif /* OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\n\\nCCode[} \
/*calcDiagonalHessian */]\\n\\n\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN \
]*/]\\n\\n\\nCCode[} /*calcForce */]\\n\\n\\nCCode[#endif /* OOZP_CALC_FORCE \
]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592224062*^9},ExpressionUUID->"332a209a-5571-482f-b9f3-\
1cfea9705310"],

Cell[BoxData["\<\"Collecting terms\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215922852182`*^9},ExpressionUUID->"cfd6fde1-f783-49ae-aa97-\
1df8c9556675"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], ":", 
  " ", "\<\"Tag \[NoBreak]\\!\\(\\*RowBox[{\\\"Times\\\"}]\\)\[NoBreak] in \
\[NoBreak]\\!\\(\\*RowBox[{\\\"Null\\\", \\\" \\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Name\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"Oozp\\\\\\\"\\\"}], \\\",\\\", \
RowBox[{\\\"AdditionalCDeclares\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"\\\\\\\"\\\"}], \\\",\\\", RowBox[{\\\"DerivativeVariables\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"x1\\\", \\\",\\\", \
\\\"y1\\\", \\\",\\\", \\\"z1\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"16\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\
\",\\\", RowBox[{\\\"Rules\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"CCode\\\", \\\"[\\\", \\\"\\\\\\\"OOZP_SET_PARAMETER(kb);\
\\\\\\\"\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"OOZP_SET_PARAMETER(za);\\\\\\\"\\\", \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"40\\\", \\\"\[RightSkeleton]\\\"}], \
\\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \\\"\\\\\\\"#endif /* \
OOZP_CALC_FORCE ]*/\\\\\\\"\\\", \\\"]\\\"}]}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"Input\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"x1\\\", \\\",\\\", \\\"y1\\\", \\\",\\\", \\\"z1\\\", \\\",\\\", \
\\\"kb\\\", \\\",\\\", \\\"za\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"Output\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"Energy\\\", \\\",\\\", \\\"fx1\\\", \\\",\\\", \\\"fy1\\\", \\\",\
\\\", \\\"fz1\\\", \\\",\\\", \\\"dhx1x1\\\", \\\",\\\", \\\"dhy1y1\\\", \
\\\",\\\", \\\"dhz1z1\\\", \\\",\\\", \\\"ohx1y1\\\", \\\",\\\", \\\"ohx1z1\\\
\", \\\",\\\", \\\"ohy1z1\\\", \\\",\\\", \\\"OozpDeviation\\\"}], \
\\\"}\\\"}]}]}], \\\"}\\\"}]}]\\)\[NoBreak] is Protected. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.774619064508478*^9, 3.774619116352861*^9, 
  3.774619182795124*^9, 3.7746207244599447`*^9, 
  3.774621592290477*^9},ExpressionUUID->"958f3ccf-4993-49d3-a053-\
40c95705887a"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592705524*^9},ExpressionUUID->"a5797262-36c1-4390-ad46-\
d28867a75eaa"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, gy1 \
-> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592710313*^9},ExpressionUUID->"049c357c-d151-41a4-abb0-\
7d68da7a9c65"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592714568*^9},ExpressionUUID->"fbc50fc0-9774-42fd-9f0b-\
f02bd888f0d3"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ngy1 -> dhx1x1\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215927221518`*^9},ExpressionUUID->"69c1f516-72b8-4747-b95a-\
c92fbf463c22"],

Cell[BoxData["\<\"After removal: \
\\nCCode[OOZP_SET_PARAMETER(kb);]\\n\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\\
n\\nCCode[OOZP_SET_PARAMETER(I1);]\\n\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\\
n\\nCCode[OOZP_SET_POSITION(x1,I1,0);]\\n\\n\\nCCode[OOZP_SET_POSITION(y1,I1,\
1);]\\n\\n\\nCCode[OOZP_SET_POSITION(z1,I1,2);]\\n\\n\\nz1 -> \
OozpDeviation\\n\\n\\n-za -> tx5\\n\\n\\nOozpDeviation + tx5 -> tx6\\n\\n   \
2.\\ntx6   -> tx7\\n\\n\\nkb tx7 -> \
Energy\\n\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\n\\nCCode[if ( calcForce ) {]\\n\\n\\n0 -> gx1\\n\\n\
\\n-gx1 -> fx1\\n\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\n\\ngx1 \
-> gy1\\n\\n\\n-gy1 -> fy1\\n\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\
\\n\\n   1.\\ntx6   -> tx8\\n\\n\\n2. kb tx8 -> gz1\\n\\n\\n-gz1 -> fz1\\n\\n\
\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\n\\ngy1 -> dhx1x1\\n\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 0, dhx1x1);]\\n\\n\\ndhx1x1 -> \
dhy1y1\\n\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\n\\n2. kb -> dhz1z1\\n\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
2, I1, 2, dhz1z1);]\\n\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\n\\ndhy1y1 -> \
ohx1y1\\n\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\n\\nohx1y1 -> \
ohx1z1\\n\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n\\nohx1z1 -> \
ohy1z1\\n\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\n\\nCCode[} /*if calcOffDiagonalHessian */ \
]\\n\\n\\nCCode[#endif /* OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\n\\nCCode[} \
/*calcDiagonalHessian */]\\n\\n\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN \
]*/]\\n\\n\\nCCode[} /*calcForce */]\\n\\n\\nCCode[#endif /* OOZP_CALC_FORCE \
]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592726553*^9},ExpressionUUID->"b08adfa9-3c20-426d-97e4-\
d164050356b0"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592785514*^9},ExpressionUUID->"7d8419a0-1a10-43a9-93c5-\
6f5d213b3b6c"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, tx6 \
-> tx8, gy1 -> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592790254*^9},ExpressionUUID->"2e2ef5c4-03dd-44cf-a408-\
0060ac73e9e9"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592794504*^9},ExpressionUUID->"a622b22a-91ed-492a-9355-\
c35214874629"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ntx6 -> tx8\\n\\ngy1 -> dhx1x1\"\>"], \
"Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592798937*^9},ExpressionUUID->"2884fc33-45f8-411a-b287-\
85b3252b9fbf"],

Cell[BoxData["\<\"After removal: \
CCode[OOZP_SET_PARAMETER(kb);]\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\nCCode[\
OOZP_SET_PARAMETER(I1);]\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\nCCode[OOZP_\
SET_POSITION(x1,I1,0);]\\n\\nCCode[OOZP_SET_POSITION(y1,I1,1);]\\n\\nCCode[\
OOZP_SET_POSITION(z1,I1,2);]\\n\\nz1 -> OozpDeviation\\n\\n-za -> \
tx5\\n\\nOozpDeviation + tx5 -> tx6\\n\\npower2[tx6] -> tx7\\n\\nkb tx7 -> \
Energy\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\n0 -> gx1\\n\\n-gx1 \
-> fx1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ngx1 -> \
gy1\\n\\n-gy1 -> fy1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx6 \
-> tx8\\n\\n2. kb tx8 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ngy1 -> dhx1x1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
0, dhx1x1);]\\n\\ndhx1x1 -> \
dhy1y1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\n2. kb -> dhz1z1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);]\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ndhy1y1 -> \
ohx1y1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\nohx1y1 -> \
ohx1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\nohx1z1 -> \
ohy1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* OOZP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215928029127`*^9},ExpressionUUID->"5a61d5e1-b95a-4e4e-9cf0-\
26db7a41ceb6"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592864987*^9},ExpressionUUID->"011d12c2-0c9f-4db1-8c61-\
662ff225f7c1"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, tx6 \
-> tx8, gy1 -> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.77462159286972*^9},ExpressionUUID->"d291d593-fd84-4173-be95-c8943e0d1c56"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592874173*^9},ExpressionUUID->"c3ce5fdc-40cf-467b-a120-\
25c7400e306c"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ntx6 -> tx8\\n\\ngy1 -> dhx1x1\"\>"], \
"Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592880476*^9},ExpressionUUID->"9d23f015-5632-4594-9c7f-\
f0294df1f029"],

Cell[BoxData["\<\"After removal: \
CCode[OOZP_SET_PARAMETER(kb);]\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\nCCode[\
OOZP_SET_PARAMETER(I1);]\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\nCCode[OOZP_\
SET_POSITION(x1,I1,0);]\\n\\nCCode[OOZP_SET_POSITION(y1,I1,1);]\\n\\nCCode[\
OOZP_SET_POSITION(z1,I1,2);]\\n\\nz1 -> OozpDeviation\\n\\n-za -> \
tx5\\n\\nOozpDeviation + tx5 -> tx6\\n\\npower2[tx6] -> tx7\\n\\nkb tx7 -> \
Energy\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\n0 -> gx1\\n\\n-gx1 \
-> fx1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ngx1 -> \
gy1\\n\\n-gy1 -> fy1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx6 \
-> tx8\\n\\n2. kb tx8 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ngy1 -> dhx1x1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
0, dhx1x1);]\\n\\ndhx1x1 -> \
dhy1y1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\n2. kb -> dhz1z1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);]\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ndhy1y1 -> \
ohx1y1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\nohx1y1 -> \
ohx1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\nohx1z1 -> \
ohy1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* OOZP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621592885476*^9},ExpressionUUID->"7e6ddc78-542c-4fda-9520-\
5251ae8cab73"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, tx6 \
-> tx8, gy1 -> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593011179*^9},ExpressionUUID->"7133157a-4df3-4ee9-8db0-\
b41964bc22bb"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593016391*^9},ExpressionUUID->"2e2b8e05-a220-464f-9948-\
6238d832385f"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ntx6 -> tx8\\n\\ngy1 -> dhx1x1\"\>"], \
"Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215930211477`*^9},ExpressionUUID->"ebe48e04-a60b-4a9f-88aa-\
38d61493c94f"],

Cell[BoxData["\<\"After removal: \
CCode[OOZP_SET_PARAMETER(kb);]\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\nCCode[\
OOZP_SET_PARAMETER(I1);]\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\nCCode[OOZP_\
SET_POSITION(x1,I1,0);]\\n\\nCCode[OOZP_SET_POSITION(y1,I1,1);]\\n\\nCCode[\
OOZP_SET_POSITION(z1,I1,2);]\\n\\nz1 -> OozpDeviation\\n\\n-za -> \
tx5\\n\\nOozpDeviation + tx5 -> tx6\\n\\npower2[tx6] -> tx7\\n\\nkb tx7 -> \
Energy\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\n0 -> gx1\\n\\n-gx1 \
-> fx1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ngx1 -> \
gy1\\n\\n-gy1 -> fy1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx6 \
-> tx8\\n\\n2. kb tx8 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ngy1 -> dhx1x1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
0, dhx1x1);]\\n\\ndhx1x1 -> \
dhy1y1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\n2. kb -> dhz1z1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);]\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ndhy1y1 -> \
ohx1y1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\nohx1y1 -> \
ohx1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\nohx1z1 -> \
ohy1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* OOZP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593025937*^9},ExpressionUUID->"75d014ad-152e-4106-935f-\
8b6340cfc6b3"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593084629*^9},ExpressionUUID->"0cd8f499-8249-4771-9c80-\
f16816729ab7"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, tx6 \
-> tx8, gy1 -> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593089225*^9},ExpressionUUID->"7783e1d7-99b2-46e9-8d3c-\
c514d0a154f1"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593093505*^9},ExpressionUUID->"7da9e4f9-49f1-42b1-bf1f-\
aab17ab07a0a"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ntx6 -> tx8\\n\\ngy1 -> dhx1x1\"\>"], \
"Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593097868*^9},ExpressionUUID->"fc0eb160-fff7-4993-bc19-\
57d51920b257"],

Cell[BoxData["\<\"After removal: \
CCode[OOZP_SET_PARAMETER(kb);]\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\nCCode[\
OOZP_SET_PARAMETER(I1);]\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\nCCode[OOZP_\
SET_POSITION(x1,I1,0);]\\n\\nCCode[OOZP_SET_POSITION(y1,I1,1);]\\n\\nCCode[\
OOZP_SET_POSITION(z1,I1,2);]\\n\\nz1 -> OozpDeviation\\n\\n-za -> \
tx5\\n\\nOozpDeviation + tx5 -> tx6\\n\\npower2[tx6] -> tx7\\n\\nkb tx7 -> \
Energy\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\n0 -> gx1\\n\\n-gx1 \
-> fx1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ngx1 -> \
gy1\\n\\n-gy1 -> fy1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx6 \
-> tx8\\n\\n2. kb tx8 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ngy1 -> dhx1x1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
0, dhx1x1);]\\n\\ndhx1x1 -> \
dhy1y1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\n2. kb -> dhz1z1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);]\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ndhy1y1 -> \
ohx1y1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\nohx1y1 -> \
ohx1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\nohx1z1 -> \
ohy1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* OOZP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215931020517`*^9},ExpressionUUID->"43d6cf97-89d1-42ff-b1b3-\
6f7484ff6e07"],

Cell[BoxData["\<\"trivialRules>> triv = {z1 -> OozpDeviation, gx1 -> gy1, tx6 \
-> tx8, gy1 -> dhx1x1}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593229632*^9},ExpressionUUID->"f7ab1bc7-ec92-463c-87df-\
857ae4d2908a"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, OozpDeviation}\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.7746215932347183`*^9},ExpressionUUID->"271a63e7-163e-4566-b078-\
2ea9dfe0cefd"],

Cell[BoxData["\<\"Trivial rules are being removed: z1 -> \
OozpDeviation\\n\\ngx1 -> gy1\\n\\ntx6 -> tx8\\n\\ngy1 -> dhx1x1\"\>"], \
"Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593240828*^9},ExpressionUUID->"2ad4f24f-29ce-45ec-b32e-\
1b624cb6ce53"],

Cell[BoxData["\<\"After removal: \
CCode[OOZP_SET_PARAMETER(kb);]\\n\\nCCode[OOZP_SET_PARAMETER(za);]\\n\\nCCode[\
OOZP_SET_PARAMETER(I1);]\\n\\nCCode[OOZP_SET_PARAMETER(I2);]\\n\\nCCode[OOZP_\
SET_POSITION(x1,I1,0);]\\n\\nCCode[OOZP_SET_POSITION(y1,I1,1);]\\n\\nCCode[\
OOZP_SET_POSITION(z1,I1,2);]\\n\\nz1 -> OozpDeviation\\n\\n-za -> \
tx5\\n\\nOozpDeviation + tx5 -> tx6\\n\\npower2[tx6] -> tx7\\n\\nkb tx7 -> \
Energy\\n\\nCCode[OOZP_ENERGY_ACCUMULATE(Energy);]\\n\\nCCode[#ifdef \
OOZP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\n0 -> gx1\\n\\n-gx1 \
-> fx1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ngx1 -> \
gy1\\n\\n-gy1 -> fy1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx6 \
-> tx8\\n\\n2. kb tx8 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[OOZP_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\nCCode[#ifdef \
OOZP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ngy1 -> dhx1x1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
0, dhx1x1);]\\n\\ndhx1x1 -> \
dhy1y1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\n2. kb -> dhz1z1\\n\\nCCode[OOZP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);]\\n\\nCCode[#ifdef OOZP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ndhy1y1 -> \
ohx1y1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\nohx1y1 -> \
ohx1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\nohx1z1 -> \
ohy1z1\\n\\nCCode[OOZP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
OOZP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* OOZP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* OOZP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593245595*^9},ExpressionUUID->"7229217c-6a8f-4780-aef5-\
6878776328ca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing declares to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Oozp_termDeclares.cc\"\>"}],
  SequenceForm["Writing declares to file: ", "_Oozp_termDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593305251*^9},ExpressionUUID->"06e0a486-02ae-4f8d-9755-\
bdabaa0045b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing code to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Oozp_termCode.cc\"\>"}],
  SequenceForm["Writing code to file: ", "_Oozp_termCode.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.7746190642687263`*^9, 3.7746191160893*^9, 
  3.774619182590453*^9, 3.774620723986932*^9, 
  3.774621593310532*^9},ExpressionUUID->"b9a1912f-c897-4a1d-a9a9-\
8b860dcbc88d"]
}, Open  ]]
}, Open  ]],

Cell["\<\
Draw an evaluation tree for the optimized \"C\" code.  It doesn' t do \
anything useful but it looks impressive - I have got to print some of these \
on large format posters.

Inputs (independent variables and parameters) are on the left and drawn in \
Black, and outputs are on the right and also drawn in Black. Computationally \
expensive functions are highlighted in red, Plus functions are blue and Times \
functions are green.\
\>", "Subsection",
 CellChangeTimes->{{3.494844130294557*^9, 3.494844200819201*^9}, {
  3.494844239453156*^9, 3.494844307388302*^9}, {3.494844349909049*^9, 
  3.494844362349473*^9}, {3.494844417981534*^9, 
  3.49484444617253*^9}},ExpressionUUID->"d85419f9-f6ab-47b9-9980-\
3a9d88d220c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "oozpPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 
   3.774618554964554*^9},ExpressionUUID->"da94a614-58b0-482f-9c2c-\
09b6822c7db4"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], ":", 
  " ", "\<\"Part \[NoBreak]\\!\\(\\*RowBox[{\\\"1\\\"}]\\)\[NoBreak] of \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\)\[NoBreak] does not \
exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.774619098544506*^9, 3.774619117303034*^9}, 
   3.77461918471496*^9, 3.77461969410402*^9, 3.774620726392139*^9, 
   3.774621593848895*^9},ExpressionUUID->"cd15bce2-ee98-4fd7-b5a5-\
4ef8456d5993"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], ":", 
  " ", "\<\"Part \[NoBreak]\\!\\(\\*RowBox[{\\\"1\\\"}]\\)\[NoBreak] of \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", \\\"}\\\"}]\\)\[NoBreak] does not \
exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.774619098544506*^9, 3.774619117303034*^9}, 
   3.77461918471496*^9, 3.77461969410402*^9, 3.774620726392139*^9, 
   3.774621593876663*^9},ExpressionUUID->"319162e7-e6c3-4bd2-84e9-\
450d3560dab9"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], LineBox[{{0.06999999999999999, 7.5}, {0.03, 7.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 22.5}, {0.03, 22.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 6.}, {0.13, 7.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 6.}, {0.13, 22.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 5.}, {0.22999999999999998`, 6.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 7.5}, {0.22999999999999998`, 18.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.37000000000000005`, 7.5}, {0.33, 5.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.06999999999999999, 37.5}, {0.03, 37.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 30.}, {0.13, 37.5}}]}, 
   {GrayLevel[0], LineBox[{{0.17, 42.}, {0.13, 37.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 15.}, {0.22999999999999998`, 42.}}]}, 
   {GrayLevel[0], LineBox[{{0.27, 25.}, {0.22999999999999998`, 6.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 22.5}, {0.22999999999999998`, 18.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.37000000000000005`, 22.5}, {0.33, 25.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.47000000000000003`, 10.}, {0.43, 22.5}}]}, 
   {GrayLevel[0], LineBox[{{0.27, 35.}, {0.22999999999999998`, 42.}}]}, 
   {GrayLevel[0], LineBox[{{0.37000000000000005`, 37.5}, {0.33, 35.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 45.}, {0.22999999999999998`, 18.}}]}, 
   {GrayLevel[0], LineBox[{{0.47000000000000003`, 30.}, {0.43, 37.5}}]}, 
   {GrayLevel[0], LineBox[{{0.5700000000000001, 15.}, {0.53, 30.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 15.}, {0.63, 15.}}]}, 
   {GrayLevel[0], InsetBox["\<\"z1\"\>", {0., 7.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"OozpDeviation:Symbol\"\>", {0.1, 7.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"za\"\>", {0., 22.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx5:Times(-1)\"\>", {0.1, 22.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx6:Plus\"\>", {0.2, 6.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx7:power2\"\>", {0.30000000000000004, 5.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"kb\"\>", {0.2, 18.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"Energy:Times\"\>", {0.4, 7.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"{}[[1]]\"\>", {0., 37.5},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"gx1:Integer(0)\"\>", {0.1, 37.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx1:Times(-1)\"\>", {0.2, 30.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"gy1:Symbol\"\>", {0.2, 42.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy1:Times(-1)\"\>", {0.30000000000000004, 15.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx8:Symbol\"\>", {0.30000000000000004, 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz1:Times(2.)\"\>", {0.4, 22.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz1:Times(-1)\"\>", {0.5, 10.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhx1x1:Symbol\"\>", {0.30000000000000004, 35.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhy1y1:Symbol\"\>", {0.4, 37.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"dhz1z1:Times(2.)\"\>", {0.30000000000000004, 45.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx1y1:Symbol\"\>", {0.5, 30.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx1z1:Symbol\"\>", {0.6000000000000001, 15.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy1z1:Symbol\"\>", {0.7000000000000001, 15.},
     Background->Automatic]}},
  AspectRatio->0.41,
  ImageSize->{876.3906249999992, Automatic}]], "Output",
 CellChangeTimes->{{3.7746190985780783`*^9, 3.774619117341591*^9}, 
   3.774619184720943*^9, 3.774619694145761*^9, 3.774620726447775*^9, 
   3.774621593892301*^9},ExpressionUUID->"c8ada1eb-13c1-4800-b630-\
f314fee3c134"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Harmonic potential between a point and a line (specified by two points Xa, Xb) 
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.413903156136791*^9, 3.413903180058527*^9}, {
   3.413903223172472*^9, 3.4139032263211527`*^9}, 3.414009285999349*^9, {
   3.774622274896097*^9, 
   3.774622344769668*^9}},ExpressionUUID->"e1911cd3-0e16-4ce7-89eb-\
7925443f20a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "ka"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}, {
   3.413903983939694*^9, 3.413903984536366*^9}, 3.414009246563033*^9, 
   3.7746223696324873`*^9},ExpressionUUID->"216f22c8-83eb-4f7b-829e-\
16a5b07ceaf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bx", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xa", ",", " ", "ya", ",", " ", "za"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xb", ",", " ", "yb", ",", " ", "zb"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, 
   3.413903311971038*^9, {3.413903346593233*^9, 3.4139033527796583`*^9}, {
   3.413903458114628*^9, 3.4139034691386337`*^9}, {3.774622374674086*^9, 
   3.774622383212572*^9}},ExpressionUUID->"957c5682-b448-4275-93a1-\
5fea2f3d7431"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dtop", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bx", "-", "ba"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"bx", "-", "bb"}], ")"}]}], "]"}], ".", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bx", "-", "ba"}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{"bx", "-", "bb"}], ")"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
   3.411152033364759*^9, 3.411152034157058*^9}, 3.4139031925379553`*^9, {
   3.4139033180069942`*^9, 3.41390332309116*^9}, {3.413903471689744*^9, 
   3.4139034758767776`*^9}, {3.413904038061068*^9, 3.4139040413677464`*^9}, {
   3.774622405510702*^9, 3.7746224443247747`*^9}, {3.774622483883246*^9, 
   3.774622547838169*^9}},ExpressionUUID->"0f2cb3fb-5e2a-423b-a49e-\
7bd83017c0f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Sqrt]", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "xa"}], " ", "y1"}], "+", 
       RowBox[{"xb", " ", "y1"}], "+", 
       RowBox[{"x1", " ", "ya"}], "-", 
       RowBox[{"xb", " ", "ya"}], "-", 
       RowBox[{"x1", " ", "yb"}], "+", 
       RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xa", " ", "z1"}], "-", 
       RowBox[{"xb", " ", "z1"}], "-", 
       RowBox[{"x1", " ", "za"}], "+", 
       RowBox[{"xb", " ", "za"}], "+", 
       RowBox[{"x1", " ", "zb"}], "-", 
       RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "ya"}], " ", "z1"}], "+", 
       RowBox[{"yb", " ", "z1"}], "+", 
       RowBox[{"y1", " ", "za"}], "-", 
       RowBox[{"yb", " ", "za"}], "-", 
       RowBox[{"y1", " ", "zb"}], "+", 
       RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "Input",
 NumberMarks->False,ExpressionUUID->"1c32c68a-ba47-42dc-819f-b1b0f6301e5f"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "xa"}], " ", "y1"}], "+", 
      RowBox[{"xb", " ", "y1"}], "+", 
      RowBox[{"x1", " ", "ya"}], "-", 
      RowBox[{"xb", " ", "ya"}], "-", 
      RowBox[{"x1", " ", "yb"}], "+", 
      RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xa", " ", "z1"}], "-", 
      RowBox[{"xb", " ", "z1"}], "-", 
      RowBox[{"x1", " ", "za"}], "+", 
      RowBox[{"xb", " ", "za"}], "+", 
      RowBox[{"x1", " ", "zb"}], "-", 
      RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "ya"}], " ", "z1"}], "+", 
      RowBox[{"yb", " ", "z1"}], "+", 
      RowBox[{"y1", " ", "za"}], "-", 
      RowBox[{"yb", " ", "za"}], "-", 
      RowBox[{"y1", " ", "zb"}], "+", 
      RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.774622634629136*^9, 3.7746229807528677`*^9, 
  3.774623145472986*^9},ExpressionUUID->"f2a7825c-9145-49a3-b16d-\
6c51a6ce9923"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dbottom", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bb", "-", "ba"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"bb", "-", "ba"}], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7746225153571863`*^9, 
  3.77462257601959*^9}},ExpressionUUID->"9ccd23f5-31e5-457f-a13d-\
322f36cb0c2e"],

Cell[CellGroupData[{

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]], "Input",
 NumberMarks->False,ExpressionUUID->"a5b080b5-7676-4e93-a9d1-e463c189dca4"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.7746226395318403`*^9, 3.774622980801989*^9, 
  3.774623145596088*^9},ExpressionUUID->"8049d3ed-bf00-45ba-bb94-\
a9418821b7bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointToLineEnergyFn", " ", "=", "  ", 
  RowBox[{"ka", "  ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dtop", "/", "dbottom"}], "-", "ra"}], ")"}], "^", 
    "2"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.413903193205619*^9, 3.413903194259962*^9}, 3.413904044615448*^9, 
   3.414009238387752*^9, 3.416871858821822*^9, 3.4168720341302967`*^9, {
   3.774622590734497*^9, 3.774622596967214*^9}, {3.7746227901579647`*^9, 
   3.774622790729939*^9}, 3.7746229093197203`*^9, {3.774623133031693*^9, 
   3.7746231331314898`*^9}},ExpressionUUID->"84596d0c-af08-4482-b3eb-\
660f5b099729"],

Cell[BoxData[
 RowBox[{"ka", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "ra"}], "+", 
     FractionBox[
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xa"}], " ", "y1"}], "+", 
           RowBox[{"xb", " ", "y1"}], "+", 
           RowBox[{"x1", " ", "ya"}], "-", 
           RowBox[{"xb", " ", "ya"}], "-", 
           RowBox[{"x1", " ", "yb"}], "+", 
           RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xa", " ", "z1"}], "-", 
           RowBox[{"xb", " ", "z1"}], "-", 
           RowBox[{"x1", " ", "za"}], "+", 
           RowBox[{"xb", " ", "za"}], "+", 
           RowBox[{"x1", " ", "zb"}], "-", 
           RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "ya"}], " ", "z1"}], "+", 
           RowBox[{"yb", " ", "z1"}], "+", 
           RowBox[{"y1", " ", "za"}], "-", 
           RowBox[{"yb", " ", "za"}], "-", 
           RowBox[{"y1", " ", "zb"}], "+", 
           RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], ")"}], 
   "2"]}]], "Output",
 CellChangeTimes->{3.774622642462942*^9, 3.7746229808650503`*^9, 
  3.774623145689561*^9},ExpressionUUID->"ccd3db8d-68db-4444-8fd4-\
4199d09edbee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "bx", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{3.413903342754142*^9, 
  3.4139034818315573`*^9},ExpressionUUID->"60ed279c-0020-40ec-849d-\
2a9046d0cbcb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]], "Output",
 CellChangeTimes->{3.7746226766640167`*^9, 3.774622980919084*^9, 
  3.774623145775576*^9},ExpressionUUID->"48485fa5-7fe7-4198-9c3d-\
f692c88f4fda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 
  3.401714291927002*^9}},ExpressionUUID->"b630c207-9811-4dbf-a935-\
44cc6da0b53f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLineVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, 3.41390319489956*^9, {3.413903336781911*^9, 
   3.4139033375178556`*^9}, 
   3.77462291087077*^9},ExpressionUUID->"b6c4f516-a68b-4dc8-86f8-\
6b0c609f2e87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointToLineSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xa);\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);\>\"", 
     "]"}]}], "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xb);\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(yb);\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);\>\"", 
     "]"}]}], "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}, {3.413903195586742*^9, 3.413903197762012*^9}, {
  3.4139032725347033`*^9, 3.4139032733978243`*^9}, {3.413903365080594*^9, 
  3.413903400308832*^9}, {3.413903434469326*^9, 3.413903453516231*^9}, {
  3.414020790309948*^9, 3.4140208145575933`*^9}, {3.77462268748988*^9, 
  3.7746226976343803`*^9}, {3.77462281867039*^9, 3.7746228215269337`*^9}, {
  3.7746228549380217`*^9, 3.7746228577831078`*^9}, {3.7746229116154118`*^9, 
  3.774622916677209*^9}},ExpressionUUID->"a9cfde97-ddb6-4908-8a33-\
448455ede328"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "pointToLineVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<POINT_TO_LINE_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"pointToLineVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"pointToLineVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"pointToLineVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"pointToLineSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4139031985252733`*^9, 3.41390319966262*^9}, 
   3.413903273923324*^9, {3.41402126078249*^9, 3.414021262410028*^9}, 
   3.774622858727338*^9, {3.77462291754211*^9, 
   3.774622920839436*^9}},ExpressionUUID->"e088c280-1e67-49f8-a3d6-\
dc5054ccce1f"],

Cell[BoxData["\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], \
"Print",
 CellChangeTimes->{3.774622981006426*^9, 
  3.774623145922805*^9},ExpressionUUID->"a40c3a61-ccfa-47d1-a8d6-\
10c6c4ba37b2"],

Cell[BoxData["\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], \
"Print",
 CellChangeTimes->{3.774622981006426*^9, 
  3.774623145930277*^9},ExpressionUUID->"e84f3b5c-911d-40f3-99ca-\
5b94a4ba17f9"],

Cell[BoxData["\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], \
"Print",
 CellChangeTimes->{3.774622981006426*^9, 
  3.7746231459370623`*^9},ExpressionUUID->"aac3483d-4e98-4dbb-8b3e-\
4e7b526155bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointToLineSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.413903199910615*^9, 
   3.7746229221433973`*^9},ExpressionUUID->"6e3a1361-6e11-418f-86ae-\
32d90ce468cc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xa);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xb);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(yb);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(x1,I1,0);\"\>",
         "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(y1,I1,1);\"\>",
         "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);\"\>",
         "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7746229810645647`*^9, 
  3.7746231459919*^9},ExpressionUUID->"0f9f0f04-a99f-4188-87ee-7169d1ebeba5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointToLineEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointToLineOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "pointToLineEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<POINT_TO_LINE_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 3.411152028421866*^9}, {3.413903200311384*^9, 
   3.413903202186616*^9}, {3.4139032744344463`*^9, 3.413903295296754*^9}, {
   3.4140207972347403`*^9, 3.4140207987706137`*^9}, 3.774622870618577*^9, {
   3.774622923043041*^9, 3.774622928117185*^9}, 3.774622970565984*^9, {
   3.77462344178229*^9, 
   3.77462344229912*^9}},ExpressionUUID->"a40b46e8-8d16-464f-aee4-\
0bd267e62af8"]
}, Open  ]],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 
  3.408559038294833*^9}},ExpressionUUID->"690ceaa6-7f80-4d08-a085-\
d1355e1abf45"],

Cell[CellGroupData[{

Cell[BoxData["pointToLineEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.413903202602512*^9, 
   3.774622929684964*^9},ExpressionUUID->"4eaf5511-f42c-4baf-998c-\
b0c82ead7bd6"],

Cell[BoxData[
 RowBox[{"ka", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "ra"}], "+", 
     FractionBox[
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xa"}], " ", "y1"}], "+", 
           RowBox[{"xb", " ", "y1"}], "+", 
           RowBox[{"x1", " ", "ya"}], "-", 
           RowBox[{"xb", " ", "ya"}], "-", 
           RowBox[{"x1", " ", "yb"}], "+", 
           RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xa", " ", "z1"}], "-", 
           RowBox[{"xb", " ", "z1"}], "-", 
           RowBox[{"x1", " ", "za"}], "+", 
           RowBox[{"xb", " ", "za"}], "+", 
           RowBox[{"x1", " ", "zb"}], "-", 
           RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "ya"}], " ", "z1"}], "+", 
           RowBox[{"yb", " ", "z1"}], "+", 
           RowBox[{"y1", " ", "za"}], "-", 
           RowBox[{"yb", " ", "za"}], "-", 
           RowBox[{"y1", " ", "zb"}], "+", 
           RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], ")"}], 
   "2"]}]], "Output",
 CellChangeTimes->{3.774622981122279*^9, 
  3.774623146103656*^9},ExpressionUUID->"9bf9d397-aa00-4a89-b1ef-\
da023cc4755e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"pointToLineHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.413903202921104*^9, 
   3.7746229306816597`*^9},ExpressionUUID->"1386436e-e2c5-4667-87d0-\
8456c6abeee6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7746229811801*^9, 
  3.774623146191555*^9},ExpressionUUID->"8f22e64f-f138-48fa-921a-\
14b7426f48f7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLineForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.413903203137519*^9, 
   3.774622930928327*^9},ExpressionUUID->"b68e0a34-bca3-43ee-acab-\
bef2a6e2892a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<POINT_TO_LINE_RESTRAINT\>\"", ",", "pointToLineForceHessianRules", 
    ",", "pointToLineOutputs", ",", "pointToLineHessian", ",", 
    "pointToLineEnergyFn", ",", "pointToLineVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.413903203356204*^9, 3.4139032050483017`*^9}, 
   3.413903275122141*^9, {3.414021270983808*^9, 3.414021272512858*^9}, 
   3.774622871979638*^9, {3.774622931919929*^9, 
   3.774622934653015*^9}},ExpressionUUID->"a4eea477-b970-450a-ac49-\
e462576267c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointToLineHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 3.4139032057904243`*^9, 
   3.774622935813805*^9},ExpressionUUID->"9b582343-aad8-406b-8acb-\
61b7bc63b91e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"5", "8", "9", "0", "0", "0"},
     {"8", "6", "10", "0", "0", "0"},
     {"9", "10", "7", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.774622981784936*^9, 
  3.774623147224183*^9},ExpressionUUID->"4bcca96f-1d4c-41e1-af1c-\
86e9ff8071bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["pointToLineOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4139032064409513`*^9, 
   3.7746229366679773`*^9},ExpressionUUID->"8e679f38-fa53-4896-96c7-\
5208e3185127"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "dhx1x1", ",", "dhy1y1", 
   ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", ",", "ohy1z1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.77462298184301*^9, 
  3.774623147302514*^9},ExpressionUUID->"80d1acda-8016-4182-bcee-\
7e6d01181825"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"54bf2ce1-a97b-42d8-ac9b-\
f9b8c5d266d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLineAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "pointToLineSetupRules", ",", "\[IndentingNewLine]", 
     "pointToLineEnergyRules", ",", "\[IndentingNewLine]", 
     "pointToLineForceHessianRules"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.4139032071864157`*^9, 3.413903208348619*^9}, {3.7746229377919693`*^9, 
   3.7746229393676558`*^9}},ExpressionUUID->"f2b20cb6-1ad4-4ce2-a374-\
9521872030cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLineRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "pointToLineAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.41390320889892*^9, 3.413903209224545*^9}, {3.7746229399414454`*^9, 
  3.7746229405700073`*^9}},ExpressionUUID->"4d5bfe03-8d22-48c2-8e2f-\
fee5e1105709"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pointToLineRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 3.411210898002816*^9}, 
   3.413903209717396*^9, {3.4139040641107597`*^9, 3.413904066184003*^9}, 
   3.774622941211828*^9},ExpressionUUID->"294dc2ea-bc6e-4f72-823d-\
041a33df6363"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xa);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xb);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(yb);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(x1,I1,0);\"\>",
         "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(y1,I1,1);\"\>",
         "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);\"\>",
         "]"}]},
      {
       RowBox[{"pointToLineDeviation", "\[Rule]", "PointToLineDeviation"}]},
      {
       RowBox[{
        RowBox[{"ka", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ra"}], "+", 
            FractionBox[
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                  RowBox[{"xb", " ", "y1"}], "+", 
                  RowBox[{"x1", " ", "ya"}], "-", 
                  RowBox[{"xb", " ", "ya"}], "-", 
                  RowBox[{"x1", " ", "yb"}], "+", 
                  RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xa", " ", "z1"}], "-", 
                  RowBox[{"xb", " ", "z1"}], "-", 
                  RowBox[{"x1", " ", "za"}], "+", 
                  RowBox[{"xb", " ", "za"}], "+", 
                  RowBox[{"x1", " ", "zb"}], "-", 
                  RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                  RowBox[{"yb", " ", "z1"}], "+", 
                  RowBox[{"y1", " ", "za"}], "-", 
                  RowBox[{"yb", " ", "za"}], "-", 
                  RowBox[{"y1", " ", "zb"}], "+", 
                  RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], ")"}], 
          "2"]}], "\[Rule]", "Energy"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE //[\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"ka", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"ya", "-", "yb"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "xa"}], " ", "y1"}], "+", 
               RowBox[{"xb", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "ya"}], "-", 
               RowBox[{"xb", " ", "ya"}], "-", 
               RowBox[{"x1", " ", "yb"}], "+", 
               RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xa", " ", "z1"}], "-", 
               RowBox[{"xb", " ", "z1"}], "-", 
               RowBox[{"x1", " ", "za"}], "+", 
               RowBox[{"xb", " ", "za"}], "+", 
               RowBox[{"x1", " ", "zb"}], "-", 
               RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ra"}], "+", 
            FractionBox[
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                  RowBox[{"xb", " ", "y1"}], "+", 
                  RowBox[{"x1", " ", "ya"}], "-", 
                  RowBox[{"xb", " ", "ya"}], "-", 
                  RowBox[{"x1", " ", "yb"}], "+", 
                  RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xa", " ", "z1"}], "-", 
                  RowBox[{"xb", " ", "z1"}], "-", 
                  RowBox[{"x1", " ", "za"}], "+", 
                  RowBox[{"xb", " ", "za"}], "+", 
                  RowBox[{"x1", " ", "zb"}], "-", 
                  RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                  RowBox[{"yb", " ", "z1"}], "+", 
                  RowBox[{"y1", " ", "za"}], "-", 
                  RowBox[{"yb", " ", "za"}], "-", 
                  RowBox[{"y1", " ", "zb"}], "+", 
                  RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
           ")"}]}], 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "xa"}], " ", "y1"}], "+", 
               RowBox[{"xb", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "ya"}], "-", 
               RowBox[{"xb", " ", "ya"}], "-", 
               RowBox[{"x1", " ", "yb"}], "+", 
               RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xa", " ", "z1"}], "-", 
               RowBox[{"xb", " ", "z1"}], "-", 
               RowBox[{"x1", " ", "za"}], "+", 
               RowBox[{"xb", " ", "za"}], "+", 
               RowBox[{"x1", " ", "zb"}], "-", 
               RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "ya"}], " ", "z1"}], "+", 
               RowBox[{"yb", " ", "z1"}], "+", 
               RowBox[{"y1", " ", "za"}], "-", 
               RowBox[{"yb", " ", "za"}], "-", 
               RowBox[{"y1", " ", "zb"}], "+", 
               RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]], "\[Rule]", 
        "gx1"}]},
      {
       RowBox[{
        RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>",
         "]"}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"ka", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "xa"}], " ", "y1"}], "+", 
               RowBox[{"xb", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "ya"}], "-", 
               RowBox[{"xb", " ", "ya"}], "-", 
               RowBox[{"x1", " ", "yb"}], "+", 
               RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"za", "-", "zb"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "ya"}], " ", "z1"}], "+", 
               RowBox[{"yb", " ", "z1"}], "+", 
               RowBox[{"y1", " ", "za"}], "-", 
               RowBox[{"yb", " ", "za"}], "-", 
               RowBox[{"y1", " ", "zb"}], "+", 
               RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ra"}], "+", 
            FractionBox[
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                  RowBox[{"xb", " ", "y1"}], "+", 
                  RowBox[{"x1", " ", "ya"}], "-", 
                  RowBox[{"xb", " ", "ya"}], "-", 
                  RowBox[{"x1", " ", "yb"}], "+", 
                  RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xa", " ", "z1"}], "-", 
                  RowBox[{"xb", " ", "z1"}], "-", 
                  RowBox[{"x1", " ", "za"}], "+", 
                  RowBox[{"xb", " ", "za"}], "+", 
                  RowBox[{"x1", " ", "zb"}], "-", 
                  RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                  RowBox[{"yb", " ", "z1"}], "+", 
                  RowBox[{"y1", " ", "za"}], "-", 
                  RowBox[{"yb", " ", "za"}], "-", 
                  RowBox[{"y1", " ", "zb"}], "+", 
                  RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
           ")"}]}], 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "xa"}], " ", "y1"}], "+", 
               RowBox[{"xb", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "ya"}], "-", 
               RowBox[{"xb", " ", "ya"}], "-", 
               RowBox[{"x1", " ", "yb"}], "+", 
               RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xa", " ", "z1"}], "-", 
               RowBox[{"xb", " ", "z1"}], "-", 
               RowBox[{"x1", " ", "za"}], "+", 
               RowBox[{"xb", " ", "za"}], "+", 
               RowBox[{"x1", " ", "zb"}], "-", 
               RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "ya"}], " ", "z1"}], "+", 
               RowBox[{"yb", " ", "z1"}], "+", 
               RowBox[{"y1", " ", "za"}], "-", 
               RowBox[{"yb", " ", "za"}], "-", 
               RowBox[{"y1", " ", "zb"}], "+", 
               RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]], "\[Rule]", 
        "gy1"}]},
      {
       RowBox[{
        RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>",
         "]"}]},
      {
       RowBox[{
        FractionBox[
         RowBox[{"ka", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"xa", "-", "xb"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xa", " ", "z1"}], "-", 
               RowBox[{"xb", " ", "z1"}], "-", 
               RowBox[{"x1", " ", "za"}], "+", 
               RowBox[{"xb", " ", "za"}], "+", 
               RowBox[{"x1", " ", "zb"}], "-", 
               RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "ya"}], " ", "z1"}], "+", 
               RowBox[{"yb", " ", "z1"}], "+", 
               RowBox[{"y1", " ", "za"}], "-", 
               RowBox[{"yb", " ", "za"}], "-", 
               RowBox[{"y1", " ", "zb"}], "+", 
               RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ra"}], "+", 
            FractionBox[
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                  RowBox[{"xb", " ", "y1"}], "+", 
                  RowBox[{"x1", " ", "ya"}], "-", 
                  RowBox[{"xb", " ", "ya"}], "-", 
                  RowBox[{"x1", " ", "yb"}], "+", 
                  RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"xa", " ", "z1"}], "-", 
                  RowBox[{"xb", " ", "z1"}], "-", 
                  RowBox[{"x1", " ", "za"}], "+", 
                  RowBox[{"xb", " ", "za"}], "+", 
                  RowBox[{"x1", " ", "zb"}], "-", 
                  RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                  RowBox[{"yb", " ", "z1"}], "+", 
                  RowBox[{"y1", " ", "za"}], "-", 
                  RowBox[{"yb", " ", "za"}], "-", 
                  RowBox[{"y1", " ", "zb"}], "+", 
                  RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
           ")"}]}], 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "xa"}], " ", "y1"}], "+", 
               RowBox[{"xb", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "ya"}], "-", 
               RowBox[{"xb", " ", "ya"}], "-", 
               RowBox[{"x1", " ", "yb"}], "+", 
               RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xa", " ", "z1"}], "-", 
               RowBox[{"xb", " ", "z1"}], "-", 
               RowBox[{"x1", " ", "za"}], "+", 
               RowBox[{"xb", " ", "za"}], "+", 
               RowBox[{"x1", " ", "zb"}], "-", 
               RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "ya"}], " ", "z1"}], "+", 
               RowBox[{"yb", " ", "z1"}], "+", 
               RowBox[{"y1", " ", "za"}], "-", 
               RowBox[{"yb", " ", "za"}], "-", 
               RowBox[{"y1", " ", "zb"}], "+", 
               RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]], "\[Rule]", 
        "gz1"}]},
      {
       RowBox[{
        RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>",
         "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"ka", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ya", "-", "yb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], "2"]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"ka", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"ya", "-", "yb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"ya", "-", "yb"}], ")"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]]}], "\[Rule]", 
        "dhx1x1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 0, dhx1x1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"ka", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"za", "-", "zb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], "2"]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"ka", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"za", "-", "zb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"za", "-", "zb"}], ")"}], "2"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]]}], "\[Rule]", 
        "dhy1y1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"ka", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"xa", "-", "xb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], "2"]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"ka", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"xa", "-", "xb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"xa", "-", "xb"}], ")"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"]}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]]}], "\[Rule]", 
        "dhz1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, \
I1, 2, dhz1z1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#ifdef POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN \
//[\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ya", "-", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"za", "-", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ya", "-", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"za", "-", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"ya", "-", "yb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]]}], "\[Rule]", 
        "ohx1y1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 1, ohx1y1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ya", "-", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"xa", "-", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"ya", "-", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"xa", "-", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "ka", " ", 
           RowBox[{"(", 
            RowBox[{"xa", "-", "xb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "za"}], "+", "zb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]]}], "\[Rule]", 
        "ohx1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 2, ohx1z1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"xa", "-", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"za", "-", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}]}], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}]}]], "-", 
         FractionBox[
          RowBox[{"ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"xa", "-", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"za", "-", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                 RowBox[{"xb", " ", "y1"}], "+", 
                 RowBox[{"x1", " ", "ya"}], "-", 
                 RowBox[{"xb", " ", "ya"}], "-", 
                 RowBox[{"x1", " ", "yb"}], "+", 
                 RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xa", " ", "z1"}], "-", 
                 RowBox[{"xb", " ", "z1"}], "-", 
                 RowBox[{"x1", " ", "za"}], "+", 
                 RowBox[{"xb", " ", "za"}], "+", 
                 RowBox[{"x1", " ", "zb"}], "-", 
                 RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                 RowBox[{"yb", " ", "z1"}], "+", 
                 RowBox[{"y1", " ", "za"}], "-", 
                 RowBox[{"yb", " ", "za"}], "-", 
                 RowBox[{"y1", " ", "zb"}], "+", 
                 RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]}]], "+", 
         FractionBox[
          RowBox[{"2", " ", "ka", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ya"}], "+", "yb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"za", "-", "zb"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "ra"}], "+", 
             FractionBox[
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                   RowBox[{"xb", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "ya"}], "-", 
                   RowBox[{"xb", " ", "ya"}], "-", 
                   RowBox[{"x1", " ", "yb"}], "+", 
                   RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"xa", " ", "z1"}], "-", 
                   RowBox[{"xb", " ", "z1"}], "-", 
                   RowBox[{"x1", " ", "za"}], "+", 
                   RowBox[{"xb", " ", "za"}], "+", 
                   RowBox[{"x1", " ", "zb"}], "-", 
                   RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                   RowBox[{"yb", " ", "z1"}], "+", 
                   RowBox[{"y1", " ", "za"}], "-", 
                   RowBox[{"yb", " ", "za"}], "-", 
                   RowBox[{"y1", " ", "zb"}], "+", 
                   RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]], 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]]]}], 
            ")"}]}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "xa"}], "+", "xb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "ya"}], "+", "yb"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "za"}], "+", "zb"}], ")"}], "2"]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xa"}], " ", "y1"}], "+", 
                RowBox[{"xb", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "ya"}], "-", 
                RowBox[{"xb", " ", "ya"}], "-", 
                RowBox[{"x1", " ", "yb"}], "+", 
                RowBox[{"xa", " ", "yb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xa", " ", "z1"}], "-", 
                RowBox[{"xb", " ", "z1"}], "-", 
                RowBox[{"x1", " ", "za"}], "+", 
                RowBox[{"xb", " ", "za"}], "+", 
                RowBox[{"x1", " ", "zb"}], "-", 
                RowBox[{"xa", " ", "zb"}]}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "ya"}], " ", "z1"}], "+", 
                RowBox[{"yb", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "za"}], "-", 
                RowBox[{"yb", " ", "za"}], "-", 
                RowBox[{"y1", " ", "zb"}], "+", 
                RowBox[{"ya", " ", "zb"}]}], ")"}], "2"]}]]}]]}], "\[Rule]", 
        "ohy1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
1, I1, 2, ohy1z1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN \
]*/\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/\
\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE ]*/\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.774622981944624*^9, 
  3.774623147424683*^9},ExpressionUUID->"484d3498-33ed-4c2d-b4a0-\
3682afd724f8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLineInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "xa", ",", "ya", ",", "za", ",", "xb", 
     ",", "yb", ",", "zb", ",", "ka", ",", "ra"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.413903210219502*^9, {
   3.413903523135522*^9, 3.4139035304924097`*^9}, {3.414009254249028*^9, 
   3.4140092544270477`*^9}, {3.774622734089033*^9, 3.774622736584938*^9}, {
   3.774622837962113*^9, 3.7746228382419977`*^9}, 
   3.774622941855591*^9},ExpressionUUID->"ffeb086d-42cc-4124-a1cb-\
dd098c459d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"pointToLineOutputs", ",", "PointToLineDeviation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 3.411152052756624*^9}, 
   3.413903210688085*^9, 3.413903296414403*^9, {3.774622943171233*^9, 
   3.77462297153229*^9}},ExpressionUUID->"5bf34cf6-a3f5-42ae-9674-\
896e8f83c2c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLinePack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<PointToLineRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "pointToLineHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "pointToLineRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "pointToLineInput"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "pointToLineOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9, {3.4139032111233997`*^9, 3.413903213486709*^9}, 
   3.413903298323092*^9, 3.413903540538962*^9, {3.4140187475989857`*^9, 
   3.41401874899977*^9}, {3.774622944125702*^9, 
   3.774622972667295*^9}},ExpressionUUID->"15794cbd-d819-4d9c-82f4-\
b172fc964652"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "pointToLinePack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 3.4110670621890917`*^9, 
   3.413903214952401*^9, 
   3.7746229480305443`*^9},ExpressionUUID->"c02aa680-e3c7-4ae4-b996-\
c0691378d843"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing finite difference debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_PointToLineRestraint_debugFiniteDifference.cc\"\
\>"}],
  SequenceForm[
  "Writing finite difference debug code to: ", 
   "_PointToLineRestraint_debugFiniteDifference.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774622981992518*^9, 
  3.7746231475431767`*^9},ExpressionUUID->"311eb291-14bd-4cf4-b4ba-\
6ad0b79bf9f1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing debug variable declares to: \"\>", 
   "\[InvisibleSpace]", "\<\"_PointToLineRestraint_debugEvalDeclares.cc\"\>"}],
  SequenceForm[
  "Writing debug variable declares to: ", 
   "_PointToLineRestraint_debugEvalDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774622981992518*^9, 
  3.774623147552297*^9},ExpressionUUID->"c6dc06d3-9084-45f7-9b99-\
85739b117ab5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing xml output debug code to: \"\>", 
   "\[InvisibleSpace]", \
"\<\"_PointToLineRestraint_debugEvalSerialize.cc\"\>"}],
  SequenceForm[
  "Writing xml output debug code to: ", 
   "_PointToLineRestraint_debugEvalSerialize.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774622981992518*^9, 
  3.774623147557096*^9},ExpressionUUID->"b8257c73-0c08-42df-86a1-\
47b6b8867b28"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing set variables debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_PointToLineRestraint_debugEvalSet.cc\"\>"}],
  SequenceForm[
  "Writing set variables debug code to: ", 
   "_PointToLineRestraint_debugEvalSet.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774622981992518*^9, 
  3.774623147561597*^9},ExpressionUUID->"2fb15da9-8bdb-494e-9efb-\
2f43b53c3d54"]
}, Open  ]],

Cell["\<\
pointToLinePack = Block[{PrintTemporary = Print}, \
packOptimize[pointToLinePack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.413903215882161*^9, 
   3.4139032166104527`*^9}, {3.77462294864622*^9, 
   3.7746229491324873`*^9}},ExpressionUUID->"01f4c3ba-a397-4574-a553-\
a150aaca596a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pointToLinePack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "pointToLinePack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}, {3.4139032174258947`*^9, 3.413903217685163*^9}, {
   3.7746229495828133`*^9, 
   3.774622949920102*^9}},ExpressionUUID->"2ec0963f-6f13-4043-9c58-\
b09df6efdce1"],

Cell[BoxData[
 StyleBox["\<\"Set TimesSimplify and PlusSimplify to turn these \
simplifications off and on\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->24,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623147646649*^9},ExpressionUUID->"eb70e565-0465-4f54-9084-\
8e40de00ac36"],

Cell[BoxData[
 StyleBox["\<\"PlusOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623147653926*^9},ExpressionUUID->"62d59456-05d7-4f85-8889-\
34f7bda6914f"],

Cell[BoxData[
 StyleBox["\<\"TimesOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623147661187*^9},ExpressionUUID->"a35422e9-600f-49e2-96bd-\
0fd8cda954f8"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623155995743*^9},ExpressionUUID->"997586bd-8ad1-4907-81d7-\
59cb6d77c3f3"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623156002836*^9},ExpressionUUID->"a6f8489c-9e11-4a24-8160-\
96c3fab95473"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623156007896*^9},ExpressionUUID->"c20a33db-002a-42f3-aa8d-\
508d66dc397b"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231560129128`*^9},ExpressionUUID->"73200e03-df70-4c28-ada6-\
36556ebc6e00"],

Cell[BoxData["\<\"After removal: \
\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\n\\n\\nCCode[\
POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);]\\n\\n\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xa);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(ya);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\\
n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xb);]\\n\\n\\n\\nCCode[\
POINT_TO_LINE_RESTRAINT_SET_PARAMETER(yb);]\\n\\n\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(zb);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(I1);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(x1,I1,0)\
;]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(y1,I1,1);]\\n\\n\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\\n\\n\\n\\\
npointToLineDeviation -> PointToLineDeviation\\n\\n\\n\\n-xa -> \
tx1\\n\\n\\n\\n-(xa y1) -> tx2\\n\\n\\n\\nxb y1 -> tx3\\n\\n\\n\\n-ya -> \
tx4\\n\\n\\n\\nx1 ya -> tx5\\n\\n\\n\\n-(xb ya) -> tx6\\n\\n\\n\\n-(x1 yb) -> \
tx7\\n\\n\\n\\nxa yb -> tx8\\n\\n\\n\\nxa z1 -> tx9\\n\\n\\n\\n-(xb z1) -> \
tx10\\n\\n\\n\\n-(ya z1) -> tx11\\n\\n\\n\\nyb z1 -> tx12\\n\\n\\n\\n-za -> \
tx13\\n\\n\\n\\n-(x1 za) -> tx14\\n\\n\\n\\nxb za -> tx15\\n\\n\\n\\ny1 za -> \
tx16\\n\\n\\n\\n-(yb za) -> tx17\\n\\n\\n\\nx1 zb -> tx18\\n\\n\\n\\n-(xa zb) \
-> tx19\\n\\n\\n\\n-(y1 zb) -> tx20\\n\\n\\n\\nya zb -> tx21\\n\\n\\n\\ntx13 \
x1 -> tx22\\n\\n\\n\\ntx4 xb -> tx23\\n\\n\\n\\ntx1 y1 -> \
tx24\\n\\n\\n\\ntx13 yb -> tx25\\n\\n\\n\\ntx4 z1 -> tx26\\n\\n\\n\\ntx1 zb \
-> tx27\\n\\n\\n\\ntx12 + tx16 + tx20 + tx21 + tx25 + tx26 -> \
tx28\\n\\n\\n\\ntx23 + tx24 + tx3 + tx5 + tx7 + tx8 -> tx29\\n\\n\\n\\ntx10 + \
tx15 + tx18 + tx22 + tx27 + tx9 -> tx30\\n\\n\\n\\ntx1 + xb -> \
tx31\\n\\n\\n\\ntx4 + yb -> tx32\\n\\n\\n\\ntx13 + zb -> tx33\\n\\n\\n    \
2\\ntx28  -> tx34\\n\\n\\n    2\\ntx29  -> tx35\\n\\n\\n    2\\ntx30  -> tx36\
\\n\\n\\n    2\\ntx31  -> tx37\\n\\n\\n    2\\ntx32  -> tx38\\n\\n\\n    \
2\\ntx33  -> tx39\\n\\n\\n\\ntx34 + tx35 + tx36 -> tx40\\n\\n\\n\\ntx37 + \
tx38 + tx39 -> tx41\\n\\n\\n\\nSqrt[tx40] -> tx42\\n\\n    1\\n---------- -> \
tx43\\nSqrt[tx41]\\n\\n\\n\\n-ra -> tx44\\n\\n\\n\\ntx42 tx43 -> \
tx45\\n\\n\\n\\ntx44 + tx45 -> tx46\\n\\n\\n    2\\ntx46  -> \
tx47\\n\\n\\n\\nka tx47 -> \
Energy\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\\
n\\n\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE \
//[]\\n\\n\\n\\nCCode[if ( calcForce ) {]\\n\\n\\n\\n-yb -> \
tx48\\n\\n\\n\\ntx48 + ya -> tx49\\n\\n\\n\\n2 tx30 tx33 -> tx50\\n\\n\\n\\n2 \
tx29 tx49 -> tx51\\n\\n    1\\n---------- -> \
tx52\\nSqrt[tx40]\\n\\n\\n\\ntx50 + tx51 -> tx53\\n\\n\\n\\nka tx43 tx46 tx52 \
tx53 -> gx1\\n\\n\\n\\n-gx1 -> \
fx1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n\\n\\n-zb -> tx54\\n\\n\\n\\ntx54 + za -> tx55\\n\\n\\n\\n2 tx29 \
tx31 -> tx56\\n\\n\\n\\n2 tx28 tx55 -> tx57\\n\\n\\n\\ntx56 + tx57 -> tx58\\n\
\\n\\n\\nka tx43 tx46 tx52 tx58 -> gy1\\n\\n\\n\\n-gy1 -> \
fy1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n\\n\\n-xb -> tx59\\n\\n\\n\\ntx59 + xa -> tx60\\n\\n\\n\\n2 tx28 \
tx32 -> tx61\\n\\n\\n\\n2 tx30 tx60 -> tx62\\n\\n\\n\\ntx61 + tx62 -> tx63\\n\
\\n\\n\\nka tx43 tx46 tx52 tx63 -> gz1\\n\\n\\n\\n-gz1 -> \
fz1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\n\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\n\\n    2\\ntx49  -> \
tx64\\n\\n\\n\\n2 tx39 -> tx65\\n\\n\\n\\n2 tx64 -> tx66\\n\\n\\n    \
-(3/2)\\ntx40       -> tx67\\n\\n 1\\n---- -> tx68\\ntx40\\n\\n 1\\n---- -> \
tx69\\ntx41\\n\\n\\n    2\\ntx53  -> tx70\\n\\n\\n\\ntx65 + tx66 -> \
tx71\\n\\n-(ka tx43 tx46 tx67 tx70)\\n------------------------- -> tx72\\n    \
        2\\n\\nka tx68 tx69 tx70\\n----------------- -> tx73\\n        \
2\\n\\n\\n\\nka tx43 tx46 tx52 tx71 -> tx74\\n\\n\\n\\ntx72 + tx73 + tx74 -> \
dhx1x1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 0, I1, 0, dhx1x1);]\\n\\n\\n    2\\ntx55  -> tx75\\n\\n\\n\\n2 tx37 -> \
tx76\\n\\n\\n\\n2 tx75 -> tx77\\n\\n\\n    2\\ntx58  -> tx78\\n\\n\\n\\ntx76 \
+ tx77 -> tx79\\n\\n-(ka tx43 tx46 tx67 tx78)\\n------------------------- -> \
tx80\\n            2\\n\\nka tx68 tx69 tx78\\n----------------- -> tx81\\n    \
    2\\n\\n\\n\\nka tx43 tx46 tx52 tx79 -> tx82\\n\\n\\n\\ntx80 + tx81 + tx82 \
-> dhy1y1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\\n\\n    2\\ntx60  -> tx83\\n\\n\\n\\n2 \
tx38 -> tx84\\n\\n\\n\\n2 tx83 -> tx85\\n\\n\\n    2\\ntx63  -> tx86\\n\\n\\n\
\\ntx84 + tx85 -> tx87\\n\\n-(ka tx43 tx46 tx67 \
tx86)\\n------------------------- -> tx88\\n            2\\n\\nka tx68 tx69 \
tx86\\n----------------- -> tx89\\n        2\\n\\n\\n\\nka tx43 tx46 tx52 \
tx87 -> tx90\\n\\n\\n\\ntx88 + tx89 + tx90 -> \
dhz1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 2, I1, 2, dhz1z1);]\\n\\n\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\n\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n\\n\\n2 ka tx31 tx43 tx46 tx49 tx52 -> \
tx91\\n\\n-(ka tx43 tx46 tx53 tx58 tx67)\\n------------------------------ -> \
tx92\\n              2\\n\\nka tx53 tx58 tx68 tx69\\n---------------------- \
-> tx93\\n          2\\n\\n\\n\\ntx91 + tx92 + tx93 -> \
ohx1y1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 0, I1, 1, ohx1y1);]\\n\\n\\n\\n2 ka tx33 tx43 tx46 tx52 tx60 \
-> tx94\\n\\n-(ka tx43 tx46 tx53 tx63 tx67)\\n------------------------------ \
-> tx95\\n              2\\n\\nka tx53 tx63 tx68 \
tx69\\n---------------------- -> tx96\\n          2\\n\\n\\n\\ntx94 + tx95 + \
tx96 -> ohx1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 0, I1, 2, ohx1z1);]\\n\\n\\n\\n2 ka tx32 tx43 tx46 tx52 tx55 \
-> tx97\\n\\n-(ka tx43 tx46 tx58 tx63 tx67)\\n------------------------------ \
-> tx98\\n              2\\n\\nka tx58 tx63 tx68 \
tx69\\n---------------------- -> tx99\\n          2\\n\\n\\n\\ntx97 + tx98 + \
tx99 -> ohy1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 1, I1, 2, ohy1z1);]\\n\\n\\n\\nCCode[} /*if \
calcOffDiagonalHessian */ ]\\n\\n\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\n\\n\\nCCode[} \
/*calcDiagonalHessian */]\\n\\n\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\n\\n\\nCCode[} \
/*calcForce */]\\n\\n\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE \
]*/]\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623156019212*^9},ExpressionUUID->"fda65f79-75b9-487a-a331-\
4d9df4c99815"],

Cell[BoxData["\<\"Collecting terms\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623156095778*^9},ExpressionUUID->"9007655c-043f-4348-84c6-\
57c5ceb152fb"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], ":", 
  " ", "\<\"Tag \[NoBreak]\\!\\(\\*RowBox[{\\\"Times\\\"}]\\)\[NoBreak] in \
\[NoBreak]\\!\\(\\*RowBox[{\\\"Null\\\", \\\" \\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Name\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"PointToLineRestraint\\\\\\\"\\\"}], \\\",\\\", \
RowBox[{\\\"AdditionalCDeclares\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"\\\\\\\"\\\"}], \\\",\\\", RowBox[{\\\"DerivativeVariables\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"x1\\\", \\\",\\\", \
\\\"y1\\\", \\\",\\\", \\\"z1\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"HessianStructure\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"5\\\", \\\",\\\", \\\"8\\\", \
\\\",\\\", \\\"9\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"8\\\", \\\
\",\\\", \\\"6\\\", \\\",\\\", \\\"10\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"9\\\", \\\",\\\", \\\"10\\\", \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\
\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \\\
\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"Rules\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\
\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);\\\\\\\"\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);\\\\\\\"\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xa);\\\\\\\"\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);\\\\\\\"\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);\\\\\\\"\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"38\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \\\"\\\\\
\\\"#endif /* POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/\\\\\\\"\\\
\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \\\"\\\\\\\"} \
/*calcDiagonalHessian */\\\\\\\"\\\", \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"CCode\\\", \\\"[\\\", \\\"\\\\\\\"#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/\\\\\\\"\\\", \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \\\"\\\\\\\"} /*calcForce */\\\\\
\\\"\\\", \\\"]\\\"}], \\\",\\\", RowBox[{\\\"CCode\\\", \\\"[\\\", \
\\\"\\\\\\\"#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE ]*/\\\\\\\"\\\", \
\\\"]\\\"}]}], \\\"}\\\"}]}], \\\",\\\", RowBox[{\\\"Input\\\", \\\"\[Rule]\\\
\", RowBox[{\\\"{\\\", RowBox[{\\\"x1\\\", \\\",\\\", \\\"y1\\\", \\\",\\\", \
\\\"z1\\\", \\\",\\\", \\\"xa\\\", \\\",\\\", \\\"ya\\\", \\\",\\\", \\\"za\\\
\", \\\",\\\", \\\"xb\\\", \\\",\\\", \\\"yb\\\", \\\",\\\", \\\"zb\\\", \
\\\",\\\", \\\"ka\\\", \\\",\\\", \\\"ra\\\"}], \\\"}\\\"}]}], \\\",\\\", \
RowBox[{\\\"Output\\\", \\\"\[Rule]\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"Energy\\\", \\\",\\\", \\\"fx1\\\", \\\",\\\", \\\"fy1\\\", \\\",\
\\\", \\\"fz1\\\", \\\",\\\", \\\"dhx1x1\\\", \\\",\\\", \\\"dhy1y1\\\", \
\\\",\\\", \\\"dhz1z1\\\", \\\",\\\", \\\"ohx1y1\\\", \\\",\\\", \\\"ohx1z1\\\
\", \\\",\\\", \\\"ohy1z1\\\", \\\",\\\", \\\"PointToLineDeviation\\\"}], \
\\\"}\\\"}]}]}], \\\"}\\\"}]}]\\)\[NoBreak] is Protected. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.774622987809259*^9, 
  3.774623156103606*^9},ExpressionUUID->"ecfd7f68-11e7-4f6b-8c93-\
47b3254f1bcc"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164216861*^9},ExpressionUUID->"9b311dd0-3521-4701-b826-\
93d3d85912f1"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164222969*^9},ExpressionUUID->"2ec0022d-ca5c-45e1-9161-\
751220627b74"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164227923*^9},ExpressionUUID->"8a35d763-9f1b-4954-8b69-\
93c64af6a2f1"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164232945*^9},ExpressionUUID->"82ac8203-551a-43ff-9e3c-\
334b41e4e90c"],

Cell[BoxData["\<\"After removal: \
\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\n\\n\\nCCode[\
POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);]\\n\\n\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xa);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(ya);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\\
n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xb);]\\n\\n\\n\\nCCode[\
POINT_TO_LINE_RESTRAINT_SET_PARAMETER(yb);]\\n\\n\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(zb);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(I1);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(x1,I1,0)\
;]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(y1,I1,1);]\\n\\n\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\\n\\n\\n\\\
npointToLineDeviation -> PointToLineDeviation\\n\\n\\n\\n-xa -> \
tx100\\n\\n\\n\\n-(xa y1) -> tx101\\n\\n\\n\\nxb y1 -> tx102\\n\\n\\n\\n-ya \
-> tx103\\n\\n\\n\\nx1 ya -> tx104\\n\\n\\n\\n-(xb ya) -> \
tx105\\n\\n\\n\\n-(x1 yb) -> tx106\\n\\n\\n\\nxa yb -> tx107\\n\\n\\n\\nxa z1 \
-> tx108\\n\\n\\n\\n-(xb z1) -> tx109\\n\\n\\n\\n-(ya z1) -> \
tx110\\n\\n\\n\\nyb z1 -> tx111\\n\\n\\n\\n-za -> tx112\\n\\n\\n\\n-(x1 za) \
-> tx113\\n\\n\\n\\nxb za -> tx114\\n\\n\\n\\ny1 za -> tx115\\n\\n\\n\\n-(yb \
za) -> tx116\\n\\n\\n\\nx1 zb -> tx117\\n\\n\\n\\n-(xa zb) -> \
tx118\\n\\n\\n\\n-(y1 zb) -> tx119\\n\\n\\n\\nya zb -> tx120\\n\\n\\n\\ntx112 \
x1 -> tx121\\n\\n\\n\\ntx103 xb -> tx122\\n\\n\\n\\ntx100 y1 -> \
tx123\\n\\n\\n\\ntx112 yb -> tx124\\n\\n\\n\\ntx103 z1 -> \
tx125\\n\\n\\n\\ntx100 zb -> tx126\\n\\n\\n\\ntx102 + tx104 + tx106 + tx107 + \
tx122 + tx123 -> tx127\\n\\n\\n\\ntx111 + tx115 + tx119 + tx120 + tx124 + \
tx125 -> tx128\\n\\n\\n\\ntx108 + tx109 + tx114 + tx117 + tx121 + tx126 -> \
tx129\\n\\n\\n\\ntx100 + xb -> tx130\\n\\n\\n\\ntx103 + yb -> \
tx131\\n\\n\\n\\ntx112 + zb -> tx132\\n\\n\\n     2\\ntx127  -> \
tx133\\n\\n\\n     2\\ntx128  -> tx134\\n\\n\\n     2\\ntx129  -> tx135\\n\\n\
\\n     2\\ntx130  -> tx136\\n\\n\\n     2\\ntx131  -> tx137\\n\\n\\n     \
2\\ntx132  -> tx138\\n\\n\\n\\ntx133 + tx134 + tx135 -> \
tx139\\n\\n\\n\\ntx136 + tx137 + tx138 -> tx140\\n\\n\\n\\nSqrt[tx139] -> \
tx141\\n\\n     1\\n----------- -> tx142\\nSqrt[tx140]\\n\\n\\n\\n-ra -> \
tx143\\n\\n\\n\\ntx141 tx142 -> tx144\\n\\n\\n\\ntx143 + tx144 -> tx145\\n\\n\
\\n     2\\ntx145  -> tx146\\n\\n\\n\\nka tx146 -> \
Energy\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\\
n\\n\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE \
//[]\\n\\n\\n\\nCCode[if ( calcForce ) {]\\n\\n\\n\\n-yb -> \
tx147\\n\\n\\n\\ntx147 + ya -> tx148\\n\\n\\n\\n2 tx129 tx132 -> \
tx149\\n\\n\\n\\n2 tx127 tx148 -> tx150\\n\\n     1\\n----------- -> \
tx151\\nSqrt[tx139]\\n\\n\\n\\ntx149 + tx150 -> tx152\\n\\n\\n\\nka tx142 \
tx145 tx151 tx152 -> gx1\\n\\n\\n\\n-gx1 -> \
fx1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n\\n\\n-zb -> tx153\\n\\n\\n\\ntx153 + za -> tx154\\n\\n\\n\\n2 tx127 \
tx130 -> tx155\\n\\n\\n\\n2 tx128 tx154 -> tx156\\n\\n\\n\\ntx155 + tx156 -> \
tx157\\n\\n\\n\\nka tx142 tx145 tx151 tx157 -> gy1\\n\\n\\n\\n-gy1 -> \
fy1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n\\n\\n-xb -> tx158\\n\\n\\n\\ntx158 + xa -> tx159\\n\\n\\n\\n2 tx128 \
tx131 -> tx160\\n\\n\\n\\n2 tx129 tx159 -> tx161\\n\\n\\n\\ntx160 + tx161 -> \
tx162\\n\\n\\n\\nka tx142 tx145 tx151 tx162 -> gz1\\n\\n\\n\\n-gz1 -> \
fz1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\n\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\n\\n     2\\ntx148  \
-> tx163\\n\\n\\n\\n2 tx138 -> tx164\\n\\n\\n\\n2 tx163 -> tx165\\n\\n\\n     \
-(3/2)\\ntx139       -> tx166\\n\\n  1\\n----- -> tx167\\ntx139\\n\\n  \
1\\n----- -> tx168\\ntx140\\n\\n\\n     2\\ntx152  -> tx169\\n\\n\\n\\ntx164 \
+ tx165 -> tx170\\n\\n-(ka tx142 tx145 tx166 \
tx169)\\n----------------------------- -> tx171\\n              2\\n\\nka \
tx167 tx168 tx169\\n-------------------- -> tx172\\n         2\\n\\n\\n\\nka \
tx142 tx145 tx151 tx170 -> tx173\\n\\n\\n\\ntx171 + tx172 + tx173 -> \
dhx1x1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 0, I1, 0, dhx1x1);]\\n\\n\\n     2\\ntx154  -> tx174\\n\\n\\n\\n2 tx136 \
-> tx175\\n\\n\\n\\n2 tx174 -> tx176\\n\\n\\n     2\\ntx157  -> \
tx177\\n\\n\\n\\ntx175 + tx176 -> tx178\\n\\n-(ka tx142 tx145 tx166 \
tx177)\\n----------------------------- -> tx179\\n              2\\n\\nka \
tx167 tx168 tx177\\n-------------------- -> tx180\\n         2\\n\\n\\n\\nka \
tx142 tx145 tx151 tx178 -> tx181\\n\\n\\n\\ntx179 + tx180 + tx181 -> \
dhy1y1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 1, I1, 1, dhy1y1);]\\n\\n\\n     2\\ntx159  -> tx182\\n\\n\\n\\n2 tx137 \
-> tx183\\n\\n\\n\\n2 tx182 -> tx184\\n\\n\\n     2\\ntx162  -> \
tx185\\n\\n\\n\\ntx183 + tx184 -> tx186\\n\\n-(ka tx142 tx145 tx166 \
tx185)\\n----------------------------- -> tx187\\n              2\\n\\nka \
tx167 tx168 tx185\\n-------------------- -> tx188\\n         2\\n\\n\\n\\nka \
tx142 tx145 tx151 tx186 -> tx189\\n\\n\\n\\ntx187 + tx188 + tx189 -> \
dhz1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 2, I1, 2, dhz1z1);]\\n\\n\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\n\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n\\n\\n2 ka tx130 tx142 tx145 tx148 tx151 -> \
tx190\\n\\n-(ka tx142 tx145 tx152 tx157 \
tx166)\\n----------------------------------- -> tx191\\n                 2\\n\
\\nka tx152 tx157 tx167 tx168\\n-------------------------- -> tx192\\n        \
    2\\n\\n\\n\\ntx190 + tx191 + tx192 -> \
ohx1y1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 0, I1, 1, ohx1y1);]\\n\\n\\n\\n2 ka tx132 tx142 tx145 tx151 \
tx159 -> tx193\\n\\n-(ka tx142 tx145 tx152 tx162 \
tx166)\\n----------------------------------- -> tx194\\n                 2\\n\
\\nka tx152 tx162 tx167 tx168\\n-------------------------- -> tx195\\n        \
    2\\n\\n\\n\\ntx193 + tx194 + tx195 -> \
ohx1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 0, I1, 2, ohx1z1);]\\n\\n\\n\\n2 ka tx131 tx142 tx145 tx151 \
tx154 -> tx196\\n\\n-(ka tx142 tx145 tx157 tx162 \
tx166)\\n----------------------------------- -> tx197\\n                 2\\n\
\\nka tx157 tx162 tx167 tx168\\n-------------------------- -> tx198\\n        \
    2\\n\\n\\n\\ntx196 + tx197 + tx198 -> \
ohy1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 1, I1, 2, ohy1z1);]\\n\\n\\n\\nCCode[} /*if \
calcOffDiagonalHessian */ ]\\n\\n\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\n\\n\\nCCode[} \
/*calcDiagonalHessian */]\\n\\n\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\n\\n\\nCCode[} \
/*calcForce */]\\n\\n\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE \
]*/]\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164237706*^9},ExpressionUUID->"1954e49b-543b-463e-ac84-\
bde92510ddfb"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164749261*^9},ExpressionUUID->"d9e8f03a-2347-4360-a327-\
351f827589aa"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation, tx113 -> tx121, tx105 -> tx122, tx101 -> tx123, tx116 \
-> tx124, tx110 -> tx125, tx118 -> tx126}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164753703*^9},ExpressionUUID->"6a7362e9-cae6-4909-a344-\
09f5a0e8cfb6"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231647573347`*^9},ExpressionUUID->"cf7f1f22-c8a9-4f5e-972f-\
0f1a64a9338c"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\\n\\ntx113 -> tx121\\n\\ntx105 -> tx122\\n\\ntx101 -> \
tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 -> tx126\"\>"], \
"Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164761189*^9},ExpressionUUID->"e2e6d000-1648-4bfd-86d8-\
a42c9b45b7ce"],

Cell[BoxData["\<\"After removal: \
\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\n\\n\\nCCode[\
POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ra);]\\n\\n\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xa);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(ya);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\\
n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(xb);]\\n\\n\\n\\nCCode[\
POINT_TO_LINE_RESTRAINT_SET_PARAMETER(yb);]\\n\\n\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(zb);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(I1);]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(x1,I1,0)\
;]\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(y1,I1,1);]\\n\\n\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\\n\\n\\n\\\
npointToLineDeviation -> PointToLineDeviation\\n\\n\\n\\n-xa -> \
tx100\\n\\n\\n\\ntx100 y1 -> tx101\\n\\n\\n\\nxb y1 -> tx102\\n\\n\\n\\n-ya \
-> tx103\\n\\n\\n\\nx1 ya -> tx104\\n\\n\\n\\ntx103 xb -> \
tx105\\n\\n\\n\\n-(x1 yb) -> tx106\\n\\n\\n\\nxa yb -> tx107\\n\\n\\n\\nxa z1 \
-> tx108\\n\\n\\n\\n-(xb z1) -> tx109\\n\\n\\n\\ntx103 z1 -> \
tx110\\n\\n\\n\\nyb z1 -> tx111\\n\\n\\n\\n-za -> tx112\\n\\n\\n\\ntx112 x1 \
-> tx113\\n\\n\\n\\nxb za -> tx114\\n\\n\\n\\ny1 za -> tx115\\n\\n\\n\\ntx112 \
yb -> tx116\\n\\n\\n\\nx1 zb -> tx117\\n\\n\\n\\ntx100 zb -> \
tx118\\n\\n\\n\\n-(y1 zb) -> tx119\\n\\n\\n\\nya zb -> tx120\\n\\n\\n\\ntx113 \
-> tx121\\n\\n\\n\\ntx105 -> tx122\\n\\n\\n\\ntx101 -> tx123\\n\\n\\n\\ntx116 \
-> tx124\\n\\n\\n\\ntx110 -> tx125\\n\\n\\n\\ntx118 -> tx126\\n\\n\\n\\ntx102 \
+ tx104 + tx106 + tx107 + tx122 + tx123 -> tx127\\n\\n\\n\\ntx111 + tx115 + \
tx119 + tx120 + tx124 + tx125 -> tx128\\n\\n\\n\\ntx108 + tx109 + tx114 + \
tx117 + tx121 + tx126 -> tx129\\n\\n\\n\\ntx100 + xb -> \
tx130\\n\\n\\n\\ntx103 + yb -> tx131\\n\\n\\n\\ntx112 + zb -> \
tx132\\n\\n\\n\\npower2[tx127] -> tx133\\n\\n\\n\\npower2[tx128] -> \
tx134\\n\\n\\n\\npower2[tx129] -> tx135\\n\\n\\n\\npower2[tx130] -> \
tx136\\n\\n\\n\\npower2[tx131] -> tx137\\n\\n\\n\\npower2[tx132] -> \
tx138\\n\\n\\n\\ntx133 + tx134 + tx135 -> tx139\\n\\n\\n\\ntx136 + tx137 + \
tx138 -> tx140\\n\\n\\n\\nmysqrt[tx139] -> tx141\\n\\n\\n\\nmysqrt[tx140] -> \
tx199\\n\\n\\n\\nreciprocal[tx199] -> tx142\\n\\n\\n\\n-ra -> \
tx143\\n\\n\\n\\ntx141 tx142 -> tx144\\n\\n\\n\\ntx143 + tx144 -> tx145\\n\\n\
\\n\\npower2[tx145] -> tx146\\n\\n\\n\\nka tx146 -> \
Energy\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\\
n\\n\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE \
//[]\\n\\n\\n\\nCCode[if ( calcForce ) {]\\n\\n\\n\\n-yb -> \
tx147\\n\\n\\n\\ntx147 + ya -> tx148\\n\\n\\n\\n2. tx129 tx132 -> tx149\\n\\n\
\\n\\n2. tx127 tx148 -> tx150\\n\\n\\n\\nreciprocal[tx141] -> \
tx151\\n\\n\\n\\ntx149 + tx150 -> tx152\\n\\n\\n\\nka tx142 tx145 tx151 tx152 \
-> gx1\\n\\n\\n\\n-gx1 -> \
fx1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n\\n\\n-zb -> tx153\\n\\n\\n\\ntx153 + za -> tx154\\n\\n\\n\\n2. \
tx127 tx130 -> tx155\\n\\n\\n\\n2. tx128 tx154 -> tx156\\n\\n\\n\\ntx155 + \
tx156 -> tx157\\n\\n\\n\\nka tx142 tx145 tx151 tx157 -> gy1\\n\\n\\n\\n-gy1 \
-> fy1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n\\n\\n-xb -> tx158\\n\\n\\n\\ntx158 + xa -> tx159\\n\\n\\n\\n2. \
tx128 tx131 -> tx160\\n\\n\\n\\n2. tx129 tx159 -> tx161\\n\\n\\n\\ntx160 + \
tx161 -> tx162\\n\\n\\n\\nka tx142 tx145 tx151 tx162 -> gz1\\n\\n\\n\\n-gz1 \
-> fz1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\n\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\n\\n\\npower2[tx148] \
-> tx163\\n\\n\\n\\n2. tx138 -> tx164\\n\\n\\n\\n2. tx163 -> \
tx165\\n\\n\\n\\npower1[tx139] -> tx200\\n\\n  1\\n----- -> \
tx201\\ntx141\\n\\n  1\\n----- -> tx202\\ntx200\\n\\n\\n\\n1. tx201 tx202 -> \
tx166\\n\\n\\n\\nreciprocal[tx139] -> tx167\\n\\n\\n\\nreciprocal[tx140] -> \
tx168\\n\\n\\n\\npower2[tx152] -> tx169\\n\\n\\n\\ntx164 + tx165 -> \
tx170\\n\\n\\n\\n-0.5 ka tx142 tx145 tx166 tx169 -> tx171\\n\\n\\n\\n0.5 ka \
tx167 tx168 tx169 -> tx172\\n\\n\\n\\nka tx142 tx145 tx151 tx170 -> \
tx173\\n\\n\\n\\ntx171 + tx172 + tx173 -> \
dhx1x1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 0, I1, 0, dhx1x1);]\\n\\n\\n\\npower2[tx154] -> tx174\\n\\n\\n\\n2. tx136 \
-> tx175\\n\\n\\n\\n2. tx174 -> tx176\\n\\n\\n\\npower2[tx157] -> tx177\\n\\n\
\\n\\ntx175 + tx176 -> tx178\\n\\n\\n\\n-0.5 ka tx142 tx145 tx166 tx177 -> \
tx179\\n\\n\\n\\n0.5 ka tx167 tx168 tx177 -> tx180\\n\\n\\n\\nka tx142 tx145 \
tx151 tx178 -> tx181\\n\\n\\n\\ntx179 + tx180 + tx181 -> \
dhy1y1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 1, I1, 1, dhy1y1);]\\n\\n\\n\\npower2[tx159] -> tx182\\n\\n\\n\\n2. tx137 \
-> tx183\\n\\n\\n\\n2. tx182 -> tx184\\n\\n\\n\\npower2[tx162] -> tx185\\n\\n\
\\n\\ntx183 + tx184 -> tx186\\n\\n\\n\\n-0.5 ka tx142 tx145 tx166 tx185 -> \
tx187\\n\\n\\n\\n0.5 ka tx167 tx168 tx185 -> tx188\\n\\n\\n\\nka tx142 tx145 \
tx151 tx186 -> tx189\\n\\n\\n\\ntx187 + tx188 + tx189 -> \
dhz1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(\
I1, 2, I1, 2, dhz1z1);]\\n\\n\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\n\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n\\n\\n2. ka tx130 tx142 tx145 tx148 tx151 -> \
tx190\\n\\n\\n\\n-0.5 ka tx142 tx145 tx152 tx157 tx166 -> \
tx191\\n\\n\\n\\n0.5 ka tx152 tx157 tx167 tx168 -> tx192\\n\\n\\n\\ntx190 + \
tx191 + tx192 -> \
ohx1y1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 0, I1, 1, ohx1y1);]\\n\\n\\n\\n2. ka tx132 tx142 tx145 tx151 \
tx159 -> tx193\\n\\n\\n\\n-0.5 ka tx142 tx145 tx152 tx162 tx166 -> \
tx194\\n\\n\\n\\n0.5 ka tx152 tx162 tx167 tx168 -> tx195\\n\\n\\n\\ntx193 + \
tx194 + tx195 -> \
ohx1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 0, I1, 2, ohx1z1);]\\n\\n\\n\\n2. ka tx131 tx142 tx145 tx151 \
tx154 -> tx196\\n\\n\\n\\n-0.5 ka tx142 tx145 tx157 tx162 tx166 -> \
tx197\\n\\n\\n\\n0.5 ka tx157 tx162 tx167 tx168 -> tx198\\n\\n\\n\\ntx196 + \
tx197 + tx198 -> \
ohy1z1\\n\\n\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 1, I1, 2, ohy1z1);]\\n\\n\\n\\nCCode[} /*if \
calcOffDiagonalHessian */ ]\\n\\n\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\n\\n\\nCCode[} \
/*calcDiagonalHessian */]\\n\\n\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\n\\n\\nCCode[} \
/*calcForce */]\\n\\n\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE \
]*/]\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164764851*^9},ExpressionUUID->"cefcf4eb-d521-4d5b-a93a-\
063577a7ff1f"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231648385763`*^9},ExpressionUUID->"333dd3d6-0ce6-421a-a43a-\
135ab31796dc"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation, tx113 -> tx121, tx105 -> tx122, tx101 -> tx123, tx116 \
-> tx124, tx110 -> tx125, tx118 -> tx126, tx139 -> tx200, tx151 -> tx201, \
tx202 -> tx167}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164845837*^9},ExpressionUUID->"6635ebf6-75fb-4506-8bf9-\
863e69391c63"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231648504457`*^9},ExpressionUUID->"563f3136-5106-4860-a8d6-\
b5b5c68cbde6"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\\n\\ntx113 -> tx121\\n\\ntx105 -> tx122\\n\\ntx101 -> \
tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 -> tx126\\n\\ntx139 \
-> tx200\\n\\ntx151 -> tx201\\n\\ntx202 -> tx167\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623164854415*^9},ExpressionUUID->"4bc767fb-29d9-4aba-95b5-\
8fff1ccff688"],

Cell[BoxData["\<\"After removal: \
CCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(ra);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(xa);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(yb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_POSITION(x1,I1,0);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
POSITION(y1,I1,1);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\
\\n\\npointToLineDeviation -> PointToLineDeviation\\n\\n-xa -> \
tx100\\n\\ntx100 y1 -> tx101\\n\\nxb y1 -> tx102\\n\\n-ya -> tx103\\n\\nx1 ya \
-> tx104\\n\\ntx103 xb -> tx105\\n\\n-(x1 yb) -> tx106\\n\\nxa yb -> tx107\\n\
\\nxa z1 -> tx108\\n\\n-(xb z1) -> tx109\\n\\ntx103 z1 -> tx110\\n\\nyb z1 -> \
tx111\\n\\n-za -> tx112\\n\\ntx112 x1 -> tx113\\n\\nxb za -> tx114\\n\\ny1 za \
-> tx115\\n\\ntx112 yb -> tx116\\n\\nx1 zb -> tx117\\n\\ntx100 zb -> tx118\\n\
\\n-(y1 zb) -> tx119\\n\\nya zb -> tx120\\n\\ntx113 -> tx121\\n\\ntx105 -> \
tx122\\n\\ntx101 -> tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 \
-> tx126\\n\\ntx102 + tx104 + tx106 + tx107 + tx122 + tx123 -> \
tx127\\n\\ntx111 + tx115 + tx119 + tx120 + tx124 + tx125 -> tx128\\n\\ntx108 \
+ tx109 + tx114 + tx117 + tx121 + tx126 -> tx129\\n\\ntx100 + xb -> \
tx130\\n\\ntx103 + yb -> tx131\\n\\ntx112 + zb -> tx132\\n\\npower2[tx127] -> \
tx133\\n\\npower2[tx128] -> tx134\\n\\npower2[tx129] -> \
tx135\\n\\npower2[tx130] -> tx136\\n\\npower2[tx131] -> \
tx137\\n\\npower2[tx132] -> tx138\\n\\ntx133 + tx134 + tx135 -> \
tx139\\n\\ntx136 + tx137 + tx138 -> tx140\\n\\nmysqrt[tx139] -> \
tx141\\n\\nmysqrt[tx140] -> tx199\\n\\nreciprocal[tx199] -> tx142\\n\\n-ra -> \
tx143\\n\\ntx141 tx142 -> tx144\\n\\ntx143 + tx144 -> \
tx145\\n\\npower2[tx145] -> tx146\\n\\nka tx146 -> \
Energy\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\n\\\
nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE //[]\\n\\nCCode[if ( \
calcForce ) {]\\n\\n-yb -> tx147\\n\\ntx147 + ya -> tx148\\n\\n2. tx129 tx132 \
-> tx149\\n\\n2. tx127 tx148 -> tx150\\n\\nreciprocal[tx141] -> \
tx151\\n\\ntx149 + tx150 -> tx152\\n\\nka tx142 tx145 tx151 tx152 -> \
gx1\\n\\n-gx1 -> fx1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, \
0, fx1 );]\\n\\n-zb -> tx153\\n\\ntx153 + za -> tx154\\n\\n2. tx127 tx130 -> \
tx155\\n\\n2. tx128 tx154 -> tx156\\n\\ntx155 + tx156 -> tx157\\n\\nka tx142 \
tx145 tx151 tx157 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n-xb -> tx158\\n\\ntx158 + xa -> tx159\\n\\n2. tx128 tx131 -> \
tx160\\n\\n2. tx129 tx159 -> tx161\\n\\ntx160 + tx161 -> tx162\\n\\nka tx142 \
tx145 tx151 tx162 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\npower2[tx148] -> \
tx163\\n\\n2. tx138 -> tx164\\n\\n2. tx163 -> tx165\\n\\ntx139 -> \
tx200\\n\\ntx151 -> tx201\\n\\nreciprocal[tx200] -> tx202\\n\\ntx201 tx202 -> \
tx166\\n\\ntx202 -> tx167\\n\\nreciprocal[tx140] -> tx168\\n\\npower2[tx152] \
-> tx169\\n\\ntx164 + tx165 -> tx170\\n\\n-0.5 ka tx142 tx145 tx166 tx169 -> \
tx171\\n\\n0.5 ka tx167 tx168 tx169 -> tx172\\n\\nka tx142 tx145 tx170 tx201 \
-> tx173\\n\\ntx171 + tx172 + tx173 -> \
dhx1x1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 0, dhx1x1);]\\n\\npower2[tx154] -> tx174\\n\\n2. tx136 -> tx175\\n\\n2. \
tx174 -> tx176\\n\\npower2[tx157] -> tx177\\n\\ntx175 + tx176 -> \
tx178\\n\\n-0.5 ka tx142 tx145 tx166 tx177 -> tx179\\n\\n0.5 ka tx167 tx168 \
tx177 -> tx180\\n\\nka tx142 tx145 tx178 tx201 -> tx181\\n\\ntx179 + tx180 + \
tx181 -> dhy1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_\
ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\\npower2[tx159] -> tx182\\n\\n2. tx137 \
-> tx183\\n\\n2. tx182 -> tx184\\n\\npower2[tx162] -> tx185\\n\\ntx183 + \
tx184 -> tx186\\n\\n-0.5 ka tx142 tx145 tx166 tx185 -> tx187\\n\\n0.5 ka \
tx167 tx168 tx185 -> tx188\\n\\nka tx142 tx145 tx186 tx201 -> \
tx189\\n\\ntx187 + tx188 + tx189 -> \
dhz1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, \
I1, 2, dhz1z1);]\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n2. ka tx130 tx142 tx145 tx148 tx201 -> tx190\
\\n\\n-0.5 ka tx142 tx145 tx152 tx157 tx166 -> tx191\\n\\n0.5 ka tx152 tx157 \
tx167 tx168 -> tx192\\n\\ntx190 + tx191 + tx192 -> \
ohx1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 1, ohx1y1);]\\n\\n2. ka tx132 tx142 tx145 tx159 tx201 -> \
tx193\\n\\n-0.5 ka tx142 tx145 tx152 tx162 tx166 -> tx194\\n\\n0.5 ka tx152 \
tx162 tx167 tx168 -> tx195\\n\\ntx193 + tx194 + tx195 -> \
ohx1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 2, ohx1z1);]\\n\\n2. ka tx131 tx142 tx145 tx154 tx201 -> \
tx196\\n\\n-0.5 ka tx142 tx145 tx157 tx162 tx166 -> tx197\\n\\n0.5 ka tx157 \
tx162 tx167 tx168 -> tx198\\n\\ntx196 + tx197 + tx198 -> \
ohy1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
1, I1, 2, ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ \
]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\
\\n\\nCCode[} /*calcDiagonalHessian */]\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE ]*/]\"\>"], \
"Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.77462316485813*^9},ExpressionUUID->"97082cca-809b-4a8c-b386-dd51f3788f2f"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation, tx113 -> tx121, tx105 -> tx122, tx101 -> tx123, tx116 \
-> tx124, tx110 -> tx125, tx118 -> tx126, tx139 -> tx200, tx151 -> tx201, \
tx202 -> tx167}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231662598*^9},ExpressionUUID->"416dc337-6c92-4caf-8732-85e394a6e869"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166265243*^9},ExpressionUUID->"d773fdf9-d9ad-45c9-a252-\
286aae28805a"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\\n\\ntx113 -> tx121\\n\\ntx105 -> tx122\\n\\ntx101 -> \
tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 -> tx126\\n\\ntx139 \
-> tx200\\n\\ntx151 -> tx201\\n\\ntx202 -> tx167\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166270396*^9},ExpressionUUID->"62bd24eb-f3e6-4e9a-a79a-\
a055bafd0339"],

Cell[BoxData["\<\"After removal: \
CCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(ra);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(xa);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(yb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_POSITION(x1,I1,0);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
POSITION(y1,I1,1);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\
\\n\\npointToLineDeviation -> PointToLineDeviation\\n\\n-xa -> \
tx100\\n\\ntx100 y1 -> tx101\\n\\nxb y1 -> tx102\\n\\n-ya -> tx103\\n\\nx1 ya \
-> tx104\\n\\ntx103 xb -> tx105\\n\\n-(x1 yb) -> tx106\\n\\nxa yb -> tx107\\n\
\\nxa z1 -> tx108\\n\\n-(xb z1) -> tx109\\n\\ntx103 z1 -> tx110\\n\\nyb z1 -> \
tx111\\n\\n-za -> tx112\\n\\ntx112 x1 -> tx113\\n\\nxb za -> tx114\\n\\ny1 za \
-> tx115\\n\\ntx112 yb -> tx116\\n\\nx1 zb -> tx117\\n\\ntx100 zb -> tx118\\n\
\\n-(y1 zb) -> tx119\\n\\nya zb -> tx120\\n\\ntx113 -> tx121\\n\\ntx105 -> \
tx122\\n\\ntx101 -> tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 \
-> tx126\\n\\ntx102 + tx104 + tx106 + tx107 + tx122 + tx123 -> \
tx127\\n\\ntx111 + tx115 + tx119 + tx120 + tx124 + tx125 -> tx128\\n\\ntx108 \
+ tx109 + tx114 + tx117 + tx121 + tx126 -> tx129\\n\\ntx100 + xb -> \
tx130\\n\\ntx103 + yb -> tx131\\n\\ntx112 + zb -> tx132\\n\\npower2[tx127] -> \
tx133\\n\\npower2[tx128] -> tx134\\n\\npower2[tx129] -> \
tx135\\n\\npower2[tx130] -> tx136\\n\\npower2[tx131] -> \
tx137\\n\\npower2[tx132] -> tx138\\n\\ntx133 + tx134 + tx135 -> \
tx139\\n\\ntx136 + tx137 + tx138 -> tx140\\n\\nmysqrt[tx139] -> \
tx141\\n\\nmysqrt[tx140] -> tx199\\n\\nreciprocal[tx199] -> tx142\\n\\n-ra -> \
tx143\\n\\ntx141 tx142 -> tx144\\n\\ntx143 + tx144 -> \
tx145\\n\\npower2[tx145] -> tx146\\n\\nka tx146 -> \
Energy\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\n\\\
nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE //[]\\n\\nCCode[if ( \
calcForce ) {]\\n\\n-yb -> tx147\\n\\ntx147 + ya -> tx148\\n\\n2. tx129 -> \
tzz216\\n\\ntx132 tzz216 -> tx149\\n\\n2. tx127 -> tzz218\\n\\ntx148 tzz218 \
-> tx150\\n\\nreciprocal[tx141] -> tx151\\n\\ntx149 + tx150 -> \
tx152\\n\\ntx142 tx145 -> tzz203\\n\\nka tzz203 -> tzz204\\n\\ntx151 tzz204 \
-> tzz211\\n\\ntx152 tzz211 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n-zb -> tx153\\n\\ntx153 + za -> tx154\\n\\ntx130 tzz218 -> \
tx155\\n\\n2. tx128 -> tzz217\\n\\ntx154 tzz217 -> tx156\\n\\ntx155 + tx156 \
-> tx157\\n\\ntx157 tzz211 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n-xb -> tx158\\n\\ntx158 + xa -> tx159\\n\\ntx131 tzz217 -> \
tx160\\n\\ntx159 tzz216 -> tx161\\n\\ntx160 + tx161 -> tx162\\n\\ntx162 \
tzz211 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\npower2[tx148] -> \
tx163\\n\\n2. tx138 -> tx164\\n\\n2. tx163 -> tx165\\n\\ntx139 -> \
tx200\\n\\ntx151 -> tx201\\n\\nreciprocal[tx200] -> tx202\\n\\ntx201 tx202 -> \
tx166\\n\\ntx202 -> tx167\\n\\nreciprocal[tx140] -> tx168\\n\\npower2[tx152] \
-> tx169\\n\\ntx164 + tx165 -> tx170\\n\\ntx166 tzz204 -> tzz207\\n\\n-0.5 \
tzz207 -> tzz210\\n\\ntx169 tzz210 -> tx171\\n\\ntx167 tx168 -> \
tzz206\\n\\nka tzz206 -> tzz208\\n\\n0.5 tzz208 -> tzz209\\n\\ntx169 tzz209 \
-> tx172\\n\\ntx201 tzz204 -> tzz205\\n\\ntx170 tzz205 -> tx173\\n\\ntx171 + \
tx172 + tx173 -> \
dhx1x1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 0, dhx1x1);]\\n\\npower2[tx154] -> tx174\\n\\n2. tx136 -> tx175\\n\\n2. \
tx174 -> tx176\\n\\npower2[tx157] -> tx177\\n\\ntx175 + tx176 -> \
tx178\\n\\ntx177 tzz210 -> tx179\\n\\ntx177 tzz209 -> tx180\\n\\ntx178 tzz205 \
-> tx181\\n\\ntx179 + tx180 + tx181 -> \
dhy1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);]\\n\\npower2[tx159] -> tx182\\n\\n2. tx137 -> tx183\\n\\n2. \
tx182 -> tx184\\n\\npower2[tx162] -> tx185\\n\\ntx183 + tx184 -> \
tx186\\n\\ntx185 tzz210 -> tx187\\n\\ntx185 tzz209 -> tx188\\n\\ntx186 tzz205 \
-> tx189\\n\\ntx187 + tx188 + tx189 -> \
dhz1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, \
I1, 2, dhz1z1);]\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n2. tzz205 -> tzz212\\n\\ntx130 tx148 tzz212 \
-> tx190\\n\\ntx152 tx157 -> tzz215\\n\\ntzz210 tzz215 -> tx191\\n\\ntzz209 \
tzz215 -> tx192\\n\\ntx190 + tx191 + tx192 -> \
ohx1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 1, ohx1y1);]\\n\\ntx132 tx159 tzz212 -> tx193\\n\\ntx162 tzz210 -> \
tzz213\\n\\ntx152 tzz213 -> tx194\\n\\ntx162 tzz209 -> tzz214\\n\\ntx152 \
tzz214 -> tx195\\n\\ntx193 + tx194 + tx195 -> \
ohx1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 2, ohx1z1);]\\n\\ntx131 tx154 tzz212 -> tx196\\n\\ntx157 tzz213 -> \
tx197\\n\\ntx157 tzz214 -> tx198\\n\\ntx196 + tx197 + tx198 -> \
ohy1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
1, I1, 2, ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ \
]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\
\\n\\nCCode[} /*calcDiagonalHessian */]\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE ]*/]\"\>"], \
"Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231662755632`*^9},ExpressionUUID->"ef012d08-fd46-45b8-8cab-\
734374e0c7ce"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166358781*^9},ExpressionUUID->"6046f691-83d9-4e7d-a87e-\
24f6bc4deea8"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation, tx113 -> tx121, tx105 -> tx122, tx101 -> tx123, tx116 \
-> tx124, tx110 -> tx125, tx118 -> tx126, tx139 -> tx200, tx151 -> tx201, \
tx202 -> tx167}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166364818*^9},ExpressionUUID->"9077ffca-8424-47c0-89f9-\
3cd42f7e1ec5"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166369938*^9},ExpressionUUID->"3d34253a-d857-476d-8be6-\
f60d0243843b"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\\n\\ntx113 -> tx121\\n\\ntx105 -> tx122\\n\\ntx101 -> \
tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 -> tx126\\n\\ntx139 \
-> tx200\\n\\ntx151 -> tx201\\n\\ntx202 -> tx167\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231663750753`*^9},ExpressionUUID->"6007f024-bcbd-47cd-bda1-\
c1eb689e0c77"],

Cell[BoxData["\<\"After removal: \
CCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(ra);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(xa);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(yb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_POSITION(x1,I1,0);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
POSITION(y1,I1,1);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\
\\n\\npointToLineDeviation -> PointToLineDeviation\\n\\n-xa -> \
tx100\\n\\ntx100 y1 -> tx101\\n\\nxb y1 -> tx102\\n\\n-ya -> tx103\\n\\nx1 ya \
-> tx104\\n\\ntx103 xb -> tx105\\n\\n-(x1 yb) -> tx106\\n\\nxa yb -> tx107\\n\
\\nxa z1 -> tx108\\n\\n-(xb z1) -> tx109\\n\\ntx103 z1 -> tx110\\n\\nyb z1 -> \
tx111\\n\\n-za -> tx112\\n\\ntx112 x1 -> tx113\\n\\nxb za -> tx114\\n\\ny1 za \
-> tx115\\n\\ntx112 yb -> tx116\\n\\nx1 zb -> tx117\\n\\ntx100 zb -> tx118\\n\
\\n-(y1 zb) -> tx119\\n\\nya zb -> tx120\\n\\ntx113 -> tx121\\n\\ntx105 -> \
tx122\\n\\ntx101 -> tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 \
-> tx126\\n\\ntx102 + tx104 + tx106 + tx107 + tx122 + tx123 -> \
tx127\\n\\ntx111 + tx115 + tx119 + tx120 + tx124 + tx125 -> tx128\\n\\ntx108 \
+ tx109 + tx114 + tx117 + tx121 + tx126 -> tx129\\n\\ntx100 + xb -> \
tx130\\n\\ntx103 + yb -> tx131\\n\\ntx112 + zb -> tx132\\n\\npower2[tx127] -> \
tx133\\n\\npower2[tx128] -> tx134\\n\\npower2[tx129] -> \
tx135\\n\\npower2[tx130] -> tx136\\n\\npower2[tx131] -> \
tx137\\n\\npower2[tx132] -> tx138\\n\\ntx133 + tx134 + tx135 -> \
tx139\\n\\ntx136 + tx137 + tx138 -> tx140\\n\\nmysqrt[tx139] -> \
tx141\\n\\nmysqrt[tx140] -> tx199\\n\\nreciprocal[tx199] -> tx142\\n\\n-ra -> \
tx143\\n\\ntx141 tx142 -> tx144\\n\\ntx143 + tx144 -> \
tx145\\n\\npower2[tx145] -> tx146\\n\\nka tx146 -> \
Energy\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\n\\\
nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE //[]\\n\\nCCode[if ( \
calcForce ) {]\\n\\n-yb -> tx147\\n\\ntx147 + ya -> tx148\\n\\n2. tx129 -> \
tzz216\\n\\ntx132 tzz216 -> tx149\\n\\n2. tx127 -> tzz218\\n\\ntx148 tzz218 \
-> tx150\\n\\nreciprocal[tx141] -> tx151\\n\\ntx149 + tx150 -> \
tx152\\n\\ntx142 tx145 -> tzz203\\n\\nka tzz203 -> tzz204\\n\\ntx151 tzz204 \
-> tzz211\\n\\ntx152 tzz211 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n-zb -> tx153\\n\\ntx153 + za -> tx154\\n\\ntx130 tzz218 -> \
tx155\\n\\n2. tx128 -> tzz217\\n\\ntx154 tzz217 -> tx156\\n\\ntx155 + tx156 \
-> tx157\\n\\ntx157 tzz211 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n-xb -> tx158\\n\\ntx158 + xa -> tx159\\n\\ntx131 tzz217 -> \
tx160\\n\\ntx159 tzz216 -> tx161\\n\\ntx160 + tx161 -> tx162\\n\\ntx162 \
tzz211 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\npower2[tx148] -> \
tx163\\n\\n2. tx138 -> tx164\\n\\n2. tx163 -> tx165\\n\\ntx139 -> \
tx200\\n\\ntx151 -> tx201\\n\\nreciprocal[tx200] -> tx202\\n\\ntx201 tx202 -> \
tx166\\n\\ntx202 -> tx167\\n\\nreciprocal[tx140] -> tx168\\n\\npower2[tx152] \
-> tx169\\n\\ntx164 + tx165 -> tx170\\n\\ntx166 tzz204 -> tzz207\\n\\n-0.5 \
tzz207 -> tzz210\\n\\ntx169 tzz210 -> tx171\\n\\ntx167 tx168 -> \
tzz206\\n\\nka tzz206 -> tzz208\\n\\n0.5 tzz208 -> tzz209\\n\\ntx169 tzz209 \
-> tx172\\n\\ntx201 tzz204 -> tzz205\\n\\ntx170 tzz205 -> tx173\\n\\ntx171 + \
tx172 + tx173 -> \
dhx1x1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 0, dhx1x1);]\\n\\npower2[tx154] -> tx174\\n\\n2. tx136 -> tx175\\n\\n2. \
tx174 -> tx176\\n\\npower2[tx157] -> tx177\\n\\ntx175 + tx176 -> \
tx178\\n\\ntx177 tzz210 -> tx179\\n\\ntx177 tzz209 -> tx180\\n\\ntx178 tzz205 \
-> tx181\\n\\ntx179 + tx180 + tx181 -> \
dhy1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);]\\n\\npower2[tx159] -> tx182\\n\\n2. tx137 -> tx183\\n\\n2. \
tx182 -> tx184\\n\\npower2[tx162] -> tx185\\n\\ntx183 + tx184 -> \
tx186\\n\\ntx185 tzz210 -> tx187\\n\\ntx185 tzz209 -> tx188\\n\\ntx186 tzz205 \
-> tx189\\n\\ntx187 + tx188 + tx189 -> \
dhz1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, \
I1, 2, dhz1z1);]\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n2. tzz205 -> tzz212\\n\\ntx130 tx148 tzz212 \
-> tx190\\n\\ntx152 tx157 -> tzz215\\n\\ntzz210 tzz215 -> tx191\\n\\ntzz209 \
tzz215 -> tx192\\n\\ntx190 + tx191 + tx192 -> \
ohx1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 1, ohx1y1);]\\n\\ntx132 tx159 tzz212 -> tx193\\n\\ntx162 tzz210 -> \
tzz213\\n\\ntx152 tzz213 -> tx194\\n\\ntx162 tzz209 -> tzz214\\n\\ntx152 \
tzz214 -> tx195\\n\\ntx193 + tx194 + tx195 -> \
ohx1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 2, ohx1z1);]\\n\\ntx131 tx154 tzz212 -> tx196\\n\\ntx157 tzz213 -> \
tx197\\n\\ntx157 tzz214 -> tx198\\n\\ntx196 + tx197 + tx198 -> \
ohy1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
1, I1, 2, ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ \
]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\
\\n\\nCCode[} /*calcDiagonalHessian */]\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE ]*/]\"\>"], \
"Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231663802032`*^9},ExpressionUUID->"7fa7f2d1-b94a-4426-b693-\
607f9b562fca"],

Cell[BoxData["\<\"trivialRules>> triv = {pointToLineDeviation -> \
PointToLineDeviation, tx113 -> tx121, tx105 -> tx122, tx101 -> tx123, tx116 \
-> tx124, tx110 -> tx125, tx118 -> tx126, tx139 -> tx200, tx151 -> tx201, \
tx202 -> tx167}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231665081043`*^9},ExpressionUUID->"37b66739-3142-499b-93d0-\
cb25d291990d"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, dhx1x1, \
dhy1y1, dhz1z1, ohx1y1, ohx1z1, ohy1z1, PointToLineDeviation}\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166512939*^9},ExpressionUUID->"9717e2b3-4a30-42c4-bff6-\
1a85142385a3"],

Cell[BoxData["\<\"Trivial rules are being removed: pointToLineDeviation -> \
PointToLineDeviation\\n\\ntx113 -> tx121\\n\\ntx105 -> tx122\\n\\ntx101 -> \
tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 -> tx126\\n\\ntx139 \
-> tx200\\n\\ntx151 -> tx201\\n\\ntx202 -> tx167\"\>"], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231665183907`*^9},ExpressionUUID->"c9ef7e0e-01ff-4add-95f2-\
d0c95ef7a95a"],

Cell[BoxData["\<\"After removal: \
CCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ka);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(ra);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(xa);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(ya);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(za);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_PARAMETER(xb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
PARAMETER(yb);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(zb);]\\n\\\
nCCode[POINT_TO_LINE_RESTRAINT_SET_PARAMETER(I1);]\\n\\nCCode[POINT_TO_LINE_\
RESTRAINT_SET_POSITION(x1,I1,0);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_\
POSITION(y1,I1,1);]\\n\\nCCode[POINT_TO_LINE_RESTRAINT_SET_POSITION(z1,I1,2);]\
\\n\\npointToLineDeviation -> PointToLineDeviation\\n\\n-xa -> \
tx100\\n\\ntx100 y1 -> tx101\\n\\nxb y1 -> tx102\\n\\n-ya -> tx103\\n\\nx1 ya \
-> tx104\\n\\ntx103 xb -> tx105\\n\\n-(x1 yb) -> tx106\\n\\nxa yb -> tx107\\n\
\\nxa z1 -> tx108\\n\\n-(xb z1) -> tx109\\n\\ntx103 z1 -> tx110\\n\\nyb z1 -> \
tx111\\n\\n-za -> tx112\\n\\ntx112 x1 -> tx113\\n\\nxb za -> tx114\\n\\ny1 za \
-> tx115\\n\\ntx112 yb -> tx116\\n\\nx1 zb -> tx117\\n\\ntx100 zb -> tx118\\n\
\\n-(y1 zb) -> tx119\\n\\nya zb -> tx120\\n\\ntx113 -> tx121\\n\\ntx105 -> \
tx122\\n\\ntx101 -> tx123\\n\\ntx116 -> tx124\\n\\ntx110 -> tx125\\n\\ntx118 \
-> tx126\\n\\ntx102 + tx104 + tx106 + tx107 + tx122 + tx123 -> \
tx127\\n\\ntx111 + tx115 + tx119 + tx120 + tx124 + tx125 -> tx128\\n\\ntx108 \
+ tx109 + tx114 + tx117 + tx121 + tx126 -> tx129\\n\\ntx100 + xb -> \
tx130\\n\\ntx103 + yb -> tx131\\n\\ntx112 + zb -> tx132\\n\\npower2[tx127] -> \
tx133\\n\\npower2[tx128] -> tx134\\n\\npower2[tx129] -> \
tx135\\n\\npower2[tx130] -> tx136\\n\\npower2[tx131] -> \
tx137\\n\\npower2[tx132] -> tx138\\n\\ntx133 + tx134 + tx135 -> \
tx139\\n\\ntx136 + tx137 + tx138 -> tx140\\n\\nmysqrt[tx139] -> \
tx141\\n\\nmysqrt[tx140] -> tx199\\n\\nreciprocal[tx199] -> tx142\\n\\n-ra -> \
tx143\\n\\ntx141 tx142 -> tx144\\n\\ntx143 + tx144 -> \
tx145\\n\\npower2[tx145] -> tx146\\n\\nka tx146 -> \
Energy\\n\\nCCode[POINT_TO_LINE_RESTRAINT_ENERGY_ACCUMULATE(Energy);]\\n\\\
nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_FORCE //[]\\n\\nCCode[if ( \
calcForce ) {]\\n\\n-yb -> tx147\\n\\ntx147 + ya -> tx148\\n\\n2. tx129 -> \
tzz216\\n\\ntx132 tzz216 -> tx149\\n\\n2. tx127 -> tzz218\\n\\ntx148 tzz218 \
-> tx150\\n\\nreciprocal[tx141] -> tx151\\n\\ntx149 + tx150 -> \
tx152\\n\\ntx142 tx145 -> tzz203\\n\\nka tzz203 -> tzz204\\n\\ntx151 tzz204 \
-> tzz211\\n\\ntx152 tzz211 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 \
);]\\n\\n-zb -> tx153\\n\\ntx153 + za -> tx154\\n\\ntx130 tzz218 -> \
tx155\\n\\n2. tx128 -> tzz217\\n\\ntx154 tzz217 -> tx156\\n\\ntx155 + tx156 \
-> tx157\\n\\ntx157 tzz211 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n-xb -> tx158\\n\\ntx158 + xa -> tx159\\n\\ntx131 tzz217 -> \
tx160\\n\\ntx159 tzz216 -> tx161\\n\\ntx160 + tx161 -> tx162\\n\\ntx162 \
tzz211 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\nCCode[#ifdef POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcDiagonalHessian ) {]\\n\\npower2[tx148] -> \
tx163\\n\\n2. tx138 -> tx164\\n\\n2. tx163 -> tx165\\n\\ntx139 -> \
tx200\\n\\ntx151 -> tx201\\n\\nreciprocal[tx200] -> tx202\\n\\ntx201 tx202 -> \
tx166\\n\\ntx202 -> tx167\\n\\nreciprocal[tx140] -> tx168\\n\\npower2[tx152] \
-> tx169\\n\\ntx164 + tx165 -> tx170\\n\\ntx166 tzz204 -> tzz207\\n\\n-0.5 \
tzz207 -> tzz210\\n\\ntx169 tzz210 -> tx171\\n\\ntx167 tx168 -> \
tzz206\\n\\nka tzz206 -> tzz208\\n\\n0.5 tzz208 -> tzz209\\n\\ntx169 tzz209 \
-> tx172\\n\\ntx201 tzz204 -> tzz205\\n\\ntx170 tzz205 -> tx173\\n\\ntx171 + \
tx172 + tx173 -> \
dhx1x1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 0, dhx1x1);]\\n\\npower2[tx154] -> tx174\\n\\n2. tx136 -> tx175\\n\\n2. \
tx174 -> tx176\\n\\npower2[tx157] -> tx177\\n\\ntx175 + tx176 -> \
tx178\\n\\ntx177 tzz210 -> tx179\\n\\ntx177 tzz209 -> tx180\\n\\ntx178 tzz205 \
-> tx181\\n\\ntx179 + tx180 + tx181 -> \
dhy1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);]\\n\\npower2[tx159] -> tx182\\n\\n2. tx137 -> tx183\\n\\n2. \
tx182 -> tx184\\n\\npower2[tx162] -> tx185\\n\\ntx183 + tx184 -> \
tx186\\n\\ntx185 tzz210 -> tx187\\n\\ntx185 tzz209 -> tx188\\n\\ntx186 tzz205 \
-> tx189\\n\\ntx187 + tx188 + tx189 -> \
dhz1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, \
I1, 2, dhz1z1);]\\n\\nCCode[#ifdef \
POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcOffDiagonalHessian ) {]\\n\\n2. tzz205 -> tzz212\\n\\ntx130 tx148 tzz212 \
-> tx190\\n\\ntx152 tx157 -> tzz215\\n\\ntzz210 tzz215 -> tx191\\n\\ntzz209 \
tzz215 -> tx192\\n\\ntx190 + tx191 + tx192 -> \
ohx1y1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 1, ohx1y1);]\\n\\ntx132 tx159 tzz212 -> tx193\\n\\ntx162 tzz210 -> \
tzz213\\n\\ntx152 tzz213 -> tx194\\n\\ntx162 tzz209 -> tzz214\\n\\ntx152 \
tzz214 -> tx195\\n\\ntx193 + tx194 + tx195 -> \
ohx1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
0, I1, 2, ohx1z1);]\\n\\ntx131 tx154 tzz212 -> tx196\\n\\ntx157 tzz213 -> \
tx197\\n\\ntx157 tzz214 -> tx198\\n\\ntx196 + tx197 + tx198 -> \
ohy1z1\\n\\nCCode[POINT_TO_LINE_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, \
1, I1, 2, ohy1z1);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ \
]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/]\
\\n\\nCCode[} /*calcDiagonalHessian */]\\n\\nCCode[#endif /* \
POINT_TO_LINE_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* POINT_TO_LINE_RESTRAINT_CALC_FORCE ]*/]\"\>"], \
"Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166525085*^9},ExpressionUUID->"6c62d473-1e7d-4c18-a6ce-\
7f04aece69e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing declares to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_PointToLineRestraint_termDeclares.cc\"\>"}],
  SequenceForm[
  "Writing declares to file: ", "_PointToLineRestraint_termDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.774623166619769*^9},ExpressionUUID->"e25361cd-e739-44f3-a761-\
a722943b7e21"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing code to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_PointToLineRestraint_termCode.cc\"\>"}],
  SequenceForm["Writing code to file: ", "_PointToLineRestraint_termCode.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774622982040689*^9, 
  3.7746231666260643`*^9},ExpressionUUID->"f7ebdd08-beb1-4913-a01c-\
d80f1d64f86f"]
}, Open  ]]
}, Open  ]],

Cell["\<\
Ignore errors in packGraph[pointToLinePack], I forget what it doesn't like \
but it is something non-essential\
\>", "Text",
 CellChangeTimes->{{3.416873887395665*^9, 3.4168738997477922`*^9}, {
   3.416873947718832*^9, 3.416873957966881*^9}, 
   3.774622951069406*^9},ExpressionUUID->"aa084058-801a-4bc7-986f-\
2b5f5ca6b07d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "pointToLinePack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 3.413903219466408*^9, 
   3.774622951776198*^9},ExpressionUUID->"10510d75-92c9-492e-bb5a-\
e7c15906dd0e"],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], LineBox[{{0.06999999999999999, 5.}, {0.03, 8.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 15.}, {0.03, 26.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 8.076923076923077}, {0.13, 15.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 8.076923076923077}, {0.03, 43.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 25.}, {0.03, 61.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 25.}, {0.03, 43.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 35.}, {0.03, 78.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 45.}, {0.03, 96.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 45.}, {0.03, 78.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 24.230769230769234`}, {0.13, 35.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 24.230769230769234`}, {0.03, 61.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 55.}, {0.03, 96.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 55.}, {0.03, 113.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 65.}, {0.03, 26.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 65.}, {0.03, 113.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 75.}, {0.03, 26.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 75.}, {0.03, 131.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 85.}, {0.03, 61.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 85.}, {0.03, 131.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 40.38461538461539}, {0.13, 35.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 40.38461538461539}, {0.03, 131.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 95.}, {0.03, 113.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 95.}, {0.03, 131.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 105.}, {0.03, 148.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 56.53846153846154}, {0.13, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 56.53846153846154}, {0.03, 96.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 115.}, {0.03, 61.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 115.}, {0.03, 148.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 125.}, {0.03, 43.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 125.}, {0.03, 148.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 72.6923076923077}, {0.13, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 72.6923076923077}, {0.03, 113.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 135.}, {0.03, 96.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 135.}, {0.03, 166.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 88.84615384615385}, {0.13, 15.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.17, 88.84615384615385}, {0.03, 166.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 145.}, {0.03, 43.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 145.}, {0.03, 166.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 155.}, {0.03, 78.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 155.}, {0.03, 166.25}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.27, 8.076923076923077}, {0.22999999999999998`, 
     56.53846153846154}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.27, 24.230769230769234`}, {0.22999999999999998`, 
     24.230769230769234`}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.27, 40.38461538461539}, {0.22999999999999998`, 
     8.076923076923077}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.27, 56.53846153846154}, {0.22999999999999998`, 
     72.6923076923077}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.27, 72.6923076923077}, {0.22999999999999998`, 
     40.38461538461539}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.27, 88.84615384615385}, {0.22999999999999998`, 
     88.84615384615385}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 9.545454545454547}, {0.13, 25.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 9.545454545454547}, {0.13, 45.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 9.545454545454547}, {0.13, 55.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 9.545454545454547}, {0.13, 65.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 9.545454545454547}, {0.33, 
     24.230769230769234`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 9.545454545454547}, {0.33, 
     40.38461538461539}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 28.636363636363637`}, {0.13, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 28.636363636363637`}, {0.13, 125.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 28.636363636363637`}, {0.13, 145.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 28.636363636363637`}, {0.13, 155.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 28.636363636363637`}, {0.33, 
     56.53846153846154}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 28.636363636363637`}, {0.33, 
     72.6923076923077}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.727272727272734`}, {0.13, 75.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.727272727272734`}, {0.13, 85.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.727272727272734`}, {0.13, 115.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.727272727272734`}, {0.13, 135.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.727272727272734`}, {0.33, 
     8.076923076923077}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.727272727272734`}, {0.33, 
     88.84615384615385}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 105.}, {0.13, 15.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 105.}, {0.03, 61.25}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 121.15384615384615`}, {0.13, 35.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.17, 121.15384615384615`}, {0.03, 113.75}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 137.30769230769232`}, {0.13, 105.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.17, 137.30769230769232`}, {0.03, 166.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.47000000000000003`, 8.75}, {0.43, 9.545454545454547}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.47000000000000003`, 26.25}, {0.43, 28.636363636363637`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.47000000000000003`, 43.75}, {0.43, 47.727272727272734`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 105.}, {0.22999999999999998`, 105.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 121.15384615384615`}, {0.22999999999999998`, 
     121.15384615384615`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 137.30769230769232`}, {0.22999999999999998`, 
     137.30769230769232`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.5700000000000001, 11.666666666666668`}, {0.53, 8.75}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.5700000000000001, 11.666666666666668`}, {0.53, 26.25}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.5700000000000001, 11.666666666666668`}, {0.53, 43.75}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 66.81818181818181}, {0.33, 105.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 66.81818181818181}, {0.33, 
     121.15384615384615`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 66.81818181818181}, {0.33, 
     137.30769230769232`}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.67, 17.5}, {0.63, 11.666666666666668`}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.47000000000000003`, 61.25}, {0.43, 66.81818181818181}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.5700000000000001, 35.}, {0.53, 61.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 165.}, {0.03, 183.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 13.125}, {0.73, 17.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 13.125}, {0.63, 35.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.87, 21.}, {0.13, 165.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.87, 21.}, {0.8300000000000001, 13.125}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 21.}, {0.9300000000000002, 21.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 26.25}, {0.9300000000000002, 63.00000000000001}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 26.25}, {1.03, 21.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 175.}, {0.03, 113.75}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 153.46153846153845`}, {0.13, 175.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 153.46153846153845`}, {0.03, 78.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.47000000000000003`, 78.75}, {0.43, 47.727272727272734`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 58.33333333333334}, {0.22999999999999998`, 
     137.30769230769232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 58.33333333333334}, {0.53, 78.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.47000000000000003`, 96.25}, {0.43, 9.545454545454547}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 81.66666666666669}, {0.22999999999999998`, 
     153.46153846153845`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 81.66666666666669}, {0.53, 96.25}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.77, 39.375}, {0.73, 17.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.67, 52.5}, {0.63, 58.33333333333334}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.67, 52.5}, {0.63, 81.66666666666669}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 63.00000000000001}, {0.63, 35.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 63.00000000000001}, {0.9300000000000002, 21.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 78.75}, {0.9300000000000002, 63.00000000000001}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 78.75}, {1.03, 63.00000000000001}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 21.}, {0.8300000000000001, 39.375}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 21.}, {1.1300000000000001`, 78.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 7.5}, {0.73, 52.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 7.5}, {1.2300000000000002`, 21.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 7.5}, {1.33, 7.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 185.}, {0.03, 166.25}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 169.61538461538464`}, {0.13, 185.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.17, 169.61538461538464`}, {0.03, 148.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 105.}, {0.22999999999999998`, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.5700000000000001, 105.}, {0.53, 96.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.47000000000000003`, 113.75}, {0.43, 28.636363636363637`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 128.33333333333334`}, {0.22999999999999998`,
      169.61538461538464`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 128.33333333333334`}, {0.53, 113.75}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.67, 87.5}, {0.63, 105.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.67, 87.5}, {0.63, 128.33333333333334`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 22.5}, {0.73, 87.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 22.5}, {1.2300000000000002`, 21.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 22.5}, {1.33, 22.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 195.}, {0.03, 61.25}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 185.76923076923077`}, {0.13, 195.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 185.76923076923077`}, {0.03, 26.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 151.66666666666669`}, {0.22999999999999998`,
      121.15384615384615`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 151.66666666666669`}, {0.53, 113.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.5700000000000001, 175.}, {0.22999999999999998`, 
     185.76923076923077`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.5700000000000001, 175.}, {0.53, 78.75}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.67, 122.5}, {0.63, 151.66666666666669`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.67, 122.5}, {0.63, 175.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 37.5}, {0.73, 122.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 37.5}, {1.2300000000000002`, 21.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 37.5}, {1.33, 37.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 153.46153846153845`}, {0.22999999999999998`, 
     153.46153846153845`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 85.90909090909092}, {0.33, 
     137.30769230769232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 105.}, {0.33, 153.46153846153845`}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 157.5}, {0.63, 11.666666666666668`}}]}, 
   {GrayLevel[0], LineBox[{{0.87, 105.}, {0.8300000000000001, 39.375}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.77, 65.625}, {0.73, 157.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 105.}, {0.9300000000000002, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 105.}, {0.8300000000000001, 65.625}}]}, 
   {GrayLevel[0], LineBox[{{0.87, 147.}, {0.8300000000000001, 65.625}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.47000000000000003`, 131.25}, {0.43, 66.81818181818181}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 91.875}, {0.73, 52.5}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 148.75}, {0.43, 85.90909090909092}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 148.75}, {0.43, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 63.00000000000001}, {1.03, 105.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 63.00000000000001}, {1.1300000000000001`, 78.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.27, 52.5}, {1.2300000000000002`, 63.00000000000001}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 52.5}, {0.8300000000000001, 91.875}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 52.5}, {1.33, 52.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 147.}, {0.9300000000000002, 147.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 147.}, {0.53, 131.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 131.25}, {0.9300000000000002, 63.00000000000001}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 131.25}, {1.03, 147.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.17, 105.}, {1.1300000000000001`, 131.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 67.5}, {0.8300000000000001, 91.875}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 67.5}, {1.2300000000000002`, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 147.}, {0.9300000000000002, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 147.}, {1.1300000000000001`, 78.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 82.5}, {0.53, 148.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 82.5}, {1.2300000000000002`, 147.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 15.}, {1.4300000000000002`, 52.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 15.}, {1.33, 67.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 15.}, {1.33, 82.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 169.61538461538464`}, {0.22999999999999998`, 
     169.61538461538464`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 124.0909090909091}, {0.33, 105.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 143.1818181818182}, {0.33, 
     169.61538461538464`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 118.125}, {0.73, 87.5}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 166.25}, {0.43, 124.0909090909091}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 166.25}, {0.43, 143.1818181818182}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 67.5}, {0.8300000000000001, 118.125}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 67.5}, {1.33, 52.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.27, 97.5}, {0.8300000000000001, 118.125}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 97.5}, {1.2300000000000002`, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 112.5}, {0.53, 166.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 112.5}, {1.2300000000000002`, 147.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 45.}, {1.4300000000000002`, 67.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 45.}, {1.33, 97.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 45.}, {1.33, 112.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 185.76923076923077`}, {0.22999999999999998`, 
     185.76923076923077`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 162.27272727272725`}, {0.33, 
     121.15384615384615`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.37000000000000005`, 181.36363636363637`}, {0.33, 
     185.76923076923077`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 144.375}, {0.73, 122.5}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 183.75}, {0.43, 162.27272727272725`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.47000000000000003`, 183.75}, {0.43, 181.36363636363637`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 82.5}, {0.8300000000000001, 144.375}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 82.5}, {1.33, 52.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.27, 127.5}, {0.8300000000000001, 144.375}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 127.5}, {1.2300000000000002`, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 142.5}, {0.53, 183.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 142.5}, {1.2300000000000002`, 147.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 75.}, {1.4300000000000002`, 82.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 75.}, {1.33, 127.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 75.}, {1.33, 142.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 157.5}, {1.2300000000000002`, 147.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 97.5}, {0.22999999999999998`, 105.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 97.5}, {0.22999999999999998`, 153.46153846153845`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 97.5}, {1.33, 157.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 170.625}, {0.73, 52.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 170.625}, {0.73, 87.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 112.5}, {1.33, 52.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 112.5}, {0.8300000000000001, 170.625}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 172.5}, {1.2300000000000002`, 105.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.27, 172.5}, {0.8300000000000001, 170.625}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 105.}, {1.4300000000000002`, 97.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 105.}, {1.4300000000000002`, 112.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.47, 105.}, {1.33, 172.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 127.5}, {0.22999999999999998`, 137.30769230769232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 127.5}, {0.22999999999999998`, 185.76923076923077`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 127.5}, {1.33, 157.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 142.5}, {0.73, 122.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 142.5}, {1.33, 52.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.47, 135.}, {0.73, 52.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.47, 135.}, {1.4300000000000002`, 142.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 187.5}, {0.73, 122.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.27, 187.5}, {1.2300000000000002`, 105.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 157.5}, {0.73, 52.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 157.5}, {1.33, 187.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.57, 35.}, {1.4300000000000002`, 127.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.57, 35.}, {1.5300000000000002`, 135.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.57, 35.}, {1.4300000000000002`, 157.5}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 172.5}, {0.22999999999999998`, 121.15384615384615`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.37, 172.5}, {0.22999999999999998`, 169.61538461538464`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 172.5}, {1.33, 157.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.47, 165.}, {0.73, 87.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.47, 165.}, {1.4300000000000002`, 142.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 187.5}, {0.73, 87.5}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.37, 187.5}, {1.33, 187.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.57, 105.}, {1.4300000000000002`, 172.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.57, 105.}, {1.5300000000000002`, 165.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.57, 105.}, {1.4300000000000002`, 187.5}}]}, 
   {GrayLevel[0], InsetBox["\<\"pointToLineDeviation\"\>", {0., 8.75},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"PointToLineDeviation:Symbol\"\>", {0.1, 5.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"xa\"\>", {0., 26.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx100:Times(-1)\"\>", {0.1, 15.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y1\"\>", {0., 43.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx101:Times\"\>", {0.2, 8.076923076923077},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"xb\"\>", {0., 61.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx102:Times\"\>", {0.1, 25.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ya\"\>", {0., 78.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx103:Times(-1)\"\>", {0.1, 35.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"x1\"\>", {0., 96.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx104:Times\"\>", {0.1, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx105:Times\"\>", {0.2, 24.230769230769234},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"yb\"\>", {0., 113.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx106:Times(-1)\"\>", {0.1, 55.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx107:Times\"\>", {0.1, 65.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z1\"\>", {0., 131.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx108:Times\"\>", {0.1, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx109:Times(-1)\"\>", {0.1, 85.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx110:Times\"\>", {0.2, 40.38461538461539},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx111:Times\"\>", {0.1, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"za\"\>", {0., 148.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx112:Times(-1)\"\>", {0.1, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx113:Times\"\>", {0.2, 56.53846153846154},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx114:Times\"\>", {0.1, 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx115:Times\"\>", {0.1, 125.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx116:Times\"\>", {0.2, 72.6923076923077},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"zb\"\>", {0., 166.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx117:Times\"\>", {0.1, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx118:Times\"\>", {0.2, 88.84615384615385},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx119:Times(-1)\"\>", {0.1, 145.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx120:Times\"\>", {0.1, 155.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx121:Symbol\"\>", {0.30000000000000004, 8.076923076923077},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx122:Symbol\"\>", {0.30000000000000004, 24.230769230769234},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx123:Symbol\"\>", {0.30000000000000004, 40.38461538461539},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx124:Symbol\"\>", {0.30000000000000004, 56.53846153846154},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx125:Symbol\"\>", {0.30000000000000004, 72.6923076923077},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx126:Symbol\"\>", {0.30000000000000004, 88.84615384615385},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx127:Plus\"\>", {0.4, 9.545454545454547},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx128:Plus\"\>", {0.4, 28.636363636363637},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx129:Plus\"\>", {0.4, 47.727272727272734},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx130:Plus\"\>", {0.2, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx131:Plus\"\>", {0.2, 121.15384615384615},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx132:Plus\"\>", {0.2, 137.30769230769232},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx133:power2\"\>", {0.5, 8.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx134:power2\"\>", {0.5, 26.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx135:power2\"\>", {0.5, 43.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx136:power2\"\>", {0.30000000000000004, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx137:power2\"\>", {0.30000000000000004, 121.15384615384615},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx138:power2\"\>", {0.30000000000000004, 137.30769230769232},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx139:Plus\"\>", {0.6000000000000001, 11.666666666666668},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx140:Plus\"\>", {0.4, 66.81818181818181},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx141:mysqrt\"\>", {0.7000000000000001, 17.5},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx199:mysqrt\"\>", {0.5, 61.25},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx142:reciprocal\"\>", {0.6000000000000001, 35.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ra\"\>", {0., 183.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx143:Times(-1)\"\>", {0.1, 165.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx144:Times\"\>", {0.8, 13.125},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx145:Plus\"\>", {0.9, 21.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx146:power2\"\>", {1., 21.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ka\"\>", {0.9, 63.00000000000001},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"Energy:Times\"\>", {1.1, 26.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx147:Times(-1)\"\>", {0.1, 175.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx148:Plus\"\>", {0.2, 153.46153846153845},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz216:Times(2.)\"\>", {0.5, 78.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx149:Times\"\>", {0.6000000000000001, 58.33333333333334},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz218:Times(2.)\"\>", {0.5, 96.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx150:Times\"\>", {0.6000000000000001, 81.66666666666669},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx151:reciprocal\"\>", {0.8, 39.375},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx152:Plus\"\>", {0.7000000000000001, 52.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz203:Times\"\>", {1., 63.00000000000001},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz204:Times\"\>", {1.1, 78.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz211:Times\"\>", {1.2000000000000002, 21.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gx1:Times\"\>", {1.3, 7.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx1:Times(-1)\"\>", {1.4000000000000001, 7.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx153:Times(-1)\"\>", {0.1, 185.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx154:Plus\"\>", {0.2, 169.61538461538464},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx155:Times\"\>", {0.6000000000000001, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz217:Times(2.)\"\>", {0.5, 113.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx156:Times\"\>", {0.6000000000000001, 128.33333333333334},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx157:Plus\"\>", {0.7000000000000001, 87.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gy1:Times\"\>", {1.3, 22.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy1:Times(-1)\"\>", {1.4000000000000001, 22.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx158:Times(-1)\"\>", {0.1, 195.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx159:Plus\"\>", {0.2, 185.76923076923077},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx160:Times\"\>", {0.6000000000000001, 151.66666666666669},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx161:Times\"\>", {0.6000000000000001, 175.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx162:Plus\"\>", {0.7000000000000001, 122.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz1:Times\"\>", {1.3, 37.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz1:Times(-1)\"\>", {1.4000000000000001, 37.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx163:power2\"\>", {0.30000000000000004, 153.46153846153845},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx164:Times(2.)\"\>", {0.4, 85.90909090909092},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx165:Times(2.)\"\>", {0.4, 105.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx200:Symbol\"\>", {0.7000000000000001, 157.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx201:Symbol\"\>", {0.9, 105.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx202:reciprocal\"\>", {0.8, 65.625},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx166:Times\"\>", {1., 105.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx167:Symbol\"\>", {0.9, 147.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx168:reciprocal\"\>", {0.5, 131.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx169:power2\"\>", {0.8, 91.875},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx170:Plus\"\>", {0.5, 148.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz207:Times\"\>", {1.2000000000000002, 63.00000000000001},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz210:Times(-0.5)\"\>", {1.3, 52.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx171:Times\"\>", {1.4000000000000001, 52.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz206:Times\"\>", {1., 147.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz208:Times\"\>", {1.1, 131.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz209:Times(0.5)\"\>", {1.2000000000000002, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx172:Times\"\>", {1.3, 67.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz205:Times\"\>", {1.2000000000000002, 147.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx173:Times\"\>", {1.3, 82.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhx1x1:Plus\"\>", {1.5, 15.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx174:power2\"\>", {0.30000000000000004, 169.61538461538464},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx175:Times(2.)\"\>", {0.4, 124.0909090909091},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx176:Times(2.)\"\>", {0.4, 143.1818181818182},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx177:power2\"\>", {0.8, 118.125},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx178:Plus\"\>", {0.5, 166.25},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx179:Times\"\>", {1.4000000000000001, 67.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx180:Times\"\>", {1.3, 97.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx181:Times\"\>", {1.3, 112.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhy1y1:Plus\"\>", {1.5, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx182:power2\"\>", {0.30000000000000004, 185.76923076923077},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx183:Times(2.)\"\>", {0.4, 162.27272727272725},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx184:Times(2.)\"\>", {0.4, 181.36363636363637},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx185:power2\"\>", {0.8, 144.375},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx186:Plus\"\>", {0.5, 183.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx187:Times\"\>", {1.4000000000000001, 82.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx188:Times\"\>", {1.3, 127.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx189:Times\"\>", {1.3, 142.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhz1z1:Plus\"\>", {1.5, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz212:Times(2.)\"\>", {1.3, 157.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx190:Times\"\>", {1.4000000000000001, 97.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz215:Times\"\>", {0.8, 170.625},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx191:Times\"\>", {1.4000000000000001, 112.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx192:Times\"\>", {1.3, 172.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y1:Plus\"\>", {1.5, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx193:Times\"\>", {1.4000000000000001, 127.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz213:Times\"\>", {1.4000000000000001, 142.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx194:Times\"\>", {1.5, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz214:Times\"\>", {1.3, 187.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx195:Times\"\>", {1.4000000000000001, 157.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z1:Plus\"\>", {1.6, 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx196:Times\"\>", {1.4000000000000001, 172.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx197:Times\"\>", {1.5, 165.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx198:Times\"\>", {1.4000000000000001, 187.5},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z1:Plus\"\>", {1.6, 105.},
     Background->Automatic]}},
  AspectRatio->0.41,
  ImageSize->{1754.1406249999993`, Automatic}]], "Output",
 CellChangeTimes->{3.774622997762026*^9, 
  3.774623168354542*^9},ExpressionUUID->"8c10fdee-1c4b-49da-85ad-\
62b75f4f85dd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Sketch Non-bonding terms
\tRepulsive term for 2d sketches
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 3.402672664963516*^9}, {
  3.774789255655426*^9, 3.774789256969256*^9}, {3.7747905737124357`*^9, 
  3.7747905789431047`*^9}},ExpressionUUID->"99c9a3d5-8c1b-4271-8e48-\
b57be111d080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", " ", 
    "crep"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
  3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
  3.402741179258795*^9}, {3.774790587235073*^9, 
  3.774790587808305*^9}},ExpressionUUID->"48e9b2b3-a257-4ce2-ad6c-\
beeb5cf6f06b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 
  3.402652572153042*^9}},ExpressionUUID->"76eda1be-78ff-42d5-9611-\
741db42b0cf7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"erepInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "crep"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 3.4111751886209507`*^9}, {
   3.77479069398976*^9, 
   3.774790719391663*^9}},ExpressionUUID->"5800d749-c9ad-45e4-84cd-\
f6a8a4cce3f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "crep"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7747907357059193`*^9, 3.7747911651337423`*^9, 
  3.7747912264274273`*^9, 3.774791499440044*^9, 
  3.774791683309376*^9},ExpressionUUID->"23876a51-def2-446e-b4b1-\
982f48374205"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"erepDistance", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
  3.411197578518401*^9, 3.411197589788989*^9}, {3.774790704272292*^9, 
  3.77479072076333*^9}},ExpressionUUID->"b36654fb-48ad-4f60-95e5-\
e46a9c8fa8a9"],

Cell[CellGroupData[{

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]], "Input",
 NumberMarks->False,ExpressionUUID->"a2010ffe-88fc-4c46-8c44-20afe825bd4a"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.774790739673197*^9, 3.774791165190551*^9, 
  3.7747912265135527`*^9, 3.774791499517922*^9, 
  3.7747916833840227`*^9},ExpressionUUID->"fb93f73e-7f11-4a93-a3ed-\
9ff7d8ffbd69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"erepEquation", " ", "=", " ", 
  RowBox[{"crep", " ", "*", " ", 
   RowBox[{"Log", "[", "erepDistance", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 3.416871995722517*^9, {
   3.774790601074484*^9, 3.7747906744141607`*^9}, {3.7747907083098297`*^9, 
   3.774790708735602*^9}, 
   3.774790778287784*^9},ExpressionUUID->"e4ecce2d-11d5-4b85-bf6e-\
1c511eb237d1"],

Cell[BoxData[
 RowBox[{"crep", " ", 
  RowBox[{"Log", "[", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], "]"}]}]], "Output",
 CellChangeTimes->{3.774790743743906*^9, 3.7747907795352373`*^9, 
  3.774791165227427*^9, 3.7747912265887747`*^9, 3.7747914995770187`*^9, 
  3.774791683459578*^9},ExpressionUUID->"124f8821-dfa7-41d6-9451-\
3d9e35c1f2b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input",ExpressionUUID->\
"42be9b2f-6ceb-4fb4-8b88-a37428204869"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.774790754837577*^9, 3.774791165272126*^9, 
  3.774791226663204*^9, 3.774791499652564*^9, 
  3.774791683519223*^9},ExpressionUUID->"498a1679-e213-4398-8bca-\
1d5d159d70d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"erepEquation", ",", "x1"}], "]"}]], "Input",
 CellChangeTimes->{{3.7747907589854717`*^9, 
  3.7747907664064007`*^9}},ExpressionUUID->"e929575b-11e6-4adf-a23c-\
75da7c654803"],

Cell[BoxData[
 FractionBox[
  RowBox[{"crep", " ", 
   RowBox[{"(", 
    RowBox[{"x1", "-", "x2"}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.774790766975069*^9, 3.774790782961514*^9}, 
   3.774791165332673*^9, 3.774791226748795*^9, 3.774791499738812*^9, 
   3.774791683601439*^9},ExpressionUUID->"0a8d0df0-9931-4a03-a402-\
c4bb49323831"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 
  3.401714933019302*^9}},ExpressionUUID->"9afa1783-4c40-4de2-aa4b-\
1145622413f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"erepVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408564450747929*^9, 3.408564451541582*^9}, {
  3.774791020065336*^9, 
  3.774791022573297*^9}},ExpressionUUID->"6b90835a-5cbe-4a58-9285-\
2a21c24094a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"erepSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<EREP_SET_PARAMETER(I1);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<EREP_SET_PARAMETER(I2);\>\"", "]"}]}], "]"}], 
  ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<EREP_SET_PARAMETER(crep);\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
  3.487025950138463*^9, 3.487025960189999*^9}, {3.487026052805409*^9, 
  3.487026058323876*^9}, {3.487032089923287*^9, 3.487032096633906*^9}, {
  3.774790804866179*^9, 3.7747908063948402`*^9}, {3.774790845034441*^9, 
  3.774790849184246*^9}, {3.774791028705525*^9, 
  3.7747910352290287`*^9}},ExpressionUUID->"cfe6e606-fba1-48ea-bf9a-\
562e67f5ca83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "erepVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<EREP_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"erepVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"erepVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"erepVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"erepSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.7747908070346613`*^9, 
  3.7747908080591383`*^9}, {3.774791042936352*^9, 
  3.77479104335198*^9}},ExpressionUUID->"0e70dbf2-9ac3-4e19-8d86-\
51d956144364"],

Cell[BoxData["\<\"EREP_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.774791165413814*^9, 3.7747912268529997`*^9, 
  3.7747914998367558`*^9, 
  3.774791683742535*^9},ExpressionUUID->"f65fa632-8e8a-402a-b6c0-\
ff7d73cefcb9"],

Cell[BoxData["\<\"EREP_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.774791165413814*^9, 3.7747912268529997`*^9, 
  3.7747914998367558`*^9, 
  3.774791683750495*^9},ExpressionUUID->"ce84ce99-fffd-4437-9148-\
8eb74d7ee805"],

Cell[BoxData["\<\"EREP_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.774791165413814*^9, 3.7747912268529997`*^9, 
  3.7747914998367558`*^9, 
  3.774791683755909*^9},ExpressionUUID->"91d89524-effd-4aaa-973d-\
58864a8ff4e4"],

Cell[BoxData["\<\"EREP_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.774791165413814*^9, 3.7747912268529997`*^9, 
  3.7747914998367558`*^9, 
  3.774791683761443*^9},ExpressionUUID->"f8590448-1bed-4844-a6aa-\
0512ceae675b"],

Cell[BoxData["\<\"EREP_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.774791165413814*^9, 3.7747912268529997`*^9, 
  3.7747914998367558`*^9, 
  3.774791683766377*^9},ExpressionUUID->"a247be51-d224-4289-8e88-\
d655711cf95b"],

Cell[BoxData["\<\"EREP_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.774791165413814*^9, 3.7747912268529997`*^9, 
  3.7747914998367558`*^9, 
  3.774791683771286*^9},ExpressionUUID->"5bde0f76-b216-486d-86ba-\
6578d187584b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"erepSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 
   3.774790808433241*^9},ExpressionUUID->"1bd7bda5-b589-44c1-b96b-\
7a2d936004ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_PARAMETER(crep);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"EREP_SET_POSITION(z2,I2,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7747911654953337`*^9, 3.774791226947139*^9, 
  3.774791499941016*^9, 
  3.774791683847724*^9},ExpressionUUID->"f40d5e72-ee29-4f82-a6f3-\
0c67f634455a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"erepEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erepOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"ErepDistance", ",", "erepDistance"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<MAYBE_BAIL(ErepDistance);\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Erep", ",", "erepEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<EREP\>\"", ",", "Erep"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"erepOutputs", ",", "Erep"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}, {3.7747908087116327`*^9, 3.774790811221743*^9}, {
   3.774790875150819*^9, 3.774790932931035*^9}, {3.774791009063908*^9, 
   3.774791010153316*^9}, 3.774791211683875*^9, {3.774791404619111*^9, 
   3.774791435195458*^9}, {3.774791465639945*^9, 3.774791494540678*^9}, {
   3.7747916452511063`*^9, 
   3.774791678853571*^9}},ExpressionUUID->"5748ff68-db34-4ac3-8279-\
3935f5c793f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"erepHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 3.409334145792842*^9}, 
   3.774790811478963*^9},ExpressionUUID->"c39169d8-f987-4798-9872-\
debd8e68fb62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.774791165551743*^9, 3.774791227043541*^9, 
  3.774791500039126*^9, 
  3.774791683947061*^9},ExpressionUUID->"00b324ee-2443-4e2d-b1d2-\
e3e474659d7a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"erepForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 3.410177986821323*^9}, 
   3.774790811738274*^9},ExpressionUUID->"a0dc323a-6098-4665-a3b2-\
b2894ff60fe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<EREP\>\"", ",", "erepForceHessianRules", ",", "erepOutputs", ",", 
    "erepHessian", ",", "erepEquation", ",", "erepVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
  3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
  3.410177993430345*^9}, {3.774790811997417*^9, 3.774790813212556*^9}, {
  3.774790941617421*^9, 
  3.774790942144774*^9}},ExpressionUUID->"14519ff6-cd03-428c-a2a7-\
0052c1a28a48"],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 
  3.4017149467691317`*^9}},ExpressionUUID->"eea4db31-b283-4483-bfd5-\
f544a1e8a9ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"erepOutputs", ",", "ErepDistance"}], "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
   3.4111976578180523`*^9, 3.411197662226531*^9}, 3.7747908138858013`*^9, {
   3.77479099413391*^9, 
   3.774790994650436*^9}},ExpressionUUID->"3ef28021-744f-462f-9833-\
3dc13a7cca68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Erep", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", 
   "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", 
   "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", 
   "ohx2z2", ",", "ohy2z2", ",", "ErepDistance"}], "}"}]], "Output",
 CellChangeTimes->{3.774791167574175*^9, 3.7747912290749483`*^9, 
  3.77479150203749*^9, 
  3.77479168600765*^9},ExpressionUUID->"966a9c11-5197-4d06-a029-6129d57a98d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"erepOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9, 
   3.7747908144389753`*^9},ExpressionUUID->"3b2f49e2-f3f0-4ed2-85a8-\
7c9e56a5bb10"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Erep", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
     "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
     "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", 
     ",", "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", "ohy1x2", ",", 
     "ohy1y2", ",", "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", 
     ",", "ohx2y2", ",", "ohx2z2", ",", "ohy2z2", ",", "ErepDistance"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.7747911676280947`*^9, 3.774791229146566*^9, 
  3.774791502094819*^9, 
  3.7747916860834723`*^9},ExpressionUUID->"0c085163-d9b6-4dad-8c77-\
ae615532fda9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"erepRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "erepSetupRules", ",", "erepEnergyRules", ",", "erepForceHessianRules"}],
      "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 3.410178019066489*^9}, {
  3.774790814866137*^9, 
  3.774790815944868*^9}},ExpressionUUID->"de43ee89-e248-48fd-8059-\
1ee8fd91895e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"erepPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Erep\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "erepEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "erepHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "erepRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "erepInputs"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "erepOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9, {3.774790816204194*^9, 3.774790817196031*^9}, {
   3.774790948040938*^9, 
   3.774790968013547*^9}},ExpressionUUID->"dd3522e4-5433-4f76-b0ea-\
909c66a95f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "erepPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 3.4110670742215853`*^9, {3.774790960202442*^9, 
   3.7747909617783737`*^9}},ExpressionUUID->"0591fea1-e58a-4be8-a173-\
76d21f2b1c8f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing finite difference debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Erep_debugFiniteDifference.cc\"\>"}],
  SequenceForm[
  "Writing finite difference debug code to: ", 
   "_Erep_debugFiniteDifference.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774791167717845*^9, 3.7747912292385817`*^9, 
  3.774791502223426*^9, 
  3.774791686194601*^9},ExpressionUUID->"86ee0345-1615-42e7-aed4-\
9ea819967e63"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing debug variable declares to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Erep_debugEvalDeclares.cc\"\>"}],
  SequenceForm[
  "Writing debug variable declares to: ", "_Erep_debugEvalDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774791167717845*^9, 3.7747912292385817`*^9, 
  3.774791502223426*^9, 
  3.774791686202448*^9},ExpressionUUID->"f140c179-dcc1-4f92-b8fa-\
0b39d1023405"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing xml output debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Erep_debugEvalSerialize.cc\"\>"}],
  SequenceForm[
  "Writing xml output debug code to: ", "_Erep_debugEvalSerialize.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774791167717845*^9, 3.7747912292385817`*^9, 
  3.774791502223426*^9, 
  3.7747916862079*^9},ExpressionUUID->"34a07a43-6a9a-4e6e-9b36-5ac5acc6c763"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing set variables debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Erep_debugEvalSet.cc\"\>"}],
  SequenceForm[
  "Writing set variables debug code to: ", "_Erep_debugEvalSet.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774791167717845*^9, 3.7747912292385817`*^9, 
  3.774791502223426*^9, 
  3.774791686215901*^9},ExpressionUUID->"b340a53e-998e-4fb3-9750-\
3c4a4c09071c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"erepPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "erepPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 3.411066673303035*^9, {
   3.774790973660549*^9, 
   3.7747909780345488`*^9}},ExpressionUUID->"4560ee6b-0061-424d-b437-\
02fc7d3e4433"],

Cell[BoxData[
 StyleBox["\<\"Set TimesSimplify and PlusSimplify to turn these \
simplifications off and on\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->24,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916862821827`*^9},ExpressionUUID->"9f046fd4-963c-4ede-9beb-\
8227cb196b13"],

Cell[BoxData[
 StyleBox["\<\"PlusOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916862914057`*^9},ExpressionUUID->"74842a34-2a4b-4271-adae-\
cd0b2a280237"],

Cell[BoxData[
 StyleBox["\<\"TimesOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916862978487`*^9},ExpressionUUID->"53f67835-c1c8-45e5-bf1b-\
b98cc420a950"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916881257687`*^9},ExpressionUUID->"8120a93a-6d38-4418-9060-\
77427f0e1470"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791688130684*^9},ExpressionUUID->"96924ec0-ec82-4c6e-acf8-\
393a10d70d4c"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791688134837*^9},ExpressionUUID->"87cce30c-c699-4bd5-97c0-\
94ce51a2cdda"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791688139023*^9},ExpressionUUID->"ff6f6690-2e4b-4ac0-9279-\
df9a20ca672b"],

Cell[BoxData["\<\"Collecting terms\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791688201816*^9},ExpressionUUID->"98a38f09-9e04-4ea5-b235-\
ed9dcf2acc37"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], ":", 
  " ", "\<\"Tag \[NoBreak]\\!\\(\\*RowBox[{\\\"Times\\\"}]\\)\[NoBreak] in \
\[NoBreak]\\!\\(\\*RowBox[{\\\"Null\\\", \\\" \\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Name\\\", \\\"\[Rule]\\\", \
\\\"\\\\\\\"Erep\\\\\\\"\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"6\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"Output\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"{\\\", RowBox[{\\\"Erep\\\", \\\",\\\", \
\\\"fx1\\\", \\\",\\\", \\\"fy1\\\", \\\",\\\", \\\"fz1\\\", \\\",\\\", \
\\\"fx2\\\", \\\",\\\", \\\"fy2\\\", \\\",\\\", \\\"fz2\\\", \\\",\\\", \
\\\"dhx1x1\\\", \\\",\\\", \\\"dhy1y1\\\", \\\",\\\", \\\"dhz1z1\\\", \\\",\\\
\", \\\"dhx2x2\\\", \\\",\\\", \\\"dhy2y2\\\", \\\",\\\", \\\"dhz2z2\\\", \
\\\",\\\", \\\"ohx1y1\\\", \\\",\\\", \\\"ohx1z1\\\", \\\",\\\", \\\"ohx1x2\\\
\", \\\",\\\", \\\"ohx1y2\\\", \\\",\\\", \\\"ohx1z2\\\", \\\",\\\", \
\\\"ohy1z1\\\", \\\",\\\", \\\"ohy1x2\\\", \\\",\\\", \\\"ohy1y2\\\", \\\",\\\
\", \\\"ohy1z2\\\", \\\",\\\", \\\"ohz1x2\\\", \\\",\\\", \\\"ohz1y2\\\", \
\\\",\\\", \\\"ohz1z2\\\", \\\",\\\", \\\"ohx2y2\\\", \\\",\\\", \\\"ohx2z2\\\
\", \\\",\\\", \\\"ohy2z2\\\", \\\",\\\", \\\"ErepDistance\\\"}], \
\\\"}\\\"}]}]}], \\\"}\\\"}]}]\\)\[NoBreak] is Protected. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.774791169732931*^9, 3.774791231230166*^9, 
  3.774791504324025*^9, 
  3.7747916882070293`*^9},ExpressionUUID->"93a9c353-4f2a-45c6-a254-\
2c7845ca71eb"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916900007467`*^9},ExpressionUUID->"f743cbd1-b421-4167-8cbe-\
26e6b6b38264"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690006034*^9},ExpressionUUID->"2652af73-9c75-474e-9909-\
7214dba774fa"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690010302*^9},ExpressionUUID->"6af02114-96a7-4f46-b8d1-\
f25cf39e1e25"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916900147743`*^9},ExpressionUUID->"8086cbd8-8b7e-4f4d-bc37-\
f4fe6bcc74c4"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690084632*^9},ExpressionUUID->"d442d9d9-7576-468b-a708-\
55a7eaa007b1"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690088974*^9},ExpressionUUID->"58ca19f7-8d23-4287-b476-\
d279d291f247"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690092971*^9},ExpressionUUID->"d7e2ad7a-6e9a-48fe-ab44-\
0c8a8a4f477b"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916900970182`*^9},ExpressionUUID->"0a05ed9b-ecfd-49f5-b0f0-\
0f37a1d35908"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916901007223`*^9},ExpressionUUID->"46deabd6-779a-45c1-b420-\
531daa3197b2"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690104888*^9},ExpressionUUID->"128d97a8-f483-46cc-9250-\
60e39797f331"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690109087*^9},ExpressionUUID->"4a88c386-05e1-4b5e-b9bd-\
a20128bb4bd7"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916901129503`*^9},ExpressionUUID->"adf45366-41c0-401c-96df-\
bcb0a1adda3e"],

Cell[BoxData["\<\"trivialRules>> triv = {tzz46 -> tx35}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690522854*^9},ExpressionUUID->"a52c386a-e065-4052-b70a-\
21e2b5113c03"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916905280743`*^9},ExpressionUUID->"5413da75-abb1-46d9-b86b-\
e239c5fe9a2a"],

Cell[BoxData["\<\"Trivial rules are being removed: tzz46 -> tx35\"\>"], \
"Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916905353928`*^9},ExpressionUUID->"b9773132-86d8-4b39-b340-\
59866b01c0ce"],

Cell[BoxData["\<\"After removal: \
CCode[EREP_SET_PARAMETER(I1);]\\n\\nCCode[EREP_SET_PARAMETER(I2);]\\n\\nCCode[\
EREP_SET_PARAMETER(crep);]\\n\\nCCode[EREP_SET_POSITION(x1,I1,0);]\\n\\nCCode[\
EREP_SET_POSITION(y1,I1,1);]\\n\\nCCode[EREP_SET_POSITION(z1,I1,2);]\\n\\\
nCCode[EREP_SET_POSITION(x2,I2,0);]\\n\\nCCode[EREP_SET_POSITION(y2,I2,1);]\\\
n\\nCCode[EREP_SET_POSITION(z2,I2,2);]\\n\\n-x2 -> tx22\\n\\n-y2 -> \
tx23\\n\\n-z2 -> tx24\\n\\ntx22 + x1 -> tx25\\n\\ntx23 + y1 -> tx26\\n\\ntx24 \
+ z1 -> tx27\\n\\npower2[tx25] -> tx28\\n\\npower2[tx26] -> \
tx29\\n\\npower2[tx27] -> tx30\\n\\ntx28 + tx29 + tx30 -> \
tx31\\n\\nmysqrt[tx31] -> \
ErepDistance\\n\\nCCode[MAYBE_BAIL(ErepDistance);]\\n\\nLog[ErepDistance] -> \
tx32\\n\\ncrep tx32 -> \
Erep\\n\\nCCode[EREP_ENERGY_ACCUMULATE(Erep);]\\n\\nCCode[#ifdef \
EREP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\nreciprocal[tx31] -> \
tx33\\n\\ncrep tx33 -> tzz46\\n\\ntx25 tzz46 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ntx26 tzz46 -> gy1\\n\
\\n-gy1 -> fy1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx27 \
tzz46 -> gz1\\n\\n-gz1 -> fz1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 2, fz1 );]\
\\n\\nfx1 -> gx2\\n\\n-gx2 -> fx2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, 0, fx2 \
);]\\n\\nfy1 -> gy2\\n\\n-gy2 -> fy2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, 1, \
fy2 );]\\n\\nfz1 -> gz2\\n\\n-gz2 -> fz2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, \
2, fz2 );]\\n\\nCCode[#ifdef EREP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcDiagonalHessian ) {]\\n\\npower2[tx33] -> tx34\\n\\ntzz46 -> \
tx35\\n\\ncrep tx34 -> tzz43\\n\\n-2. tzz43 -> tzz45\\n\\ntx28 tzz45 -> \
tx36\\n\\ntx35 + tx36 -> \
dhx1x1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\\n\
\\ntx29 tzz45 -> tx37\\n\\ntx35 + tx37 -> \
dhy1y1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\ntx30 tzz45 -> tx38\\n\\ntx35 + tx38 -> \
dhz1z1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\\n\
\\ndhx1x1 -> dhx2x2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, \
dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\\n\
\\ndhz1z1 -> dhz2z2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, \
dhz2z2);]\\n\\nCCode[#ifdef EREP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ntx26 tzz45 -> tzz48\\n\\ntx25 tzz48 -> \
ohx1y1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx25 tx27 tzz45 -> \
ohx1z1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n2. tzz43 -> tzz44\\n\\ntx28 tzz44 -> tx39\\n\\n-tx35 -> \
tx40\\n\\ntx39 + tx40 -> \
ohx1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\ntx25 tx26 tzz44 -> \
ohx1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\ntx27 tzz44 -> tzz47\\n\\ntx25 tzz47 -> \
ohx1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\ntx27 tzz48 -> \
ohy1z1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx29 tzz44 -> tx41\\n\\ntx40 + tx41 -> \
ohy1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\ntx26 tzz47 -> \
ohy1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx30 tzz44 -> tx42\\n\\ntx40 + tx42 -> \
ohz1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
EREP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* EREP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* EREP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.77479169053972*^9},ExpressionUUID->"fa4a52fb-6c57-421e-8327-8aaaae4bf92e"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690607074*^9},ExpressionUUID->"bfca0cee-baf5-4b5a-a315-\
d3eab79e272f"],

Cell[BoxData["\<\"trivialRules>> triv = {tzz46 -> tx35}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690611911*^9},ExpressionUUID->"87820022-f69e-4594-8359-\
18a4d5e849bc"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690616024*^9},ExpressionUUID->"67f24508-8d18-4e98-9be1-\
239989764837"],

Cell[BoxData["\<\"Trivial rules are being removed: tzz46 -> tx35\"\>"], \
"Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690620386*^9},ExpressionUUID->"05e3b7a6-a5f4-471d-83a2-\
17e6fc34b404"],

Cell[BoxData["\<\"After removal: \
CCode[EREP_SET_PARAMETER(I1);]\\n\\nCCode[EREP_SET_PARAMETER(I2);]\\n\\nCCode[\
EREP_SET_PARAMETER(crep);]\\n\\nCCode[EREP_SET_POSITION(x1,I1,0);]\\n\\nCCode[\
EREP_SET_POSITION(y1,I1,1);]\\n\\nCCode[EREP_SET_POSITION(z1,I1,2);]\\n\\\
nCCode[EREP_SET_POSITION(x2,I2,0);]\\n\\nCCode[EREP_SET_POSITION(y2,I2,1);]\\\
n\\nCCode[EREP_SET_POSITION(z2,I2,2);]\\n\\n-x2 -> tx22\\n\\n-y2 -> \
tx23\\n\\n-z2 -> tx24\\n\\ntx22 + x1 -> tx25\\n\\ntx23 + y1 -> tx26\\n\\ntx24 \
+ z1 -> tx27\\n\\npower2[tx25] -> tx28\\n\\npower2[tx26] -> \
tx29\\n\\npower2[tx27] -> tx30\\n\\ntx28 + tx29 + tx30 -> \
tx31\\n\\nmysqrt[tx31] -> \
ErepDistance\\n\\nCCode[MAYBE_BAIL(ErepDistance);]\\n\\nLog[ErepDistance] -> \
tx32\\n\\ncrep tx32 -> \
Erep\\n\\nCCode[EREP_ENERGY_ACCUMULATE(Erep);]\\n\\nCCode[#ifdef \
EREP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\nreciprocal[tx31] -> \
tx33\\n\\ncrep tx33 -> tzz46\\n\\ntx25 tzz46 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ntx26 tzz46 -> gy1\\n\
\\n-gy1 -> fy1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx27 \
tzz46 -> gz1\\n\\n-gz1 -> fz1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 2, fz1 );]\
\\n\\nfx1 -> gx2\\n\\n-gx2 -> fx2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, 0, fx2 \
);]\\n\\nfy1 -> gy2\\n\\n-gy2 -> fy2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, 1, \
fy2 );]\\n\\nfz1 -> gz2\\n\\n-gz2 -> fz2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, \
2, fz2 );]\\n\\nCCode[#ifdef EREP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcDiagonalHessian ) {]\\n\\npower2[tx33] -> tx34\\n\\ntzz46 -> \
tx35\\n\\ncrep tx34 -> tzz43\\n\\n-2. tzz43 -> tzz45\\n\\ntx28 tzz45 -> \
tx36\\n\\ntx35 + tx36 -> \
dhx1x1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\\n\
\\ntx29 tzz45 -> tx37\\n\\ntx35 + tx37 -> \
dhy1y1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\ntx30 tzz45 -> tx38\\n\\ntx35 + tx38 -> \
dhz1z1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\\n\
\\ndhx1x1 -> dhx2x2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, \
dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\\n\
\\ndhz1z1 -> dhz2z2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, \
dhz2z2);]\\n\\nCCode[#ifdef EREP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ntx26 tzz45 -> tzz48\\n\\ntx25 tzz48 -> \
ohx1y1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx25 tx27 tzz45 -> \
ohx1z1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n2. tzz43 -> tzz44\\n\\ntx28 tzz44 -> tx39\\n\\n-tx35 -> \
tx40\\n\\ntx39 + tx40 -> \
ohx1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\ntx25 tx26 tzz44 -> \
ohx1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\ntx27 tzz44 -> tzz47\\n\\ntx25 tzz47 -> \
ohx1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\ntx27 tzz48 -> \
ohy1z1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx29 tzz44 -> tx41\\n\\ntx40 + tx41 -> \
ohy1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\ntx26 tzz47 -> \
ohy1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx30 tzz44 -> tx42\\n\\ntx40 + tx42 -> \
ohz1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
EREP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* EREP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* EREP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916906246347`*^9},ExpressionUUID->"3593fa4a-fec2-45b6-96d9-\
8d9892a791ef"],

Cell[BoxData["\<\"trivialRules>> triv = {tzz46 -> tx35}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690741109*^9},ExpressionUUID->"67d222d2-69fd-493d-98a9-\
2bcc35c0f67d"],

Cell[BoxData["\<\"trivialRules>> outs = {Erep, fx1, fy1, fz1, fx2, fy2, fz2, \
dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, ErepDistance}\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690746005*^9},ExpressionUUID->"5ae7e341-ec98-4dff-97e9-\
4af5223bcb0d"],

Cell[BoxData["\<\"Trivial rules are being removed: tzz46 -> tx35\"\>"], \
"Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690750492*^9},ExpressionUUID->"1c790084-1f06-4cc6-8952-\
63a92cf80c1b"],

Cell[BoxData["\<\"After removal: \
CCode[EREP_SET_PARAMETER(I1);]\\n\\nCCode[EREP_SET_PARAMETER(I2);]\\n\\nCCode[\
EREP_SET_PARAMETER(crep);]\\n\\nCCode[EREP_SET_POSITION(x1,I1,0);]\\n\\nCCode[\
EREP_SET_POSITION(y1,I1,1);]\\n\\nCCode[EREP_SET_POSITION(z1,I1,2);]\\n\\\
nCCode[EREP_SET_POSITION(x2,I2,0);]\\n\\nCCode[EREP_SET_POSITION(y2,I2,1);]\\\
n\\nCCode[EREP_SET_POSITION(z2,I2,2);]\\n\\n-x2 -> tx22\\n\\n-y2 -> \
tx23\\n\\n-z2 -> tx24\\n\\ntx22 + x1 -> tx25\\n\\ntx23 + y1 -> tx26\\n\\ntx24 \
+ z1 -> tx27\\n\\npower2[tx25] -> tx28\\n\\npower2[tx26] -> \
tx29\\n\\npower2[tx27] -> tx30\\n\\ntx28 + tx29 + tx30 -> \
tx31\\n\\nmysqrt[tx31] -> \
ErepDistance\\n\\nCCode[MAYBE_BAIL(ErepDistance);]\\n\\nLog[ErepDistance] -> \
tx32\\n\\ncrep tx32 -> \
Erep\\n\\nCCode[EREP_ENERGY_ACCUMULATE(Erep);]\\n\\nCCode[#ifdef \
EREP_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) {]\\n\\nreciprocal[tx31] -> \
tx33\\n\\ncrep tx33 -> tzz46\\n\\ntx25 tzz46 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\ntx26 tzz46 -> gy1\\n\
\\n-gy1 -> fy1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx27 \
tzz46 -> gz1\\n\\n-gz1 -> fz1\\n\\nCCode[EREP_FORCE_ACCUMULATE(I1, 2, fz1 );]\
\\n\\nfx1 -> gx2\\n\\n-gx2 -> fx2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, 0, fx2 \
);]\\n\\nfy1 -> gy2\\n\\n-gy2 -> fy2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, 1, \
fy2 );]\\n\\nfz1 -> gz2\\n\\n-gz2 -> fz2\\n\\nCCode[EREP_FORCE_ACCUMULATE(I2, \
2, fz2 );]\\n\\nCCode[#ifdef EREP_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcDiagonalHessian ) {]\\n\\npower2[tx33] -> tx34\\n\\ntzz46 -> \
tx35\\n\\ncrep tx34 -> tzz43\\n\\n-2. tzz43 -> tzz45\\n\\ntx28 tzz45 -> \
tx36\\n\\ntx35 + tx36 -> \
dhx1x1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\\n\
\\ntx29 tzz45 -> tx37\\n\\ntx35 + tx37 -> \
dhy1y1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\\n\
\\ntx30 tzz45 -> tx38\\n\\ntx35 + tx38 -> \
dhz1z1\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\\n\
\\ndhx1x1 -> dhx2x2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, \
dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\\n\
\\ndhz1z1 -> dhz2z2\\n\\nCCode[EREP_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, \
dhz2z2);]\\n\\nCCode[#ifdef EREP_CALC_OFF_DIAGONAL_HESSIAN //[]\\n\\nCCode[if \
( calcOffDiagonalHessian ) {]\\n\\ntx26 tzz45 -> tzz48\\n\\ntx25 tzz48 -> \
ohx1y1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx25 tx27 tzz45 -> \
ohx1z1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n2. tzz43 -> tzz44\\n\\ntx28 tzz44 -> tx39\\n\\n-tx35 -> \
tx40\\n\\ntx39 + tx40 -> \
ohx1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\ntx25 tx26 tzz44 -> \
ohx1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\ntx27 tzz44 -> tzz47\\n\\ntx25 tzz47 -> \
ohx1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\ntx27 tzz48 -> \
ohy1z1\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx29 tzz44 -> tx41\\n\\ntx40 + tx41 -> \
ohy1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\ntx26 tzz47 -> \
ohy1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx30 tzz44 -> tx42\\n\\ntx40 + tx42 -> \
ohz1z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[EREP_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
EREP_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\\n\
\\nCCode[#endif /* EREP_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcForce \
*/]\\n\\nCCode[#endif /* EREP_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.7747916907573643`*^9},ExpressionUUID->"eae5762d-4826-4ff9-a9a7-\
85b143dde355"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing declares to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Erep_termDeclares.cc\"\>"}],
  SequenceForm["Writing declares to file: ", "_Erep_termDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690821969*^9},ExpressionUUID->"928986fb-a69d-45c0-a939-\
479272714e8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing code to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Erep_termCode.cc\"\>"}],
  SequenceForm["Writing code to file: ", "_Erep_termCode.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.774791167788149*^9, 3.77479122932929*^9, 
  3.774791502320908*^9, 
  3.774791690827303*^9},ExpressionUUID->"4e7eb104-59a1-4b2b-a1ce-\
ee524919008a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "erepPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 3.4055995100170727`*^9}, {
  3.774790981083748*^9, 
  3.7747909815321198`*^9}},ExpressionUUID->"e46929c0-07ce-4709-bcda-\
8c7ac12b8862"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 20.}, {0.03, 11.428571428571427`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 60.}, {0.03, 34.285714285714285`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 100.}, {0.03, 57.14285714285714}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 20.}, {0.13, 20.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 20.}, {0.03, 80.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 60.}, {0.13, 60.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 60.}, {0.03, 102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 100.}, {0.13, 100.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 100.}, {0.03, 125.71428571428571`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 20.}, {0.22999999999999998`, 20.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 60.}, {0.22999999999999998`, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 100.}, {0.22999999999999998`, 100.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.37000000000000005`, 40.}, {0.33, 20.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.37000000000000005`, 40.}, {0.33, 60.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.37000000000000005`, 40.}, {0.33, 100.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.47000000000000003`, 20.}, {0.43, 40.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.5700000000000001, 20.}, {0.53, 20.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 11.428571428571427`}, {0.53, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 11.428571428571427`}, {0.63, 20.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.47000000000000003`, 100.}, {0.43, 40.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.5700000000000001, 60.}, {0.53, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.5700000000000001, 60.}, {0.53, 100.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.67, 34.285714285714285`}, {0.22999999999999998`, 20.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 34.285714285714285`}, {0.63, 60.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 11.428571428571427`}, {0.73, 34.285714285714285`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.67, 57.14285714285714}, {0.22999999999999998`, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 57.14285714285714}, {0.63, 60.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 34.285714285714285`}, {0.73, 57.14285714285714}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 80.}, {0.22999999999999998`, 100.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 80.}, {0.63, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 57.14285714285714}, {0.73, 80.}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.87, 5.7142857142857135`}, {0.8300000000000001, 
     11.428571428571427`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 5.}, {0.9300000000000002, 5.7142857142857135`}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.87, 17.142857142857142`}, {0.8300000000000001, 
     34.285714285714285`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 15.}, {0.9300000000000002, 17.142857142857142`}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.87, 28.57142857142857}, {0.8300000000000001, 
     57.14285714285714}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 25.}, {0.9300000000000002, 28.57142857142857}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.5700000000000001, 100.}, {0.53, 100.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 102.85714285714285`}, {0.63, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 125.71428571428571`}, {0.53, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 125.71428571428571`}, {0.63, 100.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 80.}, {0.73, 125.71428571428571`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 40.}, {0.33, 20.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 40.}, {0.8300000000000001, 80.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.97, 35.}, {0.73, 102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.97, 35.}, {0.9300000000000002, 40.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 51.42857142857142}, {0.33, 60.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 51.42857142857142}, {0.8300000000000001, 80.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.97, 45.}, {0.73, 102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 45.}, {0.9300000000000002, 51.42857142857142}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 62.857142857142854`}, {0.33, 100.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 62.857142857142854`}, {0.8300000000000001, 80.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.97, 55.}, {0.73, 102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 55.}, {0.9300000000000002, 62.857142857142854`}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 10.}, {1.03, 35.}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 30.}, {1.03, 45.}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 50.}, {1.03, 55.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 74.28571428571428}, {0.22999999999999998`, 60.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 74.28571428571428}, {0.8300000000000001, 80.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 65.}, {0.22999999999999998`, 20.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 65.}, {0.9300000000000002, 74.28571428571428}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 85.71428571428571}, {0.22999999999999998`, 20.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 85.71428571428571}, {0.22999999999999998`, 100.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 85.71428571428571}, {0.8300000000000001, 80.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 102.85714285714285`}, {0.73, 125.71428571428571`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 97.14285714285714}, {0.33, 20.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 97.14285714285714}, {0.8300000000000001, 
     102.85714285714285`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 125.71428571428571`}, {0.73, 102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 75.}, {0.9300000000000002, 97.14285714285714}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 75.}, {0.8300000000000001, 125.71428571428571`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 108.57142857142856`}, {0.22999999999999998`, 20.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 108.57142857142856`}, {0.22999999999999998`, 60.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 108.57142857142856`}, {0.8300000000000001, 
     102.85714285714285`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 120.}, {0.22999999999999998`, 100.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 120.}, {0.8300000000000001, 102.85714285714285`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 85.}, {0.22999999999999998`, 20.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 85.}, {0.9300000000000002, 120.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 95.}, {0.22999999999999998`, 100.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 95.}, {0.9300000000000002, 74.28571428571428}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.97, 105.}, {0.9300000000000002, 108.57142857142856`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 131.42857142857142`}, {0.33, 60.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 131.42857142857142`}, {0.8300000000000001, 
     102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 115.}, {0.8300000000000001, 125.71428571428571`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 115.}, {0.9300000000000002, 131.42857142857142`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 125.}, {0.22999999999999998`, 60.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 125.}, {0.9300000000000002, 120.}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 70.}, {1.03, 85.}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 90.}, {1.03, 125.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 142.85714285714283`}, {0.33, 100.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 142.85714285714283`}, {0.8300000000000001, 
     102.85714285714285`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 135.}, {0.8300000000000001, 125.71428571428571`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.97, 135.}, {0.9300000000000002, 142.85714285714283`}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 110.}, {1.03, 65.}}]}, 
   {GrayLevel[0], 
    LineBox[{{0.97, 145.}, {0.9300000000000002, 85.71428571428571}}]}, 
   {GrayLevel[0], LineBox[{{1.07, 130.}, {1.03, 95.}}]}, 
   {GrayLevel[0], InsetBox["\<\"x2\"\>", {0., 11.428571428571427},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx22:Times(-1)\"\>", {0.1, 20.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y2\"\>", {0., 34.285714285714285},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx23:Times(-1)\"\>", {0.1, 60.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z2\"\>", {0., 57.14285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx24:Times(-1)\"\>", {0.1, 100.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"x1\"\>", {0., 80.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx25:Plus\"\>", {0.2, 20.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y1\"\>", {0., 102.85714285714285},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx26:Plus\"\>", {0.2, 60.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z1\"\>", {0., 125.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx27:Plus\"\>", {0.2, 100.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx28:power2\"\>", {0.30000000000000004, 20.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx29:power2\"\>", {0.30000000000000004, 60.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx30:power2\"\>", {0.30000000000000004, 100.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx31:Plus\"\>", {0.4, 40.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"ErepDistance:mysqrt\"\>", {0.5, 20.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx32:Log\"\>", {0.6000000000000001, 20.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"crep\"\>", {0.5, 60.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"Erep:Times\"\>", {0.7000000000000001, 11.428571428571427},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx33:reciprocal\"\>", {0.5, 100.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz46:Times\"\>", {0.6000000000000001, 60.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gx1:Times\"\>", {0.7000000000000001, 34.285714285714285},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx1:Times(-1)\"\>", {0.8, 11.428571428571427},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gy1:Times\"\>", {0.7000000000000001, 57.14285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy1:Times(-1)\"\>", {0.8, 34.285714285714285},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz1:Times\"\>", {0.7000000000000001, 80.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz1:Times(-1)\"\>", {0.8, 57.14285714285714},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"gx2:Symbol\"\>", {0.9, 5.7142857142857135},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx2:Times(-1)\"\>", {1., 5.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"gy2:Symbol\"\>", {0.9, 17.142857142857142},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy2:Times(-1)\"\>", {1., 15.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"gz2:Symbol\"\>", {0.9, 28.57142857142857},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz2:Times(-1)\"\>", {1., 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx34:power2\"\>", {0.6000000000000001, 100.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx35:Symbol\"\>", {0.7000000000000001, 102.85714285714285},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz43:Times\"\>", {0.7000000000000001, 125.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz45:Times(-2.)\"\>", {0.8, 80.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx36:Times\"\>", {0.9, 40.},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhx1x1:Plus\"\>", {1., 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx37:Times\"\>", {0.9, 51.42857142857142},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhy1y1:Plus\"\>", {1., 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx38:Times\"\>", {0.9, 62.857142857142854},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhz1z1:Plus\"\>", {1., 55.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhx2x2:Symbol\"\>", {1.1, 10.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhy2y2:Symbol\"\>", {1.1, 30.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhz2z2:Symbol\"\>", {1.1, 50.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz48:Times\"\>", {0.9, 74.28571428571428},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"ohx1y1:Times\"\>", {1., 65.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"ohx1z1:Times\"\>", {0.9, 85.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz44:Times(2.)\"\>", {0.8, 102.85714285714285},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx39:Times\"\>", {0.9, 97.14285714285714},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx40:Times(-1)\"\>", {0.8, 125.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1x2:Plus\"\>", {1., 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"ohx1y2:Times\"\>", {0.9, 108.57142857142856},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz47:Times\"\>", {0.9, 120.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"ohx1z2:Times\"\>", {1., 85.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"ohy1z1:Times\"\>", {1., 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy1x2:Symbol\"\>", {1., 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx41:Times\"\>", {0.9, 131.42857142857142},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1y2:Plus\"\>", {1., 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"ohy1z2:Times\"\>", {1., 125.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1x2:Symbol\"\>", {1.1, 70.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1y2:Symbol\"\>", {1.1, 90.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx42:Times\"\>", {0.9, 142.85714285714283},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohz1z2:Plus\"\>", {1., 135.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2y2:Symbol\"\>", {1.1, 110.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2z2:Symbol\"\>", {1., 145.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy2z2:Symbol\"\>", {1.1, 130.},
     Background->Automatic]}},
  AspectRatio->0.41,
  ImageSize->{613.3249999999972, Automatic}]], "Output",
 CellChangeTimes->{3.7747911731499968`*^9, 3.774791234481515*^9, 
  3.77479150773744*^9, 
  3.774791691585248*^9},ExpressionUUID->"2bd513bd-dbe4-47dd-bdc7-\
40c1a2ec383e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowToolbars->"RulerBar",
Evaluator->"Local",
CellGrouping->Manual,
WindowSize->{1600, 1177},
WindowMargins->{{555, Automatic}, {Automatic, 59}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3c9e1e8a-9b6d-49e9-8507-239e9dd17049"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 270, 7, 67, "Subtitle",ExpressionUUID->"b0fd39df-8862-4179-a880-dbe2092c9a61",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[862, 33, 301, 5, 65, "Code",ExpressionUUID->"c70641c7-1b5d-410e-ad0a-56f59ac2d689",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1166, 40, 420, 6, 42, "Output",ExpressionUUID->"b8d14ea6-aee7-4174-a27e-7f2f8fc0de53",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[1623, 51, 790, 12, 65, "Code",ExpressionUUID->"2d137b9b-ea88-410b-9968-95caebda6207",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2416, 65, 472, 6, 42, "Output",ExpressionUUID->"68097b85-431a-4b1c-8f39-d83d8efdb4b2",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[2903, 74, 152, 3, 37, "Input",ExpressionUUID->"56979870-3ed4-4d4e-af8e-a63b4ff23368"],
Cell[3058, 79, 299, 5, 67, "Subtitle",ExpressionUUID->"13656531-838c-4e7a-a5ac-d7f574743d13",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[3360, 86, 212, 4, 65, "Code",ExpressionUUID->"49c3f62a-426b-40d8-ad03-a51a7d875bc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3609, 95, 297, 7, 108, "Subtitle",ExpressionUUID->"40c497cd-8ecb-4a12-a19e-90050870a153"],
Cell[3909, 104, 276, 7, 37, "Input",ExpressionUUID->"a3598273-c222-436b-9d94-ca29ebbf3a24"],
Cell[4188, 113, 452, 13, 64, "Input",ExpressionUUID->"58e0eab9-be8c-43e5-82a3-ad8adbb63338"],
Cell[4643, 128, 193, 3, 67, "Subsection",ExpressionUUID->"3879886e-f184-4d74-93af-6e49da00fb72"],
Cell[4839, 133, 470, 14, 31, "Input",ExpressionUUID->"495fb4b5-85f0-462f-aac7-785188d5dabc"],
Cell[5312, 149, 656, 12, 37, "Input",ExpressionUUID->"4e665c6e-c0f4-4ca4-833d-8dc01f25a9b8"],
Cell[5971, 163, 205, 5, 37, "Input",ExpressionUUID->"d49fcc02-7be5-4d13-bb3a-5b4b3983e308"],
Cell[CellGroupData[{
Cell[6201, 172, 241, 4, 67, "Subsection",ExpressionUUID->"76c2ef4b-da46-4f83-b9d7-f91a9c19990f"],
Cell[6445, 178, 1051, 26, 220, "Input",ExpressionUUID->"446f8cb2-7ee6-4b8d-884e-be17a694418a"],
Cell[7499, 206, 1101, 27, 142, "Input",ExpressionUUID->"abcb48bc-d911-47a2-92e5-016ff7afb1b1"],
Cell[8603, 235, 1495, 35, 168, "Input",ExpressionUUID->"0bbb2f4a-d376-457f-894a-dcf14cdf7f4d"],
Cell[10101, 272, 251, 5, 37, "Input",ExpressionUUID->"56551ce3-b9df-432e-b5e3-f2b5d6f01a87"],
Cell[10355, 279, 1965, 42, 168, "Input",ExpressionUUID->"d2ec2e96-4d08-4a2b-9b30-b2997f4c3329"]
}, Open  ]],
Cell[12335, 324, 281, 4, 67, "Subsection",ExpressionUUID->"ed8cec90-4c0a-47d9-9f0f-1990a0389f2f"],
Cell[12619, 330, 171, 3, 31, "Input",ExpressionUUID->"07b80f7a-8e11-48e8-95f4-52af32d2333f"],
Cell[12793, 335, 437, 13, 37, "Input",ExpressionUUID->"63510d04-307f-48f5-b131-93115a1e8bfe"],
Cell[13233, 350, 247, 6, 37, "Input",ExpressionUUID->"1d7c25b0-fdd8-4f33-81d8-92b1808f75e8"],
Cell[13483, 358, 493, 10, 37, "Input",ExpressionUUID->"1ca74e93-7a67-4d46-a40b-bafa109761de"],
Cell[13979, 370, 250, 5, 37, "Input",ExpressionUUID->"85b973da-3bee-4bad-afca-ddd60139d234"],
Cell[14232, 377, 166, 3, 37, "Input",ExpressionUUID->"806ee8fc-0086-468d-8963-65f7bd951e4c"],
Cell[CellGroupData[{
Cell[14423, 384, 183, 3, 67, "Subsection",ExpressionUUID->"962d4dfb-fe35-420f-b0a2-e2747b27b8a4"],
Cell[14609, 389, 483, 11, 116, "Input",ExpressionUUID->"c35375c0-5832-4e1b-8621-e85aed162528"],
Cell[15095, 402, 265, 6, 37, "Input",ExpressionUUID->"52064099-ffa3-4627-80f8-c2c37f91a2f8"],
Cell[15363, 410, 164, 3, 37, "Input",ExpressionUUID->"b1a40249-4327-451e-bdb0-e7f8cabf6dd8"],
Cell[15530, 415, 395, 10, 37, "Input",ExpressionUUID->"1410c9bd-0156-4261-9767-d7b16ffc7251"],
Cell[15928, 427, 257, 6, 37, "Input",ExpressionUUID->"faf75be5-87ba-4164-babb-9d8d83ab387c"],
Cell[16188, 435, 310, 6, 101, "Subsection",ExpressionUUID->"7a30b210-9d08-4aa3-9dbe-0c1bec4ec4de"],
Cell[16501, 443, 1828, 32, 240, "Input",ExpressionUUID->"e7c04b05-4842-4c2d-8283-54f03f84cc79"],
Cell[18332, 477, 318, 7, 37, "Input",ExpressionUUID->"0398e0a1-c5f2-4b1c-b25d-c1ef738c0fb1"],
Cell[18653, 486, 495, 9, 44, "Text",ExpressionUUID->"95dc914b-df9d-44ae-9c6d-67f1919fbd54"],
Cell[19151, 497, 199, 3, 67, "Subsection",ExpressionUUID->"47d94349-2f0d-408a-90da-4fb017e5e65a"],
Cell[19353, 502, 583, 10, 31, "Input",ExpressionUUID->"59c99ea9-0cd8-47be-9284-c22abf527e8b"]
}, Open  ]],
Cell[19951, 515, 731, 14, 234, "Subsection",ExpressionUUID->"d85419f9-f6ab-47b9-9980-3a9d88d220c3"],
Cell[20685, 531, 245, 5, 31, "Input",ExpressionUUID->"da94a614-58b0-482f-9c2c-09b6822c7db4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20967, 541, 274, 8, 67, "Subtitle",ExpressionUUID->"3740d397-c035-493d-b12d-221dd6531450"],
Cell[21244, 551, 423, 10, 120, "Input",ExpressionUUID->"ae82f043-635a-4d1d-b26f-56323efddcd4"],
Cell[21670, 563, 666, 19, 282, "Input",ExpressionUUID->"9f3f81f9-7c35-431b-b26e-614d1fa0da83"],
Cell[22339, 584, 453, 10, 120, "Input",ExpressionUUID->"eac7cb44-7298-4b7c-99b7-738e18279309"],
Cell[22795, 596, 260, 7, 120, "Input",ExpressionUUID->"ca2b6acb-001f-461b-b16b-4b42d9f59874"],
Cell[23058, 605, 1010, 25, 360, "Input",ExpressionUUID->"3b1a5463-33ea-40ec-a8d1-ed75e741b211"],
Cell[24071, 632, 501, 10, 120, "Input",ExpressionUUID->"4803ac6a-5532-4fae-9264-76732195b8b4"],
Cell[24575, 644, 306, 7, 120, "Input",ExpressionUUID->"11dcc23a-07fc-49aa-b476-99a82ff9dd1f"],
Cell[24884, 653, 336, 8, 120, "Input",ExpressionUUID->"91ca3e6e-d35d-4d29-973c-65b1b23c74ae"],
Cell[25223, 663, 158, 3, 160, "Subsection",ExpressionUUID->"d01e3804-0121-42fb-b752-462ad3907501"],
Cell[25384, 668, 1440, 36, 890, "Input",ExpressionUUID->"4a1098bb-6683-4b4b-bbc6-193f7b6583ed"],
Cell[26827, 706, 1316, 33, 518, "Input",ExpressionUUID->"bc48386f-00e3-481f-8f93-7f02d8708878"],
Cell[28146, 741, 1532, 36, 597, "Input",ExpressionUUID->"71ebd469-15e6-4c29-ba8d-cbccedf421ea"],
Cell[29681, 779, 273, 5, 120, "Input",ExpressionUUID->"2d433e6a-3b2c-4143-8ac4-c0af017d427a"],
Cell[29957, 786, 235, 6, 120, "Input",ExpressionUUID->"bf10f6b1-dbdb-4070-a279-631cc559be3d"],
Cell[30195, 794, 362, 10, 120, "Input",ExpressionUUID->"e0399880-1939-4a57-8e96-973795f918fc"],
Cell[30560, 806, 2961, 64, 835, "Input",ExpressionUUID->"84dbbe44-5859-46c4-80dd-23eba52707cb"],
Cell[33524, 872, 501, 12, 282, "Input",ExpressionUUID->"33044a73-602b-403b-828c-e24f272955ff"],
Cell[CellGroupData[{
Cell[34050, 888, 169, 3, 160, "Subsection",ExpressionUUID->"8d6cdac2-cc26-4c0d-ac4a-8b0ff426ee18"],
Cell[34222, 893, 176, 4, 120, "Input",ExpressionUUID->"601d371d-06ac-4299-9ce7-fca9f62e056b"],
Cell[34401, 899, 371, 10, 120, "Input",ExpressionUUID->"d71a2f28-d191-440f-8517-468c91233049"],
Cell[34775, 911, 302, 7, 120, "Input",ExpressionUUID->"414db486-17cf-4e8a-92b3-a4e9e36ec83c"],
Cell[35080, 920, 242, 5, 120, "Input",ExpressionUUID->"75729371-1f94-4886-b8b8-b77b5f14cfd1"],
Cell[35325, 927, 1653, 30, 835, "Input",ExpressionUUID->"f5a8d9b0-8db4-4f49-84eb-ce2bd28e5834"],
Cell[36981, 959, 316, 7, 120, "Input",ExpressionUUID->"9b6f394b-9f14-469f-90d3-6465f824448f"],
Cell[37300, 968, 431, 8, 120, "Input",ExpressionUUID->"b673f5bb-2f7e-4566-95b1-308c52e10579"],
Cell[37734, 978, 196, 4, 120, "Input",ExpressionUUID->"f51f5e46-cfff-4566-b8cb-a9dcb4a268b2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[37979, 988, 346, 8, 188, "Subtitle",ExpressionUUID->"99c9a3d5-8c1b-4271-8e48-b57be111d080"],
Cell[38328, 998, 945, 17, 64, "Input",ExpressionUUID->"48e9b2b3-a257-4ce2-ad6c-beeb5cf6f06b"],
Cell[39276, 1017, 501, 14, 64, "Input",ExpressionUUID->"76eda1be-78ff-42d5-9611-741db42b0cf7"],
Cell[CellGroupData[{
Cell[39802, 1035, 542, 11, 37, "Input",ExpressionUUID->"5800d749-c9ad-45e4-84cd-f6a8a4cce3f5"],
Cell[40347, 1048, 705, 13, 42, "Output",ExpressionUUID->"957c3bb5-7c31-4fc5-b201-0600cb8aee19"]
}, Open  ]],
Cell[41067, 1064, 1084, 28, 90, "Input",ExpressionUUID->"3be9cd52-872d-4a49-b010-eed5e31db5ac"],
Cell[42154, 1094, 477, 12, 90, "Input",ExpressionUUID->"b7d95fe9-9e6a-4b89-8406-cf27452e4ba9"],
Cell[42634, 1108, 458, 15, 90, "Input",ExpressionUUID->"1df4f7ef-c456-4e20-a537-284b728469c0"],
Cell[CellGroupData[{
Cell[43117, 1127, 387, 9, 37, "Input",ExpressionUUID->"5933a60e-14a0-42ff-81ab-bdfa68cf0c55"],
Cell[43507, 1138, 587, 17, 43, "Output",ExpressionUUID->"7d2b8ac4-9b56-4c4e-b00d-a74091692875"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44131, 1160, 619, 10, 37, "Input",ExpressionUUID->"b36654fb-48ad-4f60-95e5-e46a9c8fa8a9"],
Cell[44753, 1172, 609, 18, 48, "Output",ExpressionUUID->"112528e0-caec-470c-8bf9-d01bf59e6cb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45399, 1195, 666, 14, 60, "Input",ExpressionUUID->"e4ecce2d-11d5-4b85-bf6e-1c511eb237d1"],
Cell[46068, 1211, 1512, 43, 66, "Output",ExpressionUUID->"9d08e572-7b99-4b46-bc1c-edf3d64cde0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47617, 1259, 707, 12, 60, "Input",ExpressionUUID->"d57a3757-ab4e-45e7-89a8-13fcf89aaab6"],
Cell[48327, 1273, 962, 24, 71, "Output",ExpressionUUID->"2e547006-1761-4908-adb3-16b060b491a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49326, 1302, 307, 6, 36, "Input",ExpressionUUID->"9bbdfa5d-e675-4352-a694-e98112f9445d"],
Cell[49636, 1310, 1932, 57, 128, "Output",ExpressionUUID->"dd7eaa6d-80a6-41c7-903c-8d980d4aed44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51605, 1372, 205, 5, 35, "Input",ExpressionUUID->"42be9b2f-6ceb-4fb4-8b88-a37428204869"],
Cell[51813, 1379, 622, 11, 36, "Output",ExpressionUUID->"9560e881-b965-482c-9cf0-7fc26a328cf4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52472, 1395, 382, 8, 36, "Input",ExpressionUUID->"f7e4707e-7c41-4aca-adc4-9d588e8f629c"],
Cell[52857, 1405, 1924, 65, 122, "Output",ExpressionUUID->"ea6b81df-9a10-415b-be5e-e0be2cd9c21d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54818, 1475, 286, 6, 36, "Input",ExpressionUUID->"dd649c5c-b84f-4fec-9923-3ae3a9fc8cf0"],
Cell[55107, 1483, 1965, 67, 122, "Output",ExpressionUUID->"bf69c842-1ca2-428e-8ef0-57aea12cc46f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57109, 1555, 425, 8, 36, "Input",ExpressionUUID->"3d2aca5a-00fa-431f-9eaf-77af83fffc39"],
Cell[57537, 1565, 1965, 67, 122, "Output",ExpressionUUID->"b044838c-36be-4b5d-b39c-2531c04c0f7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59539, 1637, 211, 5, 36, "Input",ExpressionUUID->"b956ad0d-7062-4d75-8177-e7a64dccf2b2"],
Cell[59753, 1644, 1926, 65, 122, "Output",ExpressionUUID->"612b8a33-eb77-427e-8ea7-9e07fbf93707"]
}, Open  ]],
Cell[61694, 1712, 1253, 32, 141, "Input",ExpressionUUID->"dd0a4412-8ddd-4889-8039-ed1c5b9eb855"],
Cell[CellGroupData[{
Cell[62972, 1748, 242, 4, 36, "Input",ExpressionUUID->"87bbdaad-8b1a-4a26-870f-09875f3e02d4"],
Cell[63217, 1754, 149, 3, 35, "Output",ExpressionUUID->"f9477404-1dfa-4b58-8737-cc6b48c8dee6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63403, 1762, 307, 5, 35, "Input",ExpressionUUID->"ec9ad749-e978-4461-aa01-d7781715dca3"],
Cell[63713, 1769, 147, 3, 35, "Output",ExpressionUUID->"3d9b7261-37ba-41bd-8f3b-82d906d560c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63897, 1777, 156, 3, 35, "Input",ExpressionUUID->"c0d16d0c-051f-4af8-81a3-0f1836a4f3eb"],
Cell[64056, 1782, 164, 4, 35, "Output",ExpressionUUID->"4d44dfb2-8b22-4fc5-a716-c1e1c02cd407"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64257, 1791, 154, 3, 54, "Subsection",ExpressionUUID->"9afa1783-4c40-4de2-aa4b-1145622413f3"],
Cell[64414, 1796, 1100, 27, 183, "Input",ExpressionUUID->"6b90835a-5cbe-4a58-9285-2a21c24094a7"],
Cell[65517, 1825, 1443, 33, 162, "Input",ExpressionUUID->"cfe6e606-fba1-48ea-bf9a-562e67f5ca83"],
Cell[CellGroupData[{
Cell[66985, 1862, 1595, 37, 141, "Input",ExpressionUUID->"0e70dbf2-9ac3-4e19-8d86-51d956144364"],
Cell[68583, 1901, 512, 8, 26, "Print",ExpressionUUID->"828251f2-b7cc-42c7-a393-340a61693761"],
Cell[69098, 1911, 512, 8, 26, "Print",ExpressionUUID->"0ab42c07-b94d-4325-8b59-e8821fd3a1d9"],
Cell[69613, 1921, 512, 8, 26, "Print",ExpressionUUID->"6790db43-f140-4749-b770-9761c9056c5b"],
Cell[70128, 1931, 512, 8, 26, "Print",ExpressionUUID->"64183308-818d-4d07-8f68-932c3ac20fdf"],
Cell[70643, 1941, 512, 8, 26, "Print",ExpressionUUID->"2f0e7915-256e-4c92-9a0f-01f5c4b6ebed"],
Cell[71158, 1951, 512, 8, 26, "Print",ExpressionUUID->"96cd5c87-a8f8-4e35-b267-d034293fb241"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71707, 1964, 297, 5, 36, "Input",ExpressionUUID->"1bd7bda5-b589-44c1-b96b-7a2d936004ce"],
Cell[72007, 1971, 1993, 47, 292, "Output",ExpressionUUID->"b22d6899-4b6c-47aa-9be7-818ce5fde576"]
}, Open  ]],
Cell[74015, 2021, 4419, 113, 414, "Input",ExpressionUUID->"5748ff68-db34-4ac3-8279-3935f5c793f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78471, 2139, 368, 10, 35, "Input",ExpressionUUID->"c39169d8-f987-4798-9872-debd8e68fb62"],
Cell[78842, 2151, 1125, 28, 35, "Output",ExpressionUUID->"cf831e40-d392-4b0a-860d-0b4f09cafe91"]
}, Open  ]],
Cell[79982, 2182, 244, 6, 35, "Input",ExpressionUUID->"a0dc323a-6098-4665-a3b2-b2894ff60fe3"],
Cell[80229, 2190, 414, 8, 61, "Text",ExpressionUUID->"14519ff6-cd03-428c-a2a7-0052c1a28a48"],
Cell[80646, 2200, 817, 15, 57, "Input",ExpressionUUID->"14519ff6-cd03-428c-a2a7-0052c1a28a48"],
Cell[CellGroupData[{
Cell[81488, 2219, 171, 3, 54, "Subsection",ExpressionUUID->"eea4db31-b283-4483-bfd5-f544a1e8a9ab"],
Cell[CellGroupData[{
Cell[81684, 2226, 290, 6, 36, "Input",ExpressionUUID->"3ef28021-744f-462f-9833-3dc13a7cca68"],
Cell[81977, 2234, 1025, 17, 78, "Output",ExpressionUUID->"7857db04-7240-4ff0-9a69-2d8fc579049b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83039, 2256, 221, 4, 36, "Input",ExpressionUUID->"3b2f49e2-f3f0-4ed2-85a8-7c9e56a5bb10"],
Cell[83263, 2262, 1186, 24, 92, "Output",ExpressionUUID->"b20ab8a7-3abd-4033-8575-07c42aebdd6b"]
}, Open  ]],
Cell[84464, 2289, 381, 10, 36, "Input",ExpressionUUID->"de43ee89-e248-48fd-8059-1ee8fd91895e"],
Cell[84848, 2301, 1631, 31, 225, "Input",ExpressionUUID->"dd3522e4-5433-4f76-b0ea-909c66a95f50"],
Cell[CellGroupData[{
Cell[86504, 2336, 365, 8, 36, "Input",ExpressionUUID->"0591fea1-e58a-4be8-a173-76d21f2b1c8f"],
Cell[86872, 2346, 757, 15, 26, "Print",ExpressionUUID->"c662669e-0a31-4341-9ac1-0bf2e5974682"],
Cell[87632, 2363, 735, 14, 26, "Print",ExpressionUUID->"be704d18-2fa4-45d3-b683-84f465cfa98a"],
Cell[88370, 2379, 733, 14, 26, "Print",ExpressionUUID->"5f753cba-43e0-48e7-85f1-fa431bca6c05"],
Cell[89106, 2395, 727, 14, 26, "Print",ExpressionUUID->"f5b3466e-5f23-4ed4-bdc6-7307eefbb95e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89870, 2414, 479, 9, 36, "Input",ExpressionUUID->"4560ee6b-0061-424d-b437-02fc7d3e4433"],
Cell[90352, 2425, 811, 18, 79, "Print",ExpressionUUID->"8eb2bad4-9816-447b-80f1-d6a05967690a"],
Cell[91166, 2445, 753, 17, 35, "Print",ExpressionUUID->"bca06915-0af5-43cc-b4b1-a6feac6d1c5c"],
Cell[91922, 2464, 754, 17, 35, "Print",ExpressionUUID->"727cc927-aa9b-44a0-88c6-a24925196440"],
Cell[92679, 2483, 510, 8, 26, "Print",ExpressionUUID->"8573d7a4-907c-49ce-9a2e-0a34c47fd935"],
Cell[93192, 2493, 508, 7, 26, "Print",ExpressionUUID->"e3e76b41-efe8-4c0e-b60d-7dc0d436a7ba"],
Cell[93703, 2502, 778, 12, 65, "Print",ExpressionUUID->"d165254f-c58a-46d8-ba0f-a747e47be998"],
Cell[94484, 2516, 516, 8, 26, "Print",ExpressionUUID->"899b3563-8953-4b93-a5c2-8fcdd7cadc7d"],
Cell[95003, 2526, 507, 8, 26, "Print",ExpressionUUID->"befc0cee-1d89-4d9e-be56-fcca4c26705e"],
Cell[95513, 2536, 2537, 38, 92, "Message",ExpressionUUID->"567340a3-41a5-4d38-b799-37419256eabb"],
Cell[98053, 2576, 510, 8, 26, "Print",ExpressionUUID->"4ecb9d45-6407-4610-8ee5-117978a62f1c"],
Cell[98566, 2586, 513, 8, 26, "Print",ExpressionUUID->"2f3227d4-81dd-40ad-b725-4b06a72c8ed2"],
Cell[99082, 2596, 778, 12, 65, "Print",ExpressionUUID->"4e550026-9c62-4481-9e23-ca6348a86436"],
Cell[99863, 2610, 518, 8, 26, "Print",ExpressionUUID->"438e96cb-9457-4f6d-8f32-5355fb28861b"],
Cell[100384, 2620, 510, 8, 26, "Print",ExpressionUUID->"f4ece002-dbf8-4eab-9297-ac80a615db13"],
Cell[100897, 2630, 513, 8, 26, "Print",ExpressionUUID->"6b4e4e13-f8cf-4454-bab8-106a2aec3dc9"],
Cell[101413, 2640, 778, 12, 65, "Print",ExpressionUUID->"698274e4-b9b3-4186-acb8-0e000ccdf49c"],
Cell[102194, 2654, 518, 8, 26, "Print",ExpressionUUID->"00c0b402-302c-4e54-a4e0-dcad25c8e73c"],
Cell[102715, 2664, 510, 8, 26, "Print",ExpressionUUID->"e24b77cf-4f57-49a6-a37d-f1f4aaa2dd65"],
Cell[103228, 2674, 567, 8, 26, "Print",ExpressionUUID->"e34c8cca-402b-484f-b0a1-aded5ba99e37"],
Cell[103798, 2684, 778, 12, 65, "Print",ExpressionUUID->"f2594ffb-b311-4cf4-9c1a-dc9938120eb2"],
Cell[104579, 2698, 587, 9, 103, "Print",ExpressionUUID->"e5ef3355-58ca-4bf0-96f0-8120dfa81ae4"],
Cell[105169, 2709, 7838, 115, 7057, "Print",ExpressionUUID->"a3e3418f-2de0-4185-8424-b063e1acb6cc"],
Cell[113010, 2826, 657, 10, 46, "Print",ExpressionUUID->"e702a8a1-d37b-4b0c-9611-23aa1c8f9f73"],
Cell[113670, 2838, 778, 12, 65, "Print",ExpressionUUID->"2d7e9dba-bf77-43d6-950f-297138c8338b"],
Cell[114451, 2852, 698, 11, 293, "Print",ExpressionUUID->"10e407c9-b671-48fb-b809-c31337bb010b"],
Cell[115152, 2865, 7938, 115, 7779, "Print",ExpressionUUID->"c5f73333-21af-4c77-b161-f99e33d4fd53"],
Cell[123093, 2982, 510, 8, 26, "Print",ExpressionUUID->"a5dc2bf4-61a7-458e-b3b7-72db249b32aa"],
Cell[123606, 2992, 673, 10, 46, "Print",ExpressionUUID->"6f5404c2-d3c2-4200-b448-b02f9a15dfbf"],
Cell[124282, 3004, 778, 12, 65, "Print",ExpressionUUID->"c0e78275-d3de-45c2-b846-278fa4e3fe84"],
Cell[125063, 3018, 716, 11, 331, "Print",ExpressionUUID->"7a81c769-3aaa-4146-ad55-141ff28928ea"],
Cell[125782, 3031, 7934, 114, 7817, "Print",ExpressionUUID->"2968b4be-2a3b-4b06-8470-969382e831f7"],
Cell[133719, 3147, 673, 10, 46, "Print",ExpressionUUID->"bdad7e70-53e3-42a5-a594-fc1fdb5a262f"],
Cell[134395, 3159, 778, 12, 65, "Print",ExpressionUUID->"d9544bd3-7ea9-4071-950e-2b91d91fd312"],
Cell[135176, 3173, 718, 11, 331, "Print",ExpressionUUID->"8c36a94d-7f40-4ed3-a333-c6a364544bb4"],
Cell[135897, 3186, 7966, 116, 7969, "Print",ExpressionUUID->"4e97b824-be79-4902-af29-306db74a3bdc"],
Cell[143866, 3304, 705, 13, 26, "Print",ExpressionUUID->"c50f2f83-a9fe-4e18-9292-b125867b8216"],
Cell[144574, 3319, 687, 13, 26, "Print",ExpressionUUID->"f0276488-57ba-441d-a2ab-bfcba95311d7"],
Cell[145264, 3334, 152, 3, 35, "Input",ExpressionUUID->"0d9147ea-7b39-4a9a-9019-a788b08a9021"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145453, 3342, 197, 4, 36, "Input",ExpressionUUID->"e46929c0-07ce-4709-bcda-8c7ac12b8862"],
Cell[145653, 3348, 42461, 761, 642, "Output",ExpressionUUID->"425a00fa-25b1-4db1-ba30-4adb841f4d79"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[188153, 4114, 181, 4, 36, "Input",ExpressionUUID->"1161a2d9-6795-4769-a7b1-c46f0bf22cc3"],
Cell[CellGroupData[{
Cell[188359, 4122, 190, 4, 62, "Subtitle",ExpressionUUID->"2c715488-8574-4dc8-b259-e407398884f0"],
Cell[CellGroupData[{
Cell[188574, 4130, 193, 3, 120, "Subtitle",ExpressionUUID->"04a6cd04-a1ad-4f68-89b0-09b82e237d8b"],
Cell[188770, 4135, 460, 10, 188, "Input",ExpressionUUID->"48166561-3b1d-4d0c-99e7-fbf136785210"],
Cell[189233, 4147, 1204, 32, 647, "Input",ExpressionUUID->"d173f676-d991-422e-925e-848a3c01d1c8"],
Cell[190440, 4181, 305, 9, 188, "Input",ExpressionUUID->"6f4603c2-1919-4713-9f3d-46f2373773f9"],
Cell[190748, 4192, 646, 14, 425, "Input",ExpressionUUID->"f1373096-91c6-4ff9-b77d-cf67e08b45f2"],
Cell[191397, 4208, 414, 9, 188, "Input",ExpressionUUID->"d9f570bf-0939-4b37-8ea1-49aa68016099"],
Cell[191814, 4219, 335, 9, 188, "Input",ExpressionUUID->"f79c04a5-5bb8-4d01-bad7-24fb62e57685"],
Cell[192152, 4230, 357, 9, 307, "Input",ExpressionUUID->"b11908d1-0513-47b9-b2cf-7496adc770f6"],
Cell[192512, 4241, 391, 9, 307, "Input",ExpressionUUID->"1c23c8e9-8c90-42a8-b35e-89ecee86aa63"],
Cell[192906, 4252, 2171, 48, 1665, "Input",ExpressionUUID->"d12d2742-bf4e-43cd-8efe-d9b2bf9f1ddb"],
Cell[195080, 4302, 2137, 53, 1220, "Input",ExpressionUUID->"7ec09b1f-51be-4efa-a5cf-4f855bea40b4"],
Cell[197220, 4357, 1651, 37, 762, "Input",ExpressionUUID->"2bb525bc-1b3e-4313-a4d8-43596cac591d"],
Cell[198874, 4396, 326, 6, 188, "Input",ExpressionUUID->"168cbd1f-187a-4c9e-a519-380f5029763a"],
Cell[199203, 4404, 171, 4, 188, "Input",ExpressionUUID->"4d46bed1-9f85-4c46-a287-e1c498026f22"],
Cell[199377, 4410, 1010, 26, 535, "Input",ExpressionUUID->"debcb2a5-d54b-4108-a285-b9df83d79199"],
Cell[200390, 4438, 910, 20, 307, "Input",ExpressionUUID->"ea90d0af-3dd3-4248-a477-5318c4d13a44"],
Cell[201303, 4460, 315, 7, 188, "Input",ExpressionUUID->"370fcd2f-d37d-408c-ae37-9e62e685604c"],
Cell[201621, 4469, 428, 10, 188, "Input",ExpressionUUID->"c7547eb4-845e-4dc4-a46c-8808e81a4a86"],
Cell[202052, 4481, 918, 20, 307, "Input",ExpressionUUID->"32a6a789-05b7-46a9-acfd-3c76d8e4754c"],
Cell[202973, 4503, 764, 17, 307, "Input",ExpressionUUID->"66e92952-00d3-41ee-b425-43253b008cf9"],
Cell[203740, 4522, 648, 15, 307, "Input",ExpressionUUID->"86a39eaf-6c11-4f07-be79-8c82a081ffad"],
Cell[204391, 4539, 502, 11, 188, "Input",ExpressionUUID->"f7b5f770-59e8-46ac-982c-1bb4f808342f"],
Cell[204896, 4552, 457, 7, 187, "Text",ExpressionUUID->"2bb2c12e-8c52-4e40-9006-aa14df8aba28"],
Cell[205356, 4561, 386, 8, 187, "Text",ExpressionUUID->"7a22154a-cae8-4624-9a16-0a71e403dc5a"],
Cell[205745, 4571, 445, 8, 293, "Text",ExpressionUUID->"26faa9f2-ab5f-49ae-b942-980e9ac4d4aa"],
Cell[206193, 4581, 244, 6, 188, "Input",ExpressionUUID->"c18dffc4-bef2-44f6-bad3-27591dea4f8b"],
Cell[206440, 4589, 1052, 22, 307, "Input",ExpressionUUID->"5ccfd4d3-ee22-478b-ae97-d3a55f5e0442"],
Cell[207495, 4613, 997, 24, 762, "Input",ExpressionUUID->"186f3d6c-ef4e-4cff-b476-54eecbd918ac"],
Cell[208495, 4639, 581, 13, 188, "Input",ExpressionUUID->"1e2d2d99-5518-4d52-ba69-bfaf22cda31b"],
Cell[209079, 4654, 339, 9, 627, "Text",ExpressionUUID->"9b22137e-6645-4778-a8f4-e5c118342aa2"],
Cell[209421, 4665, 788, 17, 307, "Input",ExpressionUUID->"c61cd9aa-05f8-451d-afc9-a2aa733c5363"],
Cell[210212, 4684, 364, 9, 188, "Input",ExpressionUUID->"56e0d398-20da-4c24-a55a-956be9d66f62"],
Cell[210579, 4695, 370, 7, 188, "Input",ExpressionUUID->"9bed52e1-37e9-449f-b571-b64ae2d2130b"],
Cell[210952, 4704, 734, 12, 187, "Text",ExpressionUUID->"aa8e8216-8ac0-4e2a-af79-dca7d0934cca"],
Cell[211689, 4718, 1308, 31, 647, "Input",ExpressionUUID->"a9184859-c949-4e9f-88c7-1e2e39d34984"],
Cell[213000, 4751, 531, 12, 188, "Input",ExpressionUUID->"3445692b-c03d-4399-acb3-cd95d571d5bd"],
Cell[213534, 4765, 343, 8, 188, "Input",ExpressionUUID->"9f07ce97-a97b-4cc8-9e6c-70537fa3669b"],
Cell[213880, 4775, 680, 13, 188, "Input",ExpressionUUID->"67b5d60b-cd3a-4513-93fa-6dbbe68dd7c7"],
Cell[214563, 4790, 223, 5, 188, "Input",ExpressionUUID->"36e3cb19-be19-40a3-86e7-a6678a3d4a19"],
Cell[214789, 4797, 509, 11, 188, "Input",ExpressionUUID->"79b09721-d056-44ac-929c-712efbaf3908"],
Cell[215301, 4810, 638, 15, 321, "Input",ExpressionUUID->"1a06cf2d-48c0-452c-882b-c830661e46e0"],
Cell[215942, 4827, 1104, 30, 332, "Input",ExpressionUUID->"a7cd9709-264e-4fc1-bf3a-9a397dda670c"],
Cell[217049, 4859, 1075, 29, 332, "Input",ExpressionUUID->"09d44404-3c78-40a6-aa12-aa361d490dc3"],
Cell[218127, 4890, 537, 13, 321, "Input",ExpressionUUID->"1248b998-e90a-44e4-9d7d-584802f1c348"],
Cell[218667, 4905, 276, 7, 188, "Input",ExpressionUUID->"37d3e421-ee2c-4e0d-9293-8cff263da424"],
Cell[218946, 4914, 4557, 95, 2125, "Code",ExpressionUUID->"c20950c1-b387-4d71-aafc-9c39dd9774c3"],
Cell[223506, 5011, 2196, 51, 1332, "Code",ExpressionUUID->"e09ad023-a5ad-4301-8f5e-341d1cf22154"],
Cell[225705, 5064, 749, 14, 307, "Input",ExpressionUUID->"982a06ab-e132-4674-9a95-3d0ee3e9e8c2"],
Cell[226457, 5080, 234, 5, 175, "Subsubsection",ExpressionUUID->"09c0c0f8-cd97-40d3-a1a1-f921d3e1174e"],
Cell[226694, 5087, 189, 4, 140, "Input",ExpressionUUID->"b79d8e5b-16e9-4c78-8a2f-438ee6aaa943"],
Cell[226886, 5093, 187, 3, 487, "Section",ExpressionUUID->"e6ce6857-cc90-4239-a1df-e442a8d52a2f"],
Cell[227076, 5098, 343, 9, 262, "Code",ExpressionUUID->"ae4993fa-865f-4f84-b943-fb64b4319906"],
Cell[227422, 5109, 3351, 76, 1562, "Code",ExpressionUUID->"fbbf1644-2eee-4c9c-9740-8c12eb5090da"],
Cell[230776, 5187, 858, 20, 652, "Code",ExpressionUUID->"818ef731-d807-4f6c-8612-26a3c53915c4"],
Cell[231637, 5209, 2313, 58, 1220, "Input",ExpressionUUID->"97454f10-3f99-4bb2-808a-4931900b2926"],
Cell[233953, 5269, 414, 11, 188, "Input",ExpressionUUID->"af4f7656-b332-4a0f-8933-d23cb6e32181"],
Cell[234370, 5282, 219, 4, 188, "Input",ExpressionUUID->"80c7660e-d278-4017-9f6f-b049c02bf4be"],
Cell[234592, 5288, 1229, 34, 577, "Input",ExpressionUUID->"8155b724-a0ae-457b-be3d-e25534053b96"],
Cell[235824, 5324, 306, 8, 307, "Input",ExpressionUUID->"697f1200-5fee-42fa-a65d-f95674684066"],
Cell[236133, 5334, 1179, 34, 577, "Input",ExpressionUUID->"e4d1d576-8adc-4ffa-b70b-89ed9d802766"],
Cell[237315, 5370, 1719, 49, 808, "Input",ExpressionUUID->"2419fd9f-db58-42d0-85ba-9a7247fff49a"],
Cell[239037, 5421, 247, 6, 175, "Subsubsection",ExpressionUUID->"7ef8a81a-c07c-4f1d-9829-b42d5a4420a4"],
Cell[239287, 5429, 1543, 42, 916, "Input",ExpressionUUID->"0a1d5a51-b369-4814-aaab-f6ff43fb0093"],
Cell[CellGroupData[{
Cell[240855, 5475, 587, 15, 307, "Input",ExpressionUUID->"fc58003b-c069-4e3f-93e0-26ad1d1726ea"],
Cell[241445, 5492, 196, 3, 188, "Input",ExpressionUUID->"a9bcd4dd-adbd-41c2-a342-2dabdf4bd00b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241678, 5500, 3462, 99, 1408, "Input",ExpressionUUID->"311ac420-578d-4b74-91b8-b211053c896e"],
Cell[245143, 5601, 215, 4, 188, "Input",ExpressionUUID->"a256f25f-84e0-47ed-a790-c7b12f18325e"]
}, Open  ]],
Cell[245373, 5608, 203, 4, 188, "Input",ExpressionUUID->"77802582-5735-4d6f-9e69-436c6f8e4697"],
Cell[245579, 5614, 236, 5, 175, "Subsubsection",ExpressionUUID->"4cd4bd7b-1050-48fc-bb39-da6b322c36ac"],
Cell[245818, 5621, 756, 19, 140, "Input",ExpressionUUID->"c87ee2ff-3b45-40eb-80bf-7517f1956a50"],
Cell[246577, 5642, 213, 4, 175, "Subsubsection",ExpressionUUID->"84ff1a83-79bc-4815-bcc9-bd989d07957a"],
Cell[246793, 5648, 307, 7, 140, "Input",ExpressionUUID->"d54bbfcc-bb19-4018-8b6b-f8907422029d"],
Cell[247103, 5657, 250, 5, 188, "Input",ExpressionUUID->"25080c3e-fc56-45e0-b4b0-cca4bf869951"],
Cell[247356, 5664, 211, 4, 175, "Subsubsection",ExpressionUUID->"c617accd-a743-4794-b1bc-f304fb024346"],
Cell[247570, 5670, 464, 10, 140, "Input",ExpressionUUID->"a173a9b2-e17c-4c46-b2a7-8701e2a61f81"],
Cell[248037, 5682, 247, 5, 188, "Input",ExpressionUUID->"c8f1936f-f3ba-4a5a-84b2-85adc3176359"],
Cell[248287, 5689, 205, 3, 175, "Subsubsection",ExpressionUUID->"76961292-be05-4504-abd4-0bbee05f532d"],
Cell[CellGroupData[{
Cell[248517, 5696, 228, 5, 140, "Input",ExpressionUUID->"c096a14b-20ca-4bf9-9e4f-f2572a8defad"],
Cell[248748, 5703, 733, 14, 188, "Input",ExpressionUUID->"a0f5de58-4205-4238-a1e2-0d4db4f8bc50"],
Cell[249484, 5719, 250, 6, 652, "Section",ExpressionUUID->"c58c016a-b440-4836-a571-255ff16af27f"],
Cell[249737, 5727, 387, 9, 140, "Input",ExpressionUUID->"dfcb5487-80d0-4a7f-b413-cd6e8cd164ac"],
Cell[250127, 5738, 515, 13, 188, "Input",ExpressionUUID->"e1c5ecac-1834-40ab-826f-a79b1c2e853d"]
}, Open  ]],
Cell[250657, 5754, 194, 4, 188, "Input",ExpressionUUID->"e61b8955-ba8a-44ce-8444-1c01fe1e9009"],
Cell[250854, 5760, 198, 3, 175, "Subsubsection",ExpressionUUID->"a7b8e041-80a8-45cc-a9dd-69a8bf0c75b5"],
Cell[251055, 5765, 849, 23, 1603, "Text",ExpressionUUID->"ace1dd46-998a-4f42-96ae-3cb13cd1784d"],
Cell[251907, 5790, 185, 3, 175, "Subsubsection",ExpressionUUID->"79385e94-e374-4bf9-983d-6de23ed3a597"],
Cell[252095, 5795, 4601, 98, 2078, "Code",ExpressionUUID->"2c720dce-a8ae-47ab-8c31-8d7b2d33de18"],
Cell[256699, 5895, 1405, 33, 882, "Code",ExpressionUUID->"8d7b5ad7-c356-4422-8d36-2926e3135c02"],
Cell[258107, 5930, 190, 4, 188, "Input",ExpressionUUID->"67bd358d-da44-40c7-a97a-0ae034977f1e"],
Cell[258300, 5936, 518, 11, 408, "Text",ExpressionUUID->"30f7b878-2fa4-4b9b-8d42-b82983000d9c"],
Cell[258821, 5949, 369, 10, 188, "Input",ExpressionUUID->"4ecbe97e-c997-414e-8512-f83cc0cbdbca"],
Cell[259193, 5961, 557, 12, 425, "Input",ExpressionUUID->"bfda6e6a-3078-4804-977a-134934e70666"],
Cell[259753, 5975, 187, 3, 175, "Subsubsection",ExpressionUUID->"27a8054e-cdbe-4ff5-98a1-d930da91445a"],
Cell[259943, 5980, 1943, 45, 1056, "Code",ExpressionUUID->"07797665-0d89-4c61-9c8c-d75c71ae3df6"],
Cell[261889, 6027, 177, 3, 188, "Input",ExpressionUUID->"f346a6f9-76ba-45b3-a7c7-b0dc460203a1"],
Cell[262069, 6032, 564, 12, 425, "Input",ExpressionUUID->"68f064d4-1e6e-4980-94a2-5720704abaa8"],
Cell[262636, 6046, 433, 12, 627, "Text",ExpressionUUID->"2e2bc07e-e2ad-49f6-a4b6-9e9eb76ff002"],
Cell[263072, 6060, 3468, 92, 2121, "Input",ExpressionUUID->"cfca20f3-afbb-4b20-bd91-2a15bbbb4491"],
Cell[266543, 6154, 262, 7, 188, "Input",ExpressionUUID->"e1d9f5be-fe48-49f3-9f92-76f8c880d9fe"],
Cell[266808, 6163, 275, 6, 188, "Input",ExpressionUUID->"b22fda30-cd35-4302-afa2-c83af9e27620"],
Cell[267086, 6171, 434, 11, 425, "Input",ExpressionUUID->"ae140613-cb79-4cbd-878c-04eb13252ece"],
Cell[267523, 6184, 2015, 38, 1220, "Input",ExpressionUUID->"e9e88c15-0168-4b53-8b95-08cf9433142e"],
Cell[269541, 6224, 317, 8, 307, "Input",ExpressionUUID->"3405d47b-5a59-45ba-9417-50a514d54119"],
Cell[269861, 6234, 393, 8, 188, "Input",ExpressionUUID->"5b66b768-1150-4143-8054-c0104b392102"],
Cell[270257, 6244, 475, 9, 188, "Input",ExpressionUUID->"0c4d1f08-177a-4f78-9b86-929c095bcc20"],
Cell[270735, 6255, 224, 4, 188, "Input",ExpressionUUID->"0ff1f008-d4fc-4f35-a176-b34fec49f697"]
}, Closed]],
Cell[CellGroupData[{
Cell[270996, 6264, 376, 6, 120, "Subtitle",ExpressionUUID->"6294fc58-93c7-413b-bfd3-f8035c6e9d8f"],
Cell[271375, 6272, 2025, 51, 315, "Input",ExpressionUUID->"f86a40de-3ba0-4293-8b41-ed5344aef4c4"],
Cell[273403, 6325, 1771, 39, 233, "Input",ExpressionUUID->"835b3b05-90de-48c6-9009-ce83d26b2cd4"],
Cell[275177, 6366, 357, 6, 70, "Input",ExpressionUUID->"de8f2c6f-2735-409a-9f5d-4d826e94cfd7"],
Cell[275537, 6374, 252, 6, 66, "Input",ExpressionUUID->"095fcc8e-d676-42e2-9add-ee433dc19a10"],
Cell[275792, 6382, 174, 3, 103, "Subsection",ExpressionUUID->"36c4f395-0f02-4352-9d3d-4dec7b6332f4"],
Cell[275969, 6387, 250, 6, 53, "Input",ExpressionUUID->"9a9ae81a-f2b8-4496-acec-180c9d217d3b"],
Cell[276222, 6395, 405, 11, 70, "Input",ExpressionUUID->"116db58d-4626-4f3e-9560-6802e8f20566"],
Cell[276630, 6408, 726, 19, 116, "Input",ExpressionUUID->"9a9ce9d8-0b9b-4f31-b895-4b75a5802870"],
Cell[277359, 6429, 848, 23, 116, "Input",ExpressionUUID->"00883389-7ed5-41bf-924c-be0b364281ba"],
Cell[278210, 6454, 1141, 26, 275, "Input",ExpressionUUID->"6676b413-f633-44a6-ae0b-3dba93ea9113"],
Cell[279354, 6482, 1053, 22, 70, "Input",ExpressionUUID->"6fc2c491-dcac-4859-8c59-7015d47007fe"],
Cell[280410, 6506, 867, 18, 70, "Input",ExpressionUUID->"27aea4b1-e160-427b-827c-afc057e87392"],
Cell[281280, 6526, 545, 13, 70, "Input",ExpressionUUID->"b306c8be-0667-41d7-ae6e-38be3c2a1d50"],
Cell[281828, 6541, 568, 13, 70, "Input",ExpressionUUID->"7a260924-3134-42b2-8ac6-7a700cd51442"],
Cell[282399, 6556, 594, 13, 70, "Input",ExpressionUUID->"517c0ba0-5bd6-47e0-9d06-c0742b3470d6"],
Cell[CellGroupData[{
Cell[283018, 6573, 451, 9, 168, "Subsubtitle",ExpressionUUID->"0492afaf-a27f-46bb-9a09-ebdaede94796"],
Cell[283472, 6584, 186, 4, 66, "Input",ExpressionUUID->"88289d8c-6ce2-487c-b772-c03b2405f5f2"],
Cell[283661, 6590, 339, 9, 257, "Text",ExpressionUUID->"6f34dfaa-a4e5-45d0-9d62-e25af533992c"],
Cell[284003, 6601, 245, 6, 70, "Input",ExpressionUUID->"d3c28cf4-827b-453c-aa78-a90880d6ce7c"],
Cell[284251, 6609, 301, 8, 70, "Input",ExpressionUUID->"a946248e-5f50-4f44-91d8-a729969d255b"],
Cell[284555, 6619, 808, 20, 191, "Input",ExpressionUUID->"cc00a176-43c6-412b-a3bb-3344c68cd8ff"],
Cell[285366, 6641, 186, 3, 82, "Subsubsection",ExpressionUUID->"8081db88-88db-4117-840f-f1cb021a78d5"],
Cell[285555, 6646, 762, 16, 95, "Input",ExpressionUUID->"d58eeefc-24f9-4db4-8bc2-0e4555a37971"],
Cell[286320, 6664, 827, 17, 110, "Input",ExpressionUUID->"8f9716d6-4ad4-4289-a6bf-471898ff94eb"],
Cell[287150, 6683, 1099, 23, 562, "Input",ExpressionUUID->"1fc63750-b30f-491c-b764-c3a834d9ebe7"],
Cell[288252, 6708, 1115, 23, 847, "Input",ExpressionUUID->"b4a4b86f-dd27-4989-9eb9-73c6f4edaf8b"],
Cell[289370, 6733, 422, 11, 120, "Code",ExpressionUUID->"2558cbdc-f926-492f-8450-cdf5703327e6"],
Cell[289795, 6746, 209, 4, 103, "Subsection",ExpressionUUID->"2db8ce0c-0fa9-470e-946d-b2c5a16aeef0"],
Cell[290007, 6752, 474, 8, 108, "Text",ExpressionUUID->"abd73772-a9c2-41b8-a7fe-c4ad8aba99b1"],
Cell[290484, 6762, 249, 6, 70, "Input",ExpressionUUID->"06b305c9-f063-4556-89bb-e2c1fa78e4fb"],
Cell[290736, 6770, 315, 8, 116, "Input",ExpressionUUID->"b89ec56d-ef0d-4e23-9a04-f081ace5174a"],
Cell[291054, 6780, 370, 9, 70, "Input",ExpressionUUID->"24b01632-4f8e-4c84-84e2-1cd93c5d242e"],
Cell[291427, 6791, 686, 13, 75, "Input",ExpressionUUID->"41edba45-7fc6-4a4a-aa9c-649c63bb203b"],
Cell[292116, 6806, 621, 13, 70, "Input",ExpressionUUID->"4a8151f5-cb64-4cb7-bf25-32e1180ac46c"],
Cell[292740, 6821, 623, 15, 110, "Input",ExpressionUUID->"df2714fc-1093-484f-a66d-c8be0175df42"],
Cell[293366, 6838, 204, 3, 82, "Subsubsection",ExpressionUUID->"b00a03b7-7880-439a-beb6-7dd5c00b8a05"],
Cell[293573, 6843, 678, 13, 53, "Input",ExpressionUUID->"c25f6040-1a79-49f1-9e9f-cffcc60e7376"],
Cell[294254, 6858, 361, 8, 70, "Input",ExpressionUUID->"724303b8-d74c-4dfe-8f3e-dd160b80c0d5"],
Cell[294618, 6868, 891, 14, 70, "Input",ExpressionUUID->"1fe6106e-de71-49f7-a2c1-eaf6d4ec420f"],
Cell[295512, 6884, 285, 6, 70, "Input",ExpressionUUID->"2910f3f5-58f4-4e2d-972b-4959237de5fb"],
Cell[295800, 6892, 240, 6, 70, "Input",ExpressionUUID->"0b799d17-b79c-4581-9ab9-d4a12de264b7"],
Cell[296043, 6900, 1220, 26, 191, "Input",ExpressionUUID->"594b4891-4211-450b-98d7-71de46981d6d"],
Cell[297266, 6928, 743, 16, 70, "Input",ExpressionUUID->"8e6abcd4-fb7e-4029-abb2-45c4666bea00"],
Cell[298012, 6946, 213, 4, 70, "Input",ExpressionUUID->"88ceb5f1-c2c5-40fc-b989-a3842fbdfb3a"],
Cell[298228, 6952, 378, 10, 70, "Input",ExpressionUUID->"3f66efb8-cc7b-4d9d-9b46-7dfbaa7fdbcf"],
Cell[298609, 6964, 811, 15, 70, "Input",ExpressionUUID->"a9e7fd83-df64-4891-944a-1c00bdef6d8b"],
Cell[299423, 6981, 741, 15, 70, "Input",ExpressionUUID->"baa34df7-eac0-4a3c-bf0a-841d6356b87d"],
Cell[300167, 6998, 946, 22, 233, "Code",ExpressionUUID->"1dc963d6-f3c6-4a07-a2ed-fadac30c734f"],
Cell[301116, 7022, 6179, 159, 1135, "Input",ExpressionUUID->"8abdfec6-cd5c-4542-ba2d-cb8cecc20f18"],
Cell[307298, 7183, 349, 8, 70, "Input",ExpressionUUID->"006a7203-5bc5-4d07-837c-6594d827b962"],
Cell[307650, 7193, 255, 4, 70, "Input",ExpressionUUID->"9c2bb84b-96f9-4522-951e-1a1c518c535b"],
Cell[307908, 7199, 1994, 36, 397, "Input",ExpressionUUID->"f997ec67-1942-403e-a9f4-5d6e140b6d4c"],
Cell[309905, 7237, 427, 9, 70, "Input",ExpressionUUID->"88b074e4-54dd-4e2b-bad9-ea91168a7288"],
Cell[310335, 7248, 550, 11, 70, "Input",ExpressionUUID->"46a79b8d-1e2e-4535-ba78-012f08930ac0"],
Cell[310888, 7261, 260, 5, 70, "Input",ExpressionUUID->"2a284c8e-4f9e-49f4-930c-443e7a9801d2"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[311209, 7273, 235, 7, 99, "Subtitle",ExpressionUUID->"8eff8c93-b291-4cb0-9b17-7199246e51d1"],
Cell[311447, 7282, 276, 7, 188, "Input",ExpressionUUID->"d9b7948b-774f-4824-9b60-dd99d81dc301"],
Cell[311726, 7291, 922, 25, 535, "Input",ExpressionUUID->"0f08a473-a77c-4983-a9fe-f066073c6889"],
Cell[312651, 7318, 703, 17, 535, "Input",ExpressionUUID->"1b5613f7-9999-40e8-9a1b-8dd9afcb6daf"],
Cell[313357, 7337, 202, 5, 188, "Input",ExpressionUUID->"82c0e2c9-adb8-4d29-a03b-298588339569"],
Cell[313562, 7344, 1050, 23, 352, "Input",ExpressionUUID->"0598a9a2-9737-43e0-86c2-d657b3486f10"],
Cell[314615, 7369, 248, 6, 188, "Input",ExpressionUUID->"bc5287ed-a6e8-45ab-901e-e489e9525923"],
Cell[314866, 7377, 345, 8, 188, "Input",ExpressionUUID->"3a6e0aa1-a05a-4b66-a123-ad1af56a4132"],
Cell[CellGroupData[{
Cell[315236, 7389, 163, 3, 245, "Subsection",ExpressionUUID->"2e11cee1-5a1a-4cfb-9daf-d12953e14247"],
Cell[315402, 7394, 1796, 45, 1665, "Input",ExpressionUUID->"2a0cd881-05a5-4cbf-bcf9-331914dde335"],
Cell[317201, 7441, 1723, 45, 877, "Input",ExpressionUUID->"ef2df254-04a0-405b-80b4-73e467060be2"],
Cell[318927, 7488, 1937, 43, 988, "Input",ExpressionUUID->"8d9c1630-18cf-4acf-95fa-6725807f7890"],
Cell[320867, 7533, 333, 6, 188, "Input",ExpressionUUID->"8c67aaa1-28c3-4dea-b832-1cc4a7c7e851"],
Cell[321203, 7541, 2827, 60, 1102, "Input",ExpressionUUID->"7ca4aa3f-9612-4a74-a023-640a1363418a"]
}, Open  ]],
Cell[324045, 7604, 178, 3, 188, "Input",ExpressionUUID->"4921a7bc-f8ea-4c3c-acec-c55baca17f9e"],
Cell[324226, 7609, 178, 3, 188, "Input",ExpressionUUID->"481536ab-85bd-482a-97ce-22ea51eeb596"],
Cell[324407, 7614, 216, 4, 245, "Subsection",ExpressionUUID->"4ef27c07-ee8e-4cee-8fe9-e5efaf3cfd75"],
Cell[324626, 7620, 202, 3, 140, "Input",ExpressionUUID->"94317aa6-0b03-47ef-8eba-a96962bf3937"],
Cell[324831, 7625, 522, 14, 188, "Input",ExpressionUUID->"9c0ffe86-94ca-49d6-ba4c-7a16bd99a8d7"],
Cell[325356, 7641, 280, 6, 188, "Input",ExpressionUUID->"eed2827b-c4c2-40ac-8d06-c3f32cb0fe02"],
Cell[325639, 7649, 620, 12, 307, "Input",ExpressionUUID->"18bf73ed-011e-4d62-8661-97de2962c28e"],
Cell[326262, 7663, 282, 5, 188, "Input",ExpressionUUID->"3579a211-b219-427c-a8d3-2e2a49232288"],
Cell[326547, 7670, 199, 3, 188, "Input",ExpressionUUID->"abdbc1c0-1f0f-4a9a-af20-8267acb8e44f"],
Cell[CellGroupData[{
Cell[326771, 7677, 183, 3, 245, "Subsection",ExpressionUUID->"97ea9cdc-80ab-43bd-ae91-5478f81d636f"],
Cell[326957, 7682, 2225, 54, 1220, "Input",ExpressionUUID->"04ed4df2-046d-4f8f-bdd7-d96cb606975d"],
Cell[329185, 7738, 332, 7, 188, "Input",ExpressionUUID->"08ae4ef2-8503-453a-95f2-17ae3af1ae68"],
Cell[329520, 7747, 584, 12, 188, "Input",ExpressionUUID->"7aee63a8-8c6f-4f95-ae72-75d7f5a8e959"],
Cell[330107, 7761, 1905, 35, 1102, "Input",ExpressionUUID->"c145ce0d-1735-4fc7-a475-9cda3f545571"],
Cell[332015, 7798, 376, 9, 188, "Input",ExpressionUUID->"a8eddba7-569c-4584-bcbf-e1a79d33794d"],
Cell[332394, 7809, 553, 11, 188, "Input",ExpressionUUID->"622eeef3-ba27-43e4-a2f3-1472ced362ad"]
}, Open  ]],
Cell[332962, 7823, 279, 5, 188, "Input",ExpressionUUID->"65a3ea34-3ede-44da-9f37-973bd9a24806"]
}, Closed]],
Cell[CellGroupData[{
Cell[333278, 7833, 377, 9, 135, "Subtitle",ExpressionUUID->"e1911cd3-0e16-4ce7-89eb-7925443f20a0"],
Cell[333658, 7844, 364, 9, 36, "Input",ExpressionUUID->"216f22c8-83eb-4f7b-829e-16a5b07ceaf1"],
Cell[334025, 7855, 579, 15, 57, "Input",ExpressionUUID->"957c5682-b448-4275-93a1-5fea2f3d7431"],
Cell[334607, 7872, 575, 13, 35, "Input",ExpressionUUID->"0f2cb3fb-5e2a-423b-a49e-7bd83017c0f3"],
Cell[335185, 7887, 699, 12, 36, "Input",ExpressionUUID->"84596d0c-af08-4482-b3eb-660f5b099729"],
Cell[335887, 7901, 248, 6, 35, "Input",ExpressionUUID->"60ed279c-0020-40ec-849d-2a9046d0cbcb"],
Cell[CellGroupData[{
Cell[336160, 7911, 163, 3, 54, "Subsection",ExpressionUUID->"b630c207-9811-4dbf-a935-44cc6da0b53f"],
Cell[336326, 7916, 783, 18, 120, "Input",ExpressionUUID->"b6c4f516-a68b-4dc8-86f8-6b0c609f2e87"],
Cell[337112, 7936, 1569, 40, 141, "Input",ExpressionUUID->"a9cfde97-ddb6-4908-8a33-448455ede328"],
Cell[338684, 7978, 1623, 37, 141, "Input",ExpressionUUID->"e088c280-1e67-49f8-a3d6-dc5054ccce1f"],
Cell[340310, 8017, 274, 5, 36, "Input",ExpressionUUID->"6e3a1361-6e11-418f-86ae-32d90ce468cc"],
Cell[340587, 8024, 2117, 44, 141, "Input",ExpressionUUID->"a40b46e8-8d16-464f-aee4-0bd267e62af8"]
}, Open  ]],
Cell[342719, 8071, 216, 4, 54, "Subsection",ExpressionUUID->"690ceaa6-7f80-4d08-a085-d1355e1abf45"],
Cell[342938, 8077, 193, 3, 28, "Input",ExpressionUUID->"4eaf5511-f42c-4baf-998c-b0c82ead7bd6"],
Cell[343134, 8082, 459, 13, 35, "Input",ExpressionUUID->"1386436e-e2c5-4667-87d0-8456c6abeee6"],
Cell[343596, 8097, 269, 6, 35, "Input",ExpressionUUID->"b68e0a34-bca3-43ee-acab-bef2a6e2892a"],
Cell[343868, 8105, 624, 12, 57, "Input",ExpressionUUID->"a4eea477-b970-450a-ac49-e462576267c4"],
Cell[344495, 8119, 275, 5, 35, "Input",ExpressionUUID->"9b582343-aad8-406b-8acb-61b7bc63b91e"],
Cell[344773, 8126, 190, 3, 36, "Input",ExpressionUUID->"8e679f38-fa53-4896-96c7-5208e3185127"],
Cell[CellGroupData[{
Cell[344988, 8133, 183, 3, 54, "Subsection",ExpressionUUID->"54bf2ce1-a97b-42d8-ac9b-f9b8c5d266d1"],
Cell[345174, 8138, 531, 12, 99, "Input",ExpressionUUID->"f2b20cb6-1ad4-4ce2-a374-9521872030cc"],
Cell[345708, 8152, 311, 7, 35, "Input",ExpressionUUID->"4d5bfe03-8d22-48c2-8e2f-fee5e1105709"],
Cell[346022, 8161, 270, 5, 35, "Input",ExpressionUUID->"294dc2ea-bc6e-4f72-823d-041a33df6363"],
Cell[346295, 8168, 506, 11, 36, "Input",ExpressionUUID->"ffeb086d-42cc-4124-a1cb-dd098c459d7d"],
Cell[346804, 8181, 304, 7, 36, "Input",ExpressionUUID->"5bf34cf6-a3f5-42ae-9674-896e8f83c2c6"],
Cell[347111, 8190, 1943, 34, 204, "Input",ExpressionUUID->"15794cbd-d819-4d9c-82f4-b172fc964652"],
Cell[349057, 8226, 339, 7, 36, "Input",ExpressionUUID->"c02aa680-e3c7-4ae4-b996-c0691378d843"],
Cell[349399, 8235, 541, 9, 37, "Text",ExpressionUUID->"01f4c3ba-a397-4574-a553-a150aaca596a"],
Cell[349943, 8246, 633, 11, 36, "Input",ExpressionUUID->"2ec0963f-6f13-4043-9c58-b09df6efdce1"]
}, Open  ]],
Cell[350591, 8260, 306, 7, 37, "Text",ExpressionUUID->"aa084058-801a-4bc7-986f-2b5f5ca6b07d"],
Cell[350900, 8269, 268, 5, 36, "Input",ExpressionUUID->"10510d75-92c9-492e-bb5a-e7c15906dd0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[351205, 8279, 488, 10, 171, "Subtitle",ExpressionUUID->"028542b0-9e01-4307-97e6-99990bb77936"],
Cell[351696, 8291, 526, 11, 188, "Input",ExpressionUUID->"d45b0108-56bb-4fca-b48f-2ac5299781fb"],
Cell[352225, 8304, 551, 14, 307, "Input",ExpressionUUID->"35bd7349-9cf0-41e4-b3b9-b4e82c85baec"],
Cell[352779, 8320, 599, 12, 188, "Input",ExpressionUUID->"b968ff22-b750-4d22-930f-2e5aeaea0053"],
Cell[353381, 8334, 501, 13, 188, "Input",ExpressionUUID->"5175a19b-cadc-4cf9-a2ea-2e6ff34f9a37"],
Cell[353885, 8349, 852, 16, 340, "Input",ExpressionUUID->"0656a7b9-dff3-4051-9108-426d8947cded"],
Cell[354740, 8367, 859, 14, 327, "Input",ExpressionUUID->"ecbcb2b6-aa93-4c3a-b8c2-e4bd24114318"],
Cell[355602, 8383, 462, 8, 188, "Input",ExpressionUUID->"03211933-86df-447e-9097-fe0d5177abcf"],
Cell[356067, 8393, 224, 6, 188, "Input",ExpressionUUID->"b36739b1-2872-4a36-93cd-8f386123e486"],
Cell[CellGroupData[{
Cell[356316, 8403, 154, 3, 245, "Subsection",ExpressionUUID->"0a514688-2796-42a4-8d97-e99b96ec4515"],
Cell[356473, 8408, 838, 19, 647, "Input",ExpressionUUID->"1bc1c738-9349-49fb-a281-14abdbe3c3b2"],
Cell[357314, 8429, 2159, 48, 1102, "Input",ExpressionUUID->"233c2c4b-3120-4b17-b635-49ab217c950d"],
Cell[359476, 8479, 1701, 38, 762, "Input",ExpressionUUID->"c3ac488b-12cb-406e-b380-02c49e2d9980"],
Cell[361180, 8519, 328, 6, 188, "Input",ExpressionUUID->"c37157b1-8af0-450e-b06b-949c8f04abe0"],
Cell[361511, 8527, 3310, 77, 1438, "Input",ExpressionUUID->"55b61fed-3600-47b5-9a4a-a363e99518b6"]
}, Open  ]],
Cell[364836, 8607, 448, 11, 188, "Input",ExpressionUUID->"68fa6a2b-5c0b-4a90-828e-89fb63d5a696"],
Cell[365287, 8620, 272, 6, 188, "Input",ExpressionUUID->"7a226d62-64ac-41c8-9781-36fce0c0c137"],
Cell[365562, 8628, 597, 12, 307, "Input",ExpressionUUID->"c98df20f-80b3-4514-86ca-93bd115476dd"],
Cell[CellGroupData[{
Cell[366184, 8644, 171, 3, 245, "Subsection",ExpressionUUID->"1f90bdff-6a7b-4eb0-bd76-d26eebfa5627"],
Cell[366358, 8649, 377, 8, 188, "Input",ExpressionUUID->"bd8205e4-3988-425e-8ba3-b0246b7cf448"],
Cell[366738, 8659, 252, 5, 188, "Input",ExpressionUUID->"87c12af7-e8b0-44b7-9f06-17b225e6568b"],
Cell[366993, 8666, 452, 11, 188, "Input",ExpressionUUID->"be515830-4a76-44b3-97cb-e431b83ecdd2"],
Cell[367448, 8679, 1782, 34, 1220, "Input",ExpressionUUID->"42f56f94-f1ce-4a55-bb60-fbbc45663e12"],
Cell[369233, 8715, 390, 8, 188, "Input",ExpressionUUID->"736fec4b-5b0b-4e73-8419-8d251b781d8a"],
Cell[369626, 8725, 502, 9, 188, "Input",ExpressionUUID->"bb92f06f-cb0a-4b46-bcbd-e1c27bcc98cb"],
Cell[370131, 8736, 197, 4, 188, "Input",ExpressionUUID->"c39afa8d-3ca8-4076-9a52-a2899a9a466c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[370377, 8746, 303, 7, 62, "Subtitle",ExpressionUUID->"40c497cd-8ecb-4a12-a19e-90050870a153"],
Cell[370683, 8755, 264, 6, 70, "Input",ExpressionUUID->"a3598273-c222-436b-9d94-ca29ebbf3a24"],
Cell[370950, 8763, 308, 7, 70, "Input",ExpressionUUID->"58e0eab9-be8c-43e5-82a3-ad8adbb63338"],
Cell[371261, 8772, 213, 3, 103, "Subsection",ExpressionUUID->"3879886e-f184-4d74-93af-6e49da00fb72"],
Cell[371477, 8777, 397, 9, 53, "Input",ExpressionUUID->"495fb4b5-85f0-462f-aac7-785188d5dabc"],
Cell[CellGroupData[{
Cell[371899, 8790, 800, 15, 70, "Input",ExpressionUUID->"4e665c6e-c0f4-4ca4-833d-8dc01f25a9b8"],
Cell[372702, 8807, 351, 8, 75, "Output",ExpressionUUID->"8d304de0-7a15-40b1-a9d3-de739ee33339"]
}, Open  ]],
Cell[CellGroupData[{
Cell[373090, 8820, 250, 6, 66, "Input",ExpressionUUID->"d49fcc02-7be5-4d13-bb3a-5b4b3983e308"],
Cell[373343, 8828, 299, 5, 70, "Output",ExpressionUUID->"d6e7d04b-1411-43cd-b459-d864f96bcf45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[373679, 8838, 241, 4, 103, "Subsection",ExpressionUUID->"76c2ef4b-da46-4f83-b9d7-f91a9c19990f"],
Cell[373923, 8844, 752, 17, 233, "Input",ExpressionUUID->"446f8cb2-7ee6-4b8d-884e-be17a694418a"],
Cell[374678, 8863, 1294, 30, 233, "Input",ExpressionUUID->"abcb48bc-d911-47a2-92e5-016ff7afb1b1"],
Cell[CellGroupData[{
Cell[375997, 8897, 1552, 36, 233, "Input",ExpressionUUID->"0bbb2f4a-d376-457f-894a-dcf14cdf7f4d"],
Cell[377552, 8935, 305, 5, 50, "Print",ExpressionUUID->"6983a7e6-ddc8-4ca2-a982-bda6a31ea027"],
Cell[377860, 8942, 302, 4, 50, "Print",ExpressionUUID->"7279ae0f-7d9a-4947-b56b-905684f5afb2"],
Cell[378165, 8948, 305, 5, 50, "Print",ExpressionUUID->"03097dad-aff8-4684-9631-d6bb759b3464"]
}, Open  ]],
Cell[CellGroupData[{
Cell[378507, 8958, 272, 5, 70, "Input",ExpressionUUID->"56551ce3-b9df-432e-b5e3-f2b5d6f01a87"],
Cell[378782, 8965, 1392, 35, 353, "Output",ExpressionUUID->"98865c67-f70e-4587-9a96-3ff7fb100164"]
}, Open  ]],
Cell[380189, 9003, 1851, 37, 233, "Input",ExpressionUUID->"d2ec2e96-4d08-4a2b-9b30-b2997f4c3329"]
}, Open  ]],
Cell[382055, 9043, 281, 4, 103, "Subsection",ExpressionUUID->"ed8cec90-4c0a-47d9-9f0f-1990a0389f2f"],
Cell[CellGroupData[{
Cell[382361, 9051, 191, 3, 53, "Input",ExpressionUUID->"07b80f7a-8e11-48e8-95f4-52af32d2333f"],
Cell[382555, 9056, 323, 8, 75, "Output",ExpressionUUID->"d0938f49-fd67-4548-bedd-ad07ee1d2b86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[382915, 9069, 509, 14, 70, "Input",ExpressionUUID->"63510d04-307f-48f5-b131-93115a1e8bfe"],
Cell[383427, 9085, 812, 22, 156, "Output",ExpressionUUID->"d0e8103c-d11d-42a7-97f0-3a875a8ae78a"]
}, Open  ]],
Cell[384254, 9110, 267, 6, 70, "Input",ExpressionUUID->"1d7c25b0-fdd8-4f33-81d8-92b1808f75e8"],
Cell[384524, 9118, 576, 12, 70, "Input",ExpressionUUID->"1ca74e93-7a67-4d46-a40b-bafa109761de"],
Cell[CellGroupData[{
Cell[385125, 9134, 271, 5, 70, "Input",ExpressionUUID->"85b973da-3bee-4bad-afca-ddd60139d234"],
Cell[385399, 9141, 813, 22, 156, "Output",ExpressionUUID->"60a82c6f-f37f-4351-803f-540fcfc39792"]
}, Open  ]],
Cell[CellGroupData[{
Cell[386249, 9168, 186, 3, 70, "Input",ExpressionUUID->"806ee8fc-0086-468d-8963-65f7bd951e4c"],
Cell[386438, 9173, 403, 9, 70, "Output",ExpressionUUID->"90acf8f7-e316-40af-8c72-dff5dedff8a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[386878, 9187, 183, 3, 103, "Subsection",ExpressionUUID->"962d4dfb-fe35-420f-b0a2-e2747b27b8a4"],
Cell[387064, 9192, 522, 12, 191, "Input",ExpressionUUID->"c35375c0-5832-4e1b-8621-e85aed162528"],
Cell[387589, 9206, 308, 7, 70, "Input",ExpressionUUID->"52064099-ffa3-4627-80f8-c2c37f91a2f8"],
Cell[CellGroupData[{
Cell[387922, 9217, 184, 3, 70, "Input",ExpressionUUID->"b1a40249-4327-451e-bdb0-e7f8cabf6dd8"],
Cell[388109, 9222, 3758, 87, 306, "Output",ExpressionUUID->"af6fb70f-bab4-4670-8fa6-bde17ff3ed9c"]
}, Open  ]],
Cell[391882, 9312, 479, 10, 70, "Input",ExpressionUUID->"1410c9bd-0156-4261-9767-d7b16ffc7251"],
Cell[392364, 9324, 324, 7, 70, "Input",ExpressionUUID->"faf75be5-87ba-4164-babb-9d8d83ab387c"],
Cell[392691, 9333, 310, 6, 103, "Subsection",ExpressionUUID->"7a30b210-9d08-4aa3-9dbe-0c1bec4ec4de"],
Cell[393004, 9341, 1869, 33, 382, "Input",ExpressionUUID->"e7c04b05-4842-4c2d-8283-54f03f84cc79"],
Cell[CellGroupData[{
Cell[394898, 9378, 337, 7, 70, "Input",ExpressionUUID->"0398e0a1-c5f2-4b1c-b25d-c1ef738c0fb1"],
Cell[395238, 9387, 489, 10, 50, "Print",ExpressionUUID->"9f1c53ce-2f12-4ea6-8c79-bc0127b19441"],
Cell[395730, 9399, 470, 10, 50, "Print",ExpressionUUID->"2b3439ba-d361-4393-814f-f85f7225a6ac"],
Cell[396203, 9411, 470, 10, 50, "Print",ExpressionUUID->"26bc24b6-d279-4a39-a25c-18fcb9fdebb5"],
Cell[396676, 9423, 462, 10, 50, "Print",ExpressionUUID->"5fd4f1ac-4540-4141-8fcd-3da8950446e9"]
}, Open  ]],
Cell[397153, 9436, 199, 3, 103, "Subsection",ExpressionUUID->"47d94349-2f0d-408a-90da-4fb017e5e65a"],
Cell[CellGroupData[{
Cell[397377, 9443, 629, 11, 53, "Input",ExpressionUUID->"59c99ea9-0cd8-47be-9284-c22abf527e8b"],
Cell[398009, 9456, 551, 14, 77, "Print",ExpressionUUID->"f7b9553d-b6b7-444a-9edd-eb9d80009c46"],
Cell[398563, 9472, 491, 13, 66, "Print",ExpressionUUID->"f6f7c203-e31d-4196-842b-8a9e4850f0d0"],
Cell[399057, 9487, 492, 13, 66, "Print",ExpressionUUID->"f05b42db-fcfc-4098-a85f-9d343deae7e0"],
Cell[399552, 9502, 250, 4, 50, "Print",ExpressionUUID->"867324c6-1aa7-4157-a852-23b7179378a2"],
Cell[399805, 9508, 299, 5, 50, "Print",ExpressionUUID->"507fe9fa-63ad-4eb5-9653-96e3c9896b5d"],
Cell[400107, 9515, 339, 5, 50, "Print",ExpressionUUID->"ed5c4d26-8e19-400b-bcd5-eb37fbdb3ee8"],
Cell[400449, 9522, 313, 4, 200, "Print",ExpressionUUID->"2d353187-6f7e-4a8d-8507-419c1301bf60"],
Cell[400765, 9528, 2204, 33, 5210, "Print",ExpressionUUID->"332a209a-5571-482f-b9f3-1cfea9705310"],
Cell[402972, 9563, 245, 4, 50, "Print",ExpressionUUID->"cfd6fde1-f783-49ae-aa97-1df8c9556675"],
Cell[403220, 9569, 2371, 37, 56, "Message",ExpressionUUID->"958f3ccf-4993-49d3-a053-40c95705887a"],
Cell[405594, 9608, 248, 4, 50, "Print",ExpressionUUID->"a5797262-36c1-4390-ad46-d28867a75eaa"],
Cell[405845, 9614, 299, 5, 50, "Print",ExpressionUUID->"049c357c-d151-41a4-abb0-7d68da7a9c65"],
Cell[406147, 9621, 337, 5, 50, "Print",ExpressionUUID->"fbc50fc0-9774-42fd-9f0b-f02bd888f0d3"],
Cell[406487, 9628, 318, 5, 200, "Print",ExpressionUUID->"69c1f516-72b8-4747-b95a-c92fbf463c22"],
Cell[406808, 9635, 2204, 33, 5210, "Print",ExpressionUUID->"b08adfa9-3c20-426d-97e4-d164050356b0"],
Cell[409015, 9670, 248, 4, 50, "Print",ExpressionUUID->"7d8419a0-1a10-43a9-93c5-6f5d213b3b6c"],
Cell[409266, 9676, 311, 5, 50, "Print",ExpressionUUID->"2e2ef5c4-03dd-44cf-a408-0060ac73e9e9"],
Cell[409580, 9683, 337, 5, 50, "Print",ExpressionUUID->"a622b22a-91ed-492a-9355-c35214874629"],
Cell[409920, 9690, 334, 6, 275, "Print",ExpressionUUID->"2884fc33-45f8-411a-b287-85b3252b9fbf"],
Cell[410257, 9698, 2055, 31, 3465, "Print",ExpressionUUID->"5a61d5e1-b95a-4e4e-9cf0-26db7a41ceb6"],
Cell[412315, 9731, 248, 4, 62, "Print",ExpressionUUID->"011d12c2-0c9f-4db1-8c61-662ff225f7c1"],
Cell[412566, 9737, 308, 4, 62, "Print",ExpressionUUID->"d291d593-fd84-4173-be95-c8943e0d1c56"],
Cell[412877, 9743, 337, 5, 62, "Print",ExpressionUUID->"c3ce5fdc-40cf-467b-a120-25c7400e306c"],
Cell[413217, 9750, 334, 6, 343, "Print",ExpressionUUID->"9d23f015-5632-4594-9c7f-f0294df1f029"],
Cell[413554, 9758, 2053, 31, 4331, "Print",ExpressionUUID->"7e6ddc78-542c-4fda-9520-5251ae8cab73"],
Cell[415610, 9791, 311, 5, 62, "Print",ExpressionUUID->"7133157a-4df3-4ee9-8db0-b41964bc22bb"],
Cell[415924, 9798, 337, 5, 62, "Print",ExpressionUUID->"2e2b8e05-a220-464f-9948-6238d832385f"],
Cell[416264, 9805, 336, 6, 275, "Print",ExpressionUUID->"ebe48e04-a60b-4a9f-88aa-38d61493c94f"],
Cell[416603, 9813, 2053, 31, 3465, "Print",ExpressionUUID->"75d014ad-152e-4106-935f-8b6340cfc6b3"],
Cell[418659, 9846, 248, 4, 50, "Print",ExpressionUUID->"0cd8f499-8249-4771-9c80-f16816729ab7"],
Cell[418910, 9852, 311, 5, 50, "Print",ExpressionUUID->"7783e1d7-99b2-46e9-8d3c-c514d0a154f1"],
Cell[419224, 9859, 337, 5, 50, "Print",ExpressionUUID->"7da9e4f9-49f1-42b1-bf1f-aab17ab07a0a"],
Cell[419564, 9866, 334, 6, 275, "Print",ExpressionUUID->"fc0eb160-fff7-4993-bc19-57d51920b257"],
Cell[419901, 9874, 2055, 31, 3465, "Print",ExpressionUUID->"43d6cf97-89d1-42ff-b1b3-6f7484ff6e07"],
Cell[421959, 9907, 311, 5, 50, "Print",ExpressionUUID->"f7ab1bc7-ec92-463c-87df-857ae4d2908a"],
Cell[422273, 9914, 339, 5, 50, "Print",ExpressionUUID->"271a63e7-163e-4566-b078-2ea9dfe0cefd"],
Cell[422615, 9921, 334, 6, 275, "Print",ExpressionUUID->"2ad4f24f-29ce-45ec-b32e-1b624cb6ce53"],
Cell[422952, 9929, 2053, 31, 3465, "Print",ExpressionUUID->"7229217c-6a8f-4780-aef5-6878776328ca"],
Cell[425008, 9962, 435, 9, 50, "Print",ExpressionUUID->"06e0a486-02ae-4f8d-9755-bdabaa0045b7"],
Cell[425446, 9973, 419, 9, 50, "Print",ExpressionUUID->"b9a1912f-c897-4a1d-a9a9-8b860dcbc88d"]
}, Open  ]]
}, Open  ]],
Cell[425892, 9986, 731, 14, 222, "Subsection",ExpressionUUID->"d85419f9-f6ab-47b9-9980-3a9d88d220c3"],
Cell[CellGroupData[{
Cell[426648, 10004, 266, 5, 53, "Input",ExpressionUUID->"da94a614-58b0-482f-9c2c-09b6822c7db4"],
Cell[426917, 10011, 681, 13, 56, "Message",ExpressionUUID->"cd15bce2-ee98-4fd7-b5a5-4ef8456d5993"],
Cell[427601, 10026, 681, 13, 56, "Message",ExpressionUUID->"319162e7-e6c3-4bd2-84e9-450d3560dab9"],
Cell[428285, 10041, 4096, 74, 895, "Output",ExpressionUUID->"c8ada1eb-13c1-4800-b630-f314fee3c134"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[432430, 10121, 420, 9, 99, "Subtitle",ExpressionUUID->"e1911cd3-0e16-4ce7-89eb-7925443f20a0"],
Cell[432853, 10132, 347, 7, 87, "Input",ExpressionUUID->"216f22c8-83eb-4f7b-829e-16a5b07ceaf1"],
Cell[433203, 10141, 789, 20, 188, "Input",ExpressionUUID->"957c5682-b448-4275-93a1-5fea2f3d7431"],
Cell[433995, 10163, 949, 23, 87, "Input",ExpressionUUID->"0f2cb3fb-5e2a-423b-a49e-7bd83017c0f3"],
Cell[CellGroupData[{
Cell[434969, 10190, 1128, 33, 101, "Input",ExpressionUUID->"1c32c68a-ba47-42dc-819f-b1b0f6301e5f"],
Cell[436100, 10225, 1136, 34, 116, "Output",ExpressionUUID->"f2a7825c-9145-49a3-b16d-6c51a6ce9923"]
}, Open  ]],
Cell[437251, 10262, 377, 11, 87, "Input",ExpressionUUID->"9ccd23f5-31e5-457f-a13d-322f36cb0c2e"],
Cell[CellGroupData[{
Cell[437653, 10277, 447, 15, 118, "Input",ExpressionUUID->"a5b080b5-7676-4e93-a9d1-e463c189dca4"],
Cell[438103, 10294, 520, 17, 116, "Output",ExpressionUUID->"8049d3ed-bf00-45ba-bb94-a9418821b7bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[438660, 10316, 957, 18, 87, "Input",ExpressionUUID->"84596d0c-af08-4482-b3eb-660f5b099729"],
Cell[439620, 10336, 1851, 55, 200, "Output",ExpressionUUID->"ccd3db8d-68db-4444-8fd4-4199d09edbee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441508, 10396, 248, 6, 82, "Input",ExpressionUUID->"60ed279c-0020-40ec-849d-2a9046d0cbcb"],
Cell[441759, 10404, 234, 5, 87, "Output",ExpressionUUID->"48485fa5-7fe7-4198-9c3d-f692c88f4fda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[442030, 10414, 163, 3, 128, "Subsection",ExpressionUUID->"b630c207-9811-4dbf-a935-44cc6da0b53f"],
Cell[442196, 10419, 813, 19, 291, "Input",ExpressionUUID->"b6c4f516-a68b-4dc8-86f8-6b0c609f2e87"],
Cell[443012, 10440, 2679, 65, 496, "Input",ExpressionUUID->"a9cfde97-ddb6-4908-8a33-448455ede328"],
Cell[CellGroupData[{
Cell[445716, 10509, 1726, 38, 291, "Input",ExpressionUUID->"e088c280-1e67-49f8-a3d6-dc5054ccce1f"],
Cell[447445, 10549, 206, 4, 62, "Print",ExpressionUUID->"a40c3a61-ccfa-47d1-a8d6-10c6c4ba37b2"],
Cell[447654, 10555, 206, 4, 62, "Print",ExpressionUUID->"e84f3b5c-911d-40f3-99ca-5b94a4ba17f9"],
Cell[447863, 10561, 208, 4, 62, "Print",ExpressionUUID->"aac3483d-4e98-4dbb-8b3e-4e7b526155bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[448108, 10570, 303, 5, 87, "Input",ExpressionUUID->"6e3a1361-6e11-418f-86ae-32d90ce468cc"],
Cell[448414, 10577, 2127, 67, 770, "Output",ExpressionUUID->"0f9f0f04-a99f-4188-87ee-7169d1ebeba5"]
}, Open  ]],
Cell[450556, 10647, 2085, 40, 291, "Input",ExpressionUUID->"a40b46e8-8d16-464f-aee4-0bd267e62af8"]
}, Open  ]],
Cell[452656, 10690, 216, 4, 128, "Subsection",ExpressionUUID->"690ceaa6-7f80-4d08-a085-d1355e1abf45"],
Cell[CellGroupData[{
Cell[452897, 10698, 224, 4, 66, "Input",ExpressionUUID->"4eaf5511-f42c-4baf-998c-b0c82ead7bd6"],
Cell[453124, 10704, 1827, 55, 200, "Output",ExpressionUUID->"9bf9d397-aa00-4a89-b1ef-da023cc4755e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[454988, 10764, 492, 14, 87, "Input",ExpressionUUID->"1386436e-e2c5-4667-87d0-8456c6abeee6"],
Cell[455483, 10780, 895, 24, 390, "Output",ExpressionUUID->"8f22e64f-f138-48fa-921a-14b7426f48f7"]
}, Open  ]],
Cell[456393, 10807, 300, 7, 87, "Input",ExpressionUUID->"b68e0a34-bca3-43ee-acab-bef2a6e2892a"],
Cell[456696, 10816, 731, 14, 87, "Input",ExpressionUUID->"a4eea477-b970-450a-ac49-e462576267c4"],
Cell[CellGroupData[{
Cell[457452, 10834, 302, 5, 87, "Input",ExpressionUUID->"9b582343-aad8-406b-8acb-61b7bc63b91e"],
Cell[457757, 10841, 899, 24, 390, "Output",ExpressionUUID->"4bcca96f-1d4c-41e1-af1c-86e9ff8071bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[458693, 10870, 223, 4, 87, "Input",ExpressionUUID->"8e679f38-fa53-4896-96c7-5208e3185127"],
Cell[458919, 10876, 327, 8, 87, "Output",ExpressionUUID->"80d1acda-8016-4182-bcee-7e6d01181825"]
}, Open  ]],
Cell[CellGroupData[{
Cell[459283, 10889, 183, 3, 128, "Subsection",ExpressionUUID->"54bf2ce1-a97b-42d8-ac9b-f9b8c5d266d1"],
Cell[459469, 10894, 604, 12, 238, "Input",ExpressionUUID->"f2b20cb6-1ad4-4ce2-a374-9521872030cc"],
Cell[460076, 10908, 371, 7, 87, "Input",ExpressionUUID->"4d5bfe03-8d22-48c2-8e2f-fee5e1105709"],
Cell[CellGroupData[{
Cell[460472, 10919, 297, 5, 87, "Input",ExpressionUUID->"294dc2ea-bc6e-4f72-823d-041a33df6363"],
Cell[460772, 10926, 102420, 2636, 3947, "Output",ExpressionUUID->"484d3498-33ed-4c2d-b4a0-3682afd724f8"]
}, Open  ]],
Cell[563207, 13565, 680, 13, 87, "Input",ExpressionUUID->"ffeb086d-42cc-4124-a1cb-dd098c459d7d"],
Cell[563890, 13580, 362, 8, 87, "Input",ExpressionUUID->"5bf34cf6-a3f5-42ae-9674-896e8f83c2c6"],
Cell[564255, 13590, 2035, 37, 496, "Input",ExpressionUUID->"15794cbd-d819-4d9c-82f4-b172fc964652"],
Cell[CellGroupData[{
Cell[566315, 13631, 372, 8, 87, "Input",ExpressionUUID->"c02aa680-e3c7-4ae4-b996-c0691378d843"],
Cell[566690, 13641, 457, 11, 62, "Print",ExpressionUUID->"311eb291-14bd-4cf4-b4ba-6ad0b79bf9f1"],
Cell[567150, 13654, 435, 10, 62, "Print",ExpressionUUID->"c6dc06d3-9084-45f7-9b99-85739b117ab5"],
Cell[567588, 13666, 435, 11, 62, "Print",ExpressionUUID->"b8257c73-0c08-42df-86a1-47b6b8867b28"],
Cell[568026, 13679, 427, 10, 62, "Print",ExpressionUUID->"2fb15da9-8bdb-494e-9efb-2f43b53c3d54"]
}, Open  ]],
Cell[568468, 13692, 604, 11, 88, "Text",ExpressionUUID->"01f4c3ba-a397-4574-a553-a150aaca596a"],
Cell[CellGroupData[{
Cell[569097, 13707, 695, 12, 87, "Input",ExpressionUUID->"2ec0963f-6f13-4043-9c58-b09df6efdce1"],
Cell[569795, 13721, 480, 13, 96, "Print",ExpressionUUID->"eb70e565-0465-4f54-9084-8e40de00ac36"],
Cell[570278, 13736, 422, 12, 82, "Print",ExpressionUUID->"62d59456-05d7-4f85-8889-34f7bda6914f"],
Cell[570703, 13750, 423, 12, 82, "Print",ExpressionUUID->"a35422e9-600f-49e2-96bd-0fd8cda954f8"],
Cell[571129, 13764, 179, 3, 62, "Print",ExpressionUUID->"997586bd-8ad1-4907-81d7-59cb6d77c3f3"],
Cell[571311, 13769, 228, 4, 62, "Print",ExpressionUUID->"a6f8489c-9e11-4a24-8160-96c3fab95473"],
Cell[571542, 13775, 275, 4, 62, "Print",ExpressionUUID->"c20a33db-002a-42f3-aa8d-508d66dc397b"],
Cell[571820, 13781, 239, 4, 62, "Print",ExpressionUUID->"73200e03-df70-4c28-ada6-36556ebc6e00"],
Cell[572062, 13787, 6809, 96, 27246, "Print",ExpressionUUID->"fda65f79-75b9-487a-a331-4d9df4c99815"],
Cell[578874, 13885, 174, 3, 62, "Print",ExpressionUUID->"9007655c-043f-4348-84c6-57c5ceb152fb"],
Cell[579051, 13890, 4326, 64, 222, "Message",ExpressionUUID->"ecfd7f68-11e7-4f6b-8c93-47b3254f1bcc"],
Cell[583380, 13956, 179, 3, 62, "Print",ExpressionUUID->"9b311dd0-3521-4701-b826-93d3d85912f1"],
Cell[583562, 13961, 228, 4, 62, "Print",ExpressionUUID->"2ec0022d-ca5c-45e1-9161-751220627b74"],
Cell[583793, 13967, 275, 4, 62, "Print",ExpressionUUID->"8a35d763-9f1b-4954-8b69-93c64af6a2f1"],
Cell[584071, 13973, 237, 4, 62, "Print",ExpressionUUID->"82ac8203-551a-43ff-9e3c-334b41e4e90c"],
Cell[584311, 13979, 7231, 103, 27246, "Print",ExpressionUUID->"1954e49b-543b-463e-ac84-bde92510ddfb"],
Cell[591545, 14084, 179, 3, 62, "Print",ExpressionUUID->"d9e8f03a-2347-4360-a327-351f827589aa"],
Cell[591727, 14089, 326, 5, 62, "Print",ExpressionUUID->"6a7362e9-cae6-4909-a344-09f5a0e8cfb6"],
Cell[592056, 14096, 277, 4, 62, "Print",ExpressionUUID->"cf7f1f22-c8a9-4f5e-972f-0f1a64a9338c"],
Cell[592336, 14102, 361, 6, 620, "Print",ExpressionUUID->"e2e6d000-1648-4bfd-86d8-a42c9b45b7ce"],
Cell[592700, 14110, 6887, 99, 27988, "Print",ExpressionUUID->"cefcf4eb-d521-4d5b-a93a-063577a7ff1f"],
Cell[599590, 14211, 181, 3, 62, "Print",ExpressionUUID->"333dd3d6-0ce6-421a-a43a-135ab31796dc"],
Cell[599774, 14216, 376, 6, 62, "Print",ExpressionUUID->"6635ebf6-75fb-4506-8bf9-863e69391c63"],
Cell[600153, 14224, 277, 4, 62, "Print",ExpressionUUID->"563f3136-5106-4860-a8d6-b5b5c68cbde6"],
Cell[600433, 14230, 421, 6, 900, "Print",ExpressionUUID->"4bc767fb-29d9-4aba-95b5-8fff1ccff688"],
Cell[600857, 14238, 5923, 84, 13978, "Print",ExpressionUUID->"97082cca-809b-4a8c-b386-dd51f3788f2f"],
Cell[606783, 14324, 372, 5, 62, "Print",ExpressionUUID->"416dc337-6c92-4caf-8732-85e394a6e869"],
Cell[607158, 14331, 275, 4, 62, "Print",ExpressionUUID->"d773fdf9-d9ad-45c9-a252-286aae28805a"],
Cell[607436, 14337, 421, 6, 900, "Print",ExpressionUUID->"62bd24eb-f3e6-4e9a-a79a-a055bafd0339"],
Cell[607860, 14345, 5986, 87, 15463, "Print",ExpressionUUID->"ef012d08-fd46-45b8-8cab-734374e0c7ce"],
Cell[613849, 14434, 179, 3, 62, "Print",ExpressionUUID->"6046f691-83d9-4e7d-a87e-24f6bc4deea8"],
Cell[614031, 14439, 376, 6, 62, "Print",ExpressionUUID->"9077ffca-8424-47c0-89f9-3cd42f7e1ec5"],
Cell[614410, 14447, 275, 4, 62, "Print",ExpressionUUID->"3d34253a-d857-476d-8be6-f60d0243843b"],
Cell[614688, 14453, 423, 6, 900, "Print",ExpressionUUID->"6007f024-bcbd-47cd-bda1-c1eb689e0c77"],
Cell[615114, 14461, 5986, 87, 15463, "Print",ExpressionUUID->"7fa7f2d1-b94a-4426-b693-607f9b562fca"],
Cell[621103, 14550, 378, 6, 62, "Print",ExpressionUUID->"37b66739-3142-499b-93d0-cb25d291990d"],
Cell[621484, 14558, 275, 4, 62, "Print",ExpressionUUID->"9717e2b3-4a30-42c4-bff6-1a85142385a3"],
Cell[621762, 14564, 423, 6, 900, "Print",ExpressionUUID->"c9ef7e0e-01ff-4add-95f2-d0c95ef7a95a"],
Cell[622188, 14572, 5984, 87, 15463, "Print",ExpressionUUID->"6c62d473-1e7d-4c18-a6ce-7f04aece69e7"],
Cell[628175, 14661, 401, 9, 62, "Print",ExpressionUUID->"e25361cd-e739-44f3-a761-a722943b7e21"],
Cell[628579, 14672, 384, 8, 62, "Print",ExpressionUUID->"f7ebdd08-beb1-4913-a01c-d80f1d64f86f"]
}, Open  ]]
}, Open  ]],
Cell[628990, 14684, 335, 7, 88, "Text",ExpressionUUID->"aa084058-801a-4bc7-986f-2b5f5ca6b07d"],
Cell[CellGroupData[{
Cell[629350, 14695, 295, 5, 87, "Input",ExpressionUUID->"10510d75-92c9-492e-bb5a-e7c15906dd0e"],
Cell[629648, 14702, 36061, 657, 2306, "Output",ExpressionUUID->"8c10fdee-1c4b-49da-85ad-62b75f4f85dd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[665758, 15365, 435, 9, 171, "Subtitle",ExpressionUUID->"99c9a3d5-8c1b-4271-8e48-b57be111d080"],
Cell[666196, 15376, 449, 10, 36, "Input",ExpressionUUID->"48e9b2b3-a257-4ce2-ad6c-beeb5cf6f06b"],
Cell[666648, 15388, 501, 14, 57, "Input",ExpressionUUID->"76eda1be-78ff-42d5-9611-741db42b0cf7"],
Cell[CellGroupData[{
Cell[667174, 15406, 561, 11, 36, "Input",ExpressionUUID->"5800d749-c9ad-45e4-84cd-f6a8a4cce3f5"],
Cell[667738, 15419, 337, 8, 36, "Output",ExpressionUUID->"23876a51-def2-446e-b4b1-982f48374205"]
}, Open  ]],
Cell[668090, 15430, 514, 13, 36, "Input",ExpressionUUID->"b36654fb-48ad-4f60-95e5-e46a9c8fa8a9"],
Cell[CellGroupData[{
Cell[668629, 15447, 381, 12, 49, "Input",ExpressionUUID->"a2010ffe-88fc-4c46-8c44-20afe825bd4a"],
Cell[669013, 15461, 503, 15, 48, "Output",ExpressionUUID->"fb93f73e-7f11-4a93-a3ed-9ff7d8ffbd69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[669553, 15481, 692, 12, 36, "Input",ExpressionUUID->"e4ecce2d-11d5-4b85-bf6e-1c511eb237d1"],
Cell[670248, 15495, 604, 17, 52, "Output",ExpressionUUID->"124f8821-dfa7-41d6-9451-3d9e35c1f2b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[670889, 15517, 205, 5, 35, "Input",ExpressionUUID->"42be9b2f-6ceb-4fb4-8b88-a37428204869"],
Cell[671097, 15524, 315, 7, 36, "Output",ExpressionUUID->"498a1679-e213-4398-8bca-1d5d159d70d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[671449, 15536, 219, 5, 36, "Input",ExpressionUUID->"e929575b-11e6-4adf-a23c-75da7c654803"],
Cell[671671, 15543, 611, 18, 61, "Output",ExpressionUUID->"0a8d0df0-9931-4a03-a402-c4bb49323831"]
}, Open  ]],
Cell[CellGroupData[{
Cell[672319, 15566, 154, 3, 54, "Subsection",ExpressionUUID->"9afa1783-4c40-4de2-aa4b-1145622413f3"],
Cell[672476, 15571, 1146, 28, 183, "Input",ExpressionUUID->"6b90835a-5cbe-4a58-9285-2a21c24094a7"],
Cell[673625, 15601, 1219, 26, 120, "Input",ExpressionUUID->"cfe6e606-fba1-48ea-bf9a-562e67f5ca83"],
Cell[CellGroupData[{
Cell[674869, 15631, 1675, 38, 141, "Input",ExpressionUUID->"0e70dbf2-9ac3-4e19-8d86-51d956144364"],
Cell[676547, 15671, 236, 4, 26, "Print",ExpressionUUID->"f65fa632-8e8a-402a-b6c0-ff7d73cefcb9"],
Cell[676786, 15677, 236, 4, 26, "Print",ExpressionUUID->"ce84ce99-fffd-4437-9148-8eb74d7ee805"],
Cell[677025, 15683, 236, 4, 26, "Print",ExpressionUUID->"91d89524-effd-4aaa-973d-58864a8ff4e4"],
Cell[677264, 15689, 236, 4, 26, "Print",ExpressionUUID->"f8590448-1bed-4844-a6aa-0512ceae675b"],
Cell[677503, 15695, 236, 4, 26, "Print",ExpressionUUID->"a247be51-d224-4289-8e88-d655711cf95b"],
Cell[677742, 15701, 236, 4, 26, "Print",ExpressionUUID->"5bde0f76-b216-486d-86ba-6578d187584b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[678015, 15710, 320, 6, 36, "Input",ExpressionUUID->"1bd7bda5-b589-44c1-b96b-7a2d936004ce"],
Cell[678338, 15718, 1520, 39, 230, "Output",ExpressionUUID->"f40d5e72-ee29-4f82-a6f3-0c67f634455a"]
}, Open  ]],
Cell[679873, 15760, 2481, 52, 162, "Input",ExpressionUUID->"5748ff68-db34-4ac3-8279-3935f5c793f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[682391, 15817, 388, 10, 36, "Input",ExpressionUUID->"c39169d8-f987-4798-9872-debd8e68fb62"],
Cell[682782, 15829, 841, 24, 35, "Output",ExpressionUUID->"00b324ee-2443-4e2d-b1d2-e3e474659d7a"]
}, Open  ]],
Cell[683638, 15856, 264, 6, 36, "Input",ExpressionUUID->"a0dc323a-6098-4665-a3b2-b2894ff60fe3"],
Cell[683905, 15864, 572, 12, 36, "Input",ExpressionUUID->"14519ff6-cd03-428c-a2a7-0052c1a28a48"],
Cell[CellGroupData[{
Cell[684502, 15880, 171, 3, 54, "Subsection",ExpressionUUID->"eea4db31-b283-4483-bfd5-f544a1e8a9ab"],
Cell[CellGroupData[{
Cell[684698, 15887, 359, 7, 36, "Input",ExpressionUUID->"3ef28021-744f-462f-9833-3dc13a7cca68"],
Cell[685060, 15896, 666, 11, 57, "Output",ExpressionUUID->"966a9c11-5197-4d06-a029-6129d57a98d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[685763, 15912, 246, 5, 36, "Input",ExpressionUUID->"3b2f49e2-f3f0-4ed2-85a8-7c9e56a5bb10"],
Cell[686012, 15919, 817, 18, 57, "Output",ExpressionUUID->"0c085163-d9b6-4dad-8c77-ae615532fda9"]
}, Open  ]],
Cell[686844, 15940, 417, 11, 36, "Input",ExpressionUUID->"de43ee89-e248-48fd-8059-1ee8fd91895e"],
Cell[687264, 15953, 1703, 31, 225, "Input",ExpressionUUID->"dd3522e4-5433-4f76-b0ea-909c66a95f50"],
Cell[CellGroupData[{
Cell[688992, 15988, 415, 8, 36, "Input",ExpressionUUID->"0591fea1-e58a-4be8-a173-76d21f2b1c8f"],
Cell[689410, 15998, 470, 11, 26, "Print",ExpressionUUID->"86ee0345-1615-42e7-aed4-9ea819967e63"],
Cell[689883, 16011, 448, 10, 26, "Print",ExpressionUUID->"f140c179-dcc1-4f92-b8fa-0b39d1023405"],
Cell[690334, 16023, 442, 9, 26, "Print",ExpressionUUID->"34a07a43-6a9a-4e6e-9b36-5ac5acc6c763"],
Cell[690779, 16034, 440, 10, 26, "Print",ExpressionUUID->"b340a53e-998e-4fb3-9750-3c4a4c09071c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[691256, 16049, 535, 10, 36, "Input",ExpressionUUID->"4560ee6b-0061-424d-b437-02fc7d3e4433"],
Cell[691794, 16061, 528, 14, 79, "Print",ExpressionUUID->"9f046fd4-963c-4ede-9beb-8227cb196b13"],
Cell[692325, 16077, 470, 13, 35, "Print",ExpressionUUID->"74842a34-2a4b-4271-adae-cd0b2a280237"],
Cell[692798, 16092, 471, 13, 35, "Print",ExpressionUUID->"53f67835-c1c8-45e5-bf1b-b98cc420a950"],
Cell[693272, 16107, 227, 4, 26, "Print",ExpressionUUID->"8120a93a-6d38-4418-9060-77427f0e1470"],
Cell[693502, 16113, 228, 4, 26, "Print",ExpressionUUID->"96924ec0-ec82-4c6e-acf8-393a10d70d4c"],
Cell[693733, 16119, 450, 7, 46, "Print",ExpressionUUID->"87cce30c-c699-4bd5-97c0-94ce51a2cdda"],
Cell[694186, 16128, 231, 4, 26, "Print",ExpressionUUID->"ff6f6690-2e4b-4ac0-9279-df9a20ca672b"],
Cell[694420, 16134, 220, 4, 26, "Print",ExpressionUUID->"98a38f09-9e04-4ea5-b235-ed9dcf2acc37"],
Cell[694643, 16140, 1717, 27, 71, "Message",ExpressionUUID->"93a9c353-4f2a-45c6-a254-2c7845ca71eb"],
Cell[696363, 16169, 227, 4, 26, "Print",ExpressionUUID->"f743cbd1-b421-4167-8cbe-26e6b6b38264"],
Cell[696593, 16175, 228, 4, 26, "Print",ExpressionUUID->"2652af73-9c75-474e-9909-7214dba774fa"],
Cell[696824, 16181, 450, 7, 46, "Print",ExpressionUUID->"6af02114-96a7-4f46-b8d1-f25cf39e1e25"],
Cell[697277, 16190, 233, 4, 26, "Print",ExpressionUUID->"8086cbd8-8b7e-4f4d-bc37-f4fe6bcc74c4"],
Cell[697513, 16196, 225, 4, 26, "Print",ExpressionUUID->"d442d9d9-7576-468b-a708-55a7eaa007b1"],
Cell[697741, 16202, 228, 4, 26, "Print",ExpressionUUID->"58ca19f7-8d23-4287-b476-d279d291f247"],
Cell[697972, 16208, 450, 7, 46, "Print",ExpressionUUID->"d7e2ad7a-6e9a-48fe-ab44-0c8a8a4f477b"],
Cell[698425, 16217, 233, 4, 26, "Print",ExpressionUUID->"0a05ed9b-ecfd-49f5-b0f0-0f37a1d35908"],
Cell[698661, 16223, 227, 4, 26, "Print",ExpressionUUID->"46deabd6-779a-45c1-b420-531daa3197b2"],
Cell[698891, 16229, 228, 4, 26, "Print",ExpressionUUID->"128d97a8-f483-46cc-9250-60e39797f331"],
Cell[699122, 16235, 450, 7, 46, "Print",ExpressionUUID->"4a88c386-05e1-4b5e-b9bd-a20128bb4bd7"],
Cell[699575, 16244, 233, 4, 26, "Print",ExpressionUUID->"adf45366-41c0-401c-96df-bcb0a1adda3e"],
Cell[699811, 16250, 241, 4, 26, "Print",ExpressionUUID->"a52c386a-e065-4052-b70a-21e2b5113c03"],
Cell[700055, 16256, 452, 7, 46, "Print",ExpressionUUID->"5413da75-abb1-46d9-b86b-e239c5fe9a2a"],
Cell[700510, 16265, 254, 5, 26, "Print",ExpressionUUID->"b9773132-86d8-4b39-b340-59866b01c0ce"],
Cell[700767, 16272, 4525, 72, 4245, "Print",ExpressionUUID->"fa4a52fb-6c57-421e-8327-8aaaae4bf92e"],
Cell[705295, 16346, 225, 4, 26, "Print",ExpressionUUID->"bfca0cee-baf5-4b5a-a315-d3eab79e272f"],
Cell[705523, 16352, 241, 4, 26, "Print",ExpressionUUID->"87820022-f69e-4594-8359-18a4d5e849bc"],
Cell[705767, 16358, 450, 7, 46, "Print",ExpressionUUID->"67f24508-8d18-4e98-9be1-239989764837"],
Cell[706220, 16367, 252, 5, 26, "Print",ExpressionUUID->"05e3b7a6-a5f4-471d-83a2-17e6fc34b404"],
Cell[706475, 16374, 4530, 73, 4245, "Print",ExpressionUUID->"3593fa4a-fec2-45b6-96d9-8d9892a791ef"],
Cell[711008, 16449, 241, 4, 26, "Print",ExpressionUUID->"67d222d2-69fd-493d-98a9-2bcc35c0f67d"],
Cell[711252, 16455, 450, 7, 46, "Print",ExpressionUUID->"5ae7e341-ec98-4dff-97e9-4af5223bcb0d"],
Cell[711705, 16464, 252, 5, 26, "Print",ExpressionUUID->"1c790084-1f06-4cc6-8952-63a92cf80c1b"],
Cell[711960, 16471, 4530, 73, 4245, "Print",ExpressionUUID->"eae5762d-4826-4ff9-a9a7-85b143dde355"],
Cell[716493, 16546, 412, 9, 26, "Print",ExpressionUUID->"928986fb-a69d-45c0-a939-479272714e8d"],
Cell[716908, 16557, 396, 9, 26, "Print",ExpressionUUID->"4e7eb104-59a1-4b2b-a1ce-ee524919008a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[717341, 16571, 250, 5, 36, "Input",ExpressionUUID->"e46929c0-07ce-4709-bcda-8c7ac12b8862"],
Cell[717594, 16578, 15544, 288, 322, "Output",ExpressionUUID->"2bd513bd-dbe4-47dd-bdc7-40c1a2ec383e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

