(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    800146,      19742]
NotebookOptionsPosition[    714031,      17892]
NotebookOutlinePosition[    714668,      17917]
CellTagsIndexPosition[    714625,      17914]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Generate optimized energy, gradient, and Hessian expressions for molecular \
mechanics.\
\>", "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.402914001047615*^9},ExpressionUUID->"b0fd39df-8862-4179-a880-\
dbe2092c9a61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675593015943*^9, 3.40267560234683*^9}, 
   3.402675719919037*^9, 
   3.402914001047728*^9},ExpressionUUID->"c70641c7-1b5d-410e-ad0a-\
56f59ac2d689"],

Cell[BoxData["\<\"/Users/meister/temp/Mathematica\"\>"], "Output",
 CellChangeTimes->{{3.61955693636098*^9, 3.619556937398514*^9}, {
   3.702653597250333*^9, 3.702653598698069*^9}, 3.7026542065219917`*^9, {
   3.702664702977771*^9, 3.702664703748498*^9}, 3.702664834741228*^9, 
   3.702664879624086*^9},ExpressionUUID->"403334fc-bce5-48c5-aaa3-\
7f00ce59b585"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\</Users/meister/Temp/Mathematica\>\"", 
  "]"}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675724744155*^9, 3.402675744579932*^9}, {
   3.4026757812426653`*^9, 3.402675795163514*^9}, 3.4029140010477962`*^9, {
   3.404776927640129*^9, 3.4047769282020483`*^9}, {3.485009516098822*^9, 
   3.4850095173434477`*^9}, {3.619556879758088*^9, 3.6195568829874687`*^9}, {
   3.7026648712565193`*^9, 
   3.702664872815674*^9}},ExpressionUUID->"2d137b9b-ea88-410b-9968-\
95caebda6207"],

Cell[BoxData["\<\"/Users/meister/temp/Mathematica\"\>"], "Output",
 CellChangeTimes->{{3.619556936691887*^9, 3.619556937459659*^9}, {
   3.702653597583889*^9, 3.702653598769026*^9}, 3.702654206704248*^9, {
   3.70266470316539*^9, 3.702664703807929*^9}, {3.70266487362453*^9, 
   3.702664879745595*^9}},ExpressionUUID->"6a85699e-773d-42b7-a83f-\
3afd3b42a47a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.408659022451297*^9, 
  3.408659024556794*^9}},ExpressionUUID->"56979870-3ed4-4d4e-af8e-\
a63b4ff23368"],

Cell["Setup to generate code that is embeded within CANDO", "Subtitle",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.402914001047846*^9, {3.494842902549116*^9, 
   3.494842937561069*^9}},ExpressionUUID->"13656531-838c-4e7a-a5ac-\
d7f574743d13"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<optimizeExpressions`\>\"", "]"}]], "Code",
 CellChangeTimes->{{3.4055916304006453`*^9, 
  3.405591641125656*^9}},ExpressionUUID->"49c3f62a-426b-40d8-ad03-\
a51a7d875bc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Bond stretch term between two atoms with coordinates {x1,y1,z1} and {x2,y2,z2}
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.4948432970798798`*^9, 
   3.494843313989492*^9}},ExpressionUUID->"40c497cd-8ecb-4a12-a19e-\
90050870a153"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 
  3.403184184931066*^9}},ExpressionUUID->"a3598273-c222-436b-9d94-\
ca29ebbf3a24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 
  3.4026520109900312`*^9}},ExpressionUUID->"58e0eab9-be8c-43e5-82a3-\
ad8adbb63338"],

Cell["Define the Hooks law bond stretch potential", "Subsection",
 CellChangeTimes->{{3.494843329696516*^9, 
  3.4948433485250063`*^9}},ExpressionUUID->"3879886e-f184-4d74-93af-\
6e49da00fb72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchDeviation", " ", "=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"bb", "-", "ba"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"bb", "-", "ba"}], ")"}]}], "]"}], "-", "r0"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
  3.411152033364759*^9, 
  3.411152034157058*^9}},ExpressionUUID->"495fb4b5-85f0-462f-aac7-\
785188d5dabc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stretchEnergyFn", " ", "=", "  ", 
  RowBox[{"kb", "  ", 
   RowBox[{
    RowBox[{"(", "stretchDeviation", ")"}], "^", "2.0"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.416871725859004*^9, 3.416871727438574*^9}, 
   3.416872040224017*^9},ExpressionUUID->"4e665c6e-c0f4-4ca4-833d-\
8dc01f25a9b8"],

Cell[BoxData[
 RowBox[{"kb", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "r0"}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
   "2.`"]}]], "Output",
 CellChangeTimes->{3.6195569378511963`*^9, 3.7026536050738993`*^9, 
  3.7026536855462227`*^9, 3.702654207372356*^9, 3.7026597526627398`*^9, 
  3.702664708176724*^9, 
  3.702664882707621*^9},ExpressionUUID->"e1456d8f-5ccd-4356-b9af-\
b2b072c03dbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input",ExpressionUUID->\
"d49fcc02-7be5-4d13-bb3a-5b4b3983e308"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619556937908368*^9, 3.702653605128133*^9, 
  3.7026536855978527`*^9, 3.702654207431299*^9, 3.702659752738065*^9, 
  3.7026647082359858`*^9, 
  3.702664882771675*^9},ExpressionUUID->"7bf4518c-ca33-4c5a-888d-\
4d82c900583e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assemble the energy function rules to expand", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 3.401714291927002*^9}, {
  3.494843844071973*^9, 
  3.494843851677432*^9}},ExpressionUUID->"76c2ef4b-da46-4f83-b9d7-\
f91a9c19990f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}},ExpressionUUID->"446f8cb2-7ee6-4b8d-884e-\
be17a694418a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stretchSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(kb);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(r0);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<STRETCH_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}},ExpressionUUID->"abcb48bc-d911-47a2-92e5-\
016ff7afb1b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "stretchVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<STRETCH_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"stretchVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"stretchSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}},ExpressionUUID->"0bbb2f4a-d376-457f-894a-\
dcf14cdf7f4d"],

Cell[BoxData["\<\"STRETCH_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 
  3.7026648828907623`*^9},ExpressionUUID->"a39aa9e0-b052-446b-94a8-\
d9859bdfd0d9"],

Cell[BoxData["\<\"STRETCH_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 
  3.7026648828925743`*^9},ExpressionUUID->"d85a5298-71e2-4092-adf7-\
6a7a19c94249"],

Cell[BoxData["\<\"STRETCH_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 
  3.702664882893835*^9},ExpressionUUID->"4f3973d4-63e4-4afc-9cf1-\
2d42d5ab8f01"],

Cell[BoxData["\<\"STRETCH_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 
  3.702664882895054*^9},ExpressionUUID->"5cc7b3f1-bbf1-402e-9e99-\
f6618d6bb4cd"],

Cell[BoxData["\<\"STRETCH_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 
  3.7026648828963337`*^9},ExpressionUUID->"78e0018a-b110-430d-bb9b-\
b2c1a156776c"],

Cell[BoxData["\<\"STRETCH_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.6195569380214863`*^9, 3.702653605263967*^9, 
  3.702653685753228*^9, 3.702654207557015*^9, 3.702659752911749*^9, 
  3.7026647083603783`*^9, 
  3.7026648828977137`*^9},ExpressionUUID->"7f70118e-aff2-43c5-aef6-\
67ab637759f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stretchSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
  3.41017756267308*^9, 
  3.4101775644454517`*^9}},ExpressionUUID->"56551ce3-b9df-432e-b5e3-\
f2b5d6f01a87"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(kb);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(r0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"STRETCH_SET_POSITION(z2,I2,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556938092057*^9, 3.702653605327971*^9, 
  3.702653685806456*^9, 3.702654207694806*^9, 3.702659752987501*^9, 
  3.7026647084190598`*^9, 
  3.702664882946087*^9},ExpressionUUID->"dcecf1d4-164b-4079-9958-\
dd5734cf63b6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stretchEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stretchOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"StretchDeviation", ",", "stretchDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "stretchEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<STRETCH\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 
   3.411152028421866*^9}},ExpressionUUID->"d2ec2e96-4d08-4a2b-9b30-\
b2997f4c3329"]
}, Open  ]],

Cell["Append the Gradient and Hessian rules", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 3.408559038294833*^9}, {3.494843872271369*^9, 
  3.4948438859081783`*^9}},ExpressionUUID->"ed8cec90-4c0a-47d9-9f0f-\
1990a0389f2f"],

Cell[CellGroupData[{

Cell[BoxData["stretchEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 
  3.4085602170434313`*^9}},ExpressionUUID->"07b80f7a-8e11-48e8-95f4-\
52af32d2333f"],

Cell[BoxData[
 RowBox[{"kb", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "r0"}], "+", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x1"}], "+", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y1"}], "+", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z1"}], "+", "z2"}], ")"}], "2"]}]]}], ")"}], 
   "2.`"]}]], "Output",
 CellChangeTimes->{3.619556938156497*^9, 3.7026536054685583`*^9, 
  3.702653685912662*^9, 3.702654207807459*^9, 3.702659753095257*^9, 
  3.702664708535633*^9, 
  3.70266488302398*^9},ExpressionUUID->"eddbc087-006f-45fc-bdc4-81fff03b0011"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"stretchHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 
  3.409332795387742*^9}},ExpressionUUID->"63510d04-307f-48f5-b131-\
93115a1e8bfe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556938208083*^9, 3.7026536055282393`*^9, 
  3.702653685978429*^9, 3.702654207849318*^9, 3.702659753187606*^9, 
  3.702664708590064*^9, 
  3.702664883081134*^9},ExpressionUUID->"ac3fd518-ff49-4b25-a19f-\
d80a774527e3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 
  3.410177080322625*^9}},ExpressionUUID->"1d7c25b0-fdd8-4f33-81d8-\
92b1808f75e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<STRETCH\>\"", ",", "stretchForceHessianRules", ",", "stretchOutputs", 
    ",", "stretchHessian", ",", "stretchEnergyFn", ",", "stretchVarNames"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
  3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
  3.410177087548172*^9}},ExpressionUUID->"1ca74e93-7a67-4d46-a40b-\
bafa109761de"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stretchHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
  3.40933303751335*^9, 
  3.4093330391745863`*^9}},ExpressionUUID->"85b973da-3bee-4bad-afca-\
ddd60139d234"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"8", "14", "15", "16", "17", "18"},
     {"14", "9", "19", "20", "21", "22"},
     {"15", "19", "10", "23", "24", "25"},
     {"16", "20", "23", "11", "26", "27"},
     {"17", "21", "24", "26", "12", "28"},
     {"18", "22", "25", "27", "28", "13"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556939636632*^9, 3.702653608699246*^9, 
  3.702653689631126*^9, 3.7026542125522013`*^9, 3.702659756516313*^9, 
  3.7026647121697493`*^9, 
  3.702664884656994*^9},ExpressionUUID->"f30fac74-467b-470e-be67-\
c617a38e7b80"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["stretchOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 
  3.408559359276013*^9}},ExpressionUUID->"806ee8fc-0086-468d-8963-\
65f7bd951e4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", 
   "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", 
   "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", 
   "ohx2z2", ",", "ohy2z2"}], "}"}]], "Output",
 CellChangeTimes->{3.6195569396919193`*^9, 3.702653608899151*^9, 
  3.702653689710197*^9, 3.702654212624216*^9, 3.702659756587872*^9, 
  3.702664712435915*^9, 
  3.702664884694969*^9},ExpressionUUID->"ad89048f-8418-4d99-adb8-\
0441a008e91f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"962d4dfb-fe35-420f-b0a2-\
e2747b27b8a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "stretchSetupRules", ",", "\[IndentingNewLine]", "stretchEnergyRules", 
     ",", "\[IndentingNewLine]", "stretchForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 
   3.410958727655569*^9},ExpressionUUID->"c35375c0-5832-4e1b-8621-\
e85aed162528"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "stretchAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 
  3.410958744314476*^9}},ExpressionUUID->"52064099-ffa3-4627-80f8-\
c2c37f91a2f8"],

Cell[BoxData["stretchRules"], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 
  3.411210898002816*^9}},ExpressionUUID->"b1a40249-4327-451e-bdb0-\
e7f8cabf6dd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "r0", 
     ",", "kb"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
  3.408556502824588*^9, 
  3.4085565040993557`*^9}},ExpressionUUID->"1410c9bd-0156-4261-9767-\
d7b16ffc7251"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"stretchOutputs", ",", "StretchDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 
  3.411152052756624*^9}},ExpressionUUID->"faf75be5-87ba-4164-babb-\
9d8d83ab387c"],

Cell["\<\
Assemble the rules, the name of the energy term, the independant variable \
names, etc. into what passes for a structure in Mathematica (I call it a Pack)\
\>", "Subsection",
 CellChangeTimes->{{3.494843911918105*^9, 
  3.494844017248684*^9}},ExpressionUUID->"7a30b210-9d08-4aa3-9dbe-\
0c1bec4ec4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Stretch\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "stretchHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "stretchRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "stretchInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "stretchOutputs"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9},ExpressionUUID->"e7c04b05-4842-4c2d-8283-\
54f03f84cc79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "stretchPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 
   3.4110670621890917`*^9},ExpressionUUID->"0398e0a1-c5f2-4b1c-b25d-\
c1ef738c0fb1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing finite difference debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugFiniteDifference.cc\"\>"}],
  SequenceForm[
  "Writing finite difference debug code to: ", 
   "_Stretch_debugFiniteDifference.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 
  3.702664884974375*^9},ExpressionUUID->"d49d760c-9752-4287-b1ee-\
c59c2d9901d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing debug variable declares to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugEvalDeclares.cc\"\>"}],
  SequenceForm[
  "Writing debug variable declares to: ", "_Stretch_debugEvalDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 
  3.702664884976199*^9},ExpressionUUID->"3483245f-5da5-4fe5-b6c7-\
099b0fd2bcbd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing xml output debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugEvalSerialize.cc\"\>"}],
  SequenceForm[
  "Writing xml output debug code to: ", "_Stretch_debugEvalSerialize.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 
  3.702664884977539*^9},ExpressionUUID->"d3359fc4-2c4c-491b-a6b4-\
51cca5d2058f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing set variables debug code to: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_debugEvalSet.cc\"\>"}],
  SequenceForm[
  "Writing set variables debug code to: ", "_Stretch_debugEvalSet.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691042564*^9, 3.7026597569491587`*^9, 
  3.702664713252482*^9, 
  3.702664884978869*^9},ExpressionUUID->"f86220bb-9a97-4f9f-928f-\
9b09c5474a88"]
}, Open  ]],

Cell["\<\
stretchPack = Block[{PrintTemporary = Print}, packOptimize[stretchPack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 
   3.4110728451363277`*^9}},ExpressionUUID->"95dc914b-df9d-44ae-9c6d-\
67f1919fbd54"],

Cell["Put the pedal to the metal and generate \"C\" code.", "Subsection",
 CellChangeTimes->{{3.494844094666773*^9, 
  3.494844119787055*^9}},ExpressionUUID->"47d94349-2f0d-408a-90da-\
4fb017e5e65a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"stretchPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "stretchPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}},ExpressionUUID->"59c99ea9-0cd8-47be-9284-\
c22abf527e8b"],

Cell[BoxData[
 StyleBox["\<\"Set TimesSimplify and PlusSimplify to turn these \
simplifications off and on\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->24,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664885030191*^9},ExpressionUUID->"92bafb4d-4ba5-4ded-842d-\
fc65787b40d5"],

Cell[BoxData[
 StyleBox["\<\"PlusOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664885032074*^9},ExpressionUUID->"77c01193-cb70-4525-bfb6-\
ad7b999a8573"],

Cell[BoxData[
 StyleBox["\<\"TimesOptimize = True\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontSize->20,
  FontSlant->Italic,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.7026648850334*^9},ExpressionUUID->"bb84f2b9-0698-4abf-97cb-8c87a987c623"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664887928844*^9},ExpressionUUID->"c6f5f38b-19a3-45b9-b59d-\
d86cd0dcaef4"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664887930175*^9},ExpressionUUID->"14fe6b81-4e0e-4b1f-ac49-\
f1c554b8e688"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664887931446*^9},ExpressionUUID->"86f531ea-5575-4f25-bda1-\
75b3b330143c"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664887932836*^9},ExpressionUUID->"949d2899-8fc9-46a2-9c67-\
89ecc5ea3a2c"],

Cell[BoxData["\<\"Collecting terms\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664887977501*^9},ExpressionUUID->"856ee7af-fea0-4848-b61a-\
275afeece630"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], ":", 
  " ", "\<\"Tag \[NoBreak]\\!\\(Times\\)\[NoBreak] in \
\[NoBreak]\\!\\(Null\\\\ \\(\\({\\(\\(Name \[Rule] \\\"Stretch\\\"\\)\\), \\(\
\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \\(\\(Output \[Rule] \
\\(\\({Energy, fx1, fy1, fz1, fx2, fy2, fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, \
dhy2y2, \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), ohx1z2, ohy1z1, \
ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, ohx2y2, ohx2z2, ohy2z2, \
StretchDeviation}\\)\\)\\)\\)}\\)\\)\\)\[NoBreak] is Protected. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/write\\\", \
ButtonNote -> \\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.702659694848699*^9, 3.702659760691435*^9, 
  3.702664716820163*^9, 
  3.70266488797926*^9},ExpressionUUID->"7bf8f2a1-53c6-4c48-9507-1237a78965c1"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664890878891*^9},ExpressionUUID->"5f29907b-b737-4a02-aac0-\
997ed34dfb61"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664890880373*^9},ExpressionUUID->"5dd24b44-3866-4569-b34a-\
b3c2377a0852"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664890881813*^9},ExpressionUUID->"05a0f841-16a9-4c2d-93df-\
56fad59be501"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664890883408*^9},ExpressionUUID->"f4cf6344-000f-4654-aecd-\
35805fecb9e7"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891128175*^9},ExpressionUUID->"19b67959-fc28-41ef-a1dd-\
c1b7522c7181"],

Cell[BoxData["\<\"trivialRules>> triv = {}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891129704*^9},ExpressionUUID->"649bcf17-3a37-40d9-8068-\
210059d0c3bb"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.7026648911311502`*^9},ExpressionUUID->"52654ff7-e7b9-40a5-81c0-\
20c323a11006"],

Cell[BoxData["\<\"There were no trivial rules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891132653*^9},ExpressionUUID->"ac73d32c-0748-404b-969c-\
c64500816778"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891179064*^9},ExpressionUUID->"d7021a43-2b64-4646-9c29-\
4d2d3d51d222"],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891180541*^9},ExpressionUUID->"e6b4ceb5-ea5c-4347-bbc7-\
e3801fd0f8a4"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891182026*^9},ExpressionUUID->"d693b23a-2bac-412b-b3f6-\
cb57e65bf7d9"],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.70266489118356*^9},ExpressionUUID->"b2fc5ea1-b928-406f-b35d-dc47d9825bac"],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\n-2. kb \
tx47 tx57 tx58 -> gx1\\n\\n-gx1 -> \
fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\\n-2. kb tx48 tx57 \
tx58 -> gy1\\n\\n-gy1 -> fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 \
);]\\n\\n-2. kb tx49 tx57 tx58 -> gz1\\n\\n-gz1 -> \
fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 );]\\n\\n2. kb tx47 tx57 \
tx58 -> gx2\\n\\n-gx2 -> fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 \
);]\\n\\n2. kb tx48 tx57 tx58 -> gy2\\n\\n-gy2 -> \
fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 );]\\n\\n2. kb tx49 tx57 \
tx58 -> gz2\\n\\n-gz2 -> fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 \
);]\\n\\nCCode[#ifdef STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( \
calcDiagonalHessian ) {]\\n\\ntx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\nreciprocal[tx87] -> tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> \
tx60\\n\\n2. kb tx57 tx88 -> tx61\\n\\n-2. kb tx50 tx57 tx59 -> tx62\\n\\n2. \
kb tx50 tx60 -> tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\n-2. kb tx51 tx57 tx59 -> tx64\\n\\n2. kb tx51 tx60 -> tx65\\n\\ntx61 + \
tx64 + tx65 -> dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 1, dhy1y1);]\\n\\n-2. kb tx52 tx57 tx59 -> tx66\\n\\n2. kb tx52 tx60 -> \
tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\n-2. kb tx47 tx48 tx57 \
tx59 -> tx68\\n\\n2. kb tx47 tx48 tx60 -> tx69\\n\\ntx68 + tx69 -> \
ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\n-2. kb tx47 tx49 tx57 tx59 -> tx70\\n\\n2. kb tx47 tx49 tx60 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. kb tx57 tx88 -> tx72\\n\\n2. kb tx50 tx57 tx59 -> \
tx73\\n\\n-2. kb tx50 tx60 -> tx74\\n\\ntx72 + tx73 + tx74 -> \
ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);]\\n\\n2. kb tx47 tx48 tx57 tx59 -> tx75\\n\\n-2. kb tx47 tx48 tx60 \
-> tx76\\n\\ntx75 + tx76 -> \
ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);]\\n\\n2. kb tx47 tx49 tx57 tx59 -> tx77\\n\\n-2. kb tx47 tx49 tx60 \
-> tx78\\n\\ntx77 + tx78 -> \
ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);]\\n\\n-2. kb tx48 tx49 tx57 tx59 -> tx79\\n\\n2. kb tx48 tx49 tx60 \
-> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\n2. kb tx51 tx57 tx59 -> tx81\\n\\n-2. kb tx51 tx60 -> \
tx82\\n\\ntx72 + tx81 + tx82 -> \
ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);]\\n\\n2. kb tx48 tx49 tx57 tx59 -> tx83\\n\\n-2. kb tx48 tx49 tx60 \
-> tx84\\n\\ntx83 + tx84 -> \
ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\n2. kb tx52 tx57 tx59 -> tx85\\n\\n-2. kb tx52 tx60 -> \
tx86\\n\\ntx72 + tx85 + tx86 -> \
ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891185121*^9},ExpressionUUID->"402c1252-9a6c-4cfe-8963-\
fdf78e30087c"],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891929039*^9},ExpressionUUID->"6e1bf454-6018-4a9a-bdad-\
72fb5a58e6ef"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891930646*^9},ExpressionUUID->"c9637d92-0a42-4f2b-9118-\
1772c3d5f04a"],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891932186*^9},ExpressionUUID->"cb0d06a4-ec97-4559-a6a2-\
887bc5e94825"],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\nkb tx57 \
-> tzz90\\n\\ntx58 tzz90 -> tzz93\\n\\n-2. tzz93 -> tzz102\\n\\ntx47 tzz102 \
-> gx1\\n\\n-gx1 -> fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\
\\ntx48 tzz102 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx49 tzz102 -> \
gz1\\n\\n-gz1 -> fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n2. tzz93 -> tzz101\\n\\ntx47 tzz101 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\ntx48 tzz101 -> \
gy2\\n\\n-gy2 -> fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 \
);]\\n\\ntx49 tzz101 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ntx53 -> tx87\\n\\ntx58 -> tx88\\n\\nreciprocal[tx87] -> \
tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> tx60\\n\\n2. tx88 tzz90 -> \
tx61\\n\\ntx59 tzz90 -> tzz91\\n\\n-2. tzz91 -> tzz97\\n\\ntx50 tzz97 -> tx62\
\\n\\nkb tx60 -> tzz92\\n\\n2. tzz92 -> tzz94\\n\\ntx50 tzz94 -> \
tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx51 tzz97 -> tx64\\n\\ntx51 tzz94 -> tx65\\n\\ntx61 + tx64 + tx65 -> \
dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx52 tzz97 -> tx66\\n\\ntx52 tzz94 -> tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx47 tx48 -> \
tzz100\\n\\ntzz100 tzz97 -> tx68\\n\\ntzz100 tzz94 -> tx69\\n\\ntx68 + tx69 \
-> ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx47 tx49 -> tzz99\\n\\ntzz97 tzz99 -> tx70\\n\\ntzz94 tzz99 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. tx88 tzz90 -> tx72\\n\\n2. tzz91 -> tzz95\\n\\ntx50 tzz95 \
-> tx73\\n\\n-2. tzz92 -> tzz96\\n\\ntx50 tzz96 -> tx74\\n\\ntx72 + tx73 + \
tx74 -> ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
0, ohx1x2);]\\n\\ntzz100 tzz95 -> tx75\\n\\ntzz100 tzz96 -> tx76\\n\\ntx75 + \
tx76 -> ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
1, ohx1y2);]\\n\\ntzz95 tzz99 -> tx77\\n\\ntzz96 tzz99 -> tx78\\n\\ntx77 + \
tx78 -> ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
2, ohx1z2);]\\n\\ntx48 tx49 -> tzz98\\n\\ntzz97 tzz98 -> tx79\\n\\ntzz94 \
tzz98 -> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx51 tzz95 -> tx81\\n\\ntx51 tzz96 -> tx82\\n\\ntx72 + tx81 + \
tx82 -> ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
1, ohy1y2);]\\n\\ntzz95 tzz98 -> tx83\\n\\ntzz96 tzz98 -> tx84\\n\\ntx83 + \
tx84 -> ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
2, ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx52 tzz95 -> tx85\\n\\ntx52 tzz96 -> tx86\\n\\ntx72 + tx85 + \
tx86 -> ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, \
2, ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.70266489193359*^9},ExpressionUUID->"19c68b56-11df-4787-a131-58ac58c138c9"],

Cell[BoxData["\<\"eliminateTrivialRules\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891977737*^9},ExpressionUUID->"be9e5166-b65f-4f41-965d-\
180d64f371e8"],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891979203*^9},ExpressionUUID->"14fc543e-0301-47ff-b1ac-\
a50811a7e849"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891980592*^9},ExpressionUUID->"63417cee-f557-426a-abd0-\
87b3ae62e3f1"],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664891982128*^9},ExpressionUUID->"394c8e44-3f4d-4a6e-9706-\
bd5378b57983"],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\nkb tx57 \
-> tzz90\\n\\ntx58 tzz90 -> tzz93\\n\\n-2. tzz93 -> tzz102\\n\\ntx47 tzz102 \
-> gx1\\n\\n-gx1 -> fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\
\\ntx48 tzz102 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx49 tzz102 -> \
gz1\\n\\n-gz1 -> fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n2. tzz93 -> tzz101\\n\\ntx47 tzz101 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\ntx48 tzz101 -> \
gy2\\n\\n-gy2 -> fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 \
);]\\n\\ntx49 tzz101 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ntx53 -> tx87\\n\\ntx58 -> tx88\\n\\nreciprocal[tx87] -> \
tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> tx60\\n\\n2. tx88 tzz90 -> \
tx61\\n\\ntx59 tzz90 -> tzz91\\n\\n-2. tzz91 -> tzz97\\n\\ntx50 tzz97 -> tx62\
\\n\\nkb tx60 -> tzz92\\n\\n2. tzz92 -> tzz94\\n\\ntx50 tzz94 -> \
tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx51 tzz97 -> tx64\\n\\ntx51 tzz94 -> tx65\\n\\ntx61 + tx64 + tx65 -> \
dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx52 tzz97 -> tx66\\n\\ntx52 tzz94 -> tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx47 tx48 -> \
tzz100\\n\\ntzz100 tzz97 -> tx68\\n\\ntzz100 tzz94 -> tx69\\n\\ntx68 + tx69 \
-> ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx47 tx49 -> tzz99\\n\\ntzz97 tzz99 -> tx70\\n\\ntzz94 tzz99 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. tx88 tzz90 -> tx72\\n\\n2. tzz91 -> tzz95\\n\\ntx50 tzz95 \
-> tx73\\n\\n-2. tzz92 -> tzz96\\n\\ntx50 tzz96 -> tx74\\n\\ntx72 + tx73 + \
tx74 -> ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
0, ohx1x2);]\\n\\ntzz100 tzz95 -> tx75\\n\\ntzz100 tzz96 -> tx76\\n\\ntx75 + \
tx76 -> ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
1, ohx1y2);]\\n\\ntzz95 tzz99 -> tx77\\n\\ntzz96 tzz99 -> tx78\\n\\ntx77 + \
tx78 -> ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
2, ohx1z2);]\\n\\ntx48 tx49 -> tzz98\\n\\ntzz97 tzz98 -> tx79\\n\\ntzz94 \
tzz98 -> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx51 tzz95 -> tx81\\n\\ntx51 tzz96 -> tx82\\n\\ntx72 + tx81 + \
tx82 -> ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
1, ohy1y2);]\\n\\ntzz95 tzz98 -> tx83\\n\\ntzz96 tzz98 -> tx84\\n\\ntx83 + \
tx84 -> ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
2, ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx52 tzz95 -> tx85\\n\\ntx52 tzz96 -> tx86\\n\\ntx72 + tx85 + \
tx86 -> ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, \
2, ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.7026648919835453`*^9},ExpressionUUID->"c583dc21-2810-4dfd-9d9b-\
49c9c28b9939"],

Cell[BoxData["\<\"trivialRules>> triv = {tx53 -> tx87, tx58 -> tx88, tx89 -> \
tx60}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664892078755*^9},ExpressionUUID->"4f13b8a0-1c80-481d-b2d3-\
729dde08ee7e"],

Cell[BoxData["\<\"trivialRules>> outs = {Energy, fx1, fy1, fz1, fx2, fy2, \
fz2, dhx1x1, dhy1y1, dhz1z1, dhx2x2, dhy2y2, dhz2z2, ohx1y1, ohx1z1, ohx1x2, \
ohx1y2, ohx1z2, ohy1z1, ohy1x2, ohy1y2, ohy1z2, ohz1x2, ohz1y2, ohz1z2, \
ohx2y2, ohx2z2, ohy2z2, StretchDeviation}\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.7026648920802526`*^9},ExpressionUUID->"38e63fd3-805f-49c2-9027-\
59fe7b3e9e44"],

Cell[BoxData["\<\"Trivial rules are being removed: tx53 -> tx87\\n\\ntx58 -> \
tx88\\n\\ntx89 -> tx60\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.70266489208176*^9},ExpressionUUID->"de668f30-7d1d-47cf-8f0c-943e710dcef5"],

Cell[BoxData["\<\"After removal: \
CCode[STRETCH_SET_PARAMETER(kb);]\\n\\nCCode[STRETCH_SET_PARAMETER(r0);]\\n\\\
nCCode[STRETCH_SET_PARAMETER(I1);]\\n\\nCCode[STRETCH_SET_PARAMETER(I2);]\\n\\\
nCCode[STRETCH_SET_POSITION(x1,I1,0);]\\n\\nCCode[STRETCH_SET_POSITION(y1,I1,\
1);]\\n\\nCCode[STRETCH_SET_POSITION(z1,I1,2);]\\n\\nCCode[STRETCH_SET_\
POSITION(x2,I2,0);]\\n\\nCCode[STRETCH_SET_POSITION(y2,I2,1);]\\n\\nCCode[\
STRETCH_SET_POSITION(z2,I2,2);]\\n\\n-x1 -> tx44\\n\\n-y1 -> tx45\\n\\n-z1 -> \
tx46\\n\\ntx44 + x2 -> tx47\\n\\ntx45 + y2 -> tx48\\n\\ntx46 + z2 -> \
tx49\\n\\npower2[tx47] -> tx50\\n\\npower2[tx48] -> tx51\\n\\npower2[tx49] -> \
tx52\\n\\ntx50 + tx51 + tx52 -> tx53\\n\\n-r0 -> tx54\\n\\nmysqrt[tx53] -> \
tx55\\n\\ntx54 + tx55 -> StretchDeviation\\n\\npower2[StretchDeviation] -> \
tx56\\n\\nkb tx56 -> Energy\\n\\nCCode[STRETCH_ENERGY_ACCUMULATE(Energy);]\\n\
\\nCCode[#ifdef STRETCH_CALC_FORCE //[]\\n\\nCCode[if ( calcForce ) \
{]\\n\\nStretchDeviation -> tx57\\n\\nreciprocal[tx55] -> tx58\\n\\nkb tx57 \
-> tzz90\\n\\ntx58 tzz90 -> tzz93\\n\\n-2. tzz93 -> tzz102\\n\\ntx47 tzz102 \
-> gx1\\n\\n-gx1 -> fx1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 0, fx1 );]\\n\
\\ntx48 tzz102 -> gy1\\n\\n-gy1 -> \
fy1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 1, fy1 );]\\n\\ntx49 tzz102 -> \
gz1\\n\\n-gz1 -> fz1\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I1, 2, fz1 \
);]\\n\\n2. tzz93 -> tzz101\\n\\ntx47 tzz101 -> gx2\\n\\n-gx2 -> \
fx2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 0, fx2 );]\\n\\ntx48 tzz101 -> \
gy2\\n\\n-gy2 -> fy2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 1, fy2 \
);]\\n\\ntx49 tzz101 -> gz2\\n\\n-gz2 -> \
fz2\\n\\nCCode[STRETCH_FORCE_ACCUMULATE(I2, 2, fz2 );]\\n\\nCCode[#ifdef \
STRETCH_CALC_DIAGONAL_HESSIAN //[]\\n\\nCCode[if ( calcDiagonalHessian ) \
{]\\n\\ntx53 -> tx87\\n\\ntx58 -> tx88\\n\\nreciprocal[tx87] -> \
tx89\\n\\ntx88 tx89 -> tx59\\n\\ntx89 -> tx60\\n\\n2. tx88 tzz90 -> \
tx61\\n\\ntx59 tzz90 -> tzz91\\n\\n-2. tzz91 -> tzz97\\n\\ntx50 tzz97 -> tx62\
\\n\\nkb tx60 -> tzz92\\n\\n2. tzz92 -> tzz94\\n\\ntx50 tzz94 -> \
tx63\\n\\ntx61 + tx62 + tx63 -> \
dhx1x1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);]\
\\n\\ntx51 tzz97 -> tx64\\n\\ntx51 tzz94 -> tx65\\n\\ntx61 + tx64 + tx65 -> \
dhy1y1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);]\
\\n\\ntx52 tzz97 -> tx66\\n\\ntx52 tzz94 -> tx67\\n\\ntx61 + tx66 + tx67 -> \
dhz1z1\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);]\
\\n\\ndhx1x1 -> dhx2x2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, \
I2, 0, dhx2x2);]\\n\\ndhy1y1 -> \
dhy2y2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);]\
\\n\\ndhz1z1 -> dhz2z2\\n\\nCCode[STRETCH_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, \
I2, 2, dhz2z2);]\\n\\nCCode[#ifdef STRETCH_CALC_OFF_DIAGONAL_HESSIAN \
//[]\\n\\nCCode[if ( calcOffDiagonalHessian ) {]\\n\\ntx47 tx48 -> \
tzz100\\n\\ntzz100 tzz97 -> tx68\\n\\ntzz100 tzz94 -> tx69\\n\\ntx68 + tx69 \
-> ohx1y1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);]\\n\\ntx47 tx49 -> tzz99\\n\\ntzz97 tzz99 -> tx70\\n\\ntzz94 tzz99 \
-> tx71\\n\\ntx70 + tx71 -> \
ohx1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);]\\n\\n-2. tx88 tzz90 -> tx72\\n\\n2. tzz91 -> tzz95\\n\\ntx50 tzz95 \
-> tx73\\n\\n-2. tzz92 -> tzz96\\n\\ntx50 tzz96 -> tx74\\n\\ntx72 + tx73 + \
tx74 -> ohx1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
0, ohx1x2);]\\n\\ntzz100 tzz95 -> tx75\\n\\ntzz100 tzz96 -> tx76\\n\\ntx75 + \
tx76 -> ohx1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
1, ohx1y2);]\\n\\ntzz95 tzz99 -> tx77\\n\\ntzz96 tzz99 -> tx78\\n\\ntx77 + \
tx78 -> ohx1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, \
2, ohx1z2);]\\n\\ntx48 tx49 -> tzz98\\n\\ntzz97 tzz98 -> tx79\\n\\ntzz94 \
tzz98 -> tx80\\n\\ntx79 + tx80 -> \
ohy1z1\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);]\\n\\nohx1y2 -> \
ohy1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);]\\n\\ntx51 tzz95 -> tx81\\n\\ntx51 tzz96 -> tx82\\n\\ntx72 + tx81 + \
tx82 -> ohy1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
1, ohy1y2);]\\n\\ntzz95 tzz98 -> tx83\\n\\ntzz96 tzz98 -> tx84\\n\\ntx83 + \
tx84 -> ohy1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, \
2, ohy1z2);]\\n\\nohx1z2 -> \
ohz1x2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);]\\n\\nohy1z2 -> \
ohz1y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);]\\n\\ntx52 tzz95 -> tx85\\n\\ntx52 tzz96 -> tx86\\n\\ntx72 + tx85 + \
tx86 -> ohz1z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, \
2, ohz1z2);]\\n\\nohx1y1 -> \
ohx2y2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);]\\n\\nohx1z1 -> \
ohx2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);]\\n\\nohy1z1 -> \
ohy2z2\\n\\nCCode[STRETCH_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);]\\n\\nCCode[} /*if calcOffDiagonalHessian */ ]\\n\\nCCode[#endif /* \
STRETCH_CALC_OFF_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} /*calcDiagonalHessian */]\
\\n\\nCCode[#endif /* STRETCH_CALC_DIAGONAL_HESSIAN ]*/]\\n\\nCCode[} \
/*calcForce */]\\n\\nCCode[#endif /* STRETCH_CALC_FORCE ]*/]\"\>"], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664892083129*^9},ExpressionUUID->"cb865d67-cfaf-42a7-9d29-\
b3b5c49d5b89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing declares to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_termDeclares.cc\"\>"}],
  SequenceForm["Writing declares to file: ", "_Stretch_termDeclares.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.702664892128408*^9},ExpressionUUID->"ef25a09d-cf38-47f0-9f1b-\
a1a24733d2b5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Writing code to file: \"\>", 
   "\[InvisibleSpace]", "\<\"_Stretch_termCode.cc\"\>"}],
  SequenceForm["Writing code to file: ", "_Stretch_termCode.cc"],
  Editable->False]], "Print",
 CellChangeTimes->{3.702659691113134*^9, 3.70265975700904*^9, 
  3.702664713588789*^9, 
  3.7026648921298313`*^9},ExpressionUUID->"0c662b32-0ab6-4f1e-b083-\
16c927ef50c8"]
}, {32}]]
}, Closed]],

Cell["\<\
Draw an evaluation tree for the optimized \"C\" code.  It doesn' t do \
anything useful but it looks impressive - I have got to print some of these \
on large format posters.

Inputs (independent variables and parameters) are on the left and drawn in \
Black, and outputs are on the right and also drawn in Black. Computationally \
expensive functions are highlighted in red, Plus functions are blue and Times \
functions are green.\
\>", "Subsection",
 CellChangeTimes->{{3.494844130294557*^9, 3.494844200819201*^9}, {
  3.494844239453156*^9, 3.494844307388302*^9}, {3.494844349909049*^9, 
  3.494844362349473*^9}, {3.494844417981534*^9, 
  3.49484444617253*^9}},ExpressionUUID->"d85419f9-f6ab-47b9-9980-\
3a9d88d220c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "stretchPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
  3.4085648880849*^9, 
  3.408564889562644*^9}},ExpressionUUID->"da94a614-58b0-482f-9c2c-\
09b6822c7db4"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 19.}, {0.03, 11.875}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 56.99999999999999}, {0.03, 35.625}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.06999999999999999, 95.}, {0.03, 59.375}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 23.75}, {0.13, 19.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 23.75}, {0.03, 83.125}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 71.25}, {0.13, 56.99999999999999}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 71.25}, {0.03, 106.875}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 118.75}, {0.13, 95.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.17, 118.75}, {0.03, 130.625}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 13.571428571428573`}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 40.71428571428571}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 67.85714285714286}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.5}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.5}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.37000000000000005`, 47.5}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.06999999999999999, 133.}, {0.03, 154.375}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.47000000000000003`, 31.666666666666664`}, {0.43, 47.5}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{0.5700000000000001, 19.}, {0.13, 133.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{0.5700000000000001, 19.}, {0.53, 31.666666666666664`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.67, 19.}, {0.63, 19.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 19.}, {0.63, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 19.}, {0.73, 19.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 56.99999999999999}, {0.63, 19.}}]}, 
   {RGBColor[1, 0, 0], 
    LineBox[{{0.5700000000000001, 95.}, {0.53, 31.666666666666664`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 56.99999999999999}, {0.63, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.77, 56.99999999999999}, {0.73, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 13.571428571428573`}, {0.63, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 13.571428571428573`}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 5.588235294117647}, {0.9300000000000002, 
     13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 5.}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 5.}, {1.03, 5.588235294117647}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 5.}, {1.1300000000000001`, 5.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 15.}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 15.}, {1.03, 5.588235294117647}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 15.}, {1.1300000000000001`, 15.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 25.}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 25.}, {1.03, 5.588235294117647}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 25.}, {1.1300000000000001`, 25.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 16.764705882352942`}, {0.9300000000000002, 
     13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 35.}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 35.}, {1.03, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 35.}, {1.1300000000000001`, 35.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 45.}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 45.}, {1.03, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 45.}, {1.1300000000000001`, 45.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{1.07, 55.}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 55.}, {1.03, 16.764705882352942`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.17, 55.}, {1.1300000000000001`, 55.}}]}, 
   {GrayLevel[0], LineBox[{{0.47000000000000003`, 95.}, {0.43, 47.5}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 95.}, {0.63, 95.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0.5700000000000001, 133.}, {0.53, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 95.}, {0.73, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 95.}, {0.63, 133.}}]}, 
   {GrayLevel[0], LineBox[{{0.67, 133.}, {0.63, 133.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 40.71428571428571}, {0.73, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 40.71428571428571}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 67.85714285714286}, {0.8300000000000001, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 67.85714285714286}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 27.941176470588232`}, {0.9300000000000002, 
     67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 65.}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 65.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 133.}, {0.63, 56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.77, 133.}, {0.73, 133.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 95.}, {0.8300000000000001, 133.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 39.117647058823536`}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 39.117647058823536`}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 65.}, {0.9300000000000002, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 65.}, {1.1300000000000001`, 65.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 65.}, {1.03, 39.117647058823536`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 75.}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 75.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 50.294117647058826`}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 50.294117647058826`}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 75.}, {0.9300000000000002, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 75.}, {1.1300000000000001`, 75.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 75.}, {1.03, 50.294117647058826`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 85.}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 85.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 61.47058823529412}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 61.47058823529412}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 85.}, {0.9300000000000002, 40.71428571428571}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 85.}, {1.1300000000000001`, 85.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 85.}, {1.03, 61.47058823529412}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 9.5}, {1.2300000000000002`, 65.}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.27, 28.499999999999996`}, {1.2300000000000002`, 75.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 47.5}, {1.2300000000000002`, 85.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 95.}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.27, 95.}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 95.}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 95.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 72.6470588235294}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 72.6470588235294}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 95.}, {1.1300000000000001`, 95.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 95.}, {1.03, 72.6470588235294}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 122.14285714285715`}, {0.22999999999999998`, 23.75}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 122.14285714285715`}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 105.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 105.}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 83.82352941176471}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 83.82352941176471}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 105.}, {1.1300000000000001`, 105.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 105.}, {1.03, 83.82352941176471}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.87, 122.14285714285715`}, {0.73, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 122.14285714285715`}, {0.8300000000000001, 
     56.99999999999999}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 95.}, {0.9300000000000002, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 115.}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 115.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.87, 149.28571428571428`}, {0.8300000000000001, 133.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 106.17647058823529`}, {0.33, 13.571428571428573`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 106.17647058823529`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 115.}, {0.9300000000000002, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 115.}, {1.1300000000000001`, 115.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 115.}, {1.03, 106.17647058823529`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 125.}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 125.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{0.97, 117.3529411764706}, {0.33, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 117.3529411764706}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 125.}, {1.1300000000000001`, 125.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 125.}, {1.03, 117.3529411764706}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 135.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 135.}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 128.52941176470588`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 128.52941176470588`}, {0.33, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 135.}, {1.1300000000000001`, 135.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 135.}, {1.03, 128.52941176470588`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 149.28571428571428`}, {0.22999999999999998`, 71.25}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.27, 149.28571428571428`}, {0.22999999999999998`, 118.75}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 145.}, {1.03, 27.941176470588232`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 145.}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 139.7058823529412}, {0.9300000000000002, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 139.7058823529412}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 145.}, {1.1300000000000001`, 145.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 145.}, {1.03, 139.7058823529412}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 66.5}, {1.2300000000000002`, 125.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 155.}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 155.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 150.88235294117646`}, {0.33, 40.71428571428571}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 150.88235294117646`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 155.}, {0.9300000000000002, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 155.}, {1.1300000000000001`, 155.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 155.}, {1.03, 150.88235294117646`}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 165.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 165.}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 162.05882352941177`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 162.05882352941177`}, {0.33, 149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 165.}, {1.1300000000000001`, 165.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 165.}, {1.03, 162.05882352941177`}}]}, 
   {GrayLevel[0], 
    LineBox[{{1.27, 85.49999999999999}, {1.2300000000000002`, 135.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 104.5}, {1.2300000000000002`, 165.}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 175.}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], LineBox[{{1.07, 175.}, {1.03, 95.}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 173.23529411764707`}, {0.33, 67.85714285714286}}]}, 
   {RGBColor[0, 1, 0], 
    LineBox[{{0.97, 173.23529411764707`}, {0.9300000000000002, 
     149.28571428571428`}}]}, 
   {RGBColor[0, 0, 1], 
    LineBox[{{1.17, 175.}, {0.9300000000000002, 122.14285714285715`}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 175.}, {1.1300000000000001`, 175.}}]}, 
   {RGBColor[0, 0, 1], LineBox[{{1.17, 175.}, {1.03, 173.23529411764707`}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 123.5}, {1.2300000000000002`, 95.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 142.5}, {1.2300000000000002`, 105.}}]}, 
   {GrayLevel[0], LineBox[{{1.27, 161.5}, {1.2300000000000002`, 145.}}]}, 
   {GrayLevel[0], InsetBox["\<\"x1\"\>", {0., 11.875},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx44:Times(-1)\"\>", {0.1, 19.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y1\"\>", {0., 35.625},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx45:Times(-1)\"\>", {0.1, 56.99999999999999},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z1\"\>", {0., 59.375},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx46:Times(-1)\"\>", {0.1, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"x2\"\>", {0., 83.125},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx47:Plus\"\>", {0.2, 23.75},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"y2\"\>", {0., 106.875},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx48:Plus\"\>", {0.2, 71.25},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"z2\"\>", {0., 130.625},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx49:Plus\"\>", {0.2, 118.75},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx50:power2\"\>", {0.30000000000000004, 13.571428571428573},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx51:power2\"\>", {0.30000000000000004, 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx52:power2\"\>", {0.30000000000000004, 67.85714285714286},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"tx53:Plus\"\>", {0.4, 47.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"r0\"\>", {0., 154.375},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx54:Times(-1)\"\>", {0.1, 133.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx55:mysqrt\"\>", {0.5, 31.666666666666664},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"StretchDeviation:Plus\"\>", {0.6000000000000001, 19.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx56:power2\"\>", {0.7000000000000001, 19.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"kb\"\>", {0.6000000000000001, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"Energy:Times\"\>", {0.8, 19.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx57:Symbol\"\>", {0.7000000000000001, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx58:reciprocal\"\>", {0.6000000000000001, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz90:Times\"\>", {0.8, 56.99999999999999},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz93:Times\"\>", {0.9, 13.571428571428573},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz102:Times(-2.)\"\>", {1., 5.588235294117647},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gx1:Times\"\>", {1.1, 5.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx1:Times(-1)\"\>", {1.2000000000000002, 5.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gy1:Times\"\>", {1.1, 15.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy1:Times(-1)\"\>", {1.2000000000000002, 15.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz1:Times\"\>", {1.1, 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz1:Times(-1)\"\>", {1.2000000000000002, 25.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz101:Times(2.)\"\>", {1., 16.764705882352942},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gx2:Times\"\>", {1.1, 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fx2:Times(-1)\"\>", {1.2000000000000002, 35.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gy2:Times\"\>", {1.1, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fy2:Times(-1)\"\>", {1.2000000000000002, 45.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"gz2:Times\"\>", {1.1, 55.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"fz2:Times(-1)\"\>", {1.2000000000000002, 55.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx87:Symbol\"\>", {0.5, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx88:Symbol\"\>", {0.7000000000000001, 95.},
     Background->Automatic]}, 
   {RGBColor[1, 0, 0], InsetBox["\<\"tx89:reciprocal\"\>", {0.6000000000000001, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx59:Times\"\>", {0.8, 95.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"tx60:Symbol\"\>", {0.7000000000000001, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx61:Times(2.)\"\>", {0.9, 40.71428571428571},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz91:Times\"\>", {0.9, 67.85714285714286},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz97:Times(-2.)\"\>", {1., 27.941176470588232},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx62:Times\"\>", {1.1, 65.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz92:Times\"\>", {0.8, 133.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz94:Times(2.)\"\>", {0.9, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx63:Times\"\>", {1., 39.117647058823536},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhx1x1:Plus\"\>", {1.2000000000000002, 65.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx64:Times\"\>", {1.1, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx65:Times\"\>", {1., 50.294117647058826},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhy1y1:Plus\"\>", {1.2000000000000002, 75.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx66:Times\"\>", {1.1, 85.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx67:Times\"\>", {1., 61.47058823529412},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"dhz1z1:Plus\"\>", {1.2000000000000002, 85.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhx2x2:Symbol\"\>", {1.3, 9.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhy2y2:Symbol\"\>", {1.3, 28.499999999999996},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"dhz2z2:Symbol\"\>", {1.3, 47.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz100:Times\"\>", {0.30000000000000004, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx68:Times\"\>", {1.1, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx69:Times\"\>", {1., 72.6470588235294},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y1:Plus\"\>", {1.2000000000000002, 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz99:Times\"\>", {0.30000000000000004, 122.14285714285715},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx70:Times\"\>", {1.1, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx71:Times\"\>", {1., 83.82352941176471},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z1:Plus\"\>", {1.2000000000000002, 105.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx72:Times(-2.)\"\>", {0.9, 122.14285714285715},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz95:Times(2.)\"\>", {1., 95.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx73:Times\"\>", {1.1, 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz96:Times(-2.)\"\>", {0.9, 149.28571428571428},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx74:Times\"\>", {1., 106.17647058823529},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1x2:Plus\"\>", {1.2000000000000002, 115.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx75:Times\"\>", {1.1, 125.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx76:Times\"\>", {1., 117.3529411764706},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1y2:Plus\"\>", {1.2000000000000002, 125.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx77:Times\"\>", {1.1, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx78:Times\"\>", {1., 128.52941176470588},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohx1z2:Plus\"\>", {1.2000000000000002, 135.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tzz98:Times\"\>", {0.30000000000000004, 149.28571428571428},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx79:Times\"\>", {1.1, 145.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx80:Times\"\>", {1., 139.7058823529412},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z1:Plus\"\>", {1.2000000000000002, 145.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy1x2:Symbol\"\>", {1.3, 66.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx81:Times\"\>", {1.1, 155.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx82:Times\"\>", {1., 150.88235294117646},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1y2:Plus\"\>", {1.2000000000000002, 155.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx83:Times\"\>", {1.1, 165.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx84:Times\"\>", {1., 162.05882352941177},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohy1z2:Plus\"\>", {1.2000000000000002, 165.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1x2:Symbol\"\>", {1.3, 85.49999999999999},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohz1y2:Symbol\"\>", {1.3, 104.5},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx85:Times\"\>", {1.1, 175.},
     Background->Automatic]}, 
   {RGBColor[0, 1, 0], InsetBox["\<\"tx86:Times\"\>", {1., 173.23529411764707},
     Background->Automatic]}, 
   {RGBColor[0, 0, 1], InsetBox["\<\"ohz1z2:Plus\"\>", {1.2000000000000002, 175.},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2y2:Symbol\"\>", {1.3, 123.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohx2z2:Symbol\"\>", {1.3, 142.5},
     Background->Automatic]}, 
   {GrayLevel[0], InsetBox["\<\"ohy2z2:Symbol\"\>", {1.3, 161.5},
     Background->Automatic]}},
  AspectRatio->0.41,
  ImageSize->{464.44374999999945`, Automatic}]], "Output",
 CellChangeTimes->{3.619556950288836*^9, 3.7026536103341227`*^9, 
  3.702653690221656*^9, 3.7026542134211082`*^9, 3.702659732981819*^9, 
  3.7026597709221783`*^9, 3.7026647218992643`*^9, 
  3.7026648925602007`*^9},ExpressionUUID->"9a089f0d-00bd-4234-bbec-\
8f9ba93f8f8d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Angle bend term using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " generated gradient/Hessian expansion"
}], "Subtitle",
 CellChangeTimes->{{3.494844035232679*^9, 
  3.494844038080626*^9}},ExpressionUUID->"3740d397-c035-493d-b12d-\
221dd6531450"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", 
    ",", "y3", ",", "z3", ",", "ab", ",", "cb", ",", "ba", ",", "bb", ",", 
    "bc"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.402652780531734*^9, 3.402652792729147*^9}, {
  3.405593978391768*^9, 
  3.405593979390263*^9}},ExpressionUUID->"ae82f043-635a-4d1d-b26f-\
56323efddcd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40265249626128*^9, 3.4026525067255383`*^9}, {
  3.402652543649145*^9, 
  3.4026526050967493`*^9}},ExpressionUUID->"9f3f81f9-7c35-431b-b26e-\
614d1fa0da83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "bc", ",", 
     RowBox[{"{", 
      RowBox[{"t0", ",", "kt"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4055966209501877`*^9, 3.405596670762001*^9}, {
  3.405596704315874*^9, 3.405596706769898*^9}, {3.410178228193839*^9, 
  3.410178228313593*^9}},ExpressionUUID->"eac7cb44-7298-4b7c-99b7-\
738e18279309"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "t0", ",", "kt"}], "}"}]], "Output",
 CellChangeTimes->{3.61955698576481*^9, 
  3.702654213575954*^9},ExpressionUUID->"745549bb-247f-465a-87bf-\
5859e1b73b82"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecLen", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"ca2b6acb-001f-461b-b16b-4b42d9f59874"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", "=", " ", 
   RowBox[{"ba", " ", "-", " ", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cb", " ", "=", " ", 
   RowBox[{"bc", " ", "-", " ", "bb"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotNormAbNormCb", "=", " ", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{"ab", ",", "cb"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vecLen", "[", "ab", "]"}], 
      RowBox[{"vecLen", "[", "cb", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fnThetaDev", " ", "=", " ", 
  RowBox[{
   RowBox[{"ArcCos", "[", "dotNormAbNormCb", "]"}], "-", "t0"}]}]}], "Input",
 CellChangeTimes->{{3.405593952552783*^9, 3.4055939691503*^9}, {
   3.410366657579863*^9, 3.41036669377003*^9}, 3.410366728321971*^9, {
   3.41038785424853*^9, 3.410387855638277*^9}, {3.410392048482498*^9, 
   3.4103920758498573`*^9}, {3.4103921152109213`*^9, 
   3.4103921313864594`*^9}},ExpressionUUID->"3b1a5463-33ea-40ec-a8d1-\
ed75e741b211"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "t0"}], "+", 
  RowBox[{"ArcCos", "[", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "x2"}], "+", "x3"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y2"}], "+", "y3"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z1", "-", "z2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z2"}], "+", "z3"}], ")"}]}]}], 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x2"}], "+", "x3"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "y2"}], "+", "y3"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z2"}], "+", "z3"}], ")"}], "2"]}]]}]], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.619556985853228*^9, 
  3.702654213659534*^9},ExpressionUUID->"70ba6f1c-b27b-4aad-9684-\
43935fb6529b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleEnergyFn", " ", "=", "  ", 
  RowBox[{"kt", " ", 
   RowBox[{
    RowBox[{"(", "thetaDev", ")"}], "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.403186067709779*^9, 3.40318606785948*^9}, {
   3.403215088875318*^9, 3.4032150908565807`*^9}, {3.407556644898531*^9, 
   3.407556646619691*^9}, {3.4101782310204906`*^9, 3.41017823112637*^9}, {
   3.4168717384493732`*^9, 3.416871739535102*^9}, 
   3.416872046887182*^9},ExpressionUUID->"4803ac6a-5532-4fae-9264-\
76732195b8b4"],

Cell[BoxData[
 RowBox[{"kt", " ", 
  SuperscriptBox["thetaDev", "2"]}]], "Output",
 CellChangeTimes->{3.619556985904277*^9, 
  3.702654213713703*^9},ExpressionUUID->"0ecc08e6-ad64-4d18-b59e-\
de3e4216cdd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleEnergyFn", " ", "=", " ", 
  RowBox[{"angleEnergyFn", "/.", 
   RowBox[{"{", 
    RowBox[{"thetaDev", "\[Rule]", "fnThetaDev"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.403215209201358*^9, 
  3.4032152152672787`*^9}},ExpressionUUID->"11dcc23a-07fc-49aa-b476-\
99a82ff9dd1f"],

Cell[BoxData[
 RowBox[{"kt", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "t0"}], "+", 
     RowBox[{"ArcCos", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x2"}], "+", "x3"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y2"}], "+", "y3"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z1", "-", "z2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z2"}], "+", "z3"}], ")"}]}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x2"}], "+", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y2"}], "+", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z2"}], "+", "z3"}], ")"}], "2"]}]]}]], "]"}]}], 
    ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.6195569859544907`*^9, 
  3.702654213767082*^9},ExpressionUUID->"98a5b546-e88f-44cf-a827-\
4836ce0cb398"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "bc"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.406839124224272*^9, 3.406839125529244*^9}, {
  3.4068391856032763`*^9, 
  3.406839188261937*^9}},ExpressionUUID->"91ca3e6e-d35d-4d29-973c-\
65b1b23c74ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3"}], "}"}]], "Output",
 CellChangeTimes->{3.61955698602324*^9, 
  3.702654213830043*^9},ExpressionUUID->"eae4aa0f-338c-4854-aeb1-\
209f255bb919"]
}, Open  ]],

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.4017146731336727`*^9, 
  3.4017146744551163`*^9}},ExpressionUUID->"d01e3804-0121-42fb-b752-\
462ad3907501"],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 
  3.408563013307331*^9}},ExpressionUUID->"4a1098bb-6683-4b4b-bbc6-\
193f7b6583ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(kt);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(t0);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I1);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I2);\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<ANGLE_SET_PARAMETER(I3);\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410178179796535*^9, 
  3.410178203278604*^9}, {3.4101782360285482`*^9, 
  3.410178236128345*^9}},ExpressionUUID->"bc48386f-00e3-481f-8f93-\
7f02d8708878"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "angleVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<ANGLE_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"angleVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"angleSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 
  3.410177806677978*^9}},ExpressionUUID->"71ebd469-15e6-4c29-ba8d-\
cbccedf421ea"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.7026542139400797`*^9},ExpressionUUID->"4b1f3886-8aae-4f09-bb3c-\
22fc9b7b2a5e"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.7026542139417963`*^9},ExpressionUUID->"1d1967c5-edce-4c38-a1eb-\
0772f2caf5fb"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.702654213943021*^9},ExpressionUUID->"52b05e17-5ae7-4387-8453-\
379d49dcabcf"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.702654213944178*^9},ExpressionUUID->"492cc737-489d-443b-8320-\
ab19bf5ad2c6"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.702654213945311*^9},ExpressionUUID->"6f66e066-0752-4ea1-aeb4-\
830820f29862"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.7026542139464407`*^9},ExpressionUUID->"ac8c6542-6592-4ca9-b7ad-\
1fa24ec22830"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.702654213947575*^9},ExpressionUUID->"2f06ff27-6097-4434-be3a-\
bd3f424bebca"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.7026542139487123`*^9},ExpressionUUID->"7b3cc77a-be49-4635-9e82-\
b4044d571d8b"],

Cell[BoxData["\<\"ANGLE_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.619556986122436*^9, 
  3.702654213949847*^9},ExpressionUUID->"8c92cb5a-a9a5-45db-8c35-\
a7e314af0a66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 
   3.410177784928906*^9},ExpressionUUID->"2d433e6a-3b2c-4143-8ac4-\
c0af017d427a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(kt);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(t0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(z2,I2,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(x3,I3,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(y3,I3,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"ANGLE_SET_POSITION(z3,I3,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619556986188156*^9, 
  3.702654214110808*^9},ExpressionUUID->"d5dbf239-dc3e-4d01-86d0-\
0d2153f68f7f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408587821227968*^9, 
  3.4085878252235737`*^9}},ExpressionUUID->"bf10f6b1-dbdb-4070-a279-\
631cc559be3d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "9", "}"}]}], "]"}], ",", 
    RowBox[{"{", "9", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.40933335742642*^9, 
  3.40933336900301*^9}},ExpressionUUID->"e0399880-1939-4a57-8e96-\
973795f918fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.619556986261386*^9, 
  3.702654214189488*^9},ExpressionUUID->"d11093e0-53b9-45e7-8995-\
63b033416061"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DotNormAbNormCb", ",", "dotNormAbNormCb"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"AngleDeviation", ",", "fnThetaDev"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<bool IllegalAngle=false;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if(fabs(DotNormAbNormCb)>(1.0-VERYSMALL)) IllegalAngle=true;\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "angleEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<ANGLE\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408563249888267*^9, 
   3.408563318638526*^9}, {3.4085635055620623`*^9, 3.408563506089058*^9}, {
   3.409106851769322*^9, 3.409106882056981*^9}, {3.409333352642502*^9, 
   3.40933335434091*^9}, {3.4101778333157253`*^9, 3.410177835865591*^9}, {
   3.410177870714059*^9, 3.410177885725202*^9}, {3.410366745442485*^9, 
   3.4103668611031027`*^9}, {3.410387627352058*^9, 3.410387662996006*^9}, {
   3.410388393326111*^9, 3.4103883934847193`*^9}, {3.4103920130578737`*^9, 
   3.410392015575086*^9}, {3.410392087452957*^9, 3.4103920915966787`*^9}, {
   3.410392140741385*^9, 3.41039215558921*^9}, 3.410743057646208*^9, {
   3.411174874722517*^9, 3.411174878860882*^9}, {3.411174974239976*^9, 
   3.4111749916562967`*^9}, {3.41119932577212*^9, 
   3.4111993265205603`*^9}},ExpressionUUID->"84dbbe44-5859-46c4-80dd-\
23eba52707cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<ANGLE\>\"", ",", "angleForceHessianRules", ",", "angleOutputs", ",", 
    "angleHessian", ",", "angleEnergyFn", ",", "angleVarNames"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177889712893*^9, 
  3.410177894565605*^9}},ExpressionUUID->"33044a73-602b-403b-828c-\
e24f272955ff"],

Cell[CellGroupData[{

Cell["Collect and simplify", "Subsection",
 CellChangeTimes->{{3.4017146838017387`*^9, 
  3.40171468680226*^9}},ExpressionUUID->"8d6cdac2-cc26-4c0d-ac4a-\
8b0ff426ee18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "angleEnergyRules", "]"}]], "Input",
 CellChangeTimes->{
  3.410177837451532*^9},ExpressionUUID->"601d371d-06ac-4299-9ce7-\
fca9f62e056b"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{3.619556988925642*^9, 
  3.702654219118945*^9},ExpressionUUID->"52855112-85bd-4bf5-b76d-\
01b1d6be1657"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "angleSetupRules", ",", "angleEnergyRules", ",", 
      "angleForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.410177844659294*^9, 
  3.410177860940928*^9}},ExpressionUUID->"d71a2f28-d191-440f-8517-\
468c91233049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"angleOutputs", ",", "AngleDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411175001078189*^9, 3.411175017147767*^9}, {
  3.411199340815207*^9, 
  3.411199341516654*^9}},ExpressionUUID->"414db486-17cf-4e8a-92b3-\
a4e9e36ec83c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.40683925297971*^9, 3.406839254423614*^9}, {
  3.407733474203383*^9, 
  3.407733475711347*^9}},ExpressionUUID->"75729371-1f94-4886-b8b8-\
b77b5f14cfd1"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",",
      "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", "dhx1x1", ",", "dhy1y1",
      ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", 
     "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "ohx1y1", ",", "ohx1z1", 
     ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohx1x3", ",", 
     "ohx1y3", ",", "ohx1z3", ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", 
     ",", "ohy1z2", ",", "ohy1x3", ",", "ohy1y3", ",", "ohy1z3", ",", 
     "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohz1x3", ",", "ohz1y3", 
     ",", "ohz1z3", ",", "ohx2y2", ",", "ohx2z2", ",", "ohx2x3", ",", 
     "ohx2y3", ",", "ohx2z3", ",", "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", 
     ",", "ohy2z3", ",", "ohz2x3", ",", "ohz2y3", ",", "ohz2z3", ",", 
     "ohx3y3", ",", "ohx3z3", ",", "ohy3z3", ",", "AngleDeviation"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.6195569890302134`*^9, 
  3.70265421927724*^9},ExpressionUUID->"fe3d7b49-0e85-4297-9c6c-faf06f86894b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglePack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Angle\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "angleEnergyFn"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", " ", "\[Rule]", " ", "angleHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "angleRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "angleInputs"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "angleOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402880698908718*^9, 3.402880718144539*^9}, {
   3.405596810467842*^9, 3.405596826860199*^9}, {3.4056361468455667`*^9, 
   3.405636199543017*^9}, {3.407679917652017*^9, 3.407679931016655*^9}, 
   3.407763159631695*^9, {3.409333420940812*^9, 3.40933342773901*^9}, {
   3.410177864101145*^9, 3.410177865400531*^9}, {3.411066512729656*^9, 
   3.411066516761778*^9}, {3.41106697034696*^9, 3.411066970912582*^9}, {
   3.411073962997476*^9, 3.411073966619384*^9}, {3.411075733472687*^9, 
   3.411075737805724*^9}, {3.411076079199256*^9, 3.411076112584221*^9}, 
   3.411079373612965*^9},ExpressionUUID->"f5a8d9b0-8db4-4f49-84eb-\
ce2bd28e5834"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "anglePack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.4087904395372047`*^9, 3.408790444006906*^9}, 
   3.411067068587775*^9},ExpressionUUID->"9b6f394b-9f14-469f-90d3-\
6465f824448f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anglePack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "anglePack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402959459618227*^9, 3.402959463819249*^9}, {
   3.405593701662167*^9, 3.405593708470829*^9}, {3.405596867763544*^9, 
   3.405596869120884*^9}, {3.407559212533072*^9, 3.407559212922392*^9}, 
   3.4110666677440443`*^9},ExpressionUUID->"b673f5bb-2f7e-4566-95b1-\
308c52e10579"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "anglePack", "]"}]], "Input",
 CellChangeTimes->{{3.402959492934514*^9, 
  3.402959496895535*^9}},ExpressionUUID->"f51f5e46-cfff-4566-b8cb-\
a9dcb4a268b2"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{352., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"Angle\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "6", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
                "dhy2y2", ",", "dhz2z2", ",", "dhx3x3", ",", "dhy3y3", ",", 
                "dhz3z3", ",", "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", 
                "ohx1y2", ",", "ohx1z2", ",", 
                RowBox[{"\[LeftSkeleton]", "9", "\[RightSkeleton]"}], ",", 
                "ohy1z3", ",", "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", 
                "ohz1x3", ",", "ohz1y3", ",", "ohz1z3", ",", "ohx2y2", ",", 
                "ohx2z2", ",", "ohx2x3", ",", "ohx2y3", ",", "ohx2z3", ",", 
                "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", ",", "ohy2z3", ",", 
                "ohz2x3", ",", "ohz2y3", ",", "ohz2z3", ",", "ohx3y3", ",", 
                "ohx3z3", ",", "ohy3z3", ",", "AngleDeviation"}], "}"}]}]}], 
            "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{58., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 220, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{65., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 220, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{48., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 220, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{85., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[220]]], "Output",
 CellChangeTimes->{3.619557578663659*^9, 
  3.702654219593328*^9},ExpressionUUID->"e90a0dbf-b847-4eab-a027-\
1fddd5265f91"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Non-bonding terms
\t- Van der Waals and Electrostatic interactions.
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 
  3.402672664963516*^9}},ExpressionUUID->"99c9a3d5-8c1b-4271-8e48-\
b57be111d080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", " ", 
    "evdw", ",", " ", "eeel", ",", "nonbondEquation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
  3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
  3.402741179258795*^9}},ExpressionUUID->"48e9b2b3-a257-4ce2-ad6c-\
beeb5cf6f06b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 
  3.402652572153042*^9}},ExpressionUUID->"76eda1be-78ff-42d5-9611-\
741db42b0cf7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonBondInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "dA", ",", "dC", ",", "dQ1Q2"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 
   3.4111751886209507`*^9}},ExpressionUUID->"5800d749-c9ad-45e4-84cd-\
f6a8a4cce3f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "dA", ",",
    "dC", ",", "dQ1Q2"}], "}"}]], "Output",
 CellChangeTimes->{3.6195575788114634`*^9, 
  3.7026542197779293`*^9},ExpressionUUID->"e66e37d0-3e1c-4607-a914-\
746aaa6adfe7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondDistance", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
  3.411197578518401*^9, 
  3.411197589788989*^9}},ExpressionUUID->"b36654fb-48ad-4f60-95e5-\
e46a9c8fa8a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evdwEquation", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["dA", 
     SuperscriptBox["nonbondDistance", "12"]], "-", 
    FractionBox["dC", 
     SuperscriptBox["nonbondDistance", "6"]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 
   3.416871995722517*^9},ExpressionUUID->"e4ecce2d-11d5-4b85-bf6e-\
1c511eb237d1"],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{3.6195575788781567`*^9, 
  3.702654219876251*^9},ExpressionUUID->"a4b958fa-9c9c-4aed-a8b0-\
74eda11a66ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eeelEquation", " ", "=", " ", 
  RowBox[{"(", 
   FractionBox["dQ1Q2", "nonbondDistance"], ")"}]}]], "Input",
 CellChangeTimes->{{3.4026534322622623`*^9, 3.402653496407857*^9}, {
   3.4026535524322023`*^9, 3.402653641591628*^9}, {3.4026779483394947`*^9, 
   3.402677953362184*^9}, {3.4026781314714537`*^9, 3.4026781348802843`*^9}, {
   3.40274101413416*^9, 3.402741050316153*^9}, {3.407556736609376*^9, 
   3.4075567425681257`*^9}, {3.407557208386277*^9, 3.407557225106896*^9}, {
   3.408662115934063*^9, 3.408662119317389*^9}, 3.411081885331176*^9, {
   3.411197627982712*^9, 3.411197630382259*^9}, 
   3.416871999453731*^9},ExpressionUUID->"d57a3757-ab4e-45e7-89a8-\
13fcf89aaab6"],

Cell[BoxData[
 FractionBox["dQ1Q2", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]]], "Output",
 CellChangeTimes->{3.619557578944563*^9, 
  3.70265421993542*^9},ExpressionUUID->"f2d6cc65-229d-4d79-94a7-0d107c503325"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondEquation", " ", "=", " ", 
  RowBox[{"evdwEquation", " ", "+", " ", "eeelEquation"}]}]], "Input",
 CellChangeTimes->{{3.4027412120076227`*^9, 3.402741220906414*^9}, {
  3.4086620876703787`*^9, 
  3.408662102195766*^9}},ExpressionUUID->"9bbdfa5d-e675-4352-a694-\
e98112f9445d"],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]], "+", 
  FractionBox["dQ1Q2", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]]}]], "Output",
 CellChangeTimes->{3.619557579005105*^9, 
  3.7026542201230917`*^9},ExpressionUUID->"951dcea8-9a9f-44d2-b9c8-\
7f3cdde87413"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb"}], "}"}], "]"}]}]], "Input",ExpressionUUID->\
"42be9b2f-6ceb-4fb4-8b88-a37428204869"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.61955757905573*^9, 
  3.702654220197392*^9},ExpressionUUID->"5cb63c08-87d8-496e-9025-\
e6fde6c021bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 
  3.401714933019302*^9}},ExpressionUUID->"9afa1783-4c40-4de2-aa4b-\
1145622413f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408564450747929*^9, 
  3.408564451541582*^9}},ExpressionUUID->"6b90835a-5cbe-4a58-9285-\
2a21c24094a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonbondSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dQ1Q2);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dA);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<NONBOND_SET_PARAMETER(dC);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
  3.487025950138463*^9, 3.487025960189999*^9}, {3.487026052805409*^9, 
  3.487026058323876*^9}, {3.487032089923287*^9, 
  3.487032096633906*^9}},ExpressionUUID->"cfe6e606-fba1-48ea-bf9a-\
562e67f5ca83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "nonbondVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<NONBOND_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"nonbondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"nonbondSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 
  3.4101779539373293`*^9}},ExpressionUUID->"0e70dbf2-9ac3-4e19-8d86-\
51d956144364"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 
  3.702654220340228*^9},ExpressionUUID->"78ad736c-bb42-4577-8e04-\
91c8ca59c111"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 
  3.702654220341023*^9},ExpressionUUID->"1ac8e022-fad5-46f3-8c91-\
b48de835fd39"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 
  3.702654220341647*^9},ExpressionUUID->"fd817218-421d-4227-bdbb-\
a2310121552f"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 
  3.702654220342312*^9},ExpressionUUID->"86bbaf46-00c2-417c-bc06-\
d1967697c205"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 
  3.702654220342929*^9},ExpressionUUID->"7b198037-e8d2-460c-9dc8-\
08c3551dd13c"],

Cell[BoxData["\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619557579120377*^9, 
  3.7026542203435707`*^9},ExpressionUUID->"b28df74f-5e11-4899-a589-\
5c447cecf3d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9},ExpressionUUID->"1bd7bda5-b589-44c1-b96b-\
7a2d936004ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dA);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dC);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.61955757918412*^9, 
  3.702654220398633*^9},ExpressionUUID->"c89056a7-52ff-480a-968d-\
d8a5270df90d"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nonbondEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonbondOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"NonbondDistance", ",", "nonbondDistance"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Evdw", ",", "evdwEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND_EVDW\>\"", ",", "Evdw"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Eeel", ",", "eeelEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND_EEEL\>\"", ",", "Eeel"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", 
      RowBox[{"Evdw", "+", "Eeel"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<NONBOND\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Evdw"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nonbondOutputs", ",", "Eeel"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}},ExpressionUUID->"5748ff68-db34-4ac3-8279-\
3935f5c793f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 
  3.409334145792842*^9}},ExpressionUUID->"c39169d8-f987-4798-9872-\
debd8e68fb62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557579261977*^9, 
  3.702654220511101*^9},ExpressionUUID->"f3bc8e87-5f8c-4cf5-a54d-\
2670bfb67aba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 
  3.410177986821323*^9}},ExpressionUUID->"a0dc323a-6098-4665-a3b2-\
b2894ff60fe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<NONBOND\>\"", ",", "nonbondForceHessianRules", ",", "nonbondOutputs", 
    ",", "nonbondHessian", ",", "nonbondEquation", ",", "nonbondVarNames"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
  3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
  3.410177993430345*^9}},ExpressionUUID->"14519ff6-cd03-428c-a2a7-\
0052c1a28a48"],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 
  3.4017149467691317`*^9}},ExpressionUUID->"eea4db31-b283-4483-bfd5-\
f544a1e8a9ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"nonbondOutputs", ",", "NonbondDistance"}], "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
  3.4111976578180523`*^9, 
  3.411197662226531*^9}},ExpressionUUID->"3ef28021-744f-462f-9833-\
3dc13a7cca68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "Evdw", ",", "Eeel", ",", "fx1", ",", "fy1", ",", "fz1", ",",
    "fx2", ",", "fy2", ",", "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", 
   "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", ",", 
   "ohx1z1", ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohy1z1", ",", 
   "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohz1x2", ",", "ohz1y2", ",", 
   "ohz1z2", ",", "ohx2y2", ",", "ohx2z2", ",", "ohy2z2", ",", 
   "NonbondDistance"}], "}"}]], "Output",
 CellChangeTimes->{3.61955758071804*^9, 
  3.7026542237637577`*^9},ExpressionUUID->"6d8d7996-317b-4218-bf16-\
220af0ff26cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nonbondOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9},ExpressionUUID->"3b2f49e2-f3f0-4ed2-85a8-\
7c9e56a5bb10"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Energy", ",", "Evdw", ",", "Eeel", ",", "fx1", ",", "fy1", ",", "fz1", 
     ",", "fx2", ",", "fy2", ",", "fz2", ",", "dhx1x1", ",", "dhy1y1", ",", 
     "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", "ohx1y1", 
     ",", "ohx1z1", ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", 
     "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohz1x2", 
     ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", "ohx2z2", ",", 
     "ohy2z2", ",", "NonbondDistance"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.619557580744179*^9, 
  3.702654223815927*^9},ExpressionUUID->"dcf2b76b-5463-44cb-99f9-\
e45df26ffd16"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonbondRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "nonbondSetupRules", ",", "nonbondEnergyRules", ",", 
      "nonbondForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 
  3.410178019066489*^9}},ExpressionUUID->"de43ee89-e248-48fd-8059-\
1ee8fd91895e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Nonbond\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "nonbondEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "nonbondHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "nonbondRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "nonBondInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "nonbondOutputs"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9},ExpressionUUID->"dd3522e4-5433-4f76-b0ea-\
909c66a95f50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "nbPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 
   3.4110670742215853`*^9},ExpressionUUID->"0591fea1-e58a-4be8-a173-\
76d21f2b1c8f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "nbPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 
   3.411066673303035*^9},ExpressionUUID->"4560ee6b-0061-424d-b437-\
02fc7d3e4433"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.494844329106917*^9, 
  3.494844338578497*^9}},ExpressionUUID->"0d9147ea-7b39-4a9a-9019-\
a788b08a9021"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "nbPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 
  3.4055995100170727`*^9}},ExpressionUUID->"e46929c0-07ce-4709-bcda-\
8c7ac12b8862"],

Cell[BoxData[
 RowBox[{"packGraph", "[", 
  RowBox[{"packOptimize", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\<\"Nonbond\"\>"}], ",", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\<\"\"\>"}], ",", 
     RowBox[{"EnergyFunction", "\[Rule]", 
      RowBox[{
       FractionBox["dA", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
       FractionBox["dC", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]], "+", 
       FractionBox["dQ1Q2", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]]}]}], ",", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
       "}"}]}], ",", 
     RowBox[{"HessianStructure", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "10", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "16", ",", "11", ",", "21", ",", "22", ",", "23", ",", "24"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "17", ",", "21", ",", "12", ",", "25", ",", "26", ",", "27"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "18", ",", "22", ",", "25", ",", "13", ",", "28", ",", "29"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "19", ",", "23", ",", "26", ",", "28", ",", "14", ",", "30"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "20", ",", "24", ",", "27", ",", "29", ",", "30", ",", "15"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"Rules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I1);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(I2);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dA);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_PARAMETER(dC);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(x2,I2,0);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(y2,I2,1);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"NONBOND_SET_POSITION(z2,I2,2);\"\>", "]"}],
         ",", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]], "\[Rule]", 
         "NonbondDistance"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["dA", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "6"]], "-", 
          FractionBox["dC", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "3"]]}], 
         "\[Rule]", "Evdw"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_EVDW_ENERGY_ACCUMULATE(Evdw);\"\>", "]"}], 
        ",", 
        RowBox[{
         FractionBox["dQ1Q2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}]]], "\[Rule]", "Eeel"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_EEEL_ENERGY_ACCUMULATE(Eeel);\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"Eeel", "+", "Evdw"}], "\[Rule]", "Energy"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_ENERGY_ACCUMULATE(Energy);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"#ifdef NONBOND_CALC_FORCE //[\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gx1"}], ",", 
        RowBox[{
         RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gy1"}], ",", 
        RowBox[{
         RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gz1"}], ",", 
        RowBox[{
         RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gx2"}], ",", 
        RowBox[{
         RowBox[{"-", "gx2"}], "\[Rule]", "fx2"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I2, 0, fx2 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gy2"}], ",", 
        RowBox[{
         RowBox[{"-", "gy2"}], "\[Rule]", "fy2"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I2, 1, fy2 );\"\>", "]"}],
         ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gz2"}], ",", 
        RowBox[{
         RowBox[{"-", "gz2"}], "\[Rule]", "fz2"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"NONBOND_FORCE_ACCUMULATE(I2, 2, fz2 );\"\>", "]"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef NONBOND_CALC_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhx1x1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, dhx1x1);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhy1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, dhy1y1);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "+", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "dhz1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, dhz1z1);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhx2x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 0, dhx2x2);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhy2y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 1, dhy2y2);\
\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "+", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "dhz2z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I2, 2, I2, 2, dhz2z2);\
\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef NONBOND_CALC_OFF_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "+", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "ohx1x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 0, \
ohx1x2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 1, \
ohx1y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I2, 2, \
ohx1z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 0, \
ohy1x2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "+", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "ohy1y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 1, \
ohy1y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I2, 2, \
ohy1z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohz1x2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 0, \
ohz1x2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"168", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "y2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]]}], 
          "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohz1y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 1, \
ohz1y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "-", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "+", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "-", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohz1z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I2, 2, \
ohz1z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx2y2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 1, \
ohx2y2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "x2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx2z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 0, I2, 2, \
ohx2z2);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "y2"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "z2"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "z2"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy2z2"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"NONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I2, 1, I2, 2, \
ohy2z2);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* NONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* NONBOND_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* NONBOND_CALC_FORCE ]*/\"\>", "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"Input", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "dA",
         ",", "dC", ",", "dQ1Q2"}], "}"}]}], ",", 
     RowBox[{"Output", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Energy", ",", "Evdw", ",", "Eeel", ",", "fx1", ",", "fy1", ",", "fz1",
         ",", "fx2", ",", "fy2", ",", "fz2", ",", "dhx1x1", ",", "dhy1y1", 
        ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", ",", 
        "ohx1y1", ",", "ohx1z1", ",", "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", 
        ",", "ohy1z1", ",", "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", 
        "ohz1x2", ",", "ohz1y2", ",", "ohz1z2", ",", "ohx2y2", ",", "ohx2z2", 
        ",", "ohy2z2", ",", "NonbondDistance"}], "}"}]}]}], "}"}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.619557597742949*^9, 
  3.702654224144334*^9},ExpressionUUID->"f9ec148b-7822-4ce1-9f0c-\
aeaa69620d67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dihedral angle", "Subtitle",
 CellChangeTimes->{
  3.402881806378004*^9, {3.4029555772158318`*^9, 
   3.4029555790467377`*^9}},ExpressionUUID->"2c715488-8574-4dc8-b259-\
e407398884f0"],

Cell[CellGroupData[{

Cell["Setup the torsion term", "Subtitle",
 CellChangeTimes->{{3.402833465987742*^9, 3.402833468829653*^9}, 
   3.4028818063788223`*^9},ExpressionUUID->"04a6cd04-a1ad-4f68-89b0-\
09b82e237d8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"phi", ",", "CosNPhi", ",", "SinNPhi", ",", "Phi"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.402653084688365*^9, 3.402653100998479*^9}, {
   3.402833442487673*^9, 3.4028334501114883`*^9}, 3.402881806379428*^9, {
   3.40296426730527*^9, 3.402964283016556*^9}, 3.405637646867723*^9, {
   3.40960202074789*^9, 
   3.409602031402295*^9}},ExpressionUUID->"48166561-3b1d-4d0c-99e7-\
fbf136785210"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ri", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rj", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rk", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rl", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x4", ",", " ", "y4", ",", " ", "z4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl"}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40265249702987*^9, 3.4026525074946632`*^9}, {
   3.402652543668639*^9, 3.4026526354944773`*^9}, 3.402881806379868*^9, {
   3.4029642140397663`*^9, 3.402964261657007*^9}, 3.402968762538885*^9, {
   3.4056376184618797`*^9, 3.4056376382193604`*^9}, {3.408634462799267*^9, 
   3.408634470108696*^9}},ExpressionUUID->"d173f676-d991-422e-925e-\
848a3c01d1c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vecLen", "[", "a_", "]"}], " ", ":=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.402881806380116*^9},ExpressionUUID->"6f4603c2-1919-4713-9f3d-\
46f2373773f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"ri", " ", "-", " ", "rj"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", " ", "=", " ", 
   RowBox[{"rj", " ", "-", " ", "rk"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"rl", " ", "-", " ", "rk"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402755487828414*^9, 3.4027555454245787`*^9}, {
   3.4028250971369543`*^9, 3.4028251976062737`*^9}, {3.4028282092482367`*^9, 
   3.402828220149057*^9}, 3.402881806380427*^9, {3.402964299899055*^9, 
   3.402964340775798*^9}},ExpressionUUID->"f1373096-91c6-4ff9-b77d-\
cf67e08b45f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"F", ",", "G"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028282142394447`*^9, 3.402828222806171*^9}, {
   3.402834973364376*^9, 3.402834982337648*^9}, 3.4028818063806667`*^9, 
   3.402955566383662*^9, {3.4029643524819727`*^9, 
   3.4029643605165043`*^9}},ExpressionUUID->"d9f570bf-0939-4b37-8ea1-\
49aa68016099"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"H", ",", "G"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.402828225130542*^9, 3.402881806381667*^9, 3.402955564159459*^9, {
   3.402964370060401*^9, 
   3.402964375836578*^9}},ExpressionUUID->"f79c04a5-5bb8-4d01-bad7-\
24fb62e57685"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lenA", " ", "=", " ", 
   RowBox[{"vecLen", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lenB", " ", "=", " ", 
   RowBox[{"vecLen", "[", "B", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403381748201618*^9, 
  3.403381765864654*^9}},ExpressionUUID->"b11908d1-0513-47b9-b2cf-\
7496adc770f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reciprocalLenA", " ", "=", " ", 
   RowBox[{"reciprocal", "[", "lenA", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reciprocalLenB", " ", "=", " ", 
   RowBox[{"reciprocal", "[", "lenB", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403382804807138*^9, 
  3.403382828904648*^9}},ExpressionUUID->"1c23c8e9-8c90-42a8-b35e-\
89ecee86aa63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2", ",", "DPhiDri"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2", ",", "DPhiDrj"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2", ",", "DPhiDrk"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x4", ",", "x", ",", "I4", ",", "0", ",", "DPhiDrl"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y4", ",", "y", ",", "I4", ",", "1", ",", "DPhiDrl"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "z", ",", "I4", ",", "2", ",", "DPhiDrl"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}, {
  3.408584461197592*^9, 3.408584542081841*^9}, {3.40858684037824*^9, 
  3.408586889698691*^9}, {3.408625912333675*^9, 3.4086259293924017`*^9}, {
  3.408653564774177*^9, 
  3.408653597724698*^9}},ExpressionUUID->"d12d2742-bf4e-43cd-8efe-\
d9b2bf9f1ddb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dihedralSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(sinPhase);\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(cosPhase);\>\"", "]"}]}], "]"}],
   ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(V);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(DN);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(IN);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<DIHEDRAL_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.410178119207843*^9, 3.410178147107234*^9}, {
  3.410178361408951*^9, 3.4101784213739767`*^9}, {3.410178946297854*^9, 
  3.4101789485592403`*^9}},ExpressionUUID->"7ec09b1f-51be-4efa-a5cf-\
4f855bea40b4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "dihedralVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<DIHEDRAL_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4101781215075903`*^9, 
  3.4101781485693007`*^9}},ExpressionUUID->"2bb525bc-1b3e-4313-a4d8-\
43596cac591d"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.702654224540269*^9},ExpressionUUID->"aae06535-b113-4cb1-8481-\
367553848da8"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.702654224541053*^9},ExpressionUUID->"9811b9e9-e1b1-4296-99a3-\
0ab3e2788778"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.702654224541664*^9},ExpressionUUID->"b4d64989-4259-4845-8b67-\
7333f4e00384"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.7026542245422707`*^9},ExpressionUUID->"28290360-3d0a-4aef-bc37-\
3f831ec44381"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.70265422454288*^9},ExpressionUUID->"48c90b12-4975-4223-8086-e12897061892"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.702654224543495*^9},ExpressionUUID->"8b7afc7e-9e3a-4dba-88d6-\
42f7b0b217f4"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.70265422454408*^9},ExpressionUUID->"d58d8fa8-2974-4bae-957b-e84c60a2cef7"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.702654224544661*^9},ExpressionUUID->"8fd2b796-f975-40cd-97cd-\
71b8e352c7cc"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.7026542245452423`*^9},ExpressionUUID->"eebe39cb-d1ca-4ba2-b0b0-\
3976ae8327e9"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(x4,I4,0);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.7026542245458307`*^9},ExpressionUUID->"6bf5ed8f-02c2-4a08-9cc7-\
38994ab77ff5"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(y4,I4,1);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.70265422454639*^9},ExpressionUUID->"2b072df6-9b65-4f8c-8949-2b14cf5220ce"],

Cell[BoxData["\<\"DIHEDRAL_SET_POSITION(z4,I4,2);\"\>"], "Print",
 CellChangeTimes->{3.61955759807168*^9, 
  3.7026542245469513`*^9},ExpressionUUID->"66b1fe42-5778-4e2b-8cf1-\
168ee1371212"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 
   3.4101781294677153`*^9},ExpressionUUID->"168cbd1f-187a-4c9e-a519-\
380f5029763a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(sinPhase);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(cosPhase);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(V);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(DN);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(IN);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_PARAMETER(I4);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z2,I2,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x3,I3,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y3,I3,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z3,I3,2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(x4,I4,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(y4,I4,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"DIHEDRAL_SET_POSITION(z4,I4,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557598204474*^9, 
  3.702654224597253*^9},ExpressionUUID->"6fdb671b-3e8a-42d0-b76f-\
b372d026ef06"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralCosPhiRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",ExpressionUUID->"4d46bed1-9f85-4c46-\
a287-e1c498026f22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"lenA", "\[Rule]", "LenA"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"lenB", "\[Rule]", "LenB"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"reciprocalLenA", "\[Rule]", "ReciprocalLenA"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"reciprocalLenB", "\[Rule]", "ReciprocalLenB"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.403381795133479*^9, 3.403381809347353*^9}, {
  3.4033829211263123`*^9, 3.403382946948868*^9}, {3.408654812106743*^9, 
  3.408654814048378*^9}, {3.408654920425684*^9, 3.408654921999897*^9}, {
  3.409075691562851*^9, 
  3.409075693450658*^9}},ExpressionUUID->"debcb2a5-d54b-4108-a285-\
b9df83d79199"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<if (fabs(LenA)<TENM3) ReciprocalLenA = 0.0;\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<if (fabs(LenB)<TENM3) ReciprocalLenB = 0.0;\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4033818122758904`*^9, 3.403381840232418*^9}, {
  3.4033827438088503`*^9, 3.403382763638501*^9}, {3.4033829548741693`*^9, 
  3.403383007369802*^9}, {3.4055924931110487`*^9, 3.405592500629326*^9}, {
  3.405592532178042*^9, 3.405592534505735*^9}, {3.4086548146190777`*^9, 
  3.408654815130253*^9}, {3.408654922633814*^9, 3.408654923297142*^9}, {
  3.409075693987598*^9, 
  3.4090756946375628`*^9}},ExpressionUUID->"ea90d0af-3dd3-4248-a477-\
5318c4d13a44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"recLenArecLenB", " ", "=", " ", 
   RowBox[{"ReciprocalLenA", "*", "ReciprocalLenB"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403388254532496*^9, 3.403388262628626*^9}, {
  3.403388309891501*^9, 
  3.403388332051207*^9}},ExpressionUUID->"370fcd2f-d37d-408c-ae37-\
9e62e685604c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"recLenArecLenB", "\[Rule]", "RecLenARecLenB"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.403388232755147*^9, 3.403388241973654*^9}, {
   3.403388501153823*^9, 3.403388516222354*^9}, 3.408654816210609*^9, 
   3.408654924312829*^9, 
   3.409075695424748*^9},ExpressionUUID->"c7547eb4-845e-4dc4-a46c-\
8808e81a4a86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"CCode", "[", "\"\<EraseLinearDihedral = 1.0;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if (RecLenARecLenB==0.0) EraseLinearDihedral = 0.0;\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4033919483618107`*^9, 3.403391962642305*^9}, {
   3.403392705555187*^9, 3.4033927065442123`*^9}, 3.405592505204919*^9, 
   3.405593744922014*^9, {3.405601635740213*^9, 3.405601636005928*^9}, 
   3.408465248370534*^9, {3.408654816731285*^9, 3.408654817290806*^9}, {
   3.408654924945858*^9, 3.408654925617879*^9}, {3.409075696112319*^9, 
   3.409075697100321*^9}, {3.4103580164504538`*^9, 
   3.410358022595854*^9}},ExpressionUUID->"32a6a789-05b7-46a9-acfd-\
3c76d8e4754c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"A", ".", "B"}], "*", 
    RowBox[{"(", "RecLenARecLenB", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"vecLen", "[", "G", "]"}], "*", "RecLenARecLenB", "*", 
    RowBox[{"Dot", "[", 
     RowBox[{"A", ",", "H"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402964460638973*^9, 3.4029644979500027`*^9}, 
   3.403138409061648*^9, 3.403138952358144*^9, {3.403381771339631*^9, 
   3.403381781016387*^9}, {3.403382836161371*^9, 3.40338284912206*^9}, {
   3.403388413788684*^9, 3.4033884282841063`*^9}, {3.405601670420813*^9, 
   3.405601670652701*^9}},ExpressionUUID->"66e92952-00d3-41ee-b425-\
43253b008cf9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"cosPhi", "\[Rule]", "CosPhi"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{"sinPhi", "\[Rule]", "SinPhi"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.403383084646188*^9, 3.403383094503001*^9}, {
  3.4056016822760763`*^9, 3.405601688783058*^9}, {3.408654818267323*^9, 
  3.40865481882014*^9}, {3.408654926626211*^9, 3.408654927282428*^9}, {
  3.4090757012621*^9, 
  3.409075701874107*^9}},ExpressionUUID->"86a39eaf-6c11-4f07-be79-\
8c82a081ffad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralCosPhiRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CosPhi=MAX(-1.0,MIN(1.0,CosPhi));\>\"", "]"}]}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.403389122700157*^9, 3.4033891636404963`*^9}, {
   3.405592510669314*^9, 3.405592526290204*^9}, {3.405603211703527*^9, 
   3.4056032309337063`*^9}, 3.408654819467073*^9, 3.408654927979665*^9, 
   3.4090757033740664`*^9},ExpressionUUID->"f7b5f770-59e8-46ac-982c-\
1bb4f808342f"],

Cell["phi = ArcCos[CosPhi];", "Text",
 CellChangeTimes->{{3.40282522628094*^9, 3.402825239560916*^9}, 
   3.402828109424087*^9, 3.4028818064977922`*^9, 3.402955593607312*^9, {
   3.402966167764285*^9, 3.4029662209128017`*^9}, {3.402969136323854*^9, 
   3.4029691467936563`*^9}, 3.403118920705655*^9, {3.403382875874411*^9, 
   3.403382893266426*^9}, {3.403383072284999*^9, 
   3.403383073172804*^9}},ExpressionUUID->"2bb2c12e-8c52-4e40-9006-\
aa14df8aba28"],

Cell["\<\
AppendTo[dihedralEnergyRules, phi -> Phi]; (* I don't think I need to \
evaluate Phi *)\
\>", "Text",
 CellChangeTimes->{{3.402965641072318*^9, 3.402965644799386*^9}, {
   3.402966337775351*^9, 3.402966341759678*^9}, {3.405601725668915*^9, 
   3.4056017329385233`*^9}, 3.408654821084379*^9, 
   3.4086549288754272`*^9},ExpressionUUID->"7a22154a-cae8-4624-9a16-\
0a71e403dc5a"],

Cell["\<\
At this point we need to calculate SinNPhi and CosNPhi and we use the \
function calculateSinNPhiCosNPhi in both C and Mathematica.Insert function \
sinNPhiCosNPhi[N, &sinNPhi, &cosNPhi, sinPhi, cosPhi] into evaluation\
\>", "Text",
 CellChangeTimes->{{3.403169337342634*^9, 3.4031693991609783`*^9}, {
   3.4031694370531073`*^9, 3.403169446972969*^9}, 
   3.405602925754593*^9},ExpressionUUID->"26faa9f2-ab5f-49ae-b942-\
980e9ac4d4aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralEnergyRules", " ", "=", " ", "dihedralCosPhiRules"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4090757099968023`*^9, 
  3.409075717160824*^9}},ExpressionUUID->"c18dffc4-bef2-44f6-bad3-\
27591dea4f8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "MathCode", "[", "\"\<CosNPhi = mathCosNPhi[IN,SinPhi,CosPhi];\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "MathCode", "[", "\"\<SinNPhi = mathSinNPhi[IN,SinPhi,CosPhi];\>\"", 
     "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.405602524021294*^9, 3.4056025656526947`*^9}, {
  3.40560260894772*^9, 3.40560261252293*^9}, {3.4056026493129673`*^9, 
  3.4056026535224733`*^9}, {3.405602967032895*^9, 3.405603034772718*^9}, {
  3.405603082328196*^9, 3.405603085028963*^9}, {3.405603291979817*^9, 
  3.405603295480481*^9}, {3.405636297453783*^9, 3.4056363006503143`*^9}, {
  3.405689828587071*^9, 3.405689830571216*^9}, {3.405690580000684*^9, 
  3.405690585973423*^9}, {3.408654825235148*^9, 3.4086548259385366`*^9}, {
  3.4086549296133757`*^9, 
  3.408654930210107*^9}},ExpressionUUID->"5ccfd4d3-ee22-478b-ae97-\
d3a55f5e0442"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralEnergyRules", ",", 
       RowBox[{
       "MathCode", "[", 
        "\"\<If[CosPhi>0.1,Phi=ArcSin[SinPhi],\n\t\t\t\t\t\
Phi=ArcCos[CosPhi]*Sign[SinPhi]];\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralEnergyRules", ",", 
       RowBox[{
       "CCode", "[", 
        "\"\<if(CosPhi>0.1){Phi=asin(SinPhi);}else\n\t\t\t\t\t\
{Phi=acos(CosPhi)*SIGN(SinPhi);}\>\"", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.407764211219077*^9, 3.407764213360669*^9}, {
  3.409076769869112*^9, 3.409076770848304*^9}, {3.4090773287521353`*^9, 
  3.4090773292641153`*^9}, {3.4090773794499187`*^9, 3.409077380038114*^9}, {
  3.409361613956606*^9, 
  3.409361646817099*^9}},ExpressionUUID->"186f3d6c-ef4e-4cff-b476-\
54eecbd918ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<sinNPhiCosNPhi(IN, &SinNPhi, &CosNPhi, SinPhi, CosPhi);\>\"", 
     "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4031695628011417`*^9, 3.403169583242929*^9}, {
   3.403170106527663*^9, 3.403170113631514*^9}, 3.403171032582622*^9, {
   3.403174922877117*^9, 3.403174926106832*^9}, {3.405592540417914*^9, 
   3.405592544481194*^9}, 3.4086548276018343`*^9, 
   3.408654930937489*^9},ExpressionUUID->"1e2d2d99-5518-4d52-ba69-\
bfaf22cda31b"],

Cell["\<\
Sum and difference formulas
sin (A + B) = sin A cos B + cos A sin B
sin (A - B) = sin A cos B - cos A sin B
cos (A + B) = cos A cos B - sin A sin B
cos (A - B) = cos A cos B + sin A sin B\
\>", "Text",
 CellChangeTimes->{{3.4029651450204144`*^9, 
  3.402965152857622*^9}},ExpressionUUID->"9b22137e-6645-4778-a8f4-\
e5c118342aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cosNPhiPhase", " ", "=", 
   RowBox[{
    RowBox[{"CosNPhi", "*", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", "*", "sinPhase"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinNPhiPhase", "=", 
   RowBox[{
    RowBox[{"SinNPhi", "*", "cosPhase"}], "-", 
    RowBox[{"CosNPhi", "*", "sinPhase"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.403139078293602*^9, 3.4031391381942577`*^9}, {
  3.403139212082849*^9, 3.4031392263073587`*^9}, {3.403169453484665*^9, 
  3.403169458640418*^9}, {3.403172460862658*^9, 3.40317246375632*^9}, {
  3.403392657908375*^9, 3.4033926638482733`*^9}, {3.405602017427895*^9, 
  3.405602050542378*^9}, {3.407679968844823*^9, 
  3.407680033912936*^9}},ExpressionUUID->"c61cd9aa-05f8-451d-afc9-\
a2aa733c5363"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dihedralDeviation", " ", "=", " ", 
    RowBox[{"1.0", "+", "cosNPhiPhase"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"between", " ", "0.0", " ", "and", " ", "2.0"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.411197914354374*^9, 
  3.4111979407786827`*^9}},ExpressionUUID->"56e0d398-20da-4c24-a55a-\
956be9d66f62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fnETorsion", " ", "=", " ", 
  RowBox[{"EraseLinearDihedral", " ", "*", " ", "V", " ", 
   RowBox[{"(", "dihedralDeviation", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.405602085801338*^9, 3.405602087655345*^9}, 
   3.4096015455999117`*^9, {3.411197947482793*^9, 
   3.411197949874654*^9}},ExpressionUUID->"9bed52e1-37e9-449f-b571-\
b64ae2d2130b"],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", 
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "+", 
    RowBox[{"CosNPhi", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", " ", "sinPhase"}]}], ")"}], " ", "V"}]], "Output",
 CellChangeTimes->{3.619557598678335*^9, 
  3.702654225343552*^9},ExpressionUUID->"af542870-d3bb-4c8d-adfb-\
211cf8d8ec66"]
}, Open  ]],

Cell["\<\
fnETorsion = EraseLinearDihedral * V (1.0 + Cos[DN Phi - phase]);\
\>", "Text",
 CellChangeTimes->{{3.402664776710464*^9, 3.4026647964202747`*^9}, {
   3.402741579461403*^9, 3.402741589532634*^9}, {3.4027540176742983`*^9, 
   3.402754019034227*^9}, 3.402754202717703*^9, {3.4028278800721903`*^9, 
   3.402827880421856*^9}, {3.402833328460658*^9, 3.402833328801766*^9}, 
   3.402833524934355*^9, {3.402833585431164*^9, 3.4028335857684526`*^9}, 
   3.402881806518937*^9, 3.4029662365236692`*^9, 3.402966333014995*^9, {
   3.403170907390308*^9, 3.403170917454175*^9}, {3.403391977060162*^9, 
   3.403391981586698*^9}, {3.403392611162285*^9, 
   3.4033926122962713`*^9}},ExpressionUUID->"aa8e8216-8ac0-4e2a-af79-\
dca7d0934cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DihedralDeviation", ",", "dihedralDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"fnETorsion", "\[Rule]", "Energy"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<DIHEDRAL\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dihedralOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.402966429264083*^9, 3.402966441189411*^9}, {
  3.403180571417967*^9, 3.403180572463499*^9}, {3.408588700097761*^9, 
  3.408588806889308*^9}, {3.408654830951703*^9, 3.408654831761635*^9}, {
  3.4086549320244093`*^9, 3.4086549327532454`*^9}, {3.409106916232429*^9, 
  3.409106923925405*^9}, {3.409108094891713*^9, 3.409108096587041*^9}, {
  3.411197956372534*^9, 
  3.4111979918487797`*^9}},ExpressionUUID->"a9184859-c949-4e9f-88c7-\
1e2e39d34984"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl", ",", 
     RowBox[{"{", 
      RowBox[{
      "V", ",", "DN", ",", "IN", ",", "cosPhase", ",", " ", "sinPhase"}], 
      "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598381722083*^9, 3.4055984189648457`*^9}, {
  3.405603057636241*^9, 3.4056030583078613`*^9}, {3.405690789130921*^9, 
  3.40569079264091*^9}},ExpressionUUID->"3445692b-c03d-4399-acb3-\
cd95d571d5bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4", ",", "V", ",", "DN", 
   ",", "IN", ",", "cosPhase", ",", "sinPhase"}], "}"}]], "Output",
 CellChangeTimes->{3.61955759878785*^9, 
  3.702654225477248*^9},ExpressionUUID->"01a8a0eb-5457-435e-8256-\
23a526dff462"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralEnergyFn", " ", "=", " ", 
  RowBox[{"fnETorsion", "/.", 
   RowBox[{"{", 
    RowBox[{"Phi", "\[Rule]", "phi"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.403216193482387*^9, 3.403216216011763*^9}, {
  3.4032164096112223`*^9, 
  3.403216415920596*^9}},ExpressionUUID->"9f07ce97-a97b-4cc8-9e6c-\
70537fa3669b"],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", 
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "+", 
    RowBox[{"CosNPhi", " ", "cosPhase"}], "+", 
    RowBox[{"SinNPhi", " ", "sinPhase"}]}], ")"}], " ", "V"}]], "Output",
 CellChangeTimes->{3.619557598876274*^9, 
  3.7026542255531063`*^9},ExpressionUUID->"62128a34-580c-4400-9db5-\
da73e3db7a94"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dETorsiondPhi", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "EraseLinearDihedral"}], "*", "V", "*", "DN", "*", 
    "sinNPhiPhase"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, 3.416871814458685*^9, 
   3.416872019347313*^9},ExpressionUUID->"67b5d60b-cd3a-4513-93fa-\
6dbbe68dd7c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralGradientRules", " ", "=", " ", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.408654769261054*^9, 
  3.408654775197638*^9}},ExpressionUUID->"36e3cb19-be19-40a3-86e7-\
a6678a3d4a19"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.6195575989908123`*^9, 
  3.702654225742764*^9},ExpressionUUID->"de6b3173-5bf8-4fc9-ad0d-\
8cd2e2718eb6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralGradientRules", ",", " ", 
    RowBox[{"Assign", "[", 
     RowBox[{"DeDPhi", ",", " ", "dETorsiondPhi"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.403119298187716*^9, 3.403119313404195*^9}, {
   3.403119766211968*^9, 3.4031197683762083`*^9}, 3.408583034341649*^9, {
   3.408583127586095*^9, 3.4085831347382*^9}, {3.408654883213402*^9, 
   3.408654886361278*^9}},ExpressionUUID->"79b09721-d056-44ac-929c-\
712efbaf3908"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDri", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"A", ".", "A"}]]}], "A"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408582505876679*^9, 3.4085825260019217`*^9}, {
   3.408582666908884*^9, 3.4085826685540457`*^9}, {3.408582953793984*^9, 
   3.40858295864988*^9}, {3.408583027864543*^9, 3.408583040966227*^9}, 
   3.408583191274479*^9, {3.40858326860931*^9, 3.4085832687611732`*^9}, {
   3.408626032409171*^9, 
   3.408626033373294*^9}},ExpressionUUID->"1a06cf2d-48c0-452c-882b-\
c830661e46e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrj", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"A", ".", "A"}]], "A"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"F", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"A", ".", "A"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "A"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"H", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"B", ".", "B"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "B"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4085825280925817`*^9, 3.4085825309826937`*^9}, 
   3.408582577839138*^9, {3.4085826709324503`*^9, 3.408582715459239*^9}, {
   3.408582926123191*^9, 3.408582929442951*^9}, {3.408583042966744*^9, 
   3.4085830443033247`*^9}, {3.408583194635971*^9, 3.408583194955699*^9}, {
   3.408583270147748*^9, 3.408583270323516*^9}, {3.408626035616419*^9, 
   3.408626042918641*^9}},ExpressionUUID->"a7cd9709-264e-4fc1-bf3a-\
9a397dda670c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrk", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"H", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"B", ".", "B"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "B"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"F", ".", "G"}], ")"}], 
       RowBox[{
        RowBox[{"A", ".", "A"}], "*", 
        RowBox[{"vecLen", "[", "G", "]"}]}]], "A"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"B", ".", "B"}]], "B"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085828262895317`*^9, 3.408582843568289*^9}, {
  3.4085828906122704`*^9, 3.408582896089611*^9}, {3.4085829396988707`*^9, 
  3.4085829428671217`*^9}, {3.408583046239622*^9, 3.4085830475434027`*^9}, {
  3.408583197915868*^9, 3.408583198955614*^9}, {3.4085832717315197`*^9, 
  3.408583271883222*^9}, {3.408626045600368*^9, 
  3.4086260528864803`*^9}},ExpressionUUID->"09d44404-3c78-40a6-aa12-\
aa361d490dc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DPhiDrl", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"vecLen", "[", "G", "]"}], 
      RowBox[{"B", ".", "B"}]], "B"}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408582881233783*^9, 3.4085828856608562`*^9}, {
  3.408582948194116*^9, 3.4085829506817493`*^9}, {3.408583050590252*^9, 
  3.408583051838098*^9}, {3.40858320066665*^9, 3.408583201666376*^9}, {
  3.408583273650627*^9, 
  3.408583273778283*^9}},ExpressionUUID->"1248b998-e90a-44e4-9d7d-\
584802f1c348"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhidr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408626318970158*^9, 3.408626321691942*^9}, {
  3.408653535566351*^9, 
  3.408653537581769*^9}},ExpressionUUID->"37d3e421-ee2c-4e0d-9293-\
8cff263da424"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendOneDihedralGradientForce", "[", 
    RowBox[{
    "rawMacroPrefix_", ",", "be_", ",", "dPhidr_", ",", "outputs_", ",", 
     "rawNameInfo_", ",", "rawdEdPhi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fn", ",", "gradName", ",", "zforceName", ",", "nameRules", ",", "\n", 
       "\t", 
       RowBox[{"dEdPhi", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawdEdPhi", "]"}]}], ",", "\n", "\t", 
       RowBox[{"nameInfo", "=", 
        RowBox[{"Evaluate", "[", "rawNameInfo", "]"}]}], ",", "\n", "\t", 
       RowBox[{"macroPrefix", "=", 
        RowBox[{"Evaluate", "[", "rawMacroPrefix", "]"}]}], ",", "var"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"nameRules", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", "nameInfo", "]"}]}], ";", "\n", "\t", 
      RowBox[{"var", " ", "=", " ", 
       RowBox[{"Name", "/.", "nameRules"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"gradName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<g\>\"", "<>", 
         RowBox[{"ToString", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"zforceName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<f\>\"", "<>", 
         RowBox[{"ToString", "[", "var", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"fn", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Func", "/.", "nameRules"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Offset", "/.", "nameRules"}], ")"}], "+", "1"}], "]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"dPhidr", ",", "fn"}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"Assign", "[", 
         RowBox[{"gradName", ",", 
          RowBox[{"fn", "*", "dEdPhi"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"Assign", "[", 
         RowBox[{"zforceName", ",", 
          RowBox[{"-", "gradName"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", 
        RowBox[{"ForceAccumulate", "[", 
         RowBox[{"macroPrefix", ",", "nameRules", ",", "zforceName"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"outputs", ",", "zforceName"}], "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendOneDihedralGradientForce", ",", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408583442273871*^9, 3.40858347975031*^9}, {
   3.408583509820074*^9, 3.408583633252095*^9}, {3.408583848031049*^9, 
   3.408583860112351*^9}, {3.4085840615783367`*^9, 3.408584074466069*^9}, {
   3.408585289468058*^9, 3.408585296407564*^9}, {3.408586346355459*^9, 
   3.408586397442857*^9}, {3.408586551965033*^9, 3.40858656097042*^9}, {
   3.408586661640358*^9, 3.4085866701015673`*^9}, {3.408586723624707*^9, 
   3.408586762807335*^9}, {3.408586957277357*^9, 3.408586960316139*^9}, {
   3.408587490456483*^9, 3.408587497630123*^9}, {3.4085885065212183`*^9, 
   3.408588518784276*^9}, {3.408626242208082*^9, 3.40862626034951*^9}, {
   3.4086268358875427`*^9, 3.40862683796587*^9}, {3.408628276023779*^9, 
   3.408628277246122*^9}, {3.408628754748343*^9, 3.4086287554412327`*^9}, {
   3.408629317810897*^9, 3.40862932003971*^9}, {3.408629434381608*^9, 
   3.408629465997069*^9}, {3.4086297839355583`*^9, 3.408629799055213*^9}, {
   3.4086298969824553`*^9, 3.408629947960977*^9}, {3.408629990536791*^9, 
   3.4086300132964287`*^9}, 3.4086301209959106`*^9, {3.408630182148696*^9, 
   3.408630186363256*^9}, {3.408630225944582*^9, 3.408630291379216*^9}, {
   3.408630611862846*^9, 3.408630612733583*^9}, {3.408630750709251*^9, 
   3.408630764213498*^9}, {3.408630802985215*^9, 3.408630809271747*^9}, {
   3.408632107394019*^9, 3.40863211369786*^9}, {3.4086537003532047`*^9, 
   3.408653755712685*^9}, {3.408653792483273*^9, 3.408653811300997*^9}, {
   3.4086540934716377`*^9, 3.408654094356517*^9}, {3.408654124753436*^9, 
   3.4086541807725286`*^9}, {3.40865545878123*^9, 3.408655487290687*^9}, {
   3.411067845895697*^9, 
   3.411067854808709*^9}},ExpressionUUID->"c20950c1-b387-4d71-aafc-\
9c39dd9774c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralGradientForce", "[", 
    RowBox[{
    "rawMacroPrefix_", ",", "be_", ",", "dPhidr_", ",", "outputs_", ",", 
     "rawNames_", ",", "rawdEdPhi_"}], "]"}], ":=", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"macroPrefix", "=", 
        RowBox[{"Evaluate", "[", "rawMacroPrefix", "]"}]}], ",", "\n", "\t", 
       RowBox[{"dEdPhi", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawdEdPhi", "]"}]}], ",", "\n", "\t", 
       RowBox[{"names", " ", "=", " ", 
        RowBox[{"Evaluate", "[", "rawNames", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "names", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Appending gradient force for name: \>\"", ",", " ", 
           RowBox[{
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"AppendOneDihedralGradientForce", "[", 
          RowBox[{
          "macroPrefix", ",", "be", ",", "dPhidr", ",", "outputs", ",", 
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "dEdPhi"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralGradientForce", ",", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvcOdzS869aWjjoR5IIj292mKANFi/owxIHpiIm9o
DJCuYhCMANEd0i05IDpAsyQfRNfw5ZeB6M25JRUg+kDnmloQ/fRiRj2IzpZ+
fwdE65RPvguid/htuRkLpFue378Fol1udT8C0UkxSo9BtNVZV+cCIN24JN4d
REtd0XAvBNLrlvuA6Xu+XiUg+oW9UTmI3s17ohpEz9R+DqajVvA8BdFGa1ne
guhtt1/8BdGtv2f/A9HOn79wFAFpVo5YARC9LyJGBkS/+2ulAKKVN/zXANFT
Olg1QXSLz6GltSD/pymsB9Gpj3Y8ANHzbwg8AdEAikqcuQ==
  "],ExpressionUUID->"e09ad023-a5ad-4301-8f5e-341d1cf22154"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendDihedralGradientForce", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralGradientRules", ",", "dPhidr", ",", 
    "dihedralOutputs", ",", "dihedralVarNames", ",", "DeDPhi"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408583158451829*^9, 3.408583204297793*^9}, {
   3.408583250507711*^9, 3.4085832774018927`*^9}, {3.4085860684090223`*^9, 
   3.408586084549323*^9}, {3.4085861890242767`*^9, 3.408586192646565*^9}, 
   3.408625788717267*^9, {3.408626324346002*^9, 3.4086263256575327`*^9}, {
   3.408626862127885*^9, 3.408626863302903*^9}, {3.408653540706973*^9, 
   3.408653549608212*^9}, {3.4086547771718388`*^9, 
   3.408654780018731*^9}},ExpressionUUID->"982a06ab-e132-4674-9a95-\
3d0ee3e9e8c2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.70265422604834*^9},ExpressionUUID->"d3a17099-0f24-4d69-8d10-a74421da3990"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.702654226049123*^9},ExpressionUUID->"0f6ccc6f-9ebc-409f-b498-\
c151b84cc208"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.7026542260497093`*^9},ExpressionUUID->"5112700d-d127-4e16-b38e-\
58ae751625c4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.702654226050302*^9},ExpressionUUID->"f0891890-0f4e-422a-aafc-\
933041ecc59d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.70265422605087*^9},ExpressionUUID->"7dadbef7-11d0-4e73-9bbd-fe27af431c6d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.702654226051458*^9},ExpressionUUID->"2c6ea4a2-388c-4135-9b00-\
f46fbacbec7c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.7026542260520563`*^9},ExpressionUUID->"ba63a955-384f-4cf7-acd9-\
d7000d37aec5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.702654226052658*^9},ExpressionUUID->"3af54475-43be-48fb-9e48-\
29164c51e74e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.7026542260532722`*^9},ExpressionUUID->"240c8274-8931-43a8-aa87-\
61a6bfd22e21"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.702654226053913*^9},ExpressionUUID->"497e9579-0291-4790-a550-\
64898950ff95"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.702654226054577*^9},ExpressionUUID->"1fc214a6-31f7-48df-8c1b-\
d7bda6eaa266"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557599305213*^9, 
  3.7026542260551977`*^9},ExpressionUUID->"9e52f489-6144-4e96-ad2e-\
46c06d69148a"]
}, Open  ]],

Cell["\<\
Now dPhidr contains the vector derivative of Phi wrt every component in (r)\
\>", "Subsubsection",
 CellChangeTimes->{{3.408653888574654*^9, 
  3.408653908030429*^9}},ExpressionUUID->"09c0c0f8-cd97-40d3-a1a1-\
f921d3e1174e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "dPhidr", "]"}]], "Input",
 CellChangeTimes->{{3.40865419380256*^9, 
  3.408654215591751*^9}},ExpressionUUID->"b79d8e5b-16e9-4c78-8a2f-\
438ee6aaa943"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{3.6195575994161453`*^9, 
  3.7026542261232853`*^9},ExpressionUUID->"23917c2a-7a36-4ff1-b68c-\
4aca4a966c5e"]
}, Open  ]],

Cell["Calculate the Second derivatives of d2Edr2", "Section",
 CellChangeTimes->{{3.408638468118968*^9, 
  3.408638485233533*^9}},ExpressionUUID->"e6ce6857-cc90-4239-a1df-\
e442a8d52a2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OuterVector", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", "a", ",", "b"}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.4086496700448513`*^9, 
  3.408649688184026*^9}},ExpressionUUID->"ae4993fa-865f-4f84-b943-\
fb64b4319906"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OverlayMatrix", "[", 
    RowBox[{"phiMatrix_", ",", "xo_", ",", "yo_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "xa", ",", "ya"}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", 
        RowBox[{"x", "\[LessEqual]", "3"}], ",", 
        RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"y", "=", "1"}], ",", 
           RowBox[{"y", "\[LessEqual]", "3"}], ",", 
           RowBox[{"y", "++"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"xa", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xo", "-", "1"}], ")"}], "*", "3"}], "+", "x"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"ya", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"yo", "-", "1"}], ")"}], "*", "3"}], "+", "y"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Filling matrix[\>\"", ",", "xa", ",", "\"\<,\>\"", ",", 
              "ya", ",", "\"\<] := mat[\>\"", ",", "x", ",", "\"\<,\>\"", ",",
               "y", ",", "\"\<];\>\""}], "]"}], ";", "\[IndentingNewLine]", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"phiMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"xa", ",", "ya"}], "]"}], "]"}], "=", " ", 
             RowBox[{
              RowBox[{"mat", "[", 
               RowBox[{"[", "x", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xa", "\[NotEqual]", "ya"}], ",", 
              RowBox[{
               RowBox[{"phiMatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"ya", ",", "xa"}], "]"}], "]"}], "=", " ", 
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", "x", "]"}], "]"}], "[", 
                RowBox[{"[", "y", "]"}], "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\t\t", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\t", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"OverlayMatrix", ",", "HoldFirst"}], "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.4085956931446743`*^9, 3.408595765358075*^9}, {
   3.408595994831271*^9, 3.408596075787022*^9}, {3.408596527240266*^9, 
   3.4085965346782017`*^9}, {3.408596636857461*^9, 3.4085966739671087`*^9}, {
   3.4085967280507107`*^9, 3.408596734282061*^9}, {3.408597028304843*^9, 
   3.408597028648077*^9}, {3.408600049585248*^9, 3.408600050238905*^9}, {
   3.4086001540863256`*^9, 3.40860015575526*^9}, {3.408650868168599*^9, 
   3.408650874342412*^9}, {3.409176994256433*^9, 3.409176998128837*^9}, {
   3.40917705911803*^9, 3.4091770600650053`*^9}, 3.409177469431367*^9, {
   3.409194918943551*^9, 3.409195004699732*^9}, {3.409196900262257*^9, 
   3.4091969757737427`*^9}},ExpressionUUID->"fbbf1644-2eee-4c9c-9740-\
8c12eb5090da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OverlaySymmetricMatrix", "[", 
    RowBox[{"phiMatrix_", ",", "xo_", ",", "yo_", ",", "mat_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"OverlayMatrix", "[", 
       RowBox[{"phiMatrix", ",", "xo", ",", "yo", ",", "mat"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"OverlaySymmetricMatrix", ",", "HoldFirst"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408597009173896*^9, 3.408597090552865*^9}, {
  3.408600053806898*^9, 3.408600054390049*^9}, {3.408650877237729*^9, 
  3.4086508834211607`*^9}, {3.4091969226416397`*^9, 
  3.409196923185772*^9}},ExpressionUUID->"818ef731-d807-4f6c-8612-\
26a3c53915c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"According", " ", "to", " ", "the", " ", "paper"}], ",", " ", 
    RowBox[{
    "this", " ", "is", " ", "what", " ", "the", " ", "Outer", " ", "product", 
     " ", "of", " ", "two", " ", "matrices", " ", "should", " ", "be"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixOuter", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "a", "]"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "b", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "a", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "a", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", 
               RowBox[{"b", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.408646334685039*^9, 3.408646348937072*^9}, {
  3.408646393499062*^9, 3.408646441191723*^9}, {3.4086464941951*^9, 
  3.408646501455883*^9}, {3.408646567290539*^9, 3.408646603288045*^9}, {
  3.408646734480702*^9, 
  3.408646748040139*^9}},ExpressionUUID->"97454f10-3f99-4bb2-808a-\
4931900b2926"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhi2dFGHdFGH", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "9", "}"}]}], "]"}], ",", 
     RowBox[{"{", "9", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408650916620843*^9, 3.4086509484346237`*^9}, 
   3.408651027715415*^9},ExpressionUUID->"af4f7656-b332-4a0f-8933-\
d23cb6e32181"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dPhi2dFGHdFGH", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40865095085678*^9, 3.408650959889976*^9}, 
   3.408651029835174*^9},ExpressionUUID->"80c7660e-d278-4017-9f6f-\
b049c02bf4be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557600321226*^9, 
  3.702654226383007*^9},ExpressionUUID->"c7fcbcfe-0a60-4d5f-862b-\
3b10a7c4191d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "32"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dFdF", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OuterVector", "[", 
         RowBox[{"A", ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "A"}], "]"}]}], "]"}], "+", 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "A"}], "]"}], ",", "A"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "1", ",", "dPhi2dFdF"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408649591846072*^9, 3.408649725124913*^9}, 
   3.40864990872332*^9, {3.408650410732383*^9, 3.408650413905846*^9}, {
   3.409174396822336*^9, 3.409174400831032*^9}, {3.409174874841948*^9, 
   3.409174875243573*^9}},ExpressionUUID->"8155b724-a0ae-457b-be3d-\
e25534053b96"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 1, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226454729*^9},ExpressionUUID->"a25b5c4d-64f7-46f0-a1bf-\
d9110a90ea78"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 2, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226455908*^9},ExpressionUUID->"e37674ed-1454-4074-8164-\
0210a48ff612"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 3, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226456629*^9},ExpressionUUID->"62f67f09-90c6-4704-87a4-\
c75900ee2d8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 1, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.7026542264573193`*^9},ExpressionUUID->"7254694a-3af4-4b88-83dc-\
ef71037bb7a7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 2, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226458003*^9},ExpressionUUID->"87f1796c-7088-432e-89d4-\
a9168cdf19fe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 3, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226458652*^9},ExpressionUUID->"3ee4ee80-d43c-46d4-b498-\
776937bb3f0a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 1, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226459292*^9},ExpressionUUID->"07ab12c6-d038-4532-961c-\
c9eee65f28a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 2, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226459917*^9},ExpressionUUID->"1268e973-35f8-42dc-9c5a-\
1faf45f10d7a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 3, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600409836*^9, 
  3.702654226460539*^9},ExpressionUUID->"4b74df23-2c08-48c4-850b-\
4ebe204c6852"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "1"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.40936184075718*^9, 3.409361845493381*^9}, {
  3.409362483405528*^9, 
  3.4093624844665956`*^9}},ExpressionUUID->"697f1200-5fee-42fa-a65d-\
f95674684066"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"DebugDihedral", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{3.619557600510736*^9, 
  3.702654226531352*^9},ExpressionUUID->"cea6a84f-0b32-4c4f-8b0c-\
7c45db7cb054"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "33"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dHdH", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"-", 
        RowBox[{"vecLen", "[", "G", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B", ".", "B"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"B", ".", "B"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OuterVector", "[", 
         RowBox[{"B", ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "B"}], "]"}]}], "]"}], "+", 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"G", ",", "B"}], "]"}], ",", "B"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "3", ",", "3", ",", "dPhi2dHdH"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408649892341941*^9, 3.408649947886446*^9}, {
  3.408650378644896*^9, 3.40865040833183*^9}, {3.409174866931617*^9, 
  3.409174867233015*^9}},ExpressionUUID->"e4d1d576-8adc-4ffa-b70b-\
89ed9d802766"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 7, ",", 7, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.7026542265967417`*^9},ExpressionUUID->"71fbba6a-2c49-455d-9a5d-\
e67677758bb1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 7, ",", 8, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.702654226597788*^9},ExpressionUUID->"285015de-d834-46fb-81fd-\
5413f6234820"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 7, ",", 9, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.702654226598504*^9},ExpressionUUID->"9129409b-77a3-4233-a65d-\
18b27f6fc2a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 8, ",", 7, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.7026542265991783`*^9},ExpressionUUID->"6a67a8ab-b9db-4479-acfe-\
1ef230d22285"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 8, ",", 8, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.7026542265998487`*^9},ExpressionUUID->"488fdeb4-d6f9-4d5c-8ebe-\
117244b23831"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 8, ",", 9, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.70265422660052*^9},ExpressionUUID->"1fe31e9b-2f00-44d5-82cc-6b73e9b5d47f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 9, ",", 7, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.702654226601194*^9},ExpressionUUID->"6f5039cb-cbe4-4820-954a-\
b151c9a79410"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 9, ",", 8, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.702654226601866*^9},ExpressionUUID->"87a36947-680a-4dc9-b460-\
ae5b80464ba5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 9, ",", 9, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600594049*^9, 
  3.70265422660251*^9},ExpressionUUID->"09e89caf-9d46-4550-b8ce-9f53ccb4bb16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Equation", " ", "38"}], ",", " ", 
    RowBox[{
    "this", " ", "one", " ", "has", " ", "the", " ", "weird", " ", 
     "subscripts", " ", "but", " ", 
     RowBox[{"I", "'"}], "m", " ", "just", " ", "going", " ", "to", " ", 
     "assume", " ", "its", " ", "simple"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dPhi2dFdG", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{"vecLen", "[", "G", "]"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"A", ".", "A"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"G", ".", "G"}], ")"}], 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"A", ",", "F"}], "]"}], 
           RowBox[{"(*", "F", "*)"}], ",", "A"}], 
          RowBox[{"(*", "G", "*)"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"F", ".", "G"}], ")"}], 
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", 
           RowBox[{"(*", "F", "*)"}], ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"A", ",", "G"}], "]"}]}], 
          RowBox[{"(*", "G", "*)"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OverlaySymmetricMatrix", "[", 
     RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "2", ",", "dPhi2dFdG"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.408650421678527*^9, 3.408650598200132*^9}, {
  3.409174836771996*^9, 
  3.409174837132331*^9}},ExpressionUUID->"2419fd9f-db58-42d0-85ba-\
9a7247fff49a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 4, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226676071*^9},ExpressionUUID->"870c169e-1ff6-40c8-bdba-\
99c8e4cbd719"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 5, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226677128*^9},ExpressionUUID->"4de6f437-8b03-4d0e-a091-\
dceb2902a116"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 6, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226677897*^9},ExpressionUUID->"1b7fb24d-6d6b-4d86-a4b5-\
f757510e408f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 4, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226678588*^9},ExpressionUUID->"5199ffe4-4342-4959-bb03-\
90507320424f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 5, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226679216*^9},ExpressionUUID->"6bc49b71-1b2b-4787-9189-\
46d9b3acb44a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 6, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226679832*^9},ExpressionUUID->"ab86d5a9-79fc-44b1-a30b-\
2cc9c2e95437"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 4, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226680496*^9},ExpressionUUID->"d80781ff-1230-4266-930f-\
214e58a13c1b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 5, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226681101*^9},ExpressionUUID->"a514206b-25f6-4d14-b47f-\
30be9137a5a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 6, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600699786*^9, 
  3.702654226681731*^9},ExpressionUUID->"8d5d1c17-244c-4680-8884-\
8a6b54d8b54f"]
}, Open  ]],

Cell["\<\
Equation (39), this one needs to be transposed wrt the equation described in \
the paper.\
\>", "Subsubsection",
 CellChangeTimes->{{3.409498511759589*^9, 
  3.40949854269335*^9}},ExpressionUUID->"7ef8a81a-c07c-4f1d-9829-\
b42d5a4420a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dPhi2dGdH", " ", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], 
      RowBox[{
       RowBox[{"vecLen", "[", "G", "]"}], 
       RowBox[{"(", 
        RowBox[{"B", ".", "B"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"B", ".", "B"}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", ".", "G"}], ")"}], 
        RowBox[{"OuterVector", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"B", ",", "H"}], "]"}], 
          RowBox[{"(*", "H", "*)"}], ",", "B"}], 
         RowBox[{"(*", "G", "*)"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"H", ".", "G"}], ")"}], 
        RowBox[{"OuterVector", "[", 
         RowBox[{"B", 
          RowBox[{"(*", "H", "*)"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{"B", ",", "G"}], "]"}]}], 
         RowBox[{"(*", "G", "*)"}], "]"}]}]}], ")"}]}], "]"}]}], ";", 
  RowBox[{"OverlaySymmetricMatrix", "[", 
   RowBox[{"dPhi2dFGHdFGH", ",", "2", ",", "3", ",", "dPhi2dGdH"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.40865064540567*^9, 3.408650762067699*^9}, 
   3.4091748525583963`*^9, 3.4093531703199453`*^9, 3.409353656265156*^9, 
   3.409355906322811*^9, {3.409356672901971*^9, 3.409356682609378*^9}, 
   3.409357158267292*^9, {3.409357736245742*^9, 3.409357739845209*^9}, {
   3.4094984946855507`*^9, 
   3.409498508997938*^9}},ExpressionUUID->"0a1d5a51-b369-4814-aaab-\
f6ff43fb0093"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 7, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.702654226890703*^9},ExpressionUUID->"c258df2f-f53c-4ce5-a262-\
ddf26745b7b2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 8, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.7026542268915577`*^9},ExpressionUUID->"a3b462c2-7aa0-4ed9-9903-\
8b3cc40d1696"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 9, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.7026542268922367`*^9},ExpressionUUID->"f56c8e30-52cf-4790-8ef0-\
82207153383d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 7, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.702654226892911*^9},ExpressionUUID->"d6b07bd3-5d1e-490a-b99d-\
4543057f2e13"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 8, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.7026542268935966`*^9},ExpressionUUID->"b404323c-76f9-446d-a5d3-\
e1ca087948eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 9, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.702654226894206*^9},ExpressionUUID->"cc0c9d4b-2614-419c-b474-\
7b1a032d07ea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 7, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.702654226894788*^9},ExpressionUUID->"becfda79-c21b-4f29-b9c8-\
97d961431cec"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 8, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.702654226895363*^9},ExpressionUUID->"1bff31a8-ed0a-49e6-bc49-\
ba2f72f2d116"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 9, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.61955760081072*^9, 
  3.702654226895937*^9},ExpressionUUID->"9b915d88-31ef-4cf2-a0d8-\
927087542a4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "40"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dPhi2dFdH", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.408650327222185*^9, 3.408650362439267*^9}, {
  3.409174826448645*^9, 3.409174826884821*^9}, {3.4093412251438437`*^9, 
  3.409341230236353*^9}},ExpressionUUID->"fc58003b-c069-4e3f-93e0-\
26ad1d1726ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OverlaySymmetricMatrix", "[", 
  RowBox[{"dPhi2dFGHdFGH", ",", "1", ",", "3", ",", "dPhi2dFdH"}], 
  "]"}]], "Input",ExpressionUUID->"a9bcd4dd-adbd-41c2-a342-2dabdf4bd00b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 7, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.7026542270085573`*^9},ExpressionUUID->"5d4ccded-47fc-4342-8ed6-\
6de5a049c594"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 8, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.702654227009417*^9},ExpressionUUID->"194d28a6-f293-4651-beb4-\
952b3b9ded7d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 1, ",", 9, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.702654227010103*^9},ExpressionUUID->"29c3b613-7947-4ec2-9bf2-\
54b44b642795"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 7, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.7026542270107822`*^9},ExpressionUUID->"cd3c9679-409d-4d61-bafc-\
3ae9c78d1de7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 8, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.702654227011462*^9},ExpressionUUID->"0aa4db91-cf95-4674-b652-\
b0d132536ba8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 2, ",", 9, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.70265422701215*^9},ExpressionUUID->"b9d984b4-5b89-4c7d-b37f-6a53c4d1825f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 7, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.702654227012849*^9},ExpressionUUID->"8b3d05d2-45d5-4b17-9ad1-\
50accd330de1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 8, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.7026542270135107`*^9},ExpressionUUID->"8ffdbab1-038b-46aa-b01a-\
332e7076b3ef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 3, ",", 9, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557600943771*^9, 
  3.702654227014174*^9},ExpressionUUID->"17cfa122-a7a7-4230-b38b-\
c4225e7ca8c4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Equation", " ", "44"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dPhi2dGdG", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"vecLen", "[", "G", "]"}], "3"], ")"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "A"}], "]"}], ",", "A"}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "A"}], "]"}]}], "]"}]}], ")"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"F", ".", "G"}], ")"}], 
        RowBox[{
         RowBox[{"vecLen", "[", "G", "]"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"A", ".", "A"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"F", ",", "A"}], "]"}]}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"F", ",", "A"}], "]"}], ",", "A"}], "]"}]}], ")"}]}], 
      ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"2", 
         RowBox[{"(", 
          SuperscriptBox[
           RowBox[{"vecLen", "[", "G", "]"}], "3"], ")"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "B"}], "]"}], ",", "B"}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"G", ",", "B"}], "]"}]}], "]"}]}], ")"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"H", ".", "G"}], ")"}]}], 
        RowBox[{
         RowBox[{"vecLen", "[", "G", "]"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"B", ".", "B"}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"OuterVector", "[", 
          RowBox[{"B", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"H", ",", "B"}], "]"}]}], "]"}], "+", 
         RowBox[{"OuterVector", "[", 
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"H", ",", "B"}], "]"}], ",", "B"}], "]"}]}], ")"}]}], 
      ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.4086499523593807`*^9, 3.408650321250239*^9}, {
  3.408650365353183*^9, 3.408650375568879*^9}, {3.4091748106831207`*^9, 
  3.4091748168818808`*^9}, {3.409175136588516*^9, 3.4091752082194633`*^9}, {
  3.409175244309362*^9, 3.409175247198543*^9}, {3.409175357119368*^9, 
  3.40917538223105*^9}, {3.40917613547653*^9, 3.4091761385193377`*^9}, {
  3.409177065118088*^9, 3.4091770663792353`*^9}, {3.409177454434731*^9, 
  3.409177458268008*^9}, {3.409341216600507*^9, 
  3.40934122099883*^9}},ExpressionUUID->"311ac420-578d-4b74-91b8-\
b211053c896e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OverlaySymmetricMatrix", "[", 
   RowBox[{"dPhi2dFGHdFGH", ",", "2", ",", "2", ",", "dPhi2dGdG"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"a256f25f-84e0-47ed-a790-c7b12f18325e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 4, "] := mat[", 1, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227141191*^9},ExpressionUUID->"ffc4da7e-0273-4f3d-8259-\
6103937166f5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 5, "] := mat[", 1, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227142106*^9},ExpressionUUID->"577801fd-b7ac-4b62-9e87-\
1811d3300e5d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 4, ",", 6, "] := mat[", 1, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.7026542271428223`*^9},ExpressionUUID->"08f81ff9-acf5-4d33-9242-\
5f755b0ca2cb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 4, "] := mat[", 2, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.7026542271435328`*^9},ExpressionUUID->"0761f223-972d-434b-83c0-\
9daea34528eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 5, "] := mat[", 2, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227144236*^9},ExpressionUUID->"668a48d8-3236-45b5-bb82-\
bb93ff8c87f1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 5, ",", 6, "] := mat[", 2, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227144926*^9},ExpressionUUID->"3027af83-529d-4774-a4ef-\
df50a73722e3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 4, "] := mat[", 3, ",", 1, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227145611*^9},ExpressionUUID->"df69e36c-97f5-48c9-a246-\
776ada8b2e1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 5, "] := mat[", 3, ",", 2, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227146288*^9},ExpressionUUID->"0e5bf1ed-5cb9-4d2e-9e88-\
e9eb1990d821"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Filling matrix[\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\"] := mat[\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"];\"\>"}],
  SequenceForm["Filling matrix[", 6, ",", 6, "] := mat[", 3, ",", 3, "];"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576010872307`*^9, 
  3.702654227146948*^9},ExpressionUUID->"59771135-50e3-4cea-b3ae-\
34cd3e0c619e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dPhi2dFGHdFGH", "]"}]], "Input",
 CellChangeTimes->{{3.408651792060197*^9, 
  3.4086517978656282`*^9}},ExpressionUUID->"77802582-5735-4d6f-9e69-\
436c6f8e4697"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9"}], "}"}]], "Output",
 CellChangeTimes->{3.6195576011769657`*^9, 
  3.7026542271982307`*^9},ExpressionUUID->"6308e0fa-7c54-4283-9056-\
d79a9c699281"]
}, Open  ]],

Cell["\<\
At this point (dPhi2dFGHdFGH) should represent the first term in equation 29 \
\>", "Subsubsection",
 CellChangeTimes->{{3.408651738274075*^9, 
  3.408651769106864*^9}},ExpressionUUID->"4cd4bd7b-1050-48fc-bb39-\
da6b322c36ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dFGHdr", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"F", ",", "G", ",", "H"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl"}], "}"}], "]"}], 
       "}"}]}], "]"}]}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.408591384187497*^9, 3.4085914854368362`*^9}, {
   3.408591781261639*^9, 3.408591823963297*^9}, 3.408597322574074*^9, {
   3.4086384990450077`*^9, 3.4086385101740522`*^9}, {3.409362248899851*^9, 
   3.409362263073306*^9}, 
   3.409362549838602*^9},ExpressionUUID->"c87ee2ff-3b45-40eb-80bf-\
7517f1956a50"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557601287183*^9, 
  3.7026542272829247`*^9},ExpressionUUID->"2329c981-d063-427f-a952-\
59dde1b3bb1f"]
}, Open  ]],

Cell["Let' s try a scalar product between dPhi2dFGHdFGH and dFGHdr", \
"Subsubsection",
 CellChangeTimes->{{3.408651818318852*^9, 
  3.408651834507773*^9}},ExpressionUUID->"84ff1a83-79bc-4815-bcc9-\
bd989d07957a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralProd1", " ", "=", " ", 
   RowBox[{"dPhi2dFGHdFGH", ".", "dFGHdr"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408651845045583*^9, 3.4086518659143333`*^9}, {
  3.409339111432386*^9, 
  3.409339112905542*^9}},ExpressionUUID->"d54bbfcc-bb19-4018-8b6b-\
f8907422029d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "dihedralProd1", "]"}]], "Input",
 CellChangeTimes->{{3.408651870376741*^9, 3.408651872801318*^9}, {
  3.409339115543014*^9, 
  3.409339117067672*^9}},ExpressionUUID->"25080c3e-fc56-45e0-b4b0-\
cca4bf869951"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557601408881*^9, 
  3.702654227422731*^9},ExpressionUUID->"296a4521-1741-4da2-9376-\
95f3ebed2783"]
}, Open  ]],

Cell["Now try a matrix outer product between (prod1) and dFGHdr.", \
"Subsubsection",
 CellChangeTimes->{{3.408651883486541*^9, 
  3.408651897034092*^9}},ExpressionUUID->"c617accd-a743-4794-b1bc-\
f304fb024346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Phidr2", " ", "=", " ", 
   RowBox[{"MatrixOuter", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "dihedralProd1", "]"}], ",", 
     RowBox[{"Transpose", "[", "dFGHdr", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408651904044354*^9, 3.408651936666416*^9}, {
  3.408652075768901*^9, 3.408652083457493*^9}, {3.409339121243396*^9, 
  3.409339123792976*^9}},ExpressionUUID->"a173a9b2-e17c-4c46-b2a7-\
8701e2a61f81"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2Phidr2", "]"}]], "Input",
 CellChangeTimes->{{3.408652112695722*^9, 3.408652116232728*^9}, {
  3.4091963372082033`*^9, 
  3.409196338965362*^9}},ExpressionUUID->"c8f1936f-f3ba-4a5a-84b2-\
85adc3176359"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557601492033*^9, 
  3.702654227509246*^9},ExpressionUUID->"16e64c04-6045-439a-9b35-\
8926c1db2923"]
}, Open  ]],

Cell["d2Phidr2 Should contain the product of equation 29", "Subsubsection",
 CellChangeTimes->{{3.4086520902119923`*^9, 
  3.4086521017608767`*^9}},ExpressionUUID->"76961292-be05-4504-abd4-\
0bbee05f532d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", "dFGHdr", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.408648903929661*^9, 
  3.4086489127940187`*^9}},ExpressionUUID->"c096a14b-20ca-4bf9-9e4f-\
f2572a8defad"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557601576988*^9, 
  3.702654227582397*^9},ExpressionUUID->"4254b3f3-541d-4a9d-b175-\
a0e6a45a51bc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"dETorsiondPhi", " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "EraseLinearDihedral"}], "*", "dihedralScale", "*", "V", 
     "*", "DN", "*", "sinNPhiPhase"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, {3.408653407072007*^9, 
   3.408653409365189*^9}},ExpressionUUID->"a0f5de58-4205-4238-a1e2-\
0d4db4f8bc50"],

Cell["\<\
Assemble equation 28, the final equation for the second derivative, it should \
be a 12x12 matrix\
\>", "Section",
 CellChangeTimes->{{3.408654462449683*^9, 
  3.408654491289156*^9}},ExpressionUUID->"c58c016a-b440-4836-a571-\
255ff16af27f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2EdPhi2", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "V"}], "*", "DN", "*", "DN", "*", "cosNPhiPhase"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408653336194317*^9, 3.408653358981037*^9}, {
  3.408653422437386*^9, 3.408653431132839*^9}, {3.408654249922738*^9, 
  3.4086542980744057`*^9}},ExpressionUUID->"dfcb5487-80d0-4a7f-b413-\
cd6e8cd164ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d2Edr2", " ", "=", " ", 
   RowBox[{
    RowBox[{"OuterVector", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2EdPhi2", "*", "dPhidr"}], ")"}], ",", "dPhidr"}], "]"}], 
    "+", 
    RowBox[{"DeDPhi", "*", "d2Phidr2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.408653271521331*^9, 3.4086532779472837`*^9}, {
  3.4086534333111267`*^9, 3.408653436052641*^9}, {3.4086543078086443`*^9, 
  3.4086543833682623`*^9}},ExpressionUUID->"e1c5ecac-1834-40ab-826f-\
a79b1c2e853d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "d2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.408654332976136*^9, 
  3.408654336760715*^9}},ExpressionUUID->"e61b8955-ba8a-44ce-8444-\
1c01fe1e9009"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557601720749*^9, 
  3.702654227909264*^9},ExpressionUUID->"09fdd977-820c-4cd1-ab46-\
6b84ad81f7b8"]
}, Open  ]],

Cell["Assemble the names of the second derivatives ", "Subsubsection",
 CellChangeTimes->{{3.4086545923916807`*^9, 
  3.408654601424361*^9}},ExpressionUUID->"a7b8e041-80a8-45cc-a9dd-\
69a8bf0c75b5"],

Cell["\<\
dihedralVarNames = { 
   {x1, x, I1, 0, DPhiDri},
   {y1, y, I1, 1, DPhiDri},
   {z1, z, I1, 2, DPhiDri},
   {x2, x, I2, 0, DPhiDrj},
   {y2, y, I2, 1, DPhiDrj},
   {z2, z, I2, 2, DPhiDrj},
   {x3, x, I3, 0, DPhiDrk},
   {y3, y, I3, 1, DPhiDrk},
   {z3, z, I3, 2, DPhiDrk},
   {x4, x, I4, 0, DPhiDrl},
   {y4, y, I4, 1, DPhiDrl},
   {z4, z, I4, 2, DPhiDrl}
   };\
\>", "Text",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.408562995604747*^9, 3.408563013307331*^9}, {
  3.408584461197592*^9, 3.408584542081841*^9}, {3.40858684037824*^9, 
  3.408586889698691*^9}, {3.408625912333675*^9, 3.4086259293924017`*^9}, {
  3.408653564774177*^9, 
  3.408653597724698*^9}},ExpressionUUID->"ace1dd46-998a-4f42-96ae-\
3cb13cd1784d"],

Cell["Setup the Diagonal Hessian rules", "Subsubsection",
 CellChangeTimes->{{3.408655141263528*^9, 
  3.4086551474565687`*^9}},ExpressionUUID->"79385e94-e374-4bf9-983d-\
6de23ed3a597"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralOneHessianElement", "[", 
    RowBox[{
    "macroPrefix_", ",", " ", "be_", ",", " ", "outputs_", ",", 
     "hessianStructure_", ",", " ", "rawHessianFn_", ",", " ", "names_", ",", 
     " ", "i_", ",", " ", "j_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "   \t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "name1Info", ",", " ", "name2Info", ",", " ", "var1Name", ",", " ", 
       "var2Name", ",", "hessianName", ",", "prefix", ",", " ", "hess"}], 
      "}"}], ",", "\n", "   \t", 
     RowBox[{
      RowBox[{"name1Info", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", 
        RowBox[{"names", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"name2Info", " ", "=", " ", 
       RowBox[{"ExtractNames", "[", 
        RowBox[{"names", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"var1Name", " ", "=", " ", 
       RowBox[{"Name", " ", "/.", " ", "name1Info"}]}], ";", "\n", "   \t", 
      RowBox[{"var2Name", " ", "=", " ", 
       RowBox[{"Name", " ", "/.", " ", "name2Info"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "j"}], ",", 
        RowBox[{"prefix", "=", "\"\<d\>\""}], ",", 
        RowBox[{"prefix", "=", "\"\<o\>\""}]}], "]"}], ";", "\n", "   \t", 
      RowBox[{"hessianName", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{"prefix", "<>", "\"\<h\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", "var1Name", "]"}], " ", "<>", " ", 
         RowBox[{"ToString", "[", "var2Name", "]"}]}], "]"}]}], ";", "\n", 
      "   \t", 
      RowBox[{"hess", " ", "=", " ", 
       RowBox[{
        RowBox[{"Evaluate", "[", "rawHessianFn", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", "\n", "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", " ", 
        RowBox[{"Assign", "[", 
         RowBox[{"hessianName", ",", " ", "hess"}], "]"}]}], "]"}], ";", "\n",
       "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"outputs", ",", " ", "hessianName"}], "]"}], ";", "\n", 
      "   \t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"be", ",", " ", 
        RowBox[{"HessianAccumulate", "[", 
         RowBox[{
         "macroPrefix", ",", " ", "name1Info", ",", " ", "name2Info", ",", 
          " ", "hessianName"}], "]"}]}], "]"}], ";", "\n", "   \t", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Appended hessian element (\>\"", ",", " ", "j", ",", " ", 
        "\"\<,\>\"", ",", " ", "i", ",", " ", "\"\<) for variable: \>\"", ",",
         " ", 
        RowBox[{"ToString", "[", "hessianName", "]"}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{
       RowBox[{"hessianStructure", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"Length", "[", "outputs", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"i", "\[NotEqual]", "j"}], ",", 
        RowBox[{
         RowBox[{"hessianStructure", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{"Length", "[", "outputs", "]"}]}]}], "]"}], ";"}]}], "\n", 
    "   ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralOneHessianElement", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.408555575499645*^9, 3.40855562644662*^9}, {
   3.408555698427017*^9, 3.408555752841689*^9}, {3.408555797330433*^9, 
   3.408555805608109*^9}, {3.408556278739255*^9, 3.408556301269991*^9}, {
   3.408558697525703*^9, 3.40855870069838*^9}, {3.4085587655149603`*^9, 
   3.4085587898354597`*^9}, {3.4085609041654263`*^9, 3.408560904844736*^9}, {
   3.4085871740652237`*^9, 3.4085871810977*^9}, {3.408628090342455*^9, 
   3.408628092947421*^9}, {3.4086556756133423`*^9, 3.408655676658729*^9}, {
   3.408655768942697*^9, 3.4086557728143272`*^9}, {3.408655861830427*^9, 
   3.408655884543045*^9}, {3.408655930214017*^9, 3.4086559314530478`*^9}, {
   3.408655992493332*^9, 3.408655993195394*^9}, {3.408656367228681*^9, 
   3.408656385090145*^9}, {3.408656466170966*^9, 3.408656471028996*^9}, {
   3.408659060173934*^9, 3.408659060978992*^9}, {3.408850691207035*^9, 
   3.4088507133591547`*^9}, 3.4088510120827217`*^9, {3.409333477579693*^9, 
   3.409333520693698*^9}, {3.4093344318910427`*^9, 3.409334433652416*^9}, 
   3.4093344648892193`*^9},ExpressionUUID->"2c720dce-a8ae-47ab-8c31-\
8d7b2d33de18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralDiagonalHessian", "[", 
    RowBox[{
    "macroPrefix_", ",", "be_", ",", "outputs_", ",", "hessianStructure_", 
     ",", "rawHessianFn_", ",", "names_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "d2Edr2", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"AppendDihedralOneHessianElement", "[", 
          RowBox[{
           RowBox[{"macroPrefix", "<>", "\"\<_DIAGONAL\>\""}], ",", "be", ",",
            "outputs", ",", "hessianStructure", ",", "rawHessianFn", ",", 
           "names", ",", "i", ",", "i"}], "]"}], ";"}]}], "\n", "\t", "]"}], 
      ";"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralDiagonalHessian", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.409077919351634*^9, 3.409078031226864*^9}, {
  3.40907835011043*^9, 3.4090783521091347`*^9}, {3.4090783931519957`*^9, 
  3.4090784236570272`*^9}, {3.409333525349918*^9, 3.409333536474777*^9}, {
  3.4112619162551126`*^9, 
  3.4112619215407352`*^9}},ExpressionUUID->"8d7b5ad7-c356-4422-8d36-\
2926e3135c02"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "d2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.408656419732316*^9, 
  3.408656437275282*^9}},ExpressionUUID->"67bd358d-da44-40c7-a97a-\
0ae034977f1e"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{3.619557601840439*^9, 
  3.702654228021493*^9},ExpressionUUID->"bc2bb6a7-8f33-4be2-ba39-\
4b3c075b7c3f"]
}, Open  ]],

Cell["\<\
For[i = 1, i <= Length[d2Edr2], i++,
  AppendDihedralOneHessianElement[\"DIHEDRAL\", dihedralDiagonalHessianRules, \
dihedralOutputs, d2Edr2, dihedralVarNames, i, i];
  ];\
\>", "Text",
 CellChangeTimes->{{3.408655574169129*^9, 3.408655604152143*^9}, {
   3.4086556809622593`*^9, 3.408655728602399*^9}, {3.408655784550395*^9, 
   3.40865581948155*^9}, {3.4086560642840567`*^9, 3.408656068011984*^9}, 
   3.40865618508574*^9, 
   3.408656434005369*^9},ExpressionUUID->"30f7b878-2fa4-4b9b-8d42-\
b82983000d9c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dihedralHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "12", "}"}]}], "]"}], ",", 
    RowBox[{"{", "12", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409333587617721*^9, 
  3.409333598425961*^9}},ExpressionUUID->"4ecbe97e-c997-414e-8512-\
f83cc0cbdbca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6195576019285297`*^9, 
  3.7026542280846157`*^9},ExpressionUUID->"f9aef2af-4909-407b-8ade-\
54ec8c13792e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralDiagonalHessian", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralDiagonalHessianRules", ",", 
    "dihedralOutputs", ",", "dihedralHessian", ",", "d2Edr2", ",", 
    "dihedralVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4090782650415897`*^9, 3.40907828859654*^9}, 
   3.409079462211437*^9, {3.409333577446553*^9, 
   3.409333579646331*^9}},ExpressionUUID->"bfda6e6a-3078-4804-977a-\
134934e70666"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx1x1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 1, ",", 1, ") for variable: ", "dhx1x1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228168063*^9},ExpressionUUID->"1f30d53b-6457-4aa2-8148-\
596564722626"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 2, ") for variable: ", "dhy1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.7026542281689167`*^9},ExpressionUUID->"0c4ad8f1-5b12-4a51-805e-\
e1a4bd1b4a25"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 3, ") for variable: ", "dhz1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.7026542281695967`*^9},ExpressionUUID->"5ba7f340-37e2-4567-976a-\
fb167be8bbef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx2x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 4, ") for variable: ", "dhx2x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228170277*^9},ExpressionUUID->"b640a912-c5ac-48c7-b575-\
d3516a1c8a68"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 5, ") for variable: ", "dhy2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228170957*^9},ExpressionUUID->"88fd48e5-5158-4461-8084-\
c9be5c534a1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 6, ") for variable: ", "dhz2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.7026542281716347`*^9},ExpressionUUID->"0922e7ee-c505-41ea-8279-\
0de55cc818bd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx3x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 7, ") for variable: ", "dhx3x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228172333*^9},ExpressionUUID->"48b0d338-5852-488d-bc8c-\
d992284c9ba9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 8, ") for variable: ", "dhy3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228172982*^9},ExpressionUUID->"d9875674-769e-4145-bb4a-\
ac21748f9d89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 9, ") for variable: ", "dhz3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.7026542281736298`*^9},ExpressionUUID->"b362366d-97bf-445d-96e9-\
40b5f6e4d5fb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx4x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 10, ") for variable: ", "dhx4x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228174279*^9},ExpressionUUID->"82a9f437-3490-4180-8f8b-\
fb2c99cb5f9f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 11, ") for variable: ", "dhy4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228174943*^9},ExpressionUUID->"8b323fcf-2638-4edf-a5e3-\
a28ae0b20d75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 12, ") for variable: ", "dhz4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6195576020109777`*^9, 
  3.702654228175576*^9},ExpressionUUID->"7dbed0f3-5c81-4006-b8fb-\
0d16aadc86c9"]
}, Open  ]],

Cell["Setup the Off Diagonal Hessian rules", "Subsubsection",
 CellChangeTimes->{{3.408655161905715*^9, 
  3.408655167760612*^9}},ExpressionUUID->"27a8054e-cdbe-4ff5-98a1-\
d930da91445a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
    RowBox[{
    "macroPrefix_", ",", "be_", ",", "outputs_", ",", "hessianStructure_", 
     ",", "rawHessianFn_", ",", "names_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{
          RowBox[{"Length", "[", "d2Edr2", "]"}], "-", "1"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "d2Edr2", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"AppendDihedralOneHessianElement", "[", 
             RowBox[{
              RowBox[{"macroPrefix", "<>", "\"\<_OFF_DIAGONAL\>\""}], ",", 
              "be", ",", "outputs", ",", "hessianStructure", ",", 
              "rawHessianFn", ",", "names", ",", "i", ",", "j"}], "]"}], 
            ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], ";"}]}],
     "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AppendDihedralOffDiagonalHessian", ",", " ", "HoldAll"}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.409077919351634*^9, 3.409078031226864*^9}, {
   3.40907835011043*^9, 3.4090783521091347`*^9}, {3.4090783931519957`*^9, 
   3.409078469080504*^9}, {3.409078504804676*^9, 3.409078513741704*^9}, {
   3.409079101000098*^9, 3.409079110511812*^9}, 3.409079159511916*^9, {
   3.409333542224677*^9, 3.40933355317448*^9}, {3.411261926206048*^9, 
   3.411261930485607*^9}},ExpressionUUID->"07797665-0d89-4c61-9c8c-\
d75c71ae3df6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.408655226662992*^9, 3.4086552378642597`*^9}, 
   3.409079466777631*^9},ExpressionUUID->"f346a6f9-76ba-45b3-a7c7-\
b0dc460203a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralOffDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
   RowBox[{
   "\"\<DIHEDRAL\>\"", ",", "dihedralOffDiagonalHessianRules", ",", 
    "dihedralOutputs", ",", "dihedralHessian", ",", "d2Edr2", ",", 
    "dihedralVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.409079093793353*^9, 3.409079142461454*^9}, 
   3.409079468724416*^9, {3.409333563372666*^9, 
   3.40933356548463*^9}},ExpressionUUID->"68f064d4-1e6e-4980-94a2-\
5720704abaa8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 1, ") for variable: ", "ohx1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228356614*^9},ExpressionUUID->"a088095d-9cca-42a2-bb65-\
d8fe7291a627"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 1, ") for variable: ", "ohx1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283573847`*^9},ExpressionUUID->"edd32b07-2199-4531-9520-\
7e2a0595b389"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 1, ") for variable: ", "ohx1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228357997*^9},ExpressionUUID->"acc7d86e-eeda-4f3a-92ee-\
62c76436642f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 1, ") for variable: ", "ohx1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228358618*^9},ExpressionUUID->"e4a07e53-e721-49c1-b8a7-\
d5da97843e2b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 1, ") for variable: ", "ohx1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228359223*^9},ExpressionUUID->"164d454f-6acb-4a45-9546-\
59f05cc04a4b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 1, ") for variable: ", "ohx1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228359825*^9},ExpressionUUID->"1afe54df-a377-41d3-a799-\
f69abe5cd91d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 1, ") for variable: ", "ohx1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228360426*^9},ExpressionUUID->"3e13fef1-9530-4096-9205-\
ae13e8f89984"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 1, ") for variable: ", "ohx1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228361039*^9},ExpressionUUID->"939ac74e-594d-4e2f-8110-\
f8af185b5f72"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 1, ") for variable: ", "ohx1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228361648*^9},ExpressionUUID->"ffa6fde2-ffff-435f-9810-\
017c5d5361d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 1, ") for variable: ", "ohx1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228362254*^9},ExpressionUUID->"95497bed-5312-480f-af46-\
113ae09dcb5e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 1, ") for variable: ", "ohx1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228362907*^9},ExpressionUUID->"71cce138-76f3-4a50-8243-\
900ed4b5ae10"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 2, ") for variable: ", "ohy1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228363545*^9},ExpressionUUID->"29030a03-fb8e-4cc3-ad1e-\
458cd763197a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 2, ") for variable: ", "ohy1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228364163*^9},ExpressionUUID->"c1d4dc8e-8e0e-4932-a835-\
1e9d3282bb0e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 2, ") for variable: ", "ohy1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283647842`*^9},ExpressionUUID->"213ac765-f631-4a9e-8fd6-\
f8faabe12d23"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 2, ") for variable: ", "ohy1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228365406*^9},ExpressionUUID->"859014c6-b641-44b8-8fe1-\
aa721abffa0c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 2, ") for variable: ", "ohy1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228366026*^9},ExpressionUUID->"c1931f23-1357-4085-a70c-\
e8b53f72b47a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 2, ") for variable: ", "ohy1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228366645*^9},ExpressionUUID->"32694f18-8d2d-40a3-aa09-\
3090e1a8fe01"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 2, ") for variable: ", "ohy1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228367264*^9},ExpressionUUID->"751fe4e9-3633-4d6c-a32f-\
fcb46f42f177"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 2, ") for variable: ", "ohy1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228367885*^9},ExpressionUUID->"94ff1441-0827-4d32-a6e3-\
276fe3442c68"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 2, ") for variable: ", "ohy1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228368506*^9},ExpressionUUID->"a1a99f8b-f1cc-4714-870f-\
ea6ba36102a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 2, ") for variable: ", "ohy1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228369154*^9},ExpressionUUID->"5171dbd3-06e0-48c8-b7a7-\
aa1522df2fc3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 3, ") for variable: ", "ohz1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.70265422836976*^9},ExpressionUUID->"8ddce326-5823-4dc9-a81f-133b21064a5d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 3, ") for variable: ", "ohz1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228370364*^9},ExpressionUUID->"37dd8206-0917-4875-87eb-\
81e959e8ebab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 3, ") for variable: ", "ohz1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228371003*^9},ExpressionUUID->"b9151e92-72ba-46d6-8c51-\
5116c90fa5c0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 3, ") for variable: ", "ohz1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228371608*^9},ExpressionUUID->"835c0291-7f86-4d06-abbf-\
b023ddb3b5cc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 3, ") for variable: ", "ohz1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228372212*^9},ExpressionUUID->"b8cdaf83-c4c6-45a1-a493-\
aac73171b582"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 3, ") for variable: ", "ohz1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283728113`*^9},ExpressionUUID->"a40352bf-cb64-4360-9382-\
ff06264d0d81"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 3, ") for variable: ", "ohz1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228373414*^9},ExpressionUUID->"a037737d-14c6-4fbe-971e-\
09fe809e1377"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 3, ") for variable: ", "ohz1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228374031*^9},ExpressionUUID->"51663cb1-1d51-419f-83b5-\
deea2adf869d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 3, ") for variable: ", "ohz1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228374619*^9},ExpressionUUID->"58aa095e-36f9-45a0-8a73-\
e7e5ba6282e6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 4, ") for variable: ", "ohx2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228375209*^9},ExpressionUUID->"9ed15b8e-9b3b-4f48-9039-\
f7ec321a85eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 4, ") for variable: ", "ohx2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228375798*^9},ExpressionUUID->"c8457b85-3ee8-43df-a7cf-\
8d5e55752b2c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 4, ") for variable: ", "ohx2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283763847`*^9},ExpressionUUID->"c3d4e289-f4cd-4823-82d2-\
4db3e7541512"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 4, ") for variable: ", "ohx2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228376967*^9},ExpressionUUID->"e89985f4-1c9b-43f8-829a-\
f5719f23ee71"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 4, ") for variable: ", "ohx2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228377554*^9},ExpressionUUID->"a6a6b993-9fde-4dd2-b38c-\
5da680b071b2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 4, ") for variable: ", "ohx2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.70265422837814*^9},ExpressionUUID->"e1a6dc8d-d5a1-454f-a1cb-578b1bf88b24"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 4, ") for variable: ", "ohx2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283787317`*^9},ExpressionUUID->"f6910e33-8422-4805-9a62-\
165a1825e6aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 4, ") for variable: ", "ohx2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283793573`*^9},ExpressionUUID->"b7409094-622a-4ff0-a380-\
d809b638448e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 5, ") for variable: ", "ohy2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228379959*^9},ExpressionUUID->"17ce68fe-d850-49f6-b673-\
ae9343cf6d85"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 5, ") for variable: ", "ohy2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283805656`*^9},ExpressionUUID->"da39c297-8b87-4b9c-970e-\
4e5b1424c864"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 5, ") for variable: ", "ohy2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228381167*^9},ExpressionUUID->"1e778aba-21d6-4f3e-8b45-\
0334f9b3e653"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 5, ") for variable: ", "ohy2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283817472`*^9},ExpressionUUID->"dcf7b567-5487-4b90-8fd3-\
c694b711e7ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 5, ") for variable: ", "ohy2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228382324*^9},ExpressionUUID->"1299885d-48fb-4ae7-b479-\
6a6135ce72f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 5, ") for variable: ", "ohy2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283828993`*^9},ExpressionUUID->"008e598a-f034-4051-b764-\
018260cacafc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 5, ") for variable: ", "ohy2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283834753`*^9},ExpressionUUID->"2a20141e-8995-4937-afdd-\
ad5ce3926b03"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 6, ") for variable: ", "ohz2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.70265422838405*^9},ExpressionUUID->"e1769f64-ddae-4b02-95a7-d3396a66ba75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 6, ") for variable: ", "ohz2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228384622*^9},ExpressionUUID->"5379925a-e7b5-40fc-952c-\
405e8a22f9e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 6, ") for variable: ", "ohz2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283851957`*^9},ExpressionUUID->"4d0ab2b5-b83f-42f4-9084-\
e83ac07891ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 6, ") for variable: ", "ohz2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283857803`*^9},ExpressionUUID->"5b62c400-b077-4371-b90d-\
be646aa66992"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 6, ") for variable: ", "ohz2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228386354*^9},ExpressionUUID->"6e2dabc7-5f8e-4d67-b66e-\
88e0c00bde6a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 6, ") for variable: ", "ohz2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228386932*^9},ExpressionUUID->"8632fe7d-4fae-4284-88fa-\
9bd0b59b4de4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 7, ") for variable: ", "ohx3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228387546*^9},ExpressionUUID->"58abe94c-1bd6-47e2-8634-\
56706a77b094"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 7, ") for variable: ", "ohx3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228388693*^9},ExpressionUUID->"b96a4ff9-f81a-4e3e-b085-\
b40a3304cfb5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 7, ") for variable: ", "ohx3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228389752*^9},ExpressionUUID->"c0fc7298-2b94-4359-8fcc-\
3d8f67d711d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 7, ") for variable: ", "ohx3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228390801*^9},ExpressionUUID->"af6c2998-2237-41d9-8292-\
47aa9fda04bd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 7, ") for variable: ", "ohx3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228391618*^9},ExpressionUUID->"b8fa86f6-4907-4370-9ffc-\
32c3f33e71cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 8, ") for variable: ", "ohy3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228392426*^9},ExpressionUUID->"60f0edc7-3323-47b5-849e-\
f3f1634b5b01"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 8, ") for variable: ", "ohy3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283932343`*^9},ExpressionUUID->"f0b47445-a2d9-4f3a-83bb-\
dbef0fd1f738"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 8, ") for variable: ", "ohy3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228394042*^9},ExpressionUUID->"79ad2c81-fe56-4f9a-81b5-\
90f23fc8ae50"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 8, ") for variable: ", "ohy3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283947678`*^9},ExpressionUUID->"1040c662-c606-4826-b7fc-\
69247b3ecef7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 9, ") for variable: ", "ohz3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228395442*^9},ExpressionUUID->"8556e21d-7b71-41dd-840e-\
2a05091ff71f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 9, ") for variable: ", "ohz3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.70265422839611*^9},ExpressionUUID->"36261411-9090-4ad4-b764-d362e20b9720"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 9, ") for variable: ", "ohz3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228396782*^9},ExpressionUUID->"957ee08b-c198-4aea-9c86-\
44d5353ee14b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 10, ") for variable: ", "ohx4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228397449*^9},ExpressionUUID->"03a6017d-4ffe-4ad9-a590-\
ff95517c6032"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 10, ") for variable: ", "ohx4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.7026542283981247`*^9},ExpressionUUID->"a5be12ce-f6ea-4414-b01a-\
d8d162c62317"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 11, ") for variable: ", "ohy4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557602193057*^9, 
  3.702654228398736*^9},ExpressionUUID->"6c541bcb-82b4-4a69-b6b7-\
422e5e7c540b"]
}, Open  ]],

Cell["\<\
For[i = 1, i <= Length[d2Edr2] - 1, i++,
  For[j = i + 1, j <= Length[d2Edr2], j++,
    AppendDihedralOneHessianElement[\"DIHEDRAL\", \
dihedralOffDiagonalHessianRules, dihedralOutputs, d2Edr2, dihedralVarNames, \
i, j];
    ];
  ];\
\>", "Text",
 CellChangeTimes->{{3.408850582947207*^9, 3.408850616970339*^9}, {
  3.4088508906927147`*^9, 
  3.408850891296979*^9}},ExpressionUUID->"2e2bc07e-e2ad-49f6-a4b6-\
9e9eb76ff002"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dihedralAllRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralSetupRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralEnergyRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_FORCE //[\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcForce ) {\>\"", " ", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralGradientRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcDiagonalHessian) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef DIHEDRAL_CALC_OFF_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcOffDiagonalHessian) { \>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", "dihedralOffDiagonalHessianRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcOffDiagonalHessian*/\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif // DIHEDRAL_CALC_OFF_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcDiagonalHessian*/\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif // DIHEDRAL_CALC_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcForce*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<#endif // DIHEDRAL_CALC_FORCE ]\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4086549503985653`*^9, 3.4086551302470093`*^9}, {
   3.41017847632253*^9, 3.41017848542352*^9}, {3.4109617838377123`*^9, 
   3.410961860520269*^9}, 
   3.411198044265443*^9},ExpressionUUID->"cfca20f3-afbb-4b20-bd91-\
2a15bbbb4491"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"dihedralOutputs", ",", "DihedralDeviation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.411198046297284*^9, 
  3.411198058910133*^9}},ExpressionUUID->"e1d9f5be-fe48-49f3-9f92-\
76f8c880d9fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralFlattenedRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "dihedralAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4086552646330976`*^9, 
  3.40865527457828*^9}},ExpressionUUID->"b22fda30-cd35-4302-afa2-\
c83af9e27620"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"DebugDihedral", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"dihedralOutputs", ",", "Phi"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.409361157868669*^9, 3.40936116476217*^9}, {
  3.409361694727602*^9, 
  3.409361722609562*^9}},ExpressionUUID->"ae140613-cb79-4cbd-878c-\
04eb13252ece"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<Dihedral\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "\"\<NotUsed\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "dihedralHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "dihedralFlattenedRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "dihedralInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "dihedralOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028819578140697`*^9, 3.4028819673432083`*^9}, 
   3.402914765609372*^9, 3.402914809575083*^9, 3.402966487087537*^9, {
   3.405598673911619*^9, 3.4055986829522657`*^9}, {3.405636326678927*^9, 
   3.4056363391829853`*^9}, {3.4056363705989532`*^9, 3.40563641434286*^9}, {
   3.405637128541765*^9, 3.405637129513829*^9}, {3.405637696845604*^9, 
   3.405637711676909*^9}, {3.4076800511983557`*^9, 3.407680055922863*^9}, 
   3.4077635803880997`*^9, {3.4086552573076477`*^9, 3.4086552800537786`*^9}, {
   3.409333629383656*^9, 3.409333638096027*^9}, 3.409338350030931*^9, {
   3.4110665533637333`*^9, 3.411066563651474*^9}, {3.4110670008789177`*^9, 
   3.411067001966928*^9}, 3.411074014162706*^9, {3.4110757545928717`*^9, 
   3.41107575829285*^9}, {3.411076165330535*^9, 3.411076201362154*^9}, 
   3.411079386355109*^9, {3.411201512045719*^9, 
   3.411201514689584*^9}},ExpressionUUID->"e9e88c15-0168-4b53-8b95-\
08cf9433142e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlusOptimize", " ", "=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimesOptimize", " ", "=", " ", "False"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408659099769362*^9, 
  3.408659106874506*^9}},ExpressionUUID->"3405d47b-5a59-45ba-9417-\
50a514d54119"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "dihedralPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790475095104*^9, 3.408790482262748*^9}, {3.408844157019621*^9, 
   3.4088441576915627`*^9}, 3.409338346791582*^9, 
   3.4110670800538588`*^9},ExpressionUUID->"5b66b768-1150-4143-8054-\
c0104b392102"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dihedralPack", "=", 
   RowBox[{"packOptimize", "[", "dihedralPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4029667486164722`*^9, 3.40296675299512*^9}, {
   3.405593795731063*^9, 3.405593801151153*^9}, {3.405598686856411*^9, 
   3.405598689575983*^9}, {3.407559220509287*^9, 3.40755922087429*^9}, {
   3.409338347441646*^9, 3.409338348066732*^9}, 
   3.411066680434393*^9},ExpressionUUID->"0c4d1f08-177a-4f78-9b86-\
929c095bcc20"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "dihedralPack", "]"}]], "Input",
 CellChangeTimes->{{3.4029672273918953`*^9, 3.402967239081615*^9}, 
   3.409338349079673*^9},ExpressionUUID->"0ff1f008-d4fc-4f35-a176-\
b34fec49f697"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{352., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"Dihedral\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "6", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "fx4", ",", "fy4", ",", "fz4", ",", "dhx1x1", ",", "dhy1y1", 
                ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", 
                ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "dhx4x4", 
                ",", "dhy4y4", ",", 
                RowBox[{"\[LeftSkeleton]", "44", "\[RightSkeleton]"}], ",", 
                "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
                "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", 
                "ohx3y3", ",", "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", 
                "ohx3z4", ",", "ohy3z3", ",", "ohy3x4", ",", "ohy3y4", ",", 
                "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", "ohz3z4", ",", 
                "ohx4y4", ",", "ohx4z4", ",", "ohy4z4", ",", 
                "DihedralDeviation"}], "}"}]}]}], "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{58., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 400, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{65., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 400, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{48., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 400, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{85., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[400]]], "Output",
 CellChangeTimes->{3.619557708558012*^9, 
  3.702654229388871*^9},ExpressionUUID->"6b82eab0-f24e-4db3-bfb9-\
0252f1a9e736"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["An improved improper restraint with no discontinuities", "Subtitle",
 CellChangeTimes->{
  3.402881806378004*^9, {3.4029555772158318`*^9, 3.4029555790467377`*^9}, {
   3.408232598628756*^9, 3.408232608931699*^9}, {3.408394177272849*^9, 
   3.408394195246855*^9}, {3.408394233695057*^9, 
   3.408394251155362*^9}},ExpressionUUID->"6294fc58-93c7-413b-bfd3-\
f8035c6e9d8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(K);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(U);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(L);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<IMPROPER_RESTRAINT_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
  3.410177953524826*^9}, {3.410178119207843*^9, 3.410178147107234*^9}, {
  3.410178361408951*^9, 3.4101784213739767`*^9}, {3.410178549883905*^9, 
  3.410178572636623*^9}, {3.410178617530715*^9, 
  3.4101786338189297`*^9}},ExpressionUUID->"f86a40de-3ba0-4293-8b41-\
ed5344aef4c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "dihedralVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<IMPROPER_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dihedralVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"improperRestraintSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
  3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
  3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
  3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4101781215075903`*^9, 
  3.4101781485693007`*^9}, {3.4101785528826838`*^9, 3.410178573744811*^9}, {
  3.4101792846240253`*^9, 
  3.41017928624059*^9}},ExpressionUUID->"835b3b05-90de-48c6-9009-\
ce83d26b2cd4"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.7026542294945183`*^9},ExpressionUUID->"661b1b5e-6315-482a-8085-\
f276ec29df18"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.702654229495941*^9},ExpressionUUID->"cf283ef5-8e7c-4923-925e-\
182a0cad9446"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.702654229496933*^9},ExpressionUUID->"6611f494-0a6c-4150-b29d-\
97fb8786b49d"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.7026542294978952`*^9},ExpressionUUID->"2d78ccc5-1c64-4643-9e1a-\
efb606f7a659"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.702654229498848*^9},ExpressionUUID->"28996062-22cf-43dd-923a-\
de151ee34d76"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.702654229499791*^9},ExpressionUUID->"107baf80-aa18-4c2c-b10b-\
3eb5fe88b915"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.70265422950077*^9},ExpressionUUID->"dddd5aa5-3ce4-4e2b-b41e-392dbdb84dad"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.7026542295017557`*^9},ExpressionUUID->"8a6b57dc-b8fb-4510-9fab-\
64523b4e572f"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.702654229502747*^9},ExpressionUUID->"a551e50d-58ed-4b4a-a612-\
512ca0fb3a4e"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(x4,I4,0);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.702654229503736*^9},ExpressionUUID->"c805aa5a-18ac-4443-aa0b-\
b9e4fa7bf59a"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(y4,I4,1);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.7026542295047417`*^9},ExpressionUUID->"a3bcfb61-92b3-4495-9d3f-\
1d3eb7467a7f"],

Cell[BoxData["\<\"IMPROPER_RESTRAINT_SET_POSITION(z4,I4,2);\"\>"], "Print",
 CellChangeTimes->{3.619557708696621*^9, 
  3.7026542295057297`*^9},ExpressionUUID->"f1a16da3-ed63-4e7c-9518-\
0196ef50696a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"improperRestraintSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 3.4101781294677153`*^9, 
   3.410178556859849*^9},ExpressionUUID->"de8f2c6f-2735-409a-9f5d-\
4d826e94cfd7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(K);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(U);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(L);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_PARAMETER(I4);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x2,I2,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y2,I2,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z2,I2,2);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x3,I3,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y3,I3,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z3,I3,2);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(x4,I4,0);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(y4,I4,1);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"IMPROPER_RESTRAINT_SET_POSITION(z4,I4,2);\"\>", 
        "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195577088290787`*^9, 
  3.702654229570565*^9},ExpressionUUID->"666e893c-5924-49c5-b47b-\
7e09936232cc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"Phi", ",", "CosNPhi", ",", "SinNPhi"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4096020423340673`*^9, 
  3.409602048564129*^9}},ExpressionUUID->"095fcc8e-d676-42e2-9add-\
ee433dc19a10"],

Cell["Here is what it looks like", "Subsection",
 CellChangeTimes->{{3.408394253503767*^9, 
  3.408394256644514*^9}},ExpressionUUID->"36c4f395-0f02-4352-9d3d-\
4dec7b6332f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rad", "[", "h_", "]"}], " ", ":=", " ", 
  RowBox[{"h", "*", "0.0174533"}]}]], "Input",
 CellChangeTimes->{{3.408379663202251*^9, 
  3.4083796716685553`*^9}},ExpressionUUID->"9a9ae81a-f2b8-4496-acec-\
180c9d217d3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"1", "-", 
    RowBox[{"Cos", "[", 
     RowBox[{"phi", "//", "rad"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", "0", ",", "180"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408378919735092*^9, 3.408378935271121*^9}, {
  3.408380328431974*^9, 
  3.408380332205256*^9}},ExpressionUUID->"116db58d-4626-4f3e-9560-\
6802e8f20566"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 180}, {0., 1.999999999999178}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.619557709001719*^9, 
  3.702654229755558*^9},ExpressionUUID->"c49dedf9-e567-4e28-9d39-\
7bd55de8f50e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rawRestraintFn", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"phi", "-", "L"}], 
          RowBox[{"U", "-", "L"}]], "360"}], ")"}], "//", "rad"}], "]"}]}], 
    ")"}], "3"]}]], "Input",
 CellChangeTimes->{{3.408381041037016*^9, 3.408381047574959*^9}, {
   3.408381126025282*^9, 3.408381140009428*^9}, 3.4083811802826347`*^9, {
   3.408382087079472*^9, 3.408382093477792*^9}, {3.4107425907005043`*^9, 
   3.410742601107795*^9}},ExpressionUUID->"9a9ce9d8-0b9b-4f31-b895-\
4b75a5802870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"otherRestraintFn", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"phi", ">=", "L"}], ",", "phi", ",", 
             RowBox[{"phi", "+", "360"}]}], "]"}], "-", "L"}], 
          RowBox[{"U", "+", "360", "-", "L"}]], "360"}], ")"}], "//", "rad"}],
       "]"}]}], ")"}], "3"]}]], "Input",
 CellChangeTimes->{{3.4083839535091343`*^9, 3.408384002209145*^9}, 
   3.408384868148151*^9, {3.408385072766967*^9, 3.40838509727969*^9}, {
   3.41074260364859*^9, 
   3.410742611409767*^9}},ExpressionUUID->"00883389-7ed5-41bf-924c-\
be0b364281ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LGreaterThanU", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], " ", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"phi", "<", "L"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"phi", ">", "U"}], ")"}]}], ",", "\[IndentingNewLine]", "0.0",
       ",", "\[IndentingNewLine]", 
      RowBox[{"otherRestraintFn", "[", 
       RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzVHykOlHykvHGaLdbCB6w4sOfhB97voWMP3ujZQz
iH5QqQem5W86J4HoGzyxYFpQ+vkEEM33RH8KiDZi7l8CoqXlnVaA6JK2W2tB
NL/r+3Ugum1C5BEQffUu/zEQPefC2asgOieC5S6IlmCu+QGieUL9foJoocC1
+j+B9HPps2B6W1GhDZi+PtEWRKuF/3MB0bIK19xBdJdPdjmIvhGhVQGiL8X1
tIBoiznxE0D0kdfMi0D0jJs7wXRAx55dIPpDa89uEH3m1aYjIDrs8jYw/Ucl
9TaIbmmaC6bzrb48AtGl3449BtHnDK9+AtFVjtqfQXSZ0//fINr+xLJ/IPqT
6hHV30Ca9/0JML3rzA4TEP3l2BkwDQAtjuAH
  "],ExpressionUUID->"6676b413-f633-44a6-ae0b-3dba93ea9113"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LLessThanU", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"phi", "<", "L"}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{"phi", ">", "U"}], ")"}]}], ",", "0.0", ",", 
    RowBox[{"rawRestraintFn", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4083794838010674`*^9, 3.408379510179747*^9}, {
   3.40837954800559*^9, 3.4083795537915277`*^9}, {3.408379591053768*^9, 
   3.408379609151863*^9}, {3.408380072427807*^9, 3.408380084038293*^9}, {
   3.408380801830942*^9, 3.4083808020178556`*^9}, {3.408380892929167*^9, 
   3.408380903510066*^9}, {3.40838093570116*^9, 3.408380952776126*^9}, 
   3.408381110884235*^9, {3.408381147964313*^9, 3.408381160493845*^9}, {
   3.408382074281019*^9, 3.408382075515924*^9}, {3.408382148928997*^9, 
   3.4083821543894453`*^9}, {3.408386474756736*^9, 
   3.4083864752867823`*^9}},ExpressionUUID->"6fc2c491-dcac-4859-8c59-\
7015d47007fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"restraint", "[", 
   RowBox[{"phi_", ",", "L_", ",", "U_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"L", "<", "U"}], ",", 
    RowBox[{"LLessThanU", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}], ",", 
    RowBox[{"LGreaterThanU", "[", 
     RowBox[{"phi", ",", "L", ",", "U"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.408379613903246*^9, 3.408379652122449*^9}, {
   3.4083799622060347`*^9, 3.40837996705472*^9}, {3.408380347444665*^9, 
   3.408380349218028*^9}, {3.4083821789176483`*^9, 3.408382184335189*^9}, {
   3.4083822984696627`*^9, 3.408382304371964*^9}, {3.408382558553754*^9, 
   3.40838256003996*^9}, 3.408382835315847*^9, {3.4083864547284946`*^9, 
   3.408386460962118*^9}, {3.408386608420443*^9, 
   3.408386610693832*^9}},ExpressionUUID->"27aea4b1-e160-427b-827c-\
afc057e87392"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "130"}], ",", "130"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.408386509199087*^9, 3.408386533235841*^9}, {
  3.4083866445198183`*^9, 3.408386645343155*^9}, {3.4083942073600607`*^9, 
  3.4083942100202312`*^9}, {3.4090761945848093`*^9, 
  3.4090761959218693`*^9}},ExpressionUUID->"b306c8be-0667-41d7-ae6e-\
38be3c2a1d50"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
V3U=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{-180, 180}, {0., 7.999997299159923}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.619557709326335*^9, 
  3.702654230217071*^9},ExpressionUUID->"f8d3e2a3-8b75-4934-942f-\
a8f0cd4400c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", "140", ",", "100"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40838654200467*^9, 3.408386559808093*^9}, 
   3.4083866014963923`*^9, {3.4083877949092627`*^9, 3.408387811796521*^9}, {
   3.408394216546843*^9, 3.408394221870363*^9}, 
   3.409076226910532*^9},ExpressionUUID->"7a260924-3134-42b2-8ac6-\
7a700cd51442"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
ZIP4Nn7Tv+5x5uuOi1Q4LD/s4yIwpj/dct6TuEwFu71xm+ZfD+kTSqkTBtnL
PnySf4y/Tz8+POuwyS0qeMgLHv42+VTfvPSr0HAhFVx3bg9hWmF97lFUGf6A
CpmS9f1lAiX69WsTD8rWUWHo3J0Ih5oc/VCLIe7qJipc0ulM+TaVpK8XqlFI
6aCCCSs2dGA+VP9Hcbjj7HMqGMl8CGOSD+mXfOxavDBAhalu1t0wDit9L/F1
N9WGqaB9vU5Wc8sm/Y1mPhatE1TYP3zeUGl6addo0ONvrFkqCG6SmKB8f7gr
p1A4g+M3FSRUPZ3mD+jvcnlP253FsRfY/v8jJVryeSffP/ft4Uh8JfzPNvdy
BoXX/bPAu29Rhar//ETYcLOFxj/DiY9BkeifNQyUJOcP/LPwq1z7gYx/7uT7
sRCY889n9ffkiN35Z44bo9PWVf/8zVMl4fHLf+7lvP0kT3Tff07Zck/fJ+Gf
Gw+NT51L+edvWarZeVf/mSyUyzFw558FZq617Gn559MlF2xl2Jz/s5fWcVaL
zz+b7tSLl3Xc/5+pH0LUn+92+c8hIUuzLSKu/1mxMnz1oe//bKSakLXj5z+7
pV/REFj85/zAB3b3OWn/WX3HZOpvkX/WrXYiJW79Z+tadY0qr38+prbr8Tnf
f068ambnEvDPvcFMP87Qf/4+6cPVF0GDnAHP3IU3IrvED4Sl5kfRQKpky9S2
C0W7dDrOqwTF0aAi0dOO2TO3i6qfUWkVT4M30CTQ0K2kf6rglpl8Eg3SSdmX
HYpN9K/Ilr/5dokGqZE1bcJ9DP3a+HqPpnQaJOX47qqWCdIf/PNsMe0qDf6e
5f1QwJuov+T5Nv5INg0O99I4Bbiu68sPjsvp36QB2VPDf8fVYn0D659Fgvk0
sL2/IvwLuU6fUce1+8NdGnxWDErT1GjTj1Rf01NWtLye25e23br6Qj8vU54R
U0qDa8oib2pU3+u3rFb/vreCBpHC7cxN+8f1P4fujFKroYHmVJ9Ozb1Zfb6v
puJLdTQYF37/Z//NRf1NBym3uutpMFXlOGPNXEFYPmPo3mymQfCH+YXjgQKE
F/JpDWijgflEf6RuzBriQlHoPrNOGuRe3ctv7iJFFJPOT0j30EDj9cem2PPr
iJ4Ll4OnXtCgXKzrbuhqFWJ2KW/V49c0cHhpGGn/dTMh6l2WmfyWBnsslti6
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
40SbyWX0//93gupTRRHl1ZfR/wHZghvj
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6195577094822683`*^9, 
  3.702654230265823*^9},ExpressionUUID->"b7dafbbe-8e08-4e2d-a36b-\
601538e846fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"restraint", "[", 
    RowBox[{"phi", ",", "140", ",", "140"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "180"}], ",", "180"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.40838654200467*^9, 3.408386559808093*^9}, 
   3.4083866014963923`*^9, {3.4083877949092627`*^9, 3.408387811796521*^9}, {
   3.408394216546843*^9, 3.408394221870363*^9}, {3.408396473391996*^9, 
   3.4083964740904493`*^9}},ExpressionUUID->"517c0ba0-5bd6-47e0-9d06-\
c0742b3470d6"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwtm3k4ld/XxkWDEGXMeDKEytRgjGcv8zzP8xnNSZKpqJRC8TWThGQsCqlM
aZdSJElFIiEUSUJRkff8ruv961yfa6/z7LXv+177Of8cSephOwYrCwuLNRsL
y/8+g0py5tZO+mBzjiHtAc0kRDVvPBpxwge/PU11VCxNQi7z73/NRvpg+Lqu
eHzbBaQPEqsfjvhgUw2HqqTvF5DIUMnmFpoPLpWcOifYkow6+OqkIo19cG7a
k6vl3amotel16Xd9H9yxrsEftqahespPeV/wwZXvc2rL7dJQ0S0NZSdNZn1Q
vNvUQBqKNH9w8MAeH9wbp/gheD4dyZ7pcpjjZtbf+8yvZZmFxHbP9vty+mD/
it4LJflZiPcVj/vHTT5Y4/tx+dWZLLQqYU/pZvHBaQ8txE+nZqM3TQOHquYZ
2L31TQ73pxx0Zn7ynF8fA3/urF4Vb8hDkZfYOUZ6Gbho4S3yF7qMgmF3svNL
Bq7c+Wnbk4jLyC3lUIbRMwYuH/xFvncwH+3bvVgo08TAVXJkmfaeK2iEsq5x
5AoDux5mJDzLLUKFV07KceUx8MvJZl2TviLkNbCapZ7NwC57s8Rj+a+iIZs/
oSkpDHz2hJ8Pb8ZV9A4tKGifZOCmp2XP2C8Vo1fiE0U5ZAb+OLrD6r+OEpTq
SuNp82Dg+tSyGUW+UmSTNRoz68LANy25FPI9S1E317CboS0Dt367pDi7WIo6
//bxL+gy8MmH0aw5iuXo0cCzBCtpBmap8uSPfFaJTgsYL0WRGJiccUlvkHQd
ge0TRqkoA/92EaLtiryOWp891FvhY2DeUNPk5D03UPO9ppXK9cz+uKb8yq9U
ofqsqpANk3ScWqi6cKfmFiq1TXVpqaBj/5/R7AXWt9H1JKFH8qV0HM5TovH4
/G1U01awJ+sqHV87IvsmAN9GLarV/w7l0fHRGsEz2vvrUa9wZwnpIh336t92
ZSfdQSxjbD/iDtNx0dnshGWee2ij6AW374F0jE+kfzlncw9xOfA+dvej49Jn
Al3FafeQUPuOnAMUOjZ9eSX8nEADUrquozNpR8eypKVxfplG5BEakWiqRscJ
GtxyXJ7NiHrj3/ydfXTcPPFL7V1ZM/Ibj/eQUmbWU/j90I9mdNQpU/mvHB03
2YmWjZ1vQUlatW+rhOn4q/3bhcyW+6iB9avk1lUavj/oU6UmhRF/hldTXxsN
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
BOeLn+a91UxC/weZO6Fb
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.619557709614139*^9, 
  3.702654230291113*^9},ExpressionUUID->"056f3aed-2e32-4739-b015-\
8f393f009482"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Setup the improper torsion term
We reuse the code for the dihedral term,
specifically we start with:   dihedralCosPhiRules\
\>", "Subsubtitle",
 CellChangeTimes->{{3.402833465987742*^9, 3.402833468829653*^9}, 
   3.4028818063788223`*^9, {3.409076116812584*^9, 3.409076128097849*^9}, {
   3.409076239747479*^9, 3.4090762836308613`*^9}, {3.409076510926963*^9, 
   3.40907651161096*^9}},ExpressionUUID->"0492afaf-a27f-46bb-9a09-\
ebdaede94796"],

Cell[BoxData[
 RowBox[{"Clear", "[", "Phi", "]"}]], "Input",
 CellChangeTimes->{{3.409106688874969*^9, 
  3.409106695755435*^9}},ExpressionUUID->"88289d8c-6ce2-487c-b772-\
c03b2405f5f2"],

Cell["\<\
Sum and difference formulas
sin (A + B) = sin A cos B + cos A sin B
sin (A - B) = sin A cos B - cos A sin B
cos (A + B) = cos A cos B - sin A sin B
cos (A - B) = cos A cos B + sin A sin B\
\>", "Text",
 CellChangeTimes->{{3.4029651450204144`*^9, 
  3.402965152857622*^9}},ExpressionUUID->"6f34dfaa-a4e5-45d0-9d62-\
e25af533992c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.409076917093985*^9, 
  3.409076958634542*^9}},ExpressionUUID->"d3c28cf4-827b-453c-aa78-\
a90880d6ce7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "improperRestraintTestRules", " ", "=", " ", "dihedralCosPhiRules"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409076738470045*^9, 3.409076750070456*^9}, 
   3.409077327963084*^9, 
   3.409077378904018*^9},ExpressionUUID->"a946248e-5f50-4f44-91d8-\
a729969d255b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<If[CosPhi>0.1,Phi=ArcSin[SinPhi],\n\t\t\t\t\t\
Phi=ArcCos[CosPhi]*Sign[SinPhi]];\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<if(CosPhi>0.1){Phi=asin(SinPhi);}else\n\t\t\t\t\t\
{Phi=acos(CosPhi)*SIGN(SinPhi);}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.407764211219077*^9, 3.407764213360669*^9}, {
  3.409076769869112*^9, 3.409076770848304*^9}, {3.4090773287521353`*^9, 
  3.4090773292641153`*^9}, {3.4090773794499187`*^9, 
  3.409077380038114*^9}},ExpressionUUID->"cc00a176-43c6-412b-a3bb-\
3344c68cd8ff"],

Cell["At this point we have calculated Phi", "Subsubsection",
 CellChangeTimes->{{3.40839595538558*^9, 
  3.408395962392981*^9}},ExpressionUUID->"8081db88-88db-4117-840f-\
f1cb021a78d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"MathCode", "[", "\"\<RestraintActive = False;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"CCode", "[", "\"\<RestraintActive=false;\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40823294634426*^9, 3.408232981251742*^9}, {
  3.4083961835243187`*^9, 3.4083961869992*^9}, {3.408396277468707*^9, 
  3.4083962840727587`*^9}, {3.409076771717814*^9, 3.409076772167429*^9}, {
  3.409077330163266*^9, 3.40907733067619*^9}, {3.409077380424087*^9, 
  3.409077380823999*^9}},ExpressionUUID->"d58eeefc-24f9-4db4-8bc2-\
0e4555a37971"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"MathCode", "[", "\"\<UShift = 0.0; PhiShift=0.0;\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{"CCode", "[", "\"\<UShift = 0.0; PhiShift = 0.0;\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.40823294634426*^9, 3.408232981251742*^9}, {
  3.4083961835243187`*^9, 3.4083961869992*^9}, {3.408396277468707*^9, 
  3.4083963406328707`*^9}, {3.408398739549844*^9, 3.408398753555151*^9}, {
  3.409076772817781*^9, 3.4090767733045273`*^9}, {3.409077331126154*^9, 
  3.4090773315631657`*^9}, {3.409077381187399*^9, 
  3.409077381574326*^9}},ExpressionUUID->"8f9716d6-4ad4-4289-a6bf-\
471898ff94eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<\nIf[ L<U && ((L<=Phi)&&(Phi<=U)), \n\tRestraintActive = True;\n\t\
UShift = 0.0;\n\tPhiShift = 0.0;\n];\n\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", "       ", 
     "\"\<\nif( L<U && (L<Phi)&&(Phi<U) ) {\n\tRestraintActive = true;\n\t\
UShift = 0.0;\n\tPhiShift = 0.0;\n}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408395995514694*^9, 3.4083961575020313`*^9}, {
  3.40839623150076*^9, 3.408396268523843*^9}, {3.408396347318568*^9, 
  3.4083963604662027`*^9}, {3.408396401694859*^9, 3.408396426030796*^9}, {
  3.408398802148634*^9, 3.408398897067815*^9}, {3.408411948774922*^9, 
  3.408411956603603*^9}, {3.409076773968699*^9, 3.409076774680676*^9}, {
  3.409077332094965*^9, 3.409077332682001*^9}, {3.409077381988881*^9, 
  3.409077382400844*^9}},ExpressionUUID->"1fc63750-b30f-491c-b764-\
c3a834d9ebe7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "MathCode", "[", 
     "\"\<\nIf[ U<=L && ((Phi<=U)||(Phi>=L)),\n\tRestraintActive = True;\n\t\
UShift = TWOPI;\n\tIf[Phi>=L,\n\t\tPhiShift = 0.0;\n\t,\n\t\tPhiShift = \
TWOPI;\n\t];\n];\>\"", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintTestRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<\nif ( U<=L && ((Phi<=U)||(Phi>=L))) {\n\tRestraintActive = true;\n\
\tUShift = TWOPI;\n\tif ( Phi>=L ) {\n\t\tPhiShift = 0.0;\n\t} else {\n\t\t\
PhiShift = TWOPI;\n\t}\n}\>\"", "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.408398901969885*^9, 3.408399061964635*^9}, {
   3.408411976419505*^9, 3.408412039768778*^9}, {3.408412877808464*^9, 
   3.408412923023285*^9}, 3.40841341881848*^9, {3.409076775331386*^9, 
   3.4090767767311993`*^9}, {3.4090773331812973`*^9, 3.409077334246182*^9}, {
   3.409077382950878*^9, 3.409077383443275*^9}, 
   3.409593334566361*^9},ExpressionUUID->"b4a4b86f-dd27-4989-9eb9-\
73c6f4edaf8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MacroCall", "[", 
    RowBox[{"name_", ",", "value_"}], "]"}], " ", ":=", " ", 
   RowBox[{"CCode", "[", 
    RowBox[{"name", "<>", "\"\<(\>\"", "<>", 
     RowBox[{"ToString", "[", "value", "]"}], "<>", "\"\<);\>\""}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.409106221354478*^9, 
  3.4091062561196136`*^9}},ExpressionUUID->"2558cbdc-f926-492f-8450-\
cdf5703327e6"],

Cell["At this point we have the improperRestraintTestRules defined", \
"Subsection",
 CellChangeTimes->{{3.40907742331349*^9, 
  3.409077435721652*^9}},ExpressionUUID->"2db8ce0c-0fa9-470e-946d-\
b2c5a16aeef0"],

Cell["\<\
AppendTo[improperRestraintEnergyRules, MathCode[\"If[RestraintActive,\"]];
AppendTo[improperRestraintEnergyRules, CCode[\"if(RestraintActive){\"]];\
\>", "Text",
 CellChangeTimes->{{3.408233711153728*^9, 3.408233743197878*^9}, {
  3.408233776071458*^9, 3.408233858000513*^9}, {3.409076777879827*^9, 
  3.409076778342876*^9}, {3.409077337130555*^9, 3.409077337892419*^9}},
 FontColor->RGBColor[
  0.5, 0, 0.5],ExpressionUUID->"abd73772-a9c2-41b8-a7fe-c4ad8aba99b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.409077446945375*^9, 
  3.409077454126092*^9}},ExpressionUUID->"06b305c9-f063-4556-89bb-\
e2c1fa78e4fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"psi", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"Phi", "+", "PhiShift", "-", "L"}], 
    RowBox[{"U", "+", "UShift", "-", "L"}]], "TWOPI"}]}]], "Input",
 CellChangeTimes->{{3.408409533213232*^9, 
  3.408409539859514*^9}},ExpressionUUID->"b89ec56d-ef0d-4e23-9a04-\
f081ace5174a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", "TWOPI"}], 
  RowBox[{
   RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]]], "Output",
 CellChangeTimes->{3.6195577101520967`*^9, 
  3.702654230755043*^9},ExpressionUUID->"bc15d112-7043-4ec1-9689-\
9f04b9b9181c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Psi", ",", "psi"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408409505388205*^9, 3.408409552736274*^9}, 
   3.409076779354323*^9, 
   3.409077472770487*^9},ExpressionUUID->"24b01632-4f8e-4c84-84e2-\
1cd93c5d242e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fnEImproperRestraint", " ", "=", " ", 
  RowBox[{"EraseLinearDihedral", "*", "K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", "Psi", "]"}]}], ")"}], "3"]}]}]], "Input",
 CellChangeTimes->{{3.408403941701662*^9, 3.408403968202332*^9}, {
   3.408404024019986*^9, 3.408404059591957*^9}, {3.408404153548417*^9, 
   3.408404157132403*^9}, {3.408409602930616*^9, 3.408409625608087*^9}, {
   3.4084096662281218`*^9, 3.408409670138094*^9}, {3.410742630745689*^9, 
   3.410742646028102*^9}, 3.4168718448125772`*^9, {3.416872026444664*^9, 
   3.416872027499926*^9}},ExpressionUUID->"41edba45-7fc6-4a4a-aa9c-\
649c63bb203b"],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", "K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", "Psi", "]"}]}], ")"}], "3"]}]], "Output",
 CellChangeTimes->{3.6195577102436533`*^9, 
  3.702654230942*^9},ExpressionUUID->"c72af60c-94bd-4060-a3a5-2b46fd446684"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "fnEImproperRestraint"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.402966429264083*^9, 3.402966441189411*^9}, {
   3.403180571417967*^9, 3.403180572463499*^9}, {3.4084039245763893`*^9, 
   3.408403932654778*^9}, {3.4084040811681557`*^9, 3.4084040833033333`*^9}, 
   3.408410256995305*^9, 3.409076780512807*^9, 3.409077480920691*^9, {
   3.4091069564798737`*^9, 
   3.4091069570931683`*^9}},ExpressionUUID->"4a8151f5-cb64-4cb7-bf25-\
32e1180ac46c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<IMPROPER_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.40907696160604*^9, 3.409076980846697*^9}, {
   3.409077084100278*^9, 3.4090771173035173`*^9}, 3.4090774838242273`*^9, {
   3.4091069594628*^9, 
   3.4091069637195263`*^9}},ExpressionUUID->"df2714fc-1093-484f-a66d-\
c8be0175df42"],

Cell["Here we have the improperRestraintEnergyRules defined", "Subsubsection",
 CellChangeTimes->{{3.409077499843992*^9, 
  3.409077509481435*^9}},ExpressionUUID->"b00a03b7-7880-439a-beb6-\
7dd5c00b8a05"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"improperRestraintInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ri", ",", "rj", ",", "rk", ",", "rl", ",", 
     RowBox[{"{", 
      RowBox[{"K", ",", "L", ",", "U"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.405598381722083*^9, 3.4055984189648457`*^9}, {
  3.405603057636241*^9, 3.4056030583078613`*^9}, {3.405690789130921*^9, 
  3.40569079264091*^9}, {3.40823469297507*^9, 3.408234698309352*^9}, {
  3.408404130713231*^9, 3.40840413323258*^9}, {3.408409948237886*^9, 
  3.408409950760854*^9}, {3.4084106111249447`*^9, 
  3.408410612236628*^9}},ExpressionUUID->"c25f6040-1a79-49f1-9e9f-\
cffcc60e7376"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4", ",", "K", ",", "L", ",",
    "U"}], "}"}]], "Output",
 CellChangeTimes->{3.6195577105439377`*^9, 
  3.702654231077735*^9},ExpressionUUID->"2d13f7ac-52d8-4ba2-92a9-\
cc99730b5625"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fnEImproperRestraintWrtPhi", " ", "=", " ", 
  RowBox[{"fnEImproperRestraint", "/.", 
   RowBox[{"{", 
    RowBox[{"Psi", "\[Rule]", "psi"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.409080225735833*^9, 3.409080251398684*^9}, {
  3.409080307798128*^9, 
  3.409080316397607*^9}},ExpressionUUID->"724303b8-d74c-4dfe-8f3e-\
dd160b80c0d5"],

Cell[BoxData[
 RowBox[{"EraseLinearDihedral", " ", "K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
        "TWOPI"}], 
       RowBox[{
        RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], 
   "3"]}]], "Output",
 CellChangeTimes->{3.61955771061174*^9, 
  3.7026542311999474`*^9},ExpressionUUID->"92ee1ac4-bcc6-42fa-b65c-\
ed010c0393d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dEImproperRestraintDPhi", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"fnEImproperRestraintWrtPhi", ",", "Phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.403108227103291*^9, 3.403108265286162*^9}, {
   3.403108565808428*^9, 3.4031085698693438`*^9}, {3.403108713290944*^9, 
   3.40310871630483*^9}, {3.403139041764777*^9, 3.4031390753592253`*^9}, 
   3.403170927837961*^9, {3.403391993803377*^9, 3.403391998026582*^9}, {
   3.403392542462666*^9, 3.403392545072193*^9}, {3.407556818121216*^9, 
   3.407556824147591*^9}, {3.408234735726048*^9, 3.408234735792594*^9}, {
   3.408234808451262*^9, 3.408234826131146*^9}, {3.408235017977605*^9, 
   3.408235019911381*^9}, {3.408409473916202*^9, 3.408409476824745*^9}, {
   3.408409719718871*^9, 3.408409745680011*^9}, {3.409080325810863*^9, 
   3.409080339546691*^9}},ExpressionUUID->"1fe6106e-de71-49f7-a2c1-\
eaf6d4ec420f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", "EraseLinearDihedral", " ", "K", " ", "TWOPI", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
         "TWOPI"}], 
        RowBox[{
         RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], "2"],
    " ", 
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
      "TWOPI"}], 
     RowBox[{
      RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], 
  RowBox[{
   RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]]], "Output",
 CellChangeTimes->{3.619557710694934*^9, 
  3.702654231364122*^9},ExpressionUUID->"90a370a1-2294-4e95-b60d-\
66ce6b5077d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d2EImproperRestraintDPhi2", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"dEImproperRestraintDPhi", ",", "Phi"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409080408009396*^9, 
  3.409080435747931*^9}},ExpressionUUID->"2910f3f5-58f4-4e2d-972b-\
4959237de5fb"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", "EraseLinearDihedral", " ", "K", " ", 
    SuperscriptBox["TWOPI", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
          "TWOPI"}], 
         RowBox[{
          RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], 
     "2"], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
       "TWOPI"}], 
      RowBox[{
       RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "L"}], "+", "U", "+", "UShift"}], ")"}], "2"]], "+", 
  FractionBox[
   RowBox[{"6", " ", "EraseLinearDihedral", " ", "K", " ", 
    SuperscriptBox["TWOPI", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
         "TWOPI"}], 
        RowBox[{
         RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "L"}], "+", "Phi", "+", "PhiShift"}], ")"}], " ", 
        "TWOPI"}], 
       RowBox[{
        RowBox[{"-", "L"}], "+", "U", "+", "UShift"}]], "]"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "L"}], "+", "U", "+", "UShift"}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.619557710976215*^9, 
  3.702654231532489*^9},ExpressionUUID->"4ae08207-fd63-471c-8227-\
f61e32362a3c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintVarNames", "=", " ", "dihedralVarNames"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409081708446905*^9, 
  3.409081716742309*^9}},ExpressionUUID->"0b799d17-b79c-4581-9ab9-\
d4a12de264b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintGradientRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintGradientRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"DEImproperRestraintDPhi", ",", "dEImproperRestraintDPhi"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"improperDPhiDr", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendDihedralGradientForce", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", "improperRestraintGradientRules", ",", 
    "improperDPhiDr", ",", " ", "improperRestraintOutputs", ",", " ", 
    "improperRestraintVarNames", ",", " ", "DEImproperRestraintDPhi"}], " ", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.4090772445834618`*^9, 3.409077280014042*^9}, {
   3.409077582181634*^9, 3.40907762655396*^9}, {3.409077680041251*^9, 
   3.409077719152259*^9}, {3.4090817215192013`*^9, 3.409081723719063*^9}, {
   3.409083677301668*^9, 3.409083685320488*^9}, {3.4090837232265053`*^9, 
   3.4090837244353943`*^9}, 
   3.409083791581297*^9},ExpressionUUID->"594b4891-4211-450b-98d7-\
71de46981d6d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.7026542316807623`*^9},ExpressionUUID->"799f82cd-b4bb-4e7e-9364-\
b682e3e470d2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.7026542316824417`*^9},ExpressionUUID->"be48f682-c8ae-405f-8418-\
3768892caeef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z1"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z1],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.702654231683503*^9},ExpressionUUID->"377be842-5d00-4296-89d1-\
db24bf838735"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.702654231684558*^9},ExpressionUUID->"f65cad09-0324-4663-a421-\
5017f240df89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.7026542316856117`*^9},ExpressionUUID->"d41d8e51-f936-47e9-b641-\
6e8a779d14cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z2"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z2],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.7026542316866703`*^9},ExpressionUUID->"639abf69-8c46-4340-b010-\
cd1fb06c5861"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.702654231687685*^9},ExpressionUUID->"46c6b869-4bbd-444a-9900-\
1a7ac0862968"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.702654231688698*^9},ExpressionUUID->"75b7762f-0af5-421a-91db-\
20acd624e499"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z3"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z3],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.702654231689711*^9},ExpressionUUID->"a166aa2b-c059-46fc-a0b2-\
e075d8fd242d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "x4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`x4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.702654231690722*^9},ExpressionUUID->"f5fcf46c-c6ea-4fa4-b182-\
9b8ea0adb346"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "y4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`y4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.7026542316917353`*^9},ExpressionUUID->"f16ce09b-7566-4362-bf0b-\
c452022031b1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appending gradient force for name: \"\>", "\[InvisibleSpace]", 
   "z4"}],
  SequenceForm["Appending gradient force for name: ", $CellContext`z4],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711098793*^9, 
  3.7026542316927357`*^9},ExpressionUUID->"f8f3f22a-b36c-44f4-8a88-\
9110836d1cb6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintD2Edr2", " ", "=", " ", 
   RowBox[{
    RowBox[{"OuterVector", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2EImproperRestraintDPhi2", "*", "dPhidr"}], ")"}], ",", 
      "dPhidr"}], "]"}], "+", 
    RowBox[{"dEImproperRestraintDPhi", "*", "d2Phidr2"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4090795130053997`*^9, 3.4090795150340977`*^9}, {
   3.4090799996705008`*^9, 3.409080007832756*^9}, 3.409080480832074*^9, {
   3.4090805378299828`*^9, 3.409080545318184*^9}, {3.409081671245607*^9, 
   3.409081673669129*^9}, {3.409081788553329*^9, 3.4090817897038603`*^9}, {
   3.409082362674494*^9, 
   3.40908237238766*^9}},ExpressionUUID->"8e6abcd4-fb7e-4029-abb2-\
45c4666bea00"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "improperRestraintD2Edr2", "]"}]], "Input",
 CellChangeTimes->{{3.409082375385445*^9, 
  3.4090823788879213`*^9}},ExpressionUUID->"88ceb5f1-c2c5-40fc-b989-\
a3842fbdfb3a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12", ",", "12"}], "}"}]], "Output",
 CellChangeTimes->{3.619557711230071*^9, 
  3.7026542318136168`*^9},ExpressionUUID->"de92ea5b-393d-46d3-9529-\
6d142b062e07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"improperRestraintHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "12", "}"}]}], "]"}], ",", 
    RowBox[{"{", "12", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.409333657953597*^9, 
  3.409333684531035*^9}},ExpressionUUID->"3f66efb8-cc7b-4d9d-9b46-\
7dfbaa7fdbcf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.619557711294911*^9, 
  3.702654231883169*^9},ExpressionUUID->"e27caf59-6c02-4afd-a4a7-\
1087a026710d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralDiagonalHessian", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", "improperRestraintDiagonalHessianRules",
     ",", "improperRestraintOutputs", ",", "improperRestraintHessian", ",", 
    " ", "improperRestraintD2Edr2", ",", "improperRestraintVarNames"}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.4090782650415897`*^9, 3.40907828859654*^9}, 
   3.409079462211437*^9, {3.409079895499962*^9, 3.409079918497217*^9}, {
   3.4090816795823917`*^9, 3.409081680744109*^9}, {3.4090817363302593`*^9, 
   3.409081738967415*^9}, 3.4090818037299232`*^9, {3.409333674982085*^9, 
   3.409333680318287*^9}},ExpressionUUID->"a9e7fd83-df64-4891-944a-\
1c00bdef6d8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx1x1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 1, ",", 1, ") for variable: ", "dhx1x1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.702654232453677*^9},ExpressionUUID->"324db2a0-5348-43e3-bc26-\
0f1d02a5b681"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 2, ") for variable: ", "dhy1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.7026542324552107`*^9},ExpressionUUID->"3686059a-e398-44cc-970a-\
90fecb655e6e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 3, ") for variable: ", "dhz1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.702654232456298*^9},ExpressionUUID->"8e54482b-3b0e-4fe3-9cec-\
0d7062e3e07c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx2x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 4, ") for variable: ", "dhx2x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.702654232457344*^9},ExpressionUUID->"0831f303-c83b-4f8d-b76a-\
82b44ff27523"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 5, ") for variable: ", "dhy2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.702654232458356*^9},ExpressionUUID->"a48b3d45-3deb-4c0d-a067-\
3105ba19a136"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 6, ") for variable: ", "dhz2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.702654232459361*^9},ExpressionUUID->"30107b58-7abf-4137-be89-\
8e8b18823c4e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx3x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 7, ") for variable: ", "dhx3x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.702654232460372*^9},ExpressionUUID->"0bc21bfa-d4f2-4e8f-bd20-\
cba688105d03"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 8, ") for variable: ", "dhy3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.7026542324614277`*^9},ExpressionUUID->"2a4aff83-fd89-476e-b60d-\
6b28a0e3112a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 9, ") for variable: ", "dhz3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.7026542324624357`*^9},ExpressionUUID->"6128311c-0eee-48c9-b5a8-\
1dd582748000"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhx4x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 10, ") for variable: ", "dhx4x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.70265423246345*^9},ExpressionUUID->"d46cc3fa-fe02-45cd-bece-29ac8bcba62c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhy4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 11, ") for variable: ", "dhy4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.70265423246446*^9},ExpressionUUID->"3742cfb8-3b87-4bf1-ae81-ca62d31159c7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"dhz4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 12, ") for variable: ", "dhz4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711361277*^9, 
  3.7026542324654713`*^9},ExpressionUUID->"6a449048-5cc1-4296-b37e-\
7e4eb4d43eae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintOffDiagonalHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"AppendDihedralOffDiagonalHessian", "[", 
   RowBox[{
   "\"\<IMPROPER_RESTRAINT\>\"", ",", 
    "improperRestraintOffDiagonalHessianRules", ",", 
    "improperRestraintOutputs", ",", "improperRestraintHessian", ",", 
    "improperRestraintD2Edr2", ",", "improperRestraintVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.409079093793353*^9, 3.409079142461454*^9}, 
   3.409079468724416*^9, {3.409081684944087*^9, 3.4090816860820436`*^9}, {
   3.40908174346716*^9, 3.409081806117021*^9}, {3.409333690093843*^9, 
   3.40933369333027*^9}},ExpressionUUID->"baa34df7-eac0-4a3c-bf0a-\
841d6356b87d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 2, ",", 1, ") for variable: ", "ohx1y1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232758369*^9},ExpressionUUID->"e838e7fb-91b3-48a0-94cb-\
adb93cbf2c3d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 1, ") for variable: ", "ohx1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232759717*^9},ExpressionUUID->"d97c9378-39e3-42ec-80ba-\
2fd32d0c579f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 1, ") for variable: ", "ohx1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.70265423276073*^9},ExpressionUUID->"3a307625-082c-4b29-844e-3011c7d2dbd9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 1, ") for variable: ", "ohx1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232761712*^9},ExpressionUUID->"b8343f5b-ec4d-426c-98c5-\
07ac47ca0050"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 1, ") for variable: ", "ohx1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327626867`*^9},ExpressionUUID->"ac39699a-d670-49c8-816c-\
3aab9397eb42"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 1, ") for variable: ", "ohx1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327636633`*^9},ExpressionUUID->"5c5d2952-c72c-459f-ad34-\
f8aff9ee8e0d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 1, ") for variable: ", "ohx1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327646437`*^9},ExpressionUUID->"e7deab54-9823-4547-8c09-\
a2a6f192f595"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 1, ") for variable: ", "ohx1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327656307`*^9},ExpressionUUID->"c0049c49-67f2-4700-ac51-\
984cdd46dc60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 1, ") for variable: ", "ohx1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327666063`*^9},ExpressionUUID->"8ac7cfc9-e6a3-4346-9370-\
2fa5e7521e89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 1, ") for variable: ", "ohx1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327675743`*^9},ExpressionUUID->"9ea8555c-6d4e-4628-8f8d-\
2a57ed5ee8b2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 1, ") for variable: ", "ohx1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232768566*^9},ExpressionUUID->"50941b71-d165-4569-89c5-\
c2c95c51ae7c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z1\"\>"}],
  SequenceForm[
  "Appended hessian element (", 3, ",", 2, ") for variable: ", "ohy1z1"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327695436`*^9},ExpressionUUID->"fbf4b6ab-806f-4cf7-96bf-\
12654c87e1ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 2, ") for variable: ", "ohy1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232770557*^9},ExpressionUUID->"3ad1c3d0-6870-410a-9251-\
a039abd0e224"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 2, ") for variable: ", "ohy1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327715673`*^9},ExpressionUUID->"ec98363b-8212-4331-97df-\
88fd3e8a8d0b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 2, ") for variable: ", "ohy1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232772545*^9},ExpressionUUID->"e1dc8865-47e5-4ce3-be65-\
7403187b2ce5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 2, ") for variable: ", "ohy1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232773491*^9},ExpressionUUID->"6eb9220a-d64f-4be4-9021-\
b2e9a30a1f1b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 2, ") for variable: ", "ohy1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.70265423277444*^9},ExpressionUUID->"db601486-9aaa-431a-b1d9-dd07da455410"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 2, ") for variable: ", "ohy1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232775388*^9},ExpressionUUID->"7d865e99-d180-49ed-accc-\
5563416e09c9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 2, ") for variable: ", "ohy1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327763367`*^9},ExpressionUUID->"73880027-d9ad-4eca-8a07-\
8e46faf2fbbd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 2, ") for variable: ", "ohy1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232777289*^9},ExpressionUUID->"0995f2ea-bad5-4d93-9872-\
f6e81f589772"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 2, ") for variable: ", "ohy1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327782383`*^9},ExpressionUUID->"13b7da7e-8ba4-4076-9872-\
555c7d85c146"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 4, ",", 3, ") for variable: ", "ohz1x2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232779192*^9},ExpressionUUID->"a459ae10-0722-438a-8a7f-\
b2a7692dc49a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 3, ") for variable: ", "ohz1y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232780148*^9},ExpressionUUID->"4959a354-98c8-48ac-b4be-\
91a662c129f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 3, ") for variable: ", "ohz1z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232781095*^9},ExpressionUUID->"1a31c5b2-7a0a-4a01-972f-\
b10e865a1520"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 3, ") for variable: ", "ohz1x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327820473`*^9},ExpressionUUID->"fba846e5-6119-48c3-a203-\
1cf3cf1126ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 3, ") for variable: ", "ohz1y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327830276`*^9},ExpressionUUID->"390ae55a-e36b-45b9-b7b4-\
62a2e874a1db"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 3, ") for variable: ", "ohz1z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327840776`*^9},ExpressionUUID->"f6eb6468-ca13-4ddc-82fd-\
041355600be6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 3, ") for variable: ", "ohz1x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232785097*^9},ExpressionUUID->"9ae7810b-07d8-4a0b-bec5-\
2c4cc1239923"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 3, ") for variable: ", "ohz1y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232786076*^9},ExpressionUUID->"9508b57d-20ef-4d2f-8662-\
383db3d8f579"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz1z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 3, ") for variable: ", "ohz1z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.70265423278721*^9},ExpressionUUID->"b029570e-9539-4bac-905d-6e4f75472238"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 5, ",", 4, ") for variable: ", "ohx2y2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327882843`*^9},ExpressionUUID->"1ce63593-778c-410c-9ac2-\
5664fcb248be"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 4, ") for variable: ", "ohx2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232789342*^9},ExpressionUUID->"9727be23-ff70-4d6b-8416-\
8b2061a4cfbb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 4, ") for variable: ", "ohx2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232790367*^9},ExpressionUUID->"68cac04f-2c72-4b55-b466-\
9324c71a7049"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 4, ") for variable: ", "ohx2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.70265423279137*^9},ExpressionUUID->"77d85206-cc9b-4588-a4cc-c90a4b763a15"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 4, ") for variable: ", "ohx2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232792386*^9},ExpressionUUID->"79ce868d-eaa6-43bf-b31b-\
be1c9439abc7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 4, ") for variable: ", "ohx2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232793322*^9},ExpressionUUID->"9e12468f-6960-460a-839a-\
6c3a8e721c4e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 4, ") for variable: ", "ohx2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232794262*^9},ExpressionUUID->"e58b4907-b7ba-4bb6-9059-\
b0c5b208ae97"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 4, ") for variable: ", "ohx2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542327952023`*^9},ExpressionUUID->"1a6e3e36-3eef-445b-ab74-\
3434780f7d53"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z2\"\>"}],
  SequenceForm[
  "Appended hessian element (", 6, ",", 5, ") for variable: ", "ohy2z2"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232796133*^9},ExpressionUUID->"329fbd3f-8eb6-46b1-b262-\
6692f4b200df"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 5, ") for variable: ", "ohy2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232797104*^9},ExpressionUUID->"994dfb99-b6b6-4109-bee0-\
7d150402ca9d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 5, ") for variable: ", "ohy2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.70265423279804*^9},ExpressionUUID->"2a60be1b-74df-47fc-b0e2-a9a15328c721"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 5, ") for variable: ", "ohy2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232799117*^9},ExpressionUUID->"3e0a5606-c499-495b-b2e5-\
827158b90f6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 5, ") for variable: ", "ohy2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542328004913`*^9},ExpressionUUID->"35c139a7-05b8-4de5-8d1d-\
a28529ee391f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 5, ") for variable: ", "ohy2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232801441*^9},ExpressionUUID->"0c44c8cb-eeac-4d84-9762-\
cd116e49677a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 5, ") for variable: ", "ohy2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232802475*^9},ExpressionUUID->"c305b4d6-889e-46bd-b510-\
c3c2e178ffae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 7, ",", 6, ") for variable: ", "ohz2x3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232803501*^9},ExpressionUUID->"8407c0f4-5870-40fe-aca2-\
825a52d0402e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 6, ") for variable: ", "ohz2y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232804542*^9},ExpressionUUID->"78c5472b-9c1c-43fe-9d31-\
192747610545"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 6, ") for variable: ", "ohz2z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232805595*^9},ExpressionUUID->"6402491b-c2b8-40cf-8f6e-\
b8b1390ab952"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 6, ") for variable: ", "ohz2x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232806518*^9},ExpressionUUID->"ec52311f-2c81-48c1-a13f-\
aa18e8a4de98"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 6, ") for variable: ", "ohz2y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542328074293`*^9},ExpressionUUID->"9e849409-6eb1-48c4-81a0-\
d098f53a8a78"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "6", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz2z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 6, ") for variable: ", "ohz2z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232808343*^9},ExpressionUUID->"50cb6b9d-8886-48a7-822f-\
b2862ae4b6e5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 8, ",", 7, ") for variable: ", "ohx3y3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232809259*^9},ExpressionUUID->"53cc7003-9693-4b1e-be42-\
011b87218c6a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 7, ") for variable: ", "ohx3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232810182*^9},ExpressionUUID->"8cc83812-a52c-4958-a0cb-\
e52ca9a68f64"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 7, ") for variable: ", "ohx3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232811105*^9},ExpressionUUID->"c854c091-d973-4d09-b471-\
fde852379dbe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 7, ") for variable: ", "ohx3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232811988*^9},ExpressionUUID->"a95807f1-c956-4a41-9af7-\
4d20b3e0b492"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 7, ") for variable: ", "ohx3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232812883*^9},ExpressionUUID->"95fb0bcd-24be-477f-b503-\
61fbfbd418f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z3\"\>"}],
  SequenceForm[
  "Appended hessian element (", 9, ",", 8, ") for variable: ", "ohy3z3"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232813772*^9},ExpressionUUID->"0b8a087f-3c82-46ca-9735-\
82651361c996"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 8, ") for variable: ", "ohy3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232814673*^9},ExpressionUUID->"9b179cc7-40c4-4b05-9be9-\
cefbee6514ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 8, ") for variable: ", "ohy3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232815566*^9},ExpressionUUID->"5672149b-3eb4-4fdf-a7a9-\
e2917bea5915"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 8, ") for variable: ", "ohy3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542328164587`*^9},ExpressionUUID->"a1dc5d8d-7ccd-4a00-9d80-\
77db2f7ae280"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3x4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 10, ",", 9, ") for variable: ", "ohz3x4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542328173447`*^9},ExpressionUUID->"3a45f228-b6cb-42e7-ae09-\
80e0bfc67e6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 9, ") for variable: ", "ohz3y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232818233*^9},ExpressionUUID->"2c74316f-653d-45e0-b8d5-\
3bff77d8721e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohz3z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 9, ") for variable: ", "ohz3z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232819126*^9},ExpressionUUID->"bcd0e1dd-2c08-4efe-a517-\
10b04f2604d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4y4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 11, ",", 10, ") for variable: ", "ohx4y4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232820024*^9},ExpressionUUID->"a45e520b-bafd-48f2-90f7-\
84cbb1882067"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohx4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 10, ") for variable: ", "ohx4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.7026542328209877`*^9},ExpressionUUID->"1b35ca80-83dc-40b0-82ea-\
6bd3d31e0b37"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Appended hessian element (\"\>", "\[InvisibleSpace]", "12", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "11", 
   "\[InvisibleSpace]", "\<\") for variable: \"\>", 
   "\[InvisibleSpace]", "\<\"ohy4z4\"\>"}],
  SequenceForm[
  "Appended hessian element (", 12, ",", 11, ") for variable: ", "ohy4z4"],
  Editable->False]], "Print",
 CellChangeTimes->{3.619557711469695*^9, 
  3.702654232821888*^9},ExpressionUUID->"848196d3-ded9-4b5b-8e6c-\
405f09c4b13c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InitializeOutputs", "[", "outputs_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "zeroOutputs", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"zeroOutputs", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<= 0.0;\\n\>\""}], 
          "&"}], ",", "outputs"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"StringJoin", "[", "zeroOutputs", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.409596985374069*^9, 3.4095970096100893`*^9}, {
  3.409597043808723*^9, 3.409597093651099*^9}, {3.409597183449415*^9, 
  3.409597247958007*^9}, {3.409598917761016*^9, 
  3.409598921233493*^9}},ExpressionUUID->"1dc963d6-f3c6-4a07-a2ed-\
fadac30c734f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"improperRestraintAllRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"improperRestraintAllRules", ",", "improperRestraintSetupRules"}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "out", " ", "setting", " ", "variables", " ", "to", " ", 
    "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"improperRestraintAllRules", ",", 
      RowBox[{"CCode", "[", 
       RowBox[{"InitializeOutputs", "[", "improperRestraintOutputs", "]"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", 
     RowBox[{"InitializeOutputs", "[", "improperRestraintOutputs", "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", "improperRestraintTestRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", "\"\<If[RestraintActive,\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (RestraintActive ) {\>\"", " ", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", "improperRestraintEnergyRules"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#ifdef IMPROPER_RESTRAINT_CALC_FORCE //[\>\"", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcForce ) {\>\"", " ", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", "improperRestraintGradientRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#ifdef IMPROPER_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcDiagonalHessian) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", 
    "improperRestraintDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#ifdef IMPROPER_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (calcOffDiagonalHessian) { \>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "improperRestraintAllRules", ",", 
    "improperRestraintOffDiagonalHessianRules"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcOffDiagonalHessian*/\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#endif //IMPROPER_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]\>\"", 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcDiagonalHessian*/\>\"", "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", 
     "\"\<#endif //IMPROPER_RESTRAINT_CALC_DIAGONAL_HESSIAN ]\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*calcForce*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<#endif //IMPROPER_RESTRAINT_CALC_FORCE ]\>\"", "]"}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*RestraintActive*/\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", 
    RowBox[{"MacroCall", "[", 
     RowBox[{"\"\<IMPROPER_RESTRAINT_PHI_SET\>\"", ",", "Phi"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintOutputs", ",", "Phi"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"improperRestraintAllRules", ",", " ", 
    RowBox[{"MathCode", "[", "\"\<]; (*RestraintActive*)\>\"", "]"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.4086549503985653`*^9, 3.4086551302470093`*^9}, {
  3.409081808957452*^9, 3.4090819840158052`*^9}, {3.409108929233745*^9, 
  3.409108935291503*^9}, {3.409515435827023*^9, 3.409515442951703*^9}, {
  3.40953443636611*^9, 3.4095344513393927`*^9}, {3.409593363342606*^9, 
  3.409593368604685*^9}, {3.409596874863688*^9, 3.409596982310606*^9}, {
  3.409598264523089*^9, 3.409598269822241*^9}, {3.409598926402801*^9, 
  3.4095990222756443`*^9}, {3.4101789103021584`*^9, 3.410178923187131*^9}, {
  3.410961601455715*^9, 3.410961738638186*^9}, {3.485015325952389*^9, 
  3.485015357288415*^9}},ExpressionUUID->"8abdfec6-cd5c-4542-ba2d-\
cb8cecc20f18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintFlattenedRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "improperRestraintAllRules", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4086552646330976`*^9, 3.40865527457828*^9}, {
  3.4090820029448643`*^9, 
  3.4090820118089657`*^9}},ExpressionUUID->"006a7203-5bc5-4d07-837c-\
6594d827b962"],

Cell[CellGroupData[{

Cell[BoxData["improperRestraintOutputs"], "Input",
 CellChangeTimes->{{3.407761664825244*^9, 3.4077616727209597`*^9}, {
   3.4084101627937202`*^9, 3.408410164951118*^9}, 
   3.4090777912493277`*^9},ExpressionUUID->"9c2bb84b-96f9-4522-951e-\
1a1c518c535b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", "fx4", ",", "fy4", ",", 
   "fz4", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", 
   "dhx4x4", ",", "dhy4y4", ",", "dhz4z4", ",", "ohx1y1", ",", "ohx1z1", ",", 
   "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohx1x3", ",", "ohx1y3", ",", 
   "ohx1z3", ",", "ohx1x4", ",", "ohx1y4", ",", "ohx1z4", ",", "ohy1z1", ",", 
   "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohy1x3", ",", "ohy1y3", ",", 
   "ohy1z3", ",", "ohy1x4", ",", "ohy1y4", ",", "ohy1z4", ",", "ohz1x2", ",", 
   "ohz1y2", ",", "ohz1z2", ",", "ohz1x3", ",", "ohz1y3", ",", "ohz1z3", ",", 
   "ohz1x4", ",", "ohz1y4", ",", "ohz1z4", ",", "ohx2y2", ",", "ohx2z2", ",", 
   "ohx2x3", ",", "ohx2y3", ",", "ohx2z3", ",", "ohx2x4", ",", "ohx2y4", ",", 
   "ohx2z4", ",", "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", ",", "ohy2z3", ",", 
   "ohy2x4", ",", "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
   "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", "ohx3y3", ",", 
   "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", "ohx3z4", ",", "ohy3z3", ",", 
   "ohy3x4", ",", "ohy3y4", ",", "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", 
   "ohz3z4", ",", "ohx4y4", ",", "ohx4z4", ",", "ohy4z4", ",", "Phi"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557712095818*^9, 
  3.7026542347973833`*^9},ExpressionUUID->"9d6d9764-9fe4-4bf8-af4e-\
2fdb8b5f5dec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<ImproperRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3",
         ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "improperRestraintHessian"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "improperRestraintFlattenedRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "improperRestraintInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "improperRestraintOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4028819578140697`*^9, 3.4028819673432083`*^9}, 
   3.402914765609372*^9, 3.402914809575083*^9, 3.402966487087537*^9, {
   3.405598673911619*^9, 3.4055986829522657`*^9}, {3.405636326678927*^9, 
   3.4056363391829853`*^9}, {3.4056363705989532`*^9, 3.40563641434286*^9}, {
   3.405637128541765*^9, 3.405637129513829*^9}, {3.405637696845604*^9, 
   3.405637711676909*^9}, {3.4076800511983557`*^9, 3.407680055922863*^9}, 
   3.4077635803880997`*^9, {3.408410168114626*^9, 3.4084101962575283`*^9}, 
   3.4090768093248034`*^9, {3.4090820295356092`*^9, 3.409082037972199*^9}, {
   3.409333700219658*^9, 3.409333707443859*^9}, {3.411066597262484*^9, 
   3.411066604438355*^9}, {3.411067020063253*^9, 3.411067022495068*^9}, 
   3.41107402025056*^9, {3.411075766096381*^9, 3.4110757699989357`*^9}, {
   3.41107622587714*^9, 3.4110762393701963`*^9}, 3.4110765760400867`*^9, 
   3.411079392129137*^9},ExpressionUUID->"f997ec67-1942-403e-a9f4-\
5d6e140b6d4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "writeOutputVariablesForDebugging", "[", "improperRestraintPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, {3.409085616705697*^9, 3.409085625514409*^9}, 
   3.411067087382237*^9},ExpressionUUID->"88b074e4-54dd-4e2b-bad9-\
ea91168a7288"],

Cell[BoxData[
 RowBox[{
  RowBox[{"improperRestraintPack", "=", 
   RowBox[{"packOptimize", "[", "improperRestraintPack0", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4029667486164722`*^9, 3.40296675299512*^9}, {
   3.405593795731063*^9, 3.405593801151153*^9}, {3.405598686856411*^9, 
   3.405598689575983*^9}, {3.407559220509287*^9, 3.40755922087429*^9}, {
   3.408410200560124*^9, 3.4084102194557743`*^9}, {3.408410654126341*^9, 
   3.408410655532649*^9}, 
   3.4110666488712482`*^9},ExpressionUUID->"46a79b8d-1e2e-4535-ba78-\
012f08930ac0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "improperRestraintPack", "]"}]], "Input",
 CellChangeTimes->{{3.4029672273918953`*^9, 3.402967239081615*^9}, {
  3.4084102236314163`*^9, 
  3.40841022587131*^9}},ExpressionUUID->"2a284c8e-4f9e-49f4-930c-\
443e7a9801d2"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{352., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"ImproperRestraint\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "5", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "fx4", ",", "fy4", ",", "fz4", ",", "dhx1x1", ",", "dhy1y1", 
                ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", 
                ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "dhx4x4", 
                ",", "dhy4y4", ",", 
                RowBox[{"\[LeftSkeleton]", "44", "\[RightSkeleton]"}], ",", 
                "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
                "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", 
                "ohx3y3", ",", "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", 
                "ohx3z4", ",", "ohy3z3", ",", "ohy3x4", ",", "ohy3y4", ",", 
                "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", "ohz3z4", ",", 
                "ohx4y4", ",", "ohx4z4", ",", "ohy4z4", ",", "Phi"}], 
               "}"}]}]}], "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{58., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 487, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{65., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 487, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{48., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 487, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{85., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[487]]], "Output",
 CellChangeTimes->{3.619557817043065*^9, 
  3.702654236182584*^9},ExpressionUUID->"a4c826aa-41ea-44c6-99ef-\
0d1967d642cf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Chiral Restraint
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.410959008646387*^9, 
   3.4109590179061737`*^9}},ExpressionUUID->"8eff8c93-b291-4cb0-9b17-\
7199246e51d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 
  3.403184184931066*^9}},ExpressionUUID->"d9b7948b-774f-4824-9b60-\
dd99d81dc301"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"va", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vc", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x3", ",", " ", "y3", ",", " ", "z3"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vd", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x4", ",", " ", "y4", ",", " ", "z4"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, {
  3.410959023856037*^9, 3.41095903888342*^9}, {3.410959358432473*^9, 
  3.410959366366046*^9}, {3.41096049070288*^9, 
  3.410960503950835*^9}},ExpressionUUID->"0f08a473-a77c-4983-a9fe-\
f066073c6889"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"ac", ",", "bc", ",", "dc"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ac", " ", "=", " ", 
   RowBox[{"va", "-", "vc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bc", " ", "=", " ", 
   RowBox[{"vb", " ", "-", " ", "vc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc", " ", "=", " ", 
   RowBox[{"vd", " ", "-", " ", "vc"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.410959054691805*^9, 3.410959104500534*^9}, 
   3.4109591733772783`*^9, {3.410960420959537*^9, 3.410960459261435*^9}, {
   3.410960505510457*^9, 
   3.4109605135183067`*^9}},ExpressionUUID->"1b5613f7-9999-40e8-9a1b-\
8dd9afcb6daf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "K", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410959126465396*^9, 
  3.410959130081745*^9}},ExpressionUUID->"82c0e2c9-adb8-4d29-a03b-\
298588339569"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chiralRestraintTestFn", " ", "=", "  ", 
  RowBox[{"K", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"ac", ",", "bc"}], "]"}], ".", "dc"}], 
       RowBox[{
        RowBox[{"vecLen", "[", "ac", "]"}], 
        RowBox[{"vecLen", "[", "bc", "]"}], 
        RowBox[{"vecLen", "[", "dc", "]"}]}]], "+", "CO"}], ")"}], 
    "3"]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.4109591109262114`*^9, 
   3.410959234749806*^9}, {3.410960461630476*^9, 3.4109604710300083`*^9}, {
   3.4111342198342657`*^9, 3.411134220288424*^9}, {3.411139922041378*^9, 
   3.411139941967361*^9}, 3.411140010178594*^9, {3.411921311733358*^9, 
   3.411921327948023*^9}},ExpressionUUID->"0598a9a2-9737-43e0-86c2-\
d657b3486f10"],

Cell[BoxData[
 RowBox[{"K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"CO", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y3"}], "+", "y4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2", " ", "z1"}], "-", 
           RowBox[{"x3", " ", "z1"}], "-", 
           RowBox[{"x1", " ", "z2"}], "+", 
           RowBox[{"x3", " ", "z2"}], "+", 
           RowBox[{"x1", " ", "z3"}], "-", 
           RowBox[{"x2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x3"}], "+", "x4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "y2"}], " ", "z1"}], "+", 
           RowBox[{"y3", " ", "z1"}], "+", 
           RowBox[{"y1", " ", "z2"}], "-", 
           RowBox[{"y3", " ", "z2"}], "-", 
           RowBox[{"y1", " ", "z3"}], "+", 
           RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "x2"}], " ", "y1"}], "+", 
           RowBox[{"x3", " ", "y1"}], "+", 
           RowBox[{"x1", " ", "y2"}], "-", 
           RowBox[{"x3", " ", "y2"}], "-", 
           RowBox[{"x1", " ", "y3"}], "+", 
           RowBox[{"x2", " ", "y3"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z3"}], "+", "z4"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x2", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y2", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z2", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x3"}], "+", "x4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y3"}], "+", "y4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z3"}], "+", "z4"}], ")"}], "2"]}]]}], ")"}]}]}], 
    ")"}], "3"]}]], "Output",
 CellChangeTimes->{3.619557817496393*^9, 
  3.702654236760476*^9},ExpressionUUID->"fdf51f13-8f25-4433-bb46-\
99b5baff4f4b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintEnergyFn", " ", "=", " ", "chiralRestraintTestFn"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.411134222633911*^9, 
  3.411134230842989*^9}},ExpressionUUID->"bc5287ed-a6e8-45ab-901e-\
e489e9525923"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"va", ",", "vb", ",", "vc", ",", "vd"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.410959244997628*^9, 3.410959246043676*^9}, {
  3.410975381434297*^9, 
  3.410975391272737*^9}},ExpressionUUID->"3a6e0aa1-a05a-4b66-a123-\
ad1af56a4132"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]], "Output",
 CellChangeTimes->{3.619557817564983*^9, 
  3.702654236872802*^9},ExpressionUUID->"1ced6d6b-6317-4bf3-9d81-\
1d985f8e52d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 
  3.401714291927002*^9}},ExpressionUUID->"2e11cee1-5a1a-4cfb-9daf-\
d12953e14247"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "x", ",", "I2", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y2", ",", "y", ",", "I2", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z2", ",", "z", ",", "I2", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x3", ",", "x", ",", "I3", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y3", ",", "y", ",", "I3", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "z", ",", "I3", ",", "2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x4", ",", "x", ",", "I4", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y4", ",", "y", ",", "I4", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "z", ",", "I4", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
  3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
  3.40854589498903*^9}, {3.4109592547618723`*^9, 
  3.4109592880721416`*^9}},ExpressionUUID->"2a0cd881-05a5-4cbf-bcf9-\
331914dde335"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(K);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(CO);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I2);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I3);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<CHIRAL_RESTRAINT_SET_PARAMETER(I4);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.41095930653111*^9, 3.410959308338553*^9}, {3.410959446914455*^9, 
  3.410959448076516*^9}, {3.4109594887222424`*^9, 3.4109595065938807`*^9}, {
  3.430307504520461*^9, 
  3.4303075090533123`*^9}},ExpressionUUID->"ef2df254-04a0-405b-80b4-\
73e467060be2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "str"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "chiralRestraintVarNames", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"str", " ", "=", " ", 
         RowBox[{"\"\<CHIRAL_RESTRAINT_SET_POSITION(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"chiralRestraintVarNames", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"chiralRestraintSetupRules", ",", 
          RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4109593095964613`*^9, 3.410959312139323*^9}, 
   3.410959448741249*^9, {3.41100557090314*^9, 
   3.411005579300394*^9}},ExpressionUUID->"8d9c1630-18cf-4acf-95fa-\
6725807f7890"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.70265423702346*^9},ExpressionUUID->"12e0f06b-ffd4-46bd-9aef-bd1ffa60c695"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237024294*^9},ExpressionUUID->"4415f723-c9d3-4f0b-bc23-\
b1611d9e58ce"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.7026542370249577`*^9},ExpressionUUID->"51d6868e-6586-412c-b194-\
2cd432ef3d8e"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x2,I2,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237025612*^9},ExpressionUUID->"4301ac88-8304-4756-8e19-\
87fe2c2df6b5"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y2,I2,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237026272*^9},ExpressionUUID->"e5291bd0-2135-4cc0-8d69-\
22bedea078d8"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z2,I2,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237026927*^9},ExpressionUUID->"89bfc307-3ddc-434d-aac6-\
89c3dc5e3675"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x3,I3,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237027589*^9},ExpressionUUID->"d6157c73-9410-4601-b99f-\
b7260e12dd57"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y3,I3,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237028215*^9},ExpressionUUID->"157381e1-66c5-41ba-8fe8-\
b7ded043bf2b"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z3,I3,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.70265423702884*^9},ExpressionUUID->"bc3476d3-6ecd-4d90-bea3-eedf5b92513e"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(x4,I4,0);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237029469*^9},ExpressionUUID->"1fe98ff6-2685-44eb-8ab1-\
a60d589c97f5"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(y4,I4,1);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237030099*^9},ExpressionUUID->"89c7dc2c-3a5c-4d70-b100-\
474cb34b1fb5"],

Cell[BoxData["\<\"CHIRAL_RESTRAINT_SET_POSITION(z4,I4,2);\"\>"], "Print",
 CellChangeTimes->{3.619557817638895*^9, 
  3.702654237030725*^9},ExpressionUUID->"d5270762-c0ed-424a-997b-\
a49d567a0527"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chiralRestraintSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410959313257309*^9, {
   3.410959597371963*^9, 
   3.410959602050107*^9}},ExpressionUUID->"8c67aaa1-28c3-4dea-b832-\
1cc4a7c7e851"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(K);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(CO);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I3);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_PARAMETER(I4);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x2,I2,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y2,I2,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z2,I2,2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x3,I3,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y3,I3,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z3,I3,2);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(x4,I4,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(y4,I4,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"CHIRAL_RESTRAINT_SET_POSITION(z4,I4,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557817729368*^9, 
  3.7026542370838137`*^9},ExpressionUUID->"274b37da-b49b-41c5-9a35-\
de194b8a0294"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chiralRestraintTestRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"chiralRestraintTestRules", ",", 
     RowBox[{"Assign", "[", 
      RowBox[{"ChiralTest", ",", "chiralRestraintTestFn"}], "]"}]}], "]"}], 
   ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"We", " ", "will", " ", "test", " ", "the", " ", "Energy"}], ",", 
    " ", 
    RowBox[{
    "if", " ", "its", " ", "greater", " ", "than", " ", "zero", " ", "then", 
     " ", "the", " ", "restraint", " ", "is", " ", "active"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chiralRestraintEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"CCode", "[", "\"\<Energy=ChiralTest;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"MathCode", "[", "\"\<Energy = ChiralTest;\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<CHIRAL_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.410959314804584*^9, 
   3.4109593175472317`*^9}, 3.410959449531116*^9, {3.410959545429446*^9, 
   3.410959610720241*^9}, {3.410959644694853*^9, 3.410959691985753*^9}, {
   3.411134257170401*^9, 3.411134294169005*^9}, {3.411135094096856*^9, 
   3.4111350954424562`*^9}, {3.411135402551195*^9, 
   3.411135431190372*^9}},ExpressionUUID->"7ca4aa3f-9612-4a74-a023-\
640a1363418a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintTestRules"], "Input",
 CellChangeTimes->{{3.411135069369252*^9, 
  3.4111350725038767`*^9}},ExpressionUUID->"4921a7bc-f8ea-4c3c-acec-\
c55baca17f9e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"K", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"CO", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y3"}], "+", "y4"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "z1"}], "-", 
             RowBox[{"x3", " ", "z1"}], "-", 
             RowBox[{"x1", " ", "z2"}], "+", 
             RowBox[{"x3", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "z3"}], "-", 
             RowBox[{"x2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x3"}], "+", "x4"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "y2"}], " ", "z1"}], "+", 
             RowBox[{"y3", " ", "z1"}], "+", 
             RowBox[{"y1", " ", "z2"}], "-", 
             RowBox[{"y3", " ", "z2"}], "-", 
             RowBox[{"y1", " ", "z3"}], "+", 
             RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "x2"}], " ", "y1"}], "+", 
             RowBox[{"x3", " ", "y1"}], "+", 
             RowBox[{"x1", " ", "y2"}], "-", 
             RowBox[{"x3", " ", "y2"}], "-", 
             RowBox[{"x1", " ", "y3"}], "+", 
             RowBox[{"x2", " ", "y3"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z3"}], "+", "z4"}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "x3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "y3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "z3"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x2", "-", "x3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y2", "-", "y3"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z2", "-", "z3"}], ")"}], "2"]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x3"}], "+", "x4"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y3"}], "+", "y4"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "z3"}], "+", "z4"}], ")"}], "2"]}]]}], ")"}]}]}], 
      ")"}], "3"]}], "\[Rule]", "ChiralTest"}], "}"}]], "Output",
 CellChangeTimes->{3.619557817773321*^9, 
  3.702654237194832*^9},ExpressionUUID->"f15177b9-ee85-4220-be57-\
0f9bd2cc0f42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintEnergyRules"], "Input",
 CellChangeTimes->{{3.411135079713765*^9, 
  3.411135082886479*^9}},ExpressionUUID->"481536ab-85bd-482a-97ce-\
22ea51eeb596"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CCode", "[", "\<\"Energy=ChiralTest;\"\>", "]"}], ",", 
   RowBox[{"MathCode", "[", "\<\"Energy = ChiralTest;\"\>", "]"}], ",", 
   RowBox[{
   "CCode", "[", "\<\"CHIRAL_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6195578178104897`*^9, 
  3.70265423725237*^9},ExpressionUUID->"d02981d4-0ec0-4238-80c9-420ce0d04d27"]
}, Open  ]],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 
  3.408559038294833*^9}},ExpressionUUID->"4ef27c07-ee8e-4cee-8fe9-\
e5efaf3cfd75"],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.410959318323591*^9},ExpressionUUID->"94317aa6-0b03-47ef-8eba-\
a96962bf3937"],

Cell[BoxData[
 RowBox[{"K", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"CO", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "y3"}], "+", "y4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2", " ", "z1"}], "-", 
           RowBox[{"x3", " ", "z1"}], "-", 
           RowBox[{"x1", " ", "z2"}], "+", 
           RowBox[{"x3", " ", "z2"}], "+", 
           RowBox[{"x1", " ", "z3"}], "-", 
           RowBox[{"x2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x3"}], "+", "x4"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "y2"}], " ", "z1"}], "+", 
           RowBox[{"y3", " ", "z1"}], "+", 
           RowBox[{"y1", " ", "z2"}], "-", 
           RowBox[{"y3", " ", "z2"}], "-", 
           RowBox[{"y1", " ", "z3"}], "+", 
           RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "x2"}], " ", "y1"}], "+", 
           RowBox[{"x3", " ", "y1"}], "+", 
           RowBox[{"x1", " ", "y2"}], "-", 
           RowBox[{"x3", " ", "y2"}], "-", 
           RowBox[{"x1", " ", "y3"}], "+", 
           RowBox[{"x2", " ", "y3"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "z3"}], "+", "z4"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x2", "-", "x3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y2", "-", "y3"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z2", "-", "z3"}], ")"}], "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x3"}], "+", "x4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "y3"}], "+", "y4"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "z3"}], "+", "z4"}], ")"}], "2"]}]]}], ")"}]}]}], 
    ")"}], "3"]}]], "Output",
 CellChangeTimes->{3.6195578178536863`*^9, 
  3.702654237315117*^9},ExpressionUUID->"264bcb25-4f23-426f-aa8a-\
c3ad55d98f35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"chiralRestraintHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "12", "}"}]}], "]"}], ",", 
      RowBox[{"{", "12", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.4109593191865063`*^9, {3.410960717989409*^9, 
   3.410960719562788*^9}},ExpressionUUID->"9c0ffe86-94ca-49d6-ba4c-\
7a16bd99a8d7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195578178899717`*^9, 
  3.702654237382493*^9},ExpressionUUID->"76fe7a06-6623-477b-b4c5-\
771a3255aa94"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.4109593198653793`*^9},ExpressionUUID->"eed2827b-c4c2-40ac-8d06-\
c3f32cb0fe02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<CHIRAL_RESTRAINT\>\"", ",", "chiralRestraintForceHessianRules", ",", 
    "chiralRestraintOutputs", ",", "chiralRestraintHessian", ",", 
    "chiralRestraintEnergyFn", ",", "chiralRestraintVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.410959320803413*^9, 3.410959324344501*^9}, 
   3.410959451277605*^9},ExpressionUUID->"18bf73ed-011e-4d62-8661-\
97de2962c28e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"chiralRestraintHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 
   3.410959325491352*^9},ExpressionUUID->"3579a211-b219-427c-a8d3-\
2e2a49232288"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"14", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36"},
     {"26", "15", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46"},
     {"27", "37", "16", "47", "48", "49", "50", "51", "52", "53", "54", "55"},
     {"28", "38", "47", "17", "56", "57", "58", "59", "60", "61", "62", "63"},
     {"29", "39", "48", "56", "18", "64", "65", "66", "67", "68", "69", "70"},
     {"30", "40", "49", "57", "64", "19", "71", "72", "73", "74", "75", "76"},
     {"31", "41", "50", "58", "65", "71", "20", "77", "78", "79", "80", "81"},
     {"32", "42", "51", "59", "66", "72", "77", "21", "82", "83", "84", "85"},
     {"33", "43", "52", "60", "67", "73", "78", "82", "22", "86", "87", "88"},
     {"34", "44", "53", "61", "68", "74", "79", "83", "86", "23", "89", "90"},
     {"35", "45", "54", "62", "69", "75", "80", "84", "87", "89", "24", "91"},
     {"36", "46", "55", "63", "70", "76", "81", "85", "88", "90", "91", "25"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557821410286*^9, 
  3.702654243482113*^9},ExpressionUUID->"9e6dd4f7-bb72-4edd-b121-\
4d6d9740804f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["chiralRestraintOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4109593272519207`*^9},ExpressionUUID->"abdbc1c0-1f0f-4a9a-af20-\
8267acb8e44f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", "fy2", ",", 
   "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", "fx4", ",", "fy4", ",", 
   "fz4", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "dhx2x2", ",", 
   "dhy2y2", ",", "dhz2z2", ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", 
   "dhx4x4", ",", "dhy4y4", ",", "dhz4z4", ",", "ohx1y1", ",", "ohx1z1", ",", 
   "ohx1x2", ",", "ohx1y2", ",", "ohx1z2", ",", "ohx1x3", ",", "ohx1y3", ",", 
   "ohx1z3", ",", "ohx1x4", ",", "ohx1y4", ",", "ohx1z4", ",", "ohy1z1", ",", 
   "ohy1x2", ",", "ohy1y2", ",", "ohy1z2", ",", "ohy1x3", ",", "ohy1y3", ",", 
   "ohy1z3", ",", "ohy1x4", ",", "ohy1y4", ",", "ohy1z4", ",", "ohz1x2", ",", 
   "ohz1y2", ",", "ohz1z2", ",", "ohz1x3", ",", "ohz1y3", ",", "ohz1z3", ",", 
   "ohz1x4", ",", "ohz1y4", ",", "ohz1z4", ",", "ohx2y2", ",", "ohx2z2", ",", 
   "ohx2x3", ",", "ohx2y3", ",", "ohx2z3", ",", "ohx2x4", ",", "ohx2y4", ",", 
   "ohx2z4", ",", "ohy2z2", ",", "ohy2x3", ",", "ohy2y3", ",", "ohy2z3", ",", 
   "ohy2x4", ",", "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", "ohz2y3", ",", 
   "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", "ohz2z4", ",", "ohx3y3", ",", 
   "ohx3z3", ",", "ohx3x4", ",", "ohx3y4", ",", "ohx3z4", ",", "ohy3z3", ",", 
   "ohy3x4", ",", "ohy3y4", ",", "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", 
   "ohz3z4", ",", "ohx4y4", ",", "ohx4z4", ",", "ohy4z4"}], "}"}]], "Output",
 CellChangeTimes->{3.619557821455429*^9, 
  3.702654243553838*^9},ExpressionUUID->"fb0a8cac-3db0-4aa0-8f4b-\
6582750ae5e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"97ea9cdc-80ab-43bd-ae91-\
5478f81d636f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"chiralRestraintAllRules", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintSetupRules"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "out", " ", "setting", " ", "variables", " ", "to", " ", 
    "zero"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"chiralRestraintAllRules", ",", 
      RowBox[{"CCode", "[", 
       RowBox[{"InitializeOutputs", "[", "chiralRestraintOutputs", "]"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintTestRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"MathCode", "[", "\"\<If[ChiralTest>0.0,\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<if (ChiralTest>0.0 ) {\>\"", " ", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", "chiralRestraintEnergyRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "chiralRestraintAllRules", ",", "chiralRestraintForceHessianRules"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"chiralRestraintAllRules", ",", 
    RowBox[{"CCode", "[", "\"\<} /*ChiralTest>0.0*/\>\"", "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.410959332300748*^9, 3.410959333098225*^9}, {3.4109598627158747`*^9, 
   3.410960066783773*^9}, {3.4109601095200453`*^9, 3.410960125598184*^9}, {
   3.411134307132209*^9, 3.41113432360879*^9}, {3.485015368183762*^9, 
   3.4850153836885*^9}},ExpressionUUID->"04ed4df2-046d-4f8f-bdd7-\
d96cb606975d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "chiralRestraintAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.4109593336854553`*^9, 
  3.410959334074417*^9}},ExpressionUUID->"08ae4ef2-8503-453a-95f2-\
17ae3af1ae68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintInput", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"va", ",", "vb", ",", "vc", ",", "vd", ",", "K", ",", "CO"}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.410959334338519*^9, {
   3.4109593725101748`*^9, 3.410959398697234*^9}, {3.410976480390479*^9, 
   3.410976484490128*^9}, {3.411921363503119*^9, 
   3.411921363833495*^9}},ExpressionUUID->"7aee63a8-8c6f-4f95-ae72-\
75d7f5a8e959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<ChiralRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"va", ",", "vb", ",", "vc", ",", "vd"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "chiralRestraintHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "chiralRestraintRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "chiralRestraintInput"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "chiralRestraintOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.410959334749442*^9, 3.4109593365958223`*^9}, {3.4109594055611277`*^9, 
   3.410959422169114*^9}, {3.4109764723057404`*^9, 3.410976477991148*^9}, {
   3.4110666202631207`*^9, 3.4110666262635813`*^9}, {3.411067029087072*^9, 
   3.411067031094479*^9}, 3.411074026391202*^9, {3.411075777240587*^9, 
   3.411075781101914*^9}},ExpressionUUID->"c145ce0d-1735-4fc7-a475-\
9cda3f545571"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "writeOutputVariablesForDebugging", "[", "chiralRestraintPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, {3.410959339196207*^9, 
   3.410959340137948*^9}, 
   3.41106704496288*^9},ExpressionUUID->"a8eddba7-569c-4584-bcbf-\
e1a79d33794d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"chiralRestraintPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "chiralRestraintPack0", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, {3.410959341804433*^9, 
   3.410959345050294*^9}, 
   3.411066639651175*^9},ExpressionUUID->"622eeef3-ba27-43e4-a2f3-\
1472ced362ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "chiralRestraintPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 
   3.4109593459079313`*^9},ExpressionUUID->"65a3ea34-3ede-44da-9f37-\
973bd9a24806"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{352., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"packGraph", "[", 
          RowBox[{"packOptimize", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Name", "\[Rule]", "\<\"ChiralRestraint\"\>"}], ",", 
             RowBox[{"\[LeftSkeleton]", "5", "\[RightSkeleton]"}], ",", 
             RowBox[{"Output", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "fx2", ",", 
                "fy2", ",", "fz2", ",", "fx3", ",", "fy3", ",", "fz3", ",", 
                "fx4", ",", "fy4", ",", "fz4", ",", "dhx1x1", ",", "dhy1y1", 
                ",", "dhz1z1", ",", "dhx2x2", ",", "dhy2y2", ",", "dhz2z2", 
                ",", "dhx3x3", ",", "dhy3y3", ",", "dhz3z3", ",", "dhx4x4", 
                ",", "dhy4y4", ",", 
                RowBox[{"\[LeftSkeleton]", "43", "\[RightSkeleton]"}], ",", 
                "ohy2x4", ",", "ohy2y4", ",", "ohy2z4", ",", "ohz2x3", ",", 
                "ohz2y3", ",", "ohz2z3", ",", "ohz2x4", ",", "ohz2y4", ",", 
                "ohz2z4", ",", "ohx3y3", ",", "ohx3z3", ",", "ohx3x4", ",", 
                "ohx3y4", ",", "ohx3z4", ",", "ohy3z3", ",", "ohy3x4", ",", 
                "ohy3y4", ",", "ohy3z4", ",", "ohz3x4", ",", "ohz3y4", ",", 
                "ohz3z4", ",", "ohx4y4", ",", "ohx4z4", ",", "ohy4z4"}], 
               "}"}]}]}], "}"}], "]"}], "]"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{58., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 540, 29603057679332039141, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{65., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 540, 29603057679332039141, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{48., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 540, 29603057679332039141, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{85., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[540]]], "Output",
 CellChangeTimes->{3.619557895888568*^9, 
  3.702654244200876*^9},ExpressionUUID->"5e48f388-7f23-46c5-ac75-\
f3d5a653e3d4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Cartesian anchor term.  
Anchor atoms at a specific position with a harmonic potential
\t- Expand the gradient and Hessian.\
\>", "Subtitle",
 CellChangeTimes->{
  3.407556231365398*^9, {3.413903156136791*^9, 3.413903180058527*^9}, {
   3.413903223172472*^9, 3.4139032263211527`*^9}, 
   3.414009285999349*^9},ExpressionUUID->"e1911cd3-0e16-4ce7-89eb-\
7925443f20a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "ka"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.403184175232429*^9, 3.403184184931066*^9}, {
   3.413903983939694*^9, 3.413903984536366*^9}, 
   3.414009246563033*^9},ExpressionUUID->"216f22c8-83eb-4f7b-829e-\
16a5b07ceaf1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bx", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xa", ",", " ", "ya", ",", " ", "za"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402651996666046*^9, 3.4026520109900312`*^9}, 
   3.413903311971038*^9, {3.413903346593233*^9, 3.4139033527796583`*^9}, {
   3.413903458114628*^9, 
   3.4139034691386337`*^9}},ExpressionUUID->"957c5682-b448-4275-93a1-\
5fea2f3d7431"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorDeviation", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"bx", "-", "ba"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"bx", "-", "ba"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4111465442384167`*^9, 3.411146575191517*^9}, {
   3.411152033364759*^9, 3.411152034157058*^9}, 3.4139031925379553`*^9, {
   3.4139033180069942`*^9, 3.41390332309116*^9}, {3.413903471689744*^9, 
   3.4139034758767776`*^9}, {3.413904038061068*^9, 
   3.4139040413677464`*^9}},ExpressionUUID->"0f2cb3fb-5e2a-423b-a49e-\
7bd83017c0f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorEnergyFn", " ", "=", "  ", 
  RowBox[{"ka", "  ", 
   RowBox[{"(", "anchorDeviation", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.40265198707939*^9, 3.402651991503303*^9}, {
   3.406169693217455*^9, 3.4061697093264437`*^9}, {3.407556288039659*^9, 
   3.407556290941695*^9}, {3.408552368868788*^9, 3.408552369844737*^9}, {
   3.408555064685437*^9, 3.40855506580233*^9}, {3.411146580951942*^9, 
   3.411146583191472*^9}, {3.411152037060701*^9, 3.411152042843862*^9}, {
   3.413903193205619*^9, 3.413903194259962*^9}, 3.413904044615448*^9, 
   3.414009238387752*^9, 3.416871858821822*^9, 
   3.4168720341302967`*^9},ExpressionUUID->"84596d0c-af08-4482-b3eb-\
660f5b099729"],

Cell[BoxData[
 RowBox[{"ka", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.619557895970714*^9, 
  3.70265424444268*^9},ExpressionUUID->"0e0399b6-f01d-4e0e-ab0a-d9de2bda9973"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "bx", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{3.413903342754142*^9, 
  3.4139034818315573`*^9},ExpressionUUID->"60ed279c-0020-40ec-849d-\
2a9046d0cbcb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]], "Output",
 CellChangeTimes->{3.61955789601539*^9, 
  3.7026542445017433`*^9},ExpressionUUID->"268bc2a3-3811-4f33-a8ad-\
289768c58953"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy function", "Subsection",
 CellChangeTimes->{{3.401714290233551*^9, 
  3.401714291927002*^9}},ExpressionUUID->"b630c207-9811-4dbf-a935-\
44cc6da0b53f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, 3.41390319489956*^9, {3.413903336781911*^9, 
   3.4139033375178556`*^9}},ExpressionUUID->"b6c4f516-a68b-4dc8-86f8-\
6b0c609f2e87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(ka);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(xa);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(ya);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(za);\>\"", "]"}]}], 
   "]"}], ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<ANCHOR_RESTRAINT_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
  3.410998222146997*^9, 3.4109982499763308`*^9}, {3.411080721911592*^9, 
  3.411080722519088*^9}, {3.413903195586742*^9, 3.413903197762012*^9}, {
  3.4139032725347033`*^9, 3.4139032733978243`*^9}, {3.413903365080594*^9, 
  3.413903400308832*^9}, {3.413903434469326*^9, 3.413903453516231*^9}, {
  3.414020790309948*^9, 
  3.4140208145575933`*^9}},ExpressionUUID->"a9cfde97-ddb6-4908-8a33-\
448455ede328"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "anchorVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<ANCHOR_RESTRAINT_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"anchorVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"anchorSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.4139031985252733`*^9, 3.41390319966262*^9}, 
   3.413903273923324*^9, {3.41402126078249*^9, 
   3.414021262410028*^9}},ExpressionUUID->"e088c280-1e67-49f8-a3d6-\
dc5054ccce1f"],

Cell[BoxData["\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557896104176*^9, 
  3.702654244640542*^9},ExpressionUUID->"b8f240f1-4685-429c-b554-\
92b057265b1f"],

Cell[BoxData["\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557896104176*^9, 
  3.702654244641432*^9},ExpressionUUID->"54bbef55-0411-43d8-a983-\
077be41d0a69"],

Cell[BoxData["\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557896104176*^9, 
  3.702654244642146*^9},ExpressionUUID->"fd825468-0dad-4e79-8bc9-\
b4c008078692"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 
   3.413903199910615*^9},ExpressionUUID->"6e3a1361-6e11-418f-86ae-\
32d90ce468cc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ka);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(xa);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ya);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(za);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195578961563883`*^9, 
  3.702654244700347*^9},ExpressionUUID->"ee19a6ec-f992-4345-942c-\
556e7d1a6d2f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anchorOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"AnchorDeviation", ",", "anchorDeviation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", "anchorEnergyFn"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<ANCHOR_RESTRAINT\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorOutputs", ",", "Energy"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.408564424509923*^9}, {3.409106817648347*^9, 3.4091068250916033`*^9}, {
   3.410177095499495*^9, 3.4101771184980516`*^9}, {3.411146593842416*^9, 
   3.411146611510921*^9}, {3.4111466816415157`*^9, 3.411146697052228*^9}, {
   3.411152023623062*^9, 3.411152028421866*^9}, {3.413903200311384*^9, 
   3.413903202186616*^9}, {3.4139032744344463`*^9, 3.413903295296754*^9}, {
   3.4140207972347403`*^9, 
   3.4140207987706137`*^9}},ExpressionUUID->"a40b46e8-8d16-464f-aee4-\
0bd267e62af8"]
}, Open  ]],

Cell["Gradient and Hessian", "Subsection",
 CellChangeTimes->{{3.401714336968295*^9, 3.401714339562934*^9}, {
  3.40855903479362*^9, 
  3.408559038294833*^9}},ExpressionUUID->"690ceaa6-7f80-4d08-a085-\
d1355e1abf45"],

Cell[CellGroupData[{

Cell[BoxData["anchorEnergyFn"], "Input",
 CellChangeTimes->{{3.4085602145274897`*^9, 3.4085602170434313`*^9}, 
   3.413903202602512*^9},ExpressionUUID->"4eaf5511-f42c-4baf-998c-\
b0c82ead7bd6"],

Cell[BoxData[
 RowBox[{"ka", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6195578962098007`*^9, 
  3.702654244775423*^9},ExpressionUUID->"f03a476b-b67f-404a-a9b5-\
a1b0a23d92e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"anchorHessian", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "6", "}"}]}], "]"}], ",", 
      RowBox[{"{", "6", "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.40933277034489*^9, 3.409332795387742*^9}, 
   3.413903202921104*^9},ExpressionUUID->"1386436e-e2c5-4667-87d0-\
8456c6abeee6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557896235428*^9, 
  3.702654244832032*^9},ExpressionUUID->"162f8637-cce1-4c3e-b727-\
3421c6930929"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101770713851852`*^9, 3.410177080322625*^9}, 
   3.413903203137519*^9},ExpressionUUID->"b68e0a34-bca3-43ee-acab-\
bef2a6e2892a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<ANCHOR_RESTRAINT\>\"", ",", "anchorForceHessianRules", ",", 
    "anchorOutputs", ",", "anchorHessian", ",", "anchorEnergyFn", ",", 
    "anchorVarNames"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.408559326556645*^9, 3.4085593620526114`*^9}, {
   3.4093327990965967`*^9, 3.409332802069868*^9}, {3.410177083520434*^9, 
   3.410177087548172*^9}, {3.413903203356204*^9, 3.4139032050483017`*^9}, 
   3.413903275122141*^9, {3.414021270983808*^9, 
   3.414021272512858*^9}},ExpressionUUID->"a4eea477-b970-450a-ac49-\
e462576267c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorHessian", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.409332809311571*^9, 3.4093328114690313`*^9}, {
   3.40933303751335*^9, 3.4093330391745863`*^9}, 
   3.4139032057904243`*^9},ExpressionUUID->"9b582343-aad8-406b-8acb-\
61b7bc63b91e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"5", "8", "9", "0", "0", "0"},
     {"8", "6", "10", "0", "0", "0"},
     {"9", "10", "7", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6195578966966763`*^9, 
  3.7026542457761507`*^9},ExpressionUUID->"8daa09b0-1d72-4acd-a9c5-\
6538dba2a9a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["anchorOutputs"], "Input",
 CellChangeTimes->{{3.408559357562838*^9, 3.408559359276013*^9}, 
   3.4139032064409513`*^9},ExpressionUUID->"8e679f38-fa53-4896-96c7-\
5208e3185127"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "dhx1x1", ",", "dhy1y1", 
   ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", ",", "ohy1z1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557896721417*^9, 
  3.7026542458344584`*^9},ExpressionUUID->"11b2f38e-7786-4bb6-afc3-\
f2d6da614c88"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect terms and convert to C code", "Subsection",
 CellChangeTimes->{{3.401714376596349*^9, 
  3.401714390085981*^9}},ExpressionUUID->"54bf2ce1-a97b-42d8-ac9b-\
f9b8c5d266d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorAllRules", " ", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "anchorSetupRules", ",", "\[IndentingNewLine]", "anchorEnergyRules", ",", 
     "\[IndentingNewLine]", "anchorForceHessianRules"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.410177622861577*^9, 3.410177650326877*^9}, {
   3.410957497343137*^9, 3.410957525179797*^9}, 3.410958727655569*^9, {
   3.4139032071864157`*^9, 
   3.413903208348619*^9}},ExpressionUUID->"f2b20cb6-1ad4-4ce2-a374-\
9521872030cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", "anchorAllRules", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4109587363528433`*^9, 3.410958744314476*^9}, {
  3.41390320889892*^9, 
  3.413903209224545*^9}},ExpressionUUID->"4d5bfe03-8d22-48c2-8e2f-\
fee5e1105709"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"anchorRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.411210896309596*^9, 3.411210898002816*^9}, 
   3.413903209717396*^9, {3.4139040641107597`*^9, 
   3.413904066184003*^9}},ExpressionUUID->"294dc2ea-bc6e-4f72-823d-\
041a33df6363"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ka);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(xa);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ya);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(za);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z1", "-", "za"}], ")"}], "2"]}], "\[Rule]", 
        "AnchorDeviation"}]},
      {
       RowBox[{
        RowBox[{"ka", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}], "\[Rule]", 
        "Energy"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"ANCHOR_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
        "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_FORCE //[\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka", " ", 
         RowBox[{"(", 
          RowBox[{"x1", "-", "xa"}], ")"}]}], "\[Rule]", "gx1"}]},
      {
       RowBox[{
        RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka", " ", 
         RowBox[{"(", 
          RowBox[{"y1", "-", "ya"}], ")"}]}], "\[Rule]", "gy1"}]},
      {
       RowBox[{
        RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka", " ", 
         RowBox[{"(", 
          RowBox[{"z1", "-", "za"}], ")"}]}], "\[Rule]", "gz1"}]},
      {
       RowBox[{
        RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka"}], "\[Rule]", "dhx1x1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka"}], "\[Rule]", "dhy1y1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}]},
      {
       RowBox[{
        RowBox[{"2", " ", "ka"}], "\[Rule]", "dhz1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}]},
      {
       RowBox[{"0", "\[Rule]", "ohx1y1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
1, ohx1y1);\"\>", "]"}]},
      {
       RowBox[{"0", "\[Rule]", "ohx1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, \
2, ohx1z1);\"\>", "]"}]},
      {
       RowBox[{"0", "\[Rule]", "ohy1z1"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, \
2, ohy1z1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN \
]*/\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}]},
      {
       RowBox[{
       "CCode", 
        "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
        "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_FORCE ]*/\"\>", 
        "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557896789295*^9, 
  3.702654246027568*^9},ExpressionUUID->"7af4d9de-6186-40da-9e1c-\
6a6e65093716"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorInput", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "xa", ",", "ya", ",", "za", ",", "ka"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4055952302564087`*^9, 3.405595267347364*^9}, {
   3.408556502824588*^9, 3.4085565040993557`*^9}, 3.413903210219502*^9, {
   3.413903523135522*^9, 3.4139035304924097`*^9}, {3.414009254249028*^9, 
   3.4140092544270477`*^9}},ExpressionUUID->"ffeb086d-42cc-4124-a1cb-\
dd098c459d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"anchorOutputs", ",", "AnchorDeviation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.411152051138565*^9, 3.411152052756624*^9}, 
   3.413903210688085*^9, 
   3.413903296414403*^9},ExpressionUUID->"5bf34cf6-a3f5-42ae-9674-\
896e8f83c2c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<AnchorRestraint\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "anchorHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "anchorRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "anchorInput"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "anchorOutputs"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402876557641659*^9, 3.402876568596249*^9}, 
   3.402876852017213*^9, {3.40559527044873*^9, 3.405595281200487*^9}, {
   3.405607646467461*^9, 3.405607646567194*^9}, {3.4056349375263166`*^9, 
   3.405634963865233*^9}, {3.405635515351774*^9, 3.4056355177092333`*^9}, {
   3.407679881947057*^9, 3.4076798872149277`*^9}, {3.407763146777285*^9, 
   3.407763148181219*^9}, {3.40855652062083*^9, 3.408556522452385*^9}, {
   3.408564819262188*^9, 3.408564828757545*^9}, {3.409333145287333*^9, 
   3.40933315235924*^9}, {3.4101776186718473`*^9, 3.410177620470078*^9}, {
   3.411066451212819*^9, 3.411066462017312*^9}, {3.4110669305802307`*^9, 
   3.4110669315625343`*^9}, {3.411072159484359*^9, 3.411072166176531*^9}, {
   3.411072206442031*^9, 3.41107221385695*^9}, {3.411075684409318*^9, 
   3.4110757253172703`*^9}, {3.4110759780540733`*^9, 3.411075995800424*^9}, 
   3.4110793661329203`*^9, {3.4139032111233997`*^9, 3.413903213486709*^9}, 
   3.413903298323092*^9, 3.413903540538962*^9, {3.4140187475989857`*^9, 
   3.41401874899977*^9}},ExpressionUUID->"15794cbd-d819-4d9c-82f4-\
b172fc964652"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "anchorPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408821026441674*^9, 3.408821031596847*^9}, 3.4110670621890917`*^9, 
   3.413903214952401*^9},ExpressionUUID->"c02aa680-e3c7-4ae4-b996-\
c0691378d843"],

Cell["\<\
anchorPack = Block[{PrintTemporary = Print}, packOptimize[anchorPack0]];\
\>", "Text",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.413903215882161*^9, 
   3.4139032166104527`*^9}},ExpressionUUID->"01f4c3ba-a397-4574-a553-\
a150aaca596a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"anchorPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "anchorPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.405593154617752*^9, 3.405593181273087*^9}, {
   3.405594926006316*^9, 3.4055949283713083`*^9}, {3.40560847035536*^9, 
   3.405608470488098*^9}, {3.407559202182371*^9, 3.407559202626436*^9}, {
   3.408564854380271*^9, 3.408564873627013*^9}, 3.41106665985861*^9, {
   3.411072816696417*^9, 3.4110728451363277`*^9}, {3.411073752072069*^9, 
   3.4110737531085377`*^9}, {3.4139032174258947`*^9, 
   3.413903217685163*^9}},ExpressionUUID->"2ec0963f-6f13-4043-9c58-\
b09df6efdce1"]
}, Open  ]],

Cell["\<\
Ignore errors in packGraph[anchorPack], I forget what it doesn't like but it \
is something non-essential\
\>", "Text",
 CellChangeTimes->{{3.416873887395665*^9, 3.4168738997477922`*^9}, {
  3.416873947718832*^9, 
  3.416873957966881*^9}},ExpressionUUID->"aa084058-801a-4bc7-986f-\
2b5f5ca6b07d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "anchorPack", "]"}]], "Input",
 CellChangeTimes->{{3.405634991753235*^9, 3.405634995403973*^9}, {
   3.4085648880849*^9, 3.408564889562644*^9}, 
   3.413903219466408*^9},ExpressionUUID->"10510d75-92c9-492e-bb5a-\
e7c15906dd0e"],

Cell[BoxData[
 RowBox[{"packGraph", "[", 
  RowBox[{"packOptimize", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\<\"AnchorRestraint\"\>"}], ",", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\<\"\"\>"}], ",", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     RowBox[{"HessianStructure", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5", ",", "8", ",", "9", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "6", ",", "10", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9", ",", "10", ",", "7", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"Rules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ka);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(xa);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(ya);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(za);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_PARAMETER(I1);\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(x1,I1,0);\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(y1,I1,1);\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_SET_POSITION(z1,I1,2);\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "za"}], ")"}], "2"]}], "\[Rule]", 
         "AnchorDeviation"}], ",", 
        RowBox[{
         RowBox[{"ka", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xa"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "ya"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "za"}], ")"}], "2"]}], ")"}]}], "\[Rule]", 
         "Energy"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"ANCHOR_RESTRAINT_ENERGY_ACCUMULATE(Energy);\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_FORCE //[\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka", " ", 
          RowBox[{"(", 
           RowBox[{"x1", "-", "xa"}], ")"}]}], "\[Rule]", "gx1"}], ",", 
        RowBox[{
         RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka", " ", 
          RowBox[{"(", 
           RowBox[{"y1", "-", "ya"}], ")"}]}], "\[Rule]", "gy1"}], ",", 
        RowBox[{
         RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka", " ", 
          RowBox[{"(", 
           RowBox[{"z1", "-", "za"}], ")"}]}], "\[Rule]", "gz1"}], ",", 
        RowBox[{
         RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"2", " ", "ka"}], "\[Rule]", "dhx1x1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka"}], "\[Rule]", "dhy1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{"2", " ", "ka"}], "\[Rule]", "dhz1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#ifdef ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN //[\"\>",
          "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], ",", 
        RowBox[{"0", "\[Rule]", "ohx1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 1, ohx1y1);\"\>", "]"}], ",", 
        RowBox[{"0", "\[Rule]", "ohx1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, \
I1, 2, ohx1z1);\"\>", "]"}], ",", 
        RowBox[{"0", "\[Rule]", "ohy1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"ANCHOR_RESTRAINT_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, \
I1, 2, ohy1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\
\>", "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* ANCHOR_RESTRAINT_CALC_FORCE ]*/\"\>", 
         "]"}]}], "}"}]}], ",", 
     RowBox[{"Input", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "xa", ",", "ya", ",", "za", ",", 
        "ka"}], "}"}]}], ",", 
     RowBox[{"Output", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Energy", ",", "fx1", ",", "fy1", ",", "fz1", ",", "dhx1x1", ",", 
        "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", ",", "ohy1z1", 
        ",", "AnchorDeviation"}], "}"}]}]}], "}"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.619557898358202*^9, 
  3.702654246279891*^9},ExpressionUUID->"e20cefa8-d728-4d20-80a5-\
eafb96e70fde"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Fixed non-bonding terms
\t- Van der Waals and Electrostatic interactions with atoms that are fixed in \
space.
\t- Expand the gradient and Hessian in the most straightforward,
\t\tsimple-minded way, don't use the chain rule approach.\
\>", "Subtitle",
 CellChangeTimes->{{3.4026726634096127`*^9, 3.402672664963516*^9}, {
  3.4868991702894497`*^9, 3.4868991807145767`*^9}, {3.494844072016407*^9, 
  3.494844075959107*^9}},ExpressionUUID->"028542b0-9e01-4307-97e6-\
99990bb77936"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", " ", 
    "evdw", ",", " ", "eeel", ",", "fixedNonBondEquation"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4026532409688883`*^9, 3.4026532495758047`*^9}, {
   3.4027411110373917`*^9, 3.402741113622476*^9}, {3.402741174635448*^9, 
   3.402741179258795*^9}, {3.486899212216976*^9, 3.4868992150663013`*^9}, 
   3.486899587515778*^9},ExpressionUUID->"d45b0108-56bb-4fca-b48f-\
2ac5299781fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ba", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{"xf", ",", " ", "yf", ",", " ", "zf"}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402652497585835*^9, 3.4026525079290657`*^9}, {
  3.402652543744648*^9, 3.402652572153042*^9}, {3.4868992274659967`*^9, 
  3.4868992304790297`*^9}},ExpressionUUID->"35bd7349-9cf0-41e4-b3b9-\
b4e82c85baec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondInputs", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"ba", ",", "bb", ",", "dA", ",", "dC", ",", "dQ1Q2"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.405598799353134*^9, 3.405598800527666*^9}, {
   3.405598839484171*^9, 3.405598850689588*^9}, {3.405599099937523*^9, 
   3.40559912810675*^9}, {3.405599314188497*^9, 3.405599327722315*^9}, 
   3.405600870439898*^9, {3.411175187292178*^9, 3.4111751886209507`*^9}, {
   3.486900028093594*^9, 
   3.4869000289927797`*^9}},ExpressionUUID->"b968ff22-b750-4d22-930f-\
2e5aeaea0053"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", "dA", ",",
    "dC", ",", "dQ1Q2"}], "}"}]], "Output",
 CellChangeTimes->{3.619557898437707*^9, 
  3.7026542463777514`*^9},ExpressionUUID->"3daf3144-fa9a-49d8-8840-\
ab2b3fa0dad9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondDistance", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"ba", "-", "bb"}], ")"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.411175191371356*^9, 3.4111752070248013`*^9}, {
   3.411197578518401*^9, 3.411197589788989*^9}, 
   3.486899591964513*^9},ExpressionUUID->"5175a19b-cadc-4cf9-a2ea-\
2e6ff34f9a37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"efvdwEquation", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["dA", 
     SuperscriptBox["fixedNonBondDistance", "12"]], "-", 
    FractionBox["dC", 
     SuperscriptBox["fixedNonBondDistance", "6"]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.402740997525921*^9, 3.402741044800063*^9}, {
   3.407556720442287*^9, 3.407556726625795*^9}, {3.407557014452285*^9, 
   3.407557034497266*^9}, {3.408662107718624*^9, 3.4086621120938663`*^9}, 
   3.411081883431032*^9, {3.411175212266877*^9, 3.41117523978631*^9}, {
   3.411197604900622*^9, 3.411197623162916*^9}, 3.416871995722517*^9, {
   3.486899247667407*^9, 3.4868992682932787`*^9}, {3.4868995931240263`*^9, 
   3.486899593780075*^9}, 3.48689979376054*^9, {3.4868998240834837`*^9, 
   3.4868998427714367`*^9}},ExpressionUUID->"0656a7b9-dff3-4051-9108-\
426d8947cded"],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]]}]], "Output",
 CellChangeTimes->{3.619557898511396*^9, 
  3.702654246489319*^9},ExpressionUUID->"942c4592-836f-4986-ac86-\
f1fc1266bc16"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"efeelEquation", " ", "=", " ", 
  RowBox[{"(", 
   FractionBox["dQ1Q2", "fixedNonBondDistance"], ")"}]}]], "Input",
 CellChangeTimes->{{3.4026534322622623`*^9, 3.402653496407857*^9}, {
   3.4026535524322023`*^9, 3.402653641591628*^9}, {3.4026779483394947`*^9, 
   3.402677953362184*^9}, {3.4026781314714537`*^9, 3.4026781348802843`*^9}, {
   3.40274101413416*^9, 3.402741050316153*^9}, {3.407556736609376*^9, 
   3.4075567425681257`*^9}, {3.407557208386277*^9, 3.407557225106896*^9}, {
   3.408662115934063*^9, 3.408662119317389*^9}, 3.411081885331176*^9, {
   3.411197627982712*^9, 3.411197630382259*^9}, 3.416871999453731*^9, {
   3.486899263067898*^9, 3.486899266017837*^9}, 3.486899595492217*^9, 
   3.486899792235376*^9, 3.4868998451487417`*^9, 
   3.4868998890096083`*^9},ExpressionUUID->"ecbcb2b6-aa93-4c3a-b8c2-\
e4bd24114318"],

Cell[BoxData[
 FractionBox["dQ1Q2", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]]], "Output",
 CellChangeTimes->{3.619557898569434*^9, 
  3.702654246552062*^9},ExpressionUUID->"4744d089-a0c9-47e9-8ea1-\
f15d7ba88206"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondEquation", " ", "=", " ", 
  RowBox[{"efvdwEquation", " ", "+", " ", "efeelEquation"}]}]], "Input",
 CellChangeTimes->{{3.4027412120076227`*^9, 3.402741220906414*^9}, {
   3.4086620876703787`*^9, 3.408662102195766*^9}, 3.486899597487871*^9, {
   3.486899797160198*^9, 3.486899798372685*^9}, {3.486899829491583*^9, 
   3.4868998481540203`*^9}, 
   3.486899889928892*^9},ExpressionUUID->"03211933-86df-447e-9097-\
fe0d5177abcf"],

Cell[BoxData[
 RowBox[{
  FractionBox["dA", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
  FractionBox["dC", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]], "+", 
  FractionBox["dQ1Q2", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]]}]], "Output",
 CellChangeTimes->{3.619557898598501*^9, 
  3.7026542466421556`*^9},ExpressionUUID->"76712b84-b288-4724-91db-\
918b49bbf04e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"names", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "ba", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.486899549784584*^9},ExpressionUUID->"b36739b1-2872-4a36-93cd-\
8f386123e486"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]], "Output",
 CellChangeTimes->{3.619557898620987*^9, 
  3.702654246821478*^9},ExpressionUUID->"cf3167fb-2693-4abb-a9a2-\
adeb6269f8f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy", "Subsection",
 CellChangeTimes->{{3.401714932466758*^9, 
  3.401714933019302*^9}},ExpressionUUID->"0a514688-2796-42a4-8d97-\
e99b96ec4515"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondVarNames", " ", "=", " ", 
   RowBox[{"{", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x", ",", "I1", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y1", ",", "y", ",", "I1", ",", "1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z", ",", "I1", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4085450415029783`*^9, 3.408545189001713*^9}, {
   3.40854564425465*^9, 3.40854566509382*^9}, {3.408545841159666*^9, 
   3.40854589498903*^9}, {3.408564450747929*^9, 3.408564451541582*^9}, {
   3.486899474762479*^9, 3.486899475750346*^9}, 
   3.486899598225782*^9},ExpressionUUID->"1bc1c738-9349-49fb-a281-\
14abdbe3c3b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixedNonBondSetupRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(xf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(yf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(zf);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(I1);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{
    "CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dQ1Q2);\>\"", "]"}]}], "]"}],
   ";", 
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dA);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondSetupRules", ",", 
    RowBox[{"CCode", "[", "\"\<// FNONBOND_SET_PARAMETER(dC);\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.410177124188498*^9, 3.410177277864727*^9}, {
   3.4101777777433367`*^9, 3.410177805652183*^9}, {3.410177935376103*^9, 
   3.410177953524826*^9}, {3.4101782531152697`*^9, 3.410178268853266*^9}, {
   3.486899598988052*^9, 3.48689960053936*^9}, {3.486899642233687*^9, 
   3.486899655633342*^9}, 3.4868997620139523`*^9, {3.4869001020979548`*^9, 
   3.486900107535079*^9}, {3.487026123015799*^9, 3.487026151511093*^9}, {
   3.487026191456916*^9, 3.487026218196006*^9}, {3.48702895046251*^9, 
   3.487028956387195*^9}, {3.4872610348815603`*^9, 
   3.487261040187768*^9}},ExpressionUUID->"233c2c4b-3120-4b17-b635-\
49ab217c950d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "fixedNonBondVarNames", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", " ", "=", " ", 
      RowBox[{"\"\<FNONBOND_SET_POSITION(\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"fixedNonBondVarNames", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}], "<>", "\"\<);\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"fixedNonBondSetupRules", ",", 
       RowBox[{"CCode", "[", "str", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.410177280324893*^9, 3.410177373744402*^9}, {
   3.410177477477*^9, 3.410177533673448*^9}, {3.410177572074147*^9, 
   3.4101775752355337`*^9}, {3.410177780093665*^9, 3.410177806677978*^9}, {
   3.410177937538464*^9, 3.4101779539373293`*^9}, {3.4868996013404512`*^9, 
   3.4868996039384813`*^9}, 
   3.486900098021953*^9},ExpressionUUID->"c3ac488b-12cb-406e-b380-\
02c49e2d9980"],

Cell[BoxData["\<\"FNONBOND_SET_POSITION(x1,I1,0);\"\>"], "Print",
 CellChangeTimes->{3.619557898723919*^9, 
  3.7026542469379883`*^9},ExpressionUUID->"c0c62098-4dc4-4ab3-83df-\
fafc5981ab4d"],

Cell[BoxData["\<\"FNONBOND_SET_POSITION(y1,I1,1);\"\>"], "Print",
 CellChangeTimes->{3.619557898723919*^9, 
  3.702654246938787*^9},ExpressionUUID->"35886d45-e201-4a17-94f3-\
19bba89ea1ce"],

Cell[BoxData["\<\"FNONBOND_SET_POSITION(z1,I1,2);\"\>"], "Print",
 CellChangeTimes->{3.619557898723919*^9, 
  3.7026542469394283`*^9},ExpressionUUID->"77239f2f-4d5c-4fe9-adaa-\
2a2d2db16926"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondSetupRules", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.410177392336293*^9, 3.410177395110338*^9}, {
   3.41017756267308*^9, 3.4101775644454517`*^9}, 3.410177784928906*^9, 
   3.410177939985861*^9, 
   3.486899605018564*^9},ExpressionUUID->"c37157b1-8af0-450e-b06b-\
949c8f04abe0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(xf);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(yf);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(zf);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(I1);\"\>", "]"}]},
      {
       RowBox[{
       "CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dA);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dC);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"FNONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"FNONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}]},
      {
       RowBox[{"CCode", "[", "\<\"FNONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619557898753703*^9, 
  3.7026542469995317`*^9},ExpressionUUID->"4d408d39-232d-4136-ac71-\
c35ab2b47399"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixedNonBondEnergyRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fixedNonBondOutputs", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"NonbondDistance", ",", "fixedNonBondDistance"}], "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Efvdw", ",", "efvdwEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND_EFVDW\>\"", ",", "Efvdw"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Efeel", ",", "efeelEquation"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND_EFEEL\>\"", ",", "Efeel"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"Assign", "[", 
     RowBox[{"Energy", ",", 
      RowBox[{"Efvdw", "+", "Efeel"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondEnergyRules", ",", 
    RowBox[{"EnergyAccumulate", "[", 
     RowBox[{"\"\<FNONBOND\>\"", ",", "Energy"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Energy"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Efvdw"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"fixedNonBondOutputs", ",", "Efeel"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.401714154505054*^9, 3.40171415874859*^9}, {
   3.401714286121945*^9, 3.401714287127378*^9}, {3.401714414109407*^9, 
   3.4017144145268173`*^9}, {3.402652075438241*^9, 3.402652079400985*^9}, {
   3.402660211700779*^9, 3.402660211962166*^9}, 3.402660717868671*^9, {
   3.403183975900215*^9, 3.403183982112797*^9}, {3.405591741230144*^9, 
   3.405591745357368*^9}, {3.405605212352811*^9, 3.405605255675804*^9}, {
   3.405606432112876*^9, 3.405606432293248*^9}, {3.408552349903845*^9, 
   3.408552365804942*^9}, {3.408553616504222*^9, 3.408553632331004*^9}, {
   3.40855893637739*^9, 3.408558954320676*^9}, {3.408564420674754*^9, 
   3.40856461348985*^9}, {3.4086620182358303`*^9, 3.408662059190785*^9}, {
   3.408845741782146*^9, 3.408845742684737*^9}, {3.409106891440276*^9, 
   3.409106897731967*^9}, {3.4101779703884487`*^9, 3.4101779742502947`*^9}, {
   3.411175262320244*^9, 3.411175277196607*^9}, {3.411197639200581*^9, 
   3.411197649744299*^9}, {3.4868996061093397`*^9, 3.4868996113673363`*^9}, 
   3.486899830710224*^9, {3.486899890910192*^9, 
   3.48689995929298*^9}},ExpressionUUID->"55b61fed-3600-47b5-9a4a-\
a363e99518b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondHessian", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "6", "}"}]}], "]"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4093341201898527`*^9, 3.409334145792842*^9}, 
   3.486899612009248*^9, {3.4868999652909813`*^9, 
   3.486899969952155*^9}},ExpressionUUID->"68fa6a2b-5c0b-4a90-828e-\
89fb63d5a696"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.619557898799706*^9, 
  3.702654247247113*^9},ExpressionUUID->"e2ac34bc-66eb-41d9-a176-\
941678481ad7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondForceHessianRules", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.41017797887521*^9, 3.410177986821323*^9}, 
   3.486899612569351*^9},ExpressionUUID->"7a226d62-64ac-41c8-9781-\
36fce0c0c137"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendGradientForceAndHessian", "[", 
   RowBox[{
   "\"\<FNONBOND\>\"", ",", "fixedNonBondForceHessianRules", ",", 
    "fixedNonBondOutputs", ",", "fixedNonBondHessian", ",", 
    "fixedNonBondEquation", ",", "fixedNonBondVarNames"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408564650544894*^9, 3.4085646723988333`*^9}, {
   3.4093341503049994`*^9, 3.409334152928982*^9}, {3.410177989524556*^9, 
   3.410177993430345*^9}, {3.486899613226053*^9, 3.486899615580276*^9}, 
   3.486899978015726*^9},ExpressionUUID->"c98df20f-80b3-4514-86ca-\
93bd115476dd"],

Cell[CellGroupData[{

Cell["Collect and simplify.", "Subsection",
 CellChangeTimes->{{3.401714943920781*^9, 
  3.4017149467691317`*^9}},ExpressionUUID->"1f90bdff-6a7b-4eb0-bd76-\
d26eebfa5627"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppendTo", "[", 
  RowBox[{"fixedNonBondOutputs", ",", "fixedNonbondDistance"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4111752879915047`*^9, 3.411175299948979*^9}, {
   3.4111976578180523`*^9, 3.411197662226531*^9}, 3.486899616345285*^9, {
   3.486899992027813*^9, 
   3.486899992728018*^9}},ExpressionUUID->"bd8205e4-3988-425e-8ba3-\
b0246b7cf448"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Energy", ",", "Efvdw", ",", "Efeel", ",", "fx1", ",", "fy1", ",", "fz1", 
   ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", ",", "ohx1z1", 
   ",", "ohy1z1", ",", "fixedNonbondDistance"}], "}"}]], "Output",
 CellChangeTimes->{3.619557899210888*^9, 
  3.7026542506937523`*^9},ExpressionUUID->"dc6ef73d-d8d7-443d-a3fd-\
db2718bab369"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fixedNonBondOutputs", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.407761706517828*^9, 3.407761713826333*^9}, 
   3.4085647312264338`*^9, 
   3.486899617019046*^9},ExpressionUUID->"87c12af7-e8b0-44b7-9f06-\
17b225e6568b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "Energy", ",", "Efvdw", ",", "Efeel", ",", "fx1", ",", "fy1", ",", "fz1", 
     ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", ",", 
     "ohx1z1", ",", "ohy1z1", ",", "fixedNonbondDistance"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.6195578992368727`*^9, 
  3.7026542507493057`*^9},ExpressionUUID->"d87f5b5a-8c40-4d1c-a942-\
8b6b0bf2e5f1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixedNonBondRules", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
     "fixedNonBondSetupRules", ",", "fixedNonBondEnergyRules", ",", 
      "fixedNonBondForceHessianRules"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4101780002769012`*^9, 3.410178019066489*^9}, {
  3.486899617618881*^9, 
  3.4868996194608173`*^9}},ExpressionUUID->"be515830-4a76-44b3-97cb-\
e431b83ecdd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fnbPack0", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\"\<FixedNonbond\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\"\<\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EnergyFunction", "\[Rule]", "fixedNonBondEquation"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"HessianStructure", "\[Rule]", "fixedNonBondHessian"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Rules", "\[Rule]", "fixedNonBondRules"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Input", "\[Rule]", "fixedNonBondInputs"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Output", "\[Rule]", "fixedNonBondOutputs"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402883091844193*^9, 3.402883109757745*^9}, {
   3.405599410576713*^9, 3.405599420818408*^9}, {3.405636531900292*^9, 
   3.405636558425681*^9}, {3.407680071988505*^9, 3.407680077816546*^9}, 
   3.407763588476679*^9, 3.4085647224058104`*^9, {3.40933415538027*^9, 
   3.409334160491582*^9}, {3.410178022321698*^9, 3.4101780247202463`*^9}, {
   3.411066525378414*^9, 3.4110665305218554`*^9}, {3.4110669785605593`*^9, 
   3.411066979512672*^9}, 3.411073980102089*^9, {3.411075744183799*^9, 
   3.4110757483818693`*^9}, {3.411076126272653*^9, 3.4110761441604156`*^9}, 
   3.411079379925102*^9, {3.486899620515873*^9, 3.486899622563909*^9}, {
   3.48690000448034*^9, 3.4869000046048727`*^9}, {3.486900045658348*^9, 
   3.4869000846709013`*^9}},ExpressionUUID->"42f56f94-f1ce-4a55-bb60-\
fbbc45663e12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeOutputVariablesForDebugging", "[", "fnbPack0", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.408752301954282*^9, 3.408752370230307*^9}, {
   3.408790455561413*^9, 3.408790462727047*^9}, {3.408844136724172*^9, 
   3.4088441368164663`*^9}, 3.4110670742215853`*^9, 
   3.4869000687187243`*^9},ExpressionUUID->"736fec4b-5b0b-4e73-8419-\
8d251b781d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbPack", " ", "=", " ", 
   RowBox[{"packOptimize", "[", "fnbPack0", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.403226324288348*^9, 3.403226328476006*^9}, {
   3.405593875002966*^9, 3.405593881982143*^9}, {3.405599430468072*^9, 
   3.4055994349778767`*^9}, {3.405599474714013*^9, 3.4055994758098173`*^9}, {
   3.407559226957994*^9, 3.4075592273388157`*^9}, 3.411066673303035*^9, 
   3.486900070218787*^9},ExpressionUUID->"bb92f06f-cb0a-4b46-bcbd-\
e1c27bcc98cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"packGraph", "[", "nbPack", "]"}]], "Input",
 CellChangeTimes->{{3.4055994669993668`*^9, 
  3.4055995100170727`*^9}},ExpressionUUID->"c39afa8d-3ca8-4076-9a52-\
a2899a9a466c"],

Cell[BoxData[
 RowBox[{"packGraph", "[", 
  RowBox[{"packOptimize", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Name", "\[Rule]", "\<\"FixedNonbond\"\>"}], ",", 
     RowBox[{"AdditionalCDeclares", "\[Rule]", "\<\"\"\>"}], ",", 
     RowBox[{"EnergyFunction", "\[Rule]", 
      RowBox[{
       FractionBox["dA", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
       FractionBox["dC", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]], "+", 
       FractionBox["dQ1Q2", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]]}]}], ",", 
     RowBox[{"DerivativeVariables", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}]}], ",", 
     RowBox[{"HessianStructure", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "10", ",", "11", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "8", ",", "12", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "12", ",", "9", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"Rules", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(xf);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(yf);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(zf);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(I1);\"\>", "]"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dQ1Q2);\"\>", "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dA);\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"// FNONBOND_SET_PARAMETER(dC);\"\>", "]"}],
         ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_SET_POSITION(x1,I1,0);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_SET_POSITION(y1,I1,1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_SET_POSITION(z1,I1,2);\"\>", "]"}], ",", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]], "\[Rule]", 
         "NonbondDistance"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["dA", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "6"]], "-", 
          FractionBox["dC", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "3"]]}], 
         "\[Rule]", "Efvdw"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_EFVDW_ENERGY_ACCUMULATE(Efvdw);\"\>", 
         "]"}], ",", 
        RowBox[{
         FractionBox["dQ1Q2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}]]], "\[Rule]", 
         "Efeel"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_EFEEL_ENERGY_ACCUMULATE(Efeel);\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{"Efeel", "+", "Efvdw"}], "\[Rule]", "Energy"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_ENERGY_ACCUMULATE(Energy);\"\>", "]"}], 
        ",", 
        RowBox[{"CCode", "[", "\<\"#ifdef FNONBOND_CALC_FORCE //[\"\>", "]"}],
         ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcForce ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gx1"}], ",", 
        RowBox[{
         RowBox[{"-", "gx1"}], "\[Rule]", "fx1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_FORCE_ACCUMULATE(I1, 0, fx1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gy1"}], ",", 
        RowBox[{
         RowBox[{"-", "gy1"}], "\[Rule]", "fy1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_FORCE_ACCUMULATE(I1, 1, fy1 );\"\>", 
         "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA", " ", 
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox[
           RowBox[{"dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "gz1"}], ",", 
        RowBox[{
         RowBox[{"-", "gz1"}], "\[Rule]", "fz1"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"FNONBOND_FORCE_ACCUMULATE(I1, 2, fz1 );\"\>", 
         "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef FNONBOND_CALC_DIAGONAL_HESSIAN //[\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"if ( calcDiagonalHessian ) {\"\>", "]"}], 
        ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x1", "-", "xf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhx1x1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 0, \
dhx1x1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"12", " ", "dA"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y1", "-", "yf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]]}], "\[Rule]", "dhy1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 1, \
dhy1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"12", " ", "dA"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "7"]]}], 
          "+", 
          FractionBox[
           RowBox[{"6", " ", "dC"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "4"]], "-", 
          FractionBox["dQ1Q2", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"3", "/", "2"}]]], "+", 
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "dhz1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_DIAGONAL_HESSIAN_ACCUMULATE(I1, 2, I1, 2, \
dhz1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#ifdef FNONBOND_CALC_OFF_DIAGONAL_HESSIAN //[\"\>",
          "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"if ( calcOffDiagonalHessian ) {\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1y1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 1, \
ohx1y1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"x1", "-", "xf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohx1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 0, I1, 2, \
ohx1z1);\"\>", "]"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"168", " ", "dA", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "8"]], "-", 
          FractionBox[
           RowBox[{"48", " ", "dC", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], "5"]], "+", 
          FractionBox[
           RowBox[{"3", " ", "dQ1Q2", " ", 
            RowBox[{"(", 
             RowBox[{"y1", "-", "yf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"z1", "-", "zf"}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x1", "-", "xf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"y1", "-", "yf"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"z1", "-", "zf"}], ")"}], "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]]}], "\[Rule]", "ohy1z1"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"FNONBOND_OFF_DIAGONAL_HESSIAN_ACCUMULATE(I1, 1, I1, 2, \
ohy1z1);\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"} /*if calcOffDiagonalHessian */ \"\>", "]"}], ",", 
        RowBox[{
        "CCode", 
         "[", "\<\"#endif /* FNONBOND_CALC_OFF_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcDiagonalHessian */\"\>", "]"}], 
        ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* FNONBOND_CALC_DIAGONAL_HESSIAN ]*/\"\>", 
         "]"}], ",", 
        RowBox[{"CCode", "[", "\<\"} /*calcForce */\"\>", "]"}], ",", 
        RowBox[{
        "CCode", "[", "\<\"#endif /* FNONBOND_CALC_FORCE ]*/\"\>", "]"}]}], 
       "}"}]}], ",", 
     RowBox[{"Input", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "z1", ",", "xf", ",", "yf", ",", "zf", ",", "dA",
         ",", "dC", ",", "dQ1Q2"}], "}"}]}], ",", 
     RowBox[{"Output", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "Energy", ",", "Efvdw", ",", "Efeel", ",", "fx1", ",", "fy1", ",", 
        "fz1", ",", "dhx1x1", ",", "dhy1y1", ",", "dhz1z1", ",", "ohx1y1", 
        ",", "ohx1z1", ",", "ohy1z1", ",", "fixedNonbondDistance"}], 
       "}"}]}]}], "}"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.619557903681158*^9, 
  3.7026542512962523`*^9},ExpressionUUID->"27867a28-9c26-488f-a3c2-\
af8d9cbf7d6a"]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowToolbars->"RulerBar",
Evaluator->"Local",
CellGrouping->Manual,
WindowSize->{1003, 818},
WindowMargins->{{169, Automatic}, {Automatic, 17}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 270, 7, 100, "Subtitle", "ExpressionUUID" -> \
"b0fd39df-8862-4179-a880-dbe2092c9a61",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[862, 33, 283, 6, 65, "Code", "ExpressionUUID" -> \
"c70641c7-1b5d-410e-ad0a-56f59ac2d689",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1148, 41, 360, 5, 40, "Output", "ExpressionUUID" -> \
"403334fc-bce5-48c5-aaa3-7f00ce59b585"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1545, 51, 565, 10, 65, "Code", "ExpressionUUID" -> \
"2d137b9b-ea88-410b-9968-95caebda6207",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2113, 63, 359, 5, 40, "Output", "ExpressionUUID" -> \
"6a85699e-773d-42b7-a83f-3afd3b42a47a"]
}, Open  ]],
Cell[2487, 71, 152, 3, 40, "Input", "ExpressionUUID" -> \
"56979870-3ed4-4d4e-af8e-a63b4ff23368"],
Cell[2642, 76, 276, 5, 63, "Subtitle", "ExpressionUUID" -> \
"13656531-838c-4e7a-a5ac-d7f574743d13",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[2921, 83, 212, 4, 65, "Code", "ExpressionUUID" -> \
"49c3f62a-426b-40d8-ad03-a51a7d875bc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3170, 92, 297, 7, 136, "Subtitle", "ExpressionUUID" -> \
"40c497cd-8ecb-4a12-a19e-90050870a153"],
Cell[3470, 101, 276, 7, 40, "Input", "ExpressionUUID" -> \
"a3598273-c222-436b-9d94-ca29ebbf3a24"],
Cell[3749, 110, 452, 13, 67, "Input", "ExpressionUUID" -> \
"58e0eab9-be8c-43e5-82a3-ad8adbb63338"],
Cell[4204, 125, 193, 3, 54, "Subsection", "ExpressionUUID" -> \
"3879886e-f184-4d74-93af-6e49da00fb72"],
Cell[4400, 130, 470, 14, 31, "Input", "ExpressionUUID" -> \
"495fb4b5-85f0-462f-aac7-785188d5dabc"],
Cell[CellGroupData[{
Cell[4895, 148, 656, 12, 40, "Input", "ExpressionUUID" -> \
"4e665c6e-c0f4-4ca4-833d-8dc01f25a9b8"],
Cell[5554, 162, 800, 25, 57, "Output", "ExpressionUUID" -> \
"e1456d8f-5ccd-4356-b9af-b2b072c03dbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6391, 192, 205, 5, 40, "Input", "ExpressionUUID" -> \
"d49fcc02-7be5-4d13-bb3a-5b4b3983e308"],
Cell[6599, 199, 366, 8, 40, "Output", "ExpressionUUID" -> \
"7bf4518c-ca33-4c5a-888d-4d82c900583e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7002, 212, 241, 4, 54, "Subsection", "ExpressionUUID" -> \
"76c2ef4b-da46-4f83-b9d7-f91a9c19990f"],
Cell[7246, 218, 1051, 26, 223, "Input", "ExpressionUUID" -> \
"446f8cb2-7ee6-4b8d-884e-be17a694418a"],
Cell[8300, 246, 1101, 27, 145, "Input", "ExpressionUUID" -> \
"abcb48bc-d911-47a2-92e5-016ff7afb1b1"],
Cell[CellGroupData[{
Cell[9426, 277, 1495, 35, 197, "Input", "ExpressionUUID" -> \
"0bbb2f4a-d376-457f-894a-dcf14cdf7f4d"],
Cell[10924, 314, 310, 5, 29, "Print", "ExpressionUUID" -> \
"a39aa9e0-b052-446b-94a8-d9859bdfd0d9"],
Cell[11237, 321, 310, 5, 29, "Print", "ExpressionUUID" -> \
"d85a5298-71e2-4092-adf7-6a7a19c94249"],
Cell[11550, 328, 308, 5, 29, "Print", "ExpressionUUID" -> \
"4f3973d4-63e4-4afc-9cf1-2d42d5ab8f01"],
Cell[11861, 335, 308, 5, 29, "Print", "ExpressionUUID" -> \
"5cc7b3f1-bbf1-402e-9e99-f6618d6bb4cd"],
Cell[12172, 342, 310, 5, 29, "Print", "ExpressionUUID" -> \
"78e0018a-b110-430d-bb9b-b2c1a156776c"],
Cell[12485, 349, 310, 5, 29, "Print", "ExpressionUUID" -> \
"7f70118e-aff2-43c5-aef6-67ab637759f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12832, 359, 251, 5, 40, "Input", "ExpressionUUID" -> \
"56551ce3-b9df-432e-b5e3-f2b5d6f01a87"],
Cell[13086, 366, 1697, 42, 295, "Output", "ExpressionUUID" -> \
"dcecf1d4-164b-4079-9958-dd5734cf63b6"]
}, Open  ]],
Cell[14798, 411, 1965, 42, 171, "Input", "ExpressionUUID" -> \
"d2ec2e96-4d08-4a2b-9b30-b2997f4c3329"]
}, Open  ]],
Cell[16778, 456, 281, 4, 54, "Subsection", "ExpressionUUID" -> \
"ed8cec90-4c0a-47d9-9f0f-1990a0389f2f"],
Cell[CellGroupData[{
Cell[17084, 464, 171, 3, 31, "Input", "ExpressionUUID" -> \
"07b80f7a-8e11-48e8-95f4-52af32d2333f"],
Cell[17258, 469, 791, 24, 57, "Output", "ExpressionUUID" -> \
"eddbc087-006f-45fc-bdc4-81fff03b0011"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18086, 498, 437, 13, 40, "Input", "ExpressionUUID" -> \
"63510d04-307f-48f5-b131-93115a1e8bfe"],
Cell[18526, 513, 1015, 26, 147, "Output", "ExpressionUUID" -> \
"ac3fd518-ff49-4b25-a19f-d80a774527e3"]
}, Open  ]],
Cell[19556, 542, 247, 6, 40, "Input", "ExpressionUUID" -> \
"1d7c25b0-fdd8-4f33-81d8-92b1808f75e8"],
Cell[19806, 550, 493, 10, 67, "Input", "ExpressionUUID" -> \
"1ca74e93-7a67-4d46-a40b-bafa109761de"],
Cell[CellGroupData[{
Cell[20324, 564, 250, 5, 40, "Input", "ExpressionUUID" -> \
"85b973da-3bee-4bad-afca-ddd60139d234"],
Cell[20577, 571, 1051, 26, 147, "Output", "ExpressionUUID" -> \
"f30fac74-467b-470e-be67-c617a38e7b80"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21665, 602, 166, 3, 40, "Input", "ExpressionUUID" -> \
"806ee8fc-0086-468d-8963-65f7bd951e4c"],
Cell[21834, 607, 720, 13, 93, "Output", "ExpressionUUID" -> \
"ad89048f-8418-4d99-adb8-0441a008e91f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22591, 625, 183, 3, 54, "Subsection", "ExpressionUUID" -> \
"962d4dfb-fe35-420f-b0a2-e2747b27b8a4"],
Cell[22777, 630, 483, 11, 119, "Input", "ExpressionUUID" -> \
"c35375c0-5832-4e1b-8621-e85aed162528"],
Cell[23263, 643, 265, 6, 40, "Input", "ExpressionUUID" -> \
"52064099-ffa3-4627-80f8-c2c37f91a2f8"],
Cell[23531, 651, 164, 3, 40, "Input", "ExpressionUUID" -> \
"b1a40249-4327-451e-bdb0-e7f8cabf6dd8"],
Cell[23698, 656, 395, 10, 40, "Input", "ExpressionUUID" -> \
"1410c9bd-0156-4261-9767-d7b16ffc7251"],
Cell[24096, 668, 257, 6, 40, "Input", "ExpressionUUID" -> \
"faf75be5-87ba-4164-babb-9d8d83ab387c"],
Cell[24356, 676, 310, 6, 85, "Subsection", "ExpressionUUID" -> \
"7a30b210-9d08-4aa3-9dbe-0c1bec4ec4de"],
Cell[24669, 684, 1828, 32, 240, "Input", "ExpressionUUID" -> \
"e7c04b05-4842-4c2d-8283-54f03f84cc79"],
Cell[CellGroupData[{
Cell[26522, 720, 318, 7, 40, "Input", "ExpressionUUID" -> \
"0398e0a1-c5f2-4b1c-b25d-c1ef738c0fb1"],
Cell[26843, 729, 476, 11, 29, "Print", "ExpressionUUID" -> \
"d49d760c-9752-4287-b1ee-c59c2d9901d6"],
Cell[27322, 742, 454, 10, 29, "Print", "ExpressionUUID" -> \
"3483245f-5da5-4fe5-b6c7-099b0fd2bcbd"],
Cell[27779, 754, 452, 10, 29, "Print", "ExpressionUUID" -> \
"d3359fc4-2c4c-491b-a6b4-51cca5d2058f"],
Cell[28234, 766, 446, 10, 29, "Print", "ExpressionUUID" -> \
"f86220bb-9a97-4f9f-928f-9b09c5474a88"]
}, Open  ]],
Cell[28695, 779, 495, 9, 38, "Text", "ExpressionUUID" -> \
"95dc914b-df9d-44ae-9c6d-67f1919fbd54"],
Cell[29193, 790, 199, 3, 54, "Subsection", "ExpressionUUID" -> \
"47d94349-2f0d-408a-90da-4fb017e5e65a"],
Cell[CellGroupData[{
Cell[29417, 797, 583, 10, 33, "Input", "ExpressionUUID" -> \
"59c99ea9-0cd8-47be-9284-c22abf527e8b"],
Cell[30003, 809, 526, 14, 98, "Print", "ExpressionUUID" -> \
"92bafb4d-4ba5-4ded-842d-fc65787b40d5"],
Cell[30532, 825, 468, 13, 43, "Print", "ExpressionUUID" -> \
"77c01193-cb70-4525-bfb6-ad7b999a8573"],
Cell[31003, 840, 465, 12, 43, "Print", "ExpressionUUID" -> \
"bb84f2b9-0698-4abf-97cb-8c87a987c623"],
Cell[31471, 854, 225, 4, 32, "Print", "ExpressionUUID" -> \
"c6f5f38b-19a3-45b9-b59d-d86cd0dcaef4"],
Cell[31699, 860, 228, 4, 32, "Print", "ExpressionUUID" -> \
"14fe6b81-4e0e-4b1f-ac49-f1c554b8e688"],
Cell[31930, 866, 456, 7, 81, "Print", "ExpressionUUID" -> \
"86f531ea-5575-4f25-bda1-75b3b330143c"],
Cell[32389, 875, 231, 4, 32, "Print", "ExpressionUUID" -> \
"949d2899-8fc9-46a2-9c67-89ecc5ea3a2c"],
Cell[32623, 881, 220, 4, 32, "Print", "ExpressionUUID" -> \
"856ee7af-fea0-4848-b61a-275afeece630"],
Cell[32846, 887, 969, 16, 115, "Message", "ExpressionUUID" -> \
"7bf8f2a1-53c6-4c48-9507-1237a78965c1"],
Cell[33818, 905, 225, 4, 32, "Print", "ExpressionUUID" -> \
"5f29907b-b737-4a02-aac0-997ed34dfb61"],
Cell[34046, 911, 228, 4, 32, "Print", "ExpressionUUID" -> \
"5dd24b44-3866-4569-b34a-b3c2377a0852"],
Cell[34277, 917, 456, 7, 81, "Print", "ExpressionUUID" -> \
"05a0f841-16a9-4c2d-93df-56fad59be501"],
Cell[34736, 926, 231, 4, 32, "Print", "ExpressionUUID" -> \
"f4cf6344-000f-4654-aecd-35805fecb9e7"],
Cell[34970, 932, 225, 4, 32, "Print", "ExpressionUUID" -> \
"19b67959-fc28-41ef-a1dd-c1b7522c7181"],
Cell[35198, 938, 228, 4, 32, "Print", "ExpressionUUID" -> \
"649bcf17-3a37-40d9-8068-210059d0c3bb"],
Cell[35429, 944, 458, 7, 81, "Print", "ExpressionUUID" -> \
"52654ff7-e7b9-40a5-81c0-20c323a11006"],
Cell[35890, 953, 231, 4, 32, "Print", "ExpressionUUID" -> \
"ac73d32c-0748-404b-969c-c64500816778"],
Cell[36124, 959, 225, 4, 32, "Print", "ExpressionUUID" -> \
"d7021a43-2b64-4646-9c29-4d2d3d51d222"],
Cell[36352, 965, 270, 5, 32, "Print", "ExpressionUUID" -> \
"e6b4ceb5-ea5c-4347-bbc7-e3801fd0f8a4"],
Cell[36625, 972, 456, 7, 81, "Print", "ExpressionUUID" -> \
"d693b23a-2bac-412b-b3f6-cb57e65bf7d9"],
Cell[37084, 981, 284, 4, 128, "Print", "ExpressionUUID" -> \
"b2fc5ea1-b928-406f-b35d-dc47d9825bac"],
Cell[37371, 987, 5528, 85, 6262, "Print", "ExpressionUUID" -> \
"402c1252-9a6c-4cfe-8963-fdf78e30087c"],
Cell[42902, 1074, 270, 5, 32, "Print", "ExpressionUUID" -> \
"6e1bf454-6018-4a9a-bdad-72fb5a58e6ef"],
Cell[43175, 1081, 456, 7, 81, "Print", "ExpressionUUID" -> \
"c9637d92-0a42-4f2b-9118-1772c3d5f04a"],
Cell[43634, 1090, 287, 5, 128, "Print", "ExpressionUUID" -> \
"cb0d06a4-ec97-4559-a6a2-887bc5e94825"],
Cell[43924, 1097, 5530, 80, 6880, "Print", "ExpressionUUID" -> \
"19c68b56-11df-4787-a131-58ac58c138c9"],
Cell[49457, 1179, 225, 4, 32, "Print", "ExpressionUUID" -> \
"be9e5166-b65f-4f41-965d-180d64f371e8"],
Cell[49685, 1185, 270, 5, 32, "Print", "ExpressionUUID" -> \
"14fc543e-0301-47ff-b1ac-a50811a7e849"],
Cell[49958, 1192, 456, 7, 81, "Print", "ExpressionUUID" -> \
"63417cee-f557-426a-abd0-87b3ae62e3f1"],
Cell[50417, 1201, 287, 5, 128, "Print", "ExpressionUUID" -> \
"394c8e44-3f4d-4a6e-9706-bd5378b57983"],
Cell[50707, 1208, 5535, 81, 6894, "Print", "ExpressionUUID" -> \
"c583dc21-2810-4dfd-9d9b-49c9c28b9939"],
Cell[56245, 1291, 270, 5, 32, "Print", "ExpressionUUID" -> \
"4f13b8a0-1c80-481d-b2d3-729dde08ee7e"],
Cell[56518, 1298, 458, 7, 81, "Print", "ExpressionUUID" -> \
"38e63fd3-805f-49c2-9027-59fe7b3e9e44"],
Cell[56979, 1307, 284, 4, 128, "Print", "ExpressionUUID" -> \
"de668f30-7d1d-47cf-8f0c-943e710dcef5"],
Cell[57266, 1313, 5533, 81, 6880, "Print", "ExpressionUUID" -> \
"cb865d67-cfaf-42a7-9d29-b3b5c49d5b89"],
Cell[62802, 1396, 418, 9, 33, "Print", "ExpressionUUID" -> \
"ef25a09d-cf38-47f0-9f1b-a1a24733d2b5"],
Cell[63223, 1407, 404, 9, 33, "Print", "ExpressionUUID" -> \
"0c662b32-0ab6-4f1e-b083-16c927ef50c8"]
}, {32}]]
}, Closed]],
Cell[63652, 1420, 731, 14, 195, "Subsection", "ExpressionUUID" -> \
"d85419f9-f6ab-47b9-9980-3a9d88d220c3"],
Cell[CellGroupData[{
Cell[64408, 1438, 245, 5, 31, "Input", "ExpressionUUID" -> \
"da94a614-58b0-482f-9c2c-09b6822c7db4"],
Cell[64656, 1445, 24668, 443, 245, "Output", "ExpressionUUID" -> \
"9a089f0d-00bd-4234-bbec-8f9ba93f8f8d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[89373, 1894, 274, 8, 63, "Subtitle", "ExpressionUUID" -> \
"3740d397-c035-493d-b12d-221dd6531450"],
Cell[89650, 1904, 423, 10, 40, "Input", "ExpressionUUID" -> \
"ae82f043-635a-4d1d-b26f-56323efddcd4"],
Cell[90076, 1916, 666, 19, 93, "Input", "ExpressionUUID" -> \
"9f3f81f9-7c35-431b-b26e-614d1fa0da83"],
Cell[CellGroupData[{
Cell[90767, 1939, 453, 10, 40, "Input", "ExpressionUUID" -> \
"eac7cb44-7298-4b7c-99b7-738e18279309"],
Cell[91223, 1951, 304, 7, 40, "Output", "ExpressionUUID" -> \
"745549bb-247f-465a-87bf-5859e1b73b82"]
}, Open  ]],
Cell[91542, 1961, 260, 7, 40, "Input", "ExpressionUUID" -> \
"ca2b6acb-001f-461b-b16b-4b42d9f59874"],
Cell[CellGroupData[{
Cell[91827, 1972, 1010, 25, 119, "Input", "ExpressionUUID" -> \
"3b1a5463-33ea-40ec-a8d1-ed75e741b211"],
Cell[92840, 1999, 1526, 53, 71, "Output", "ExpressionUUID" -> \
"70ba6f1c-b27b-4aad-9684-43935fb6529b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94403, 2057, 501, 10, 40, "Input", "ExpressionUUID" -> \
"4803ac6a-5532-4fae-9264-76732195b8b4"],
Cell[94907, 2069, 206, 5, 41, "Output", "ExpressionUUID" -> \
"0ecc08e6-ad64-4d18-b59e-de3e4216cdd0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95150, 2079, 306, 7, 40, "Input", "ExpressionUUID" -> \
"11dcc23a-07fc-49aa-b476-99a82ff9dd1f"],
Cell[95459, 2088, 1747, 56, 82, "Output", "ExpressionUUID" -> \
"98a5b546-e88f-44cf-a827-4836ce0cb398"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97243, 2149, 336, 8, 40, "Input", "ExpressionUUID" -> \
"91ca3e6e-d35d-4d29-973c-65b1b23c74ae"],
Cell[97582, 2159, 282, 7, 40, "Output", "ExpressionUUID" -> \
"eae4aa0f-338c-4854-aeb1-209f255bb919"]
}, Open  ]],
Cell[97879, 2169, 158, 3, 54, "Subsection", "ExpressionUUID" -> \
"d01e3804-0121-42fb-b752-462ad3907501"],
Cell[98040, 2174, 1440, 36, 292, "Input", "ExpressionUUID" -> \
"4a1098bb-6683-4b4b-bbc6-193f7b6583ed"],
Cell[99483, 2212, 1316, 33, 171, "Input", "ExpressionUUID" -> \
"bc48386f-00e3-481f-8f93-7f02d8708878"],
Cell[CellGroupData[{
Cell[100824, 2249, 1532, 36, 197, "Input", "ExpressionUUID" -> \
"71ebd469-15e6-4c29-ba8d-cbccedf421ea"],
Cell[102359, 2287, 188, 3, 29, "Print", "ExpressionUUID" -> \
"4b1f3886-8aae-4f09-bb3c-22fc9b7b2a5e"],
Cell[102550, 2292, 188, 3, 29, "Print", "ExpressionUUID" -> \
"1d1967c5-edce-4c38-a1eb-0772f2caf5fb"],
Cell[102741, 2297, 186, 3, 29, "Print", "ExpressionUUID" -> \
"52b05e17-5ae7-4387-8453-379d49dcabcf"],
Cell[102930, 2302, 186, 3, 29, "Print", "ExpressionUUID" -> \
"492cc737-489d-443b-8320-ab19bf5ad2c6"],
Cell[103119, 2307, 186, 3, 29, "Print", "ExpressionUUID" -> \
"6f66e066-0752-4ea1-aeb4-830820f29862"],
Cell[103308, 2312, 188, 3, 29, "Print", "ExpressionUUID" -> \
"ac8c6542-6592-4ca9-b7ad-1fa24ec22830"],
Cell[103499, 2317, 186, 3, 29, "Print", "ExpressionUUID" -> \
"2f06ff27-6097-4434-be3a-bd3f424bebca"],
Cell[103688, 2322, 188, 3, 29, "Print", "ExpressionUUID" -> \
"7b3cc77a-be49-4635-9e82-b4044d571d8b"],
Cell[103879, 2327, 186, 3, 29, "Print", "ExpressionUUID" -> \
"8c92cb5a-a9a5-45db-8c35-a7e314af0a66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104102, 2335, 273, 5, 40, "Input", "ExpressionUUID" -> \
"2d433e6a-3b2c-4143-8ac4-c0af017d427a"],
Cell[104378, 2342, 1895, 48, 407, "Output", "ExpressionUUID" -> \
"d5dbf239-dc3e-4d01-86d0-0d2153f68f7f"]
}, Open  ]],
Cell[106288, 2393, 235, 6, 40, "Input", "ExpressionUUID" -> \
"bf10f6b1-dbdb-4070-a279-631cc559be3d"],
Cell[CellGroupData[{
Cell[106548, 2403, 362, 10, 40, "Input", "ExpressionUUID" -> \
"e0399880-1939-4a57-8e96-973795f918fc"],
Cell[106913, 2415, 1437, 41, 93, "Output", "ExpressionUUID" -> \
"d11093e0-53b9-45e7-8995-63b033416061"]
}, Open  ]],
Cell[108365, 2459, 2961, 64, 275, "Input", "ExpressionUUID" -> \
"84dbbe44-5859-46c4-80dd-23eba52707cb"],
Cell[111329, 2525, 501, 12, 93, "Input", "ExpressionUUID" -> \
"33044a73-602b-403b-828c-e24f272955ff"],
Cell[CellGroupData[{
Cell[111855, 2541, 169, 3, 54, "Subsection", "ExpressionUUID" -> \
"8d6cdac2-cc26-4c0d-ac4a-8b0ff426ee18"],
Cell[CellGroupData[{
Cell[112049, 2548, 176, 4, 40, "Input", "ExpressionUUID" -> \
"601d371d-06ac-4299-9ce7-fca9f62e056b"],
Cell[112228, 2554, 152, 3, 40, "Output", "ExpressionUUID" -> \
"52855112-85bd-4bf5-b76d-01b1d6be1657"]
}, Open  ]],
Cell[112395, 2560, 371, 10, 40, "Input", "ExpressionUUID" -> \
"d71a2f28-d191-440f-8517-468c91233049"],
Cell[112769, 2572, 302, 7, 40, "Input", "ExpressionUUID" -> \
"414db486-17cf-4e8a-92b3-a4e9e36ec83c"],
Cell[CellGroupData[{
Cell[113096, 2583, 242, 5, 40, "Input", "ExpressionUUID" -> \
"75729371-1f94-4886-b8b8-b77b5f14cfd1"],
Cell[113341, 2590, 1201, 22, 145, "Output", "ExpressionUUID" -> \
"fe3d7b49-0e85-4297-9c6c-faf06f86894b"]
}, Open  ]],
Cell[114557, 2615, 1653, 30, 275, "Input", "ExpressionUUID" -> \
"f5a8d9b0-8db4-4f49-84eb-ce2bd28e5834"],
Cell[116213, 2647, 316, 7, 40, "Input", "ExpressionUUID" -> \
"9b6f394b-9f14-469f-90d3-6465f824448f"],
Cell[116532, 2656, 431, 8, 40, "Input", "ExpressionUUID" -> \
"b673f5bb-2f7e-4566-95b1-308c52e10579"],
Cell[CellGroupData[{
Cell[116988, 2668, 196, 4, 40, "Input", "ExpressionUUID" -> \
"f51f5e46-cfff-4566-b8cb-a9dcb4a268b2"],
Cell[117187, 2674, 5536, 144, 273, "Output", "ExpressionUUID" -> \
"e90a0dbf-b847-4eab-a027-1fddd5265f91"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[122784, 2825, 346, 8, 172, "Subtitle", "ExpressionUUID" -> \
"99c9a3d5-8c1b-4271-8e48-b57be111d080"],
Cell[123133, 2835, 442, 9, 40, "Input", "ExpressionUUID" -> \
"48e9b2b3-a257-4ce2-ad6c-beeb5cf6f06b"],
Cell[123578, 2846, 501, 14, 67, "Input", "ExpressionUUID" -> \
"76eda1be-78ff-42d5-9611-741db42b0cf7"],
Cell[CellGroupData[{
Cell[124104, 2864, 542, 11, 40, "Input", "ExpressionUUID" -> \
"5800d749-c9ad-45e4-84cd-f6a8a4cce3f5"],
Cell[124649, 2877, 290, 7, 40, "Output", "ExpressionUUID" -> \
"e66e37d0-3e1c-4607-a914-746aaa6adfe7"]
}, Open  ]],
Cell[124954, 2887, 472, 13, 40, "Input", "ExpressionUUID" -> \
"b36654fb-48ad-4f60-95e5-e46a9c8fa8a9"],
Cell[CellGroupData[{
Cell[125451, 2904, 666, 14, 64, "Input", "ExpressionUUID" -> \
"e4ecce2d-11d5-4b85-bf6e-1c511eb237d1"],
Cell[126120, 2920, 914, 30, 68, "Output", "ExpressionUUID" -> \
"a4b958fa-9c9c-4aed-a8b0-74eda11a66ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127071, 2955, 707, 12, 61, "Input", "ExpressionUUID" -> \
"d57a3757-ab4e-45e7-89a8-13fcf89aaab6"],
Cell[127781, 2969, 462, 14, 72, "Output", "ExpressionUUID" -> \
"f2d6cc65-229d-4d79-94a7-0d107c503325"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128280, 2988, 307, 6, 40, "Input", "ExpressionUUID" -> \
"9bbdfa5d-e675-4352-a694-e98112f9445d"],
Cell[128590, 2996, 1249, 42, 131, "Output", "ExpressionUUID" -> \
"951dcea8-9a9f-44d2-b9c8-7f3cdde87413"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129876, 3043, 205, 5, 40, "Input", "ExpressionUUID" -> \
"42be9b2f-6ceb-4fb4-8b88-a37428204869"],
Cell[130084, 3050, 245, 6, 40, "Output", "ExpressionUUID" -> \
"5cb63c08-87d8-496e-9025-e6fde6c021bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130366, 3061, 154, 3, 54, "Subsection", "ExpressionUUID" -> \
"9afa1783-4c40-4de2-aa4b-1145622413f3"],
Cell[130523, 3066, 1100, 27, 223, "Input", "ExpressionUUID" -> \
"6b90835a-5cbe-4a58-9285-2a21c24094a7"],
Cell[131626, 3095, 1443, 33, 197, "Input", "ExpressionUUID" -> \
"cfe6e606-fba1-48ea-bf9a-562e67f5ca83"],
Cell[CellGroupData[{
Cell[133094, 3132, 1595, 37, 197, "Input", "ExpressionUUID" -> \
"0e70dbf2-9ac3-4e19-8d86-51d956144364"],
Cell[134692, 3171, 188, 3, 29, "Print", "ExpressionUUID" -> \
"78ad736c-bb42-4577-8e04-91c8ca59c111"],
Cell[134883, 3176, 188, 3, 29, "Print", "ExpressionUUID" -> \
"1ac8e022-fad5-46f3-8c91-b48de835fd39"],
Cell[135074, 3181, 188, 3, 29, "Print", "ExpressionUUID" -> \
"fd817218-421d-4227-bdbb-a2310121552f"],
Cell[135265, 3186, 188, 3, 29, "Print", "ExpressionUUID" -> \
"86bbaf46-00c2-417c-bc06-d1967697c205"],
Cell[135456, 3191, 188, 3, 29, "Print", "ExpressionUUID" -> \
"7b198037-e8d2-460c-9dc8-08c3551dd13c"],
Cell[135647, 3196, 190, 3, 29, "Print", "ExpressionUUID" -> \
"b28df74f-5e11-4899-a589-5c447cecf3d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135874, 3204, 297, 5, 40, "Input", "ExpressionUUID" -> \
"1bd7bda5-b589-44c1-b96b-7a2d936004ce"],
Cell[136174, 3211, 1664, 42, 323, "Output", "ExpressionUUID" -> \
"c89056a7-52ff-480a-968d-d8a5270df90d"]
}, Open  ]],
Cell[137853, 3256, 3105, 75, 327, "Input", "ExpressionUUID" -> \
"5748ff68-db34-4ac3-8279-3935f5c793f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140995, 3336, 368, 10, 40, "Input", "ExpressionUUID" -> \
"c39169d8-f987-4798-9872-debd8e68fb62"],
Cell[141366, 3348, 794, 23, 67, "Output", "ExpressionUUID" -> \
"f3bc8e87-5f8c-4cf5-a54d-2670bfb67aba"]
}, Open  ]],
Cell[142175, 3374, 244, 6, 40, "Input", "ExpressionUUID" -> \
"a0dc323a-6098-4665-a3b2-b2894ff60fe3"],
Cell[142422, 3382, 493, 10, 67, "Input", "ExpressionUUID" -> \
"14519ff6-cd03-428c-a2a7-0052c1a28a48"],
Cell[CellGroupData[{
Cell[142940, 3396, 171, 3, 54, "Subsection", "ExpressionUUID" -> \
"eea4db31-b283-4483-bfd5-f544a1e8a9ab"],
Cell[CellGroupData[{
Cell[143136, 3403, 290, 6, 40, "Input", "ExpressionUUID" -> \
"3ef28021-744f-462f-9833-3dc13a7cca68"],
Cell[143429, 3411, 657, 12, 93, "Output", "ExpressionUUID" -> \
"6d8d7996-317b-4218-bf16-220af0ff26cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144123, 3428, 221, 4, 40, "Input", "ExpressionUUID" -> \
"3b2f49e2-f3f0-4ed2-85a8-7c9e56a5bb10"],
Cell[144347, 3434, 803, 18, 93, "Output", "ExpressionUUID" -> \
"dcf2b76b-5463-44cb-99f9-e45df26ffd16"]
}, Open  ]],
Cell[145165, 3455, 381, 10, 67, "Input", "ExpressionUUID" -> \
"de43ee89-e248-48fd-8059-1ee8fd91895e"],
Cell[145549, 3467, 1631, 31, 275, "Input", "ExpressionUUID" -> \
"dd3522e4-5433-4f76-b0ea-909c66a95f50"],
Cell[147183, 3500, 365, 8, 40, "Input", "ExpressionUUID" -> \
"0591fea1-e58a-4be8-a173-76d21f2b1c8f"],
Cell[CellGroupData[{
Cell[147573, 3512, 479, 9, 40, "Input", "ExpressionUUID" -> \
"4560ee6b-0061-424d-b437-02fc7d3e4433"],
Cell[148055, 3523, 152, 3, 40, "Input", "ExpressionUUID" -> \
"0d9147ea-7b39-4a9a-9019-a788b08a9021"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148244, 3531, 197, 4, 40, "Input", "ExpressionUUID" -> \
"e46929c0-07ce-4709-bcda-8c7ac12b8862"],
Cell[148444, 3537, 81378, 2210, 5425, "Output", "ExpressionUUID" -> \
"f9ec148b-7822-4ce1-9f0c-aeaa69620d67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[229883, 5754, 190, 4, 63, "Subtitle", "ExpressionUUID" -> \
"2c715488-8574-4dc8-b259-e407398884f0"],
Cell[CellGroupData[{
Cell[230098, 5762, 193, 3, 63, "Subtitle", "ExpressionUUID" -> \
"04a6cd04-a1ad-4f68-89b0-09b82e237d8b"],
Cell[230294, 5767, 460, 10, 63, "Input", "ExpressionUUID" -> \
"48166561-3b1d-4d0c-99e7-fbf136785210"],
Cell[230757, 5779, 1204, 32, 213, "Input", "ExpressionUUID" -> \
"d173f676-d991-422e-925e-848a3c01d1c8"],
Cell[231964, 5813, 305, 9, 63, "Input", "ExpressionUUID" -> \
"6f4603c2-1919-4713-9f3d-46f2373773f9"],
Cell[232272, 5824, 646, 14, 140, "Input", "ExpressionUUID" -> \
"f1373096-91c6-4ff9-b77d-cf67e08b45f2"],
Cell[232921, 5840, 414, 9, 63, "Input", "ExpressionUUID" -> \
"d9f570bf-0939-4b37-8ea1-49aa68016099"],
Cell[233338, 5851, 335, 9, 63, "Input", "ExpressionUUID" -> \
"f79c04a5-5bb8-4d01-bad7-24fb62e57685"],
Cell[233676, 5862, 357, 9, 102, "Input", "ExpressionUUID" -> \
"b11908d1-0513-47b9-b2cf-7496adc770f6"],
Cell[234036, 5873, 391, 9, 102, "Input", "ExpressionUUID" -> \
"1c23c8e9-8c90-42a8-b35e-89ecee86aa63"],
Cell[234430, 5884, 2171, 48, 547, "Input", "ExpressionUUID" -> \
"d12d2742-bf4e-43cd-8efe-d9b2bf9f1ddb"],
Cell[236604, 5934, 2137, 53, 400, "Input", "ExpressionUUID" -> \
"7ec09b1f-51be-4efa-a5cf-4f855bea40b4"],
Cell[CellGroupData[{
Cell[238766, 5991, 1651, 37, 251, "Input", "ExpressionUUID" -> \
"2bb525bc-1b3e-4313-a4d8-43596cac591d"],
Cell[240420, 6030, 188, 3, 87, "Print", "ExpressionUUID" -> \
"aae06535-b113-4cb1-8481-367553848da8"],
Cell[240611, 6035, 188, 3, 87, "Print", "ExpressionUUID" -> \
"9811b9e9-e1b1-4296-99a3-0ab3e2788778"],
Cell[240802, 6040, 188, 3, 87, "Print", "ExpressionUUID" -> \
"b4d64989-4259-4845-8b67-7333f4e00384"],
Cell[240993, 6045, 190, 3, 87, "Print", "ExpressionUUID" -> \
"28290360-3d0a-4aef-bc37-3f831ec44381"],
Cell[241186, 6050, 185, 2, 87, "Print", "ExpressionUUID" -> \
"48c90b12-4975-4223-8086-e12897061892"],
Cell[241374, 6054, 188, 3, 87, "Print", "ExpressionUUID" -> \
"8b7afc7e-9e3a-4dba-88d6-42f7b0b217f4"],
Cell[241565, 6059, 185, 2, 87, "Print", "ExpressionUUID" -> \
"d58d8fa8-2974-4bae-957b-e84c60a2cef7"],
Cell[241753, 6063, 188, 3, 87, "Print", "ExpressionUUID" -> \
"8fd2b796-f975-40cd-97cd-71b8e352c7cc"],
Cell[241944, 6068, 190, 3, 87, "Print", "ExpressionUUID" -> \
"eebe39cb-d1ca-4ba2-b0b0-3976ae8327e9"],
Cell[242137, 6073, 190, 3, 87, "Print", "ExpressionUUID" -> \
"6bf5ed8f-02c2-4a08-9cc7-38994ab77ff5"],
Cell[242330, 6078, 185, 2, 87, "Print", "ExpressionUUID" -> \
"2b072df6-9b65-4f8c-8949-2b14cf5220ce"],
Cell[242518, 6082, 190, 3, 87, "Print", "ExpressionUUID" -> \
"66b1fe42-5778-4e2b-8cf1-168ee1371212"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242745, 6090, 326, 6, 63, "Input", "ExpressionUUID" -> \
"168cbd1f-187a-4c9e-a519-380f5029763a"],
Cell[243074, 6098, 2564, 64, 87, "Output", "ExpressionUUID" -> \
"6fdb671b-3e8a-42d0-b76f-b372d026ef06"]
}, Open  ]],
Cell[245653, 6165, 171, 4, 63, "Input", "ExpressionUUID" -> \
"4d46bed1-9f85-4c46-a287-e1c498026f22"],
Cell[245827, 6171, 1010, 26, 176, "Input", "ExpressionUUID" -> \
"debcb2a5-d54b-4108-a285-b9df83d79199"],
Cell[246840, 6199, 910, 20, 102, "Input", "ExpressionUUID" -> \
"ea90d0af-3dd3-4248-a477-5318c4d13a44"],
Cell[247753, 6221, 315, 7, 63, "Input", "ExpressionUUID" -> \
"370fcd2f-d37d-408c-ae37-9e62e685604c"],
Cell[248071, 6230, 428, 10, 63, "Input", "ExpressionUUID" -> \
"c7547eb4-845e-4dc4-a46c-8808e81a4a86"],
Cell[248502, 6242, 918, 20, 102, "Input", "ExpressionUUID" -> \
"32a6a789-05b7-46a9-acfd-3c76d8e4754c"],
Cell[249423, 6264, 764, 17, 102, "Input", "ExpressionUUID" -> \
"66e92952-00d3-41ee-b425-43253b008cf9"],
Cell[250190, 6283, 648, 15, 102, "Input", "ExpressionUUID" -> \
"86a39eaf-6c11-4f07-be79-8c82a081ffad"],
Cell[250841, 6300, 502, 11, 63, "Input", "ExpressionUUID" -> \
"f7b5f770-59e8-46ac-982c-1bb4f808342f"],
Cell[251346, 6313, 457, 7, 62, "Text", "ExpressionUUID" -> \
"2bb2c12e-8c52-4e40-9006-aa14df8aba28"],
Cell[251806, 6322, 386, 8, 62, "Text", "ExpressionUUID" -> \
"7a22154a-cae8-4624-9a16-0a71e403dc5a"],
Cell[252195, 6332, 445, 8, 97, "Text", "ExpressionUUID" -> \
"26faa9f2-ab5f-49ae-b942-980e9ac4d4aa"],
Cell[252643, 6342, 244, 6, 63, "Input", "ExpressionUUID" -> \
"c18dffc4-bef2-44f6-bad3-27591dea4f8b"],
Cell[252890, 6350, 1052, 22, 102, "Input", "ExpressionUUID" -> \
"5ccfd4d3-ee22-478b-ae97-d3a55f5e0442"],
Cell[253945, 6374, 997, 24, 251, "Input", "ExpressionUUID" -> \
"186f3d6c-ef4e-4cff-b476-54eecbd918ac"],
Cell[254945, 6400, 581, 13, 63, "Input", "ExpressionUUID" -> \
"1e2d2d99-5518-4d52-ba69-bfaf22cda31b"],
Cell[255529, 6415, 339, 9, 207, "Text", "ExpressionUUID" -> \
"9b22137e-6645-4778-a8f4-e5c118342aa2"],
Cell[255871, 6426, 788, 17, 102, "Input", "ExpressionUUID" -> \
"c61cd9aa-05f8-451d-afc9-a2aa733c5363"],
Cell[256662, 6445, 364, 9, 63, "Input", "ExpressionUUID" -> \
"56e0d398-20da-4c24-a55a-956be9d66f62"],
Cell[CellGroupData[{
Cell[257051, 6458, 370, 7, 63, "Input", "ExpressionUUID" -> \
"9bed52e1-37e9-449f-b571-b64ae2d2130b"],
Cell[257424, 6467, 357, 8, 87, "Output", "ExpressionUUID" -> \
"af542870-d3bb-4c8d-adfb-211cf8d8ec66"]
}, Open  ]],
Cell[257796, 6478, 734, 12, 62, "Text", "ExpressionUUID" -> \
"aa8e8216-8ac0-4e2a-af79-dca7d0934cca"],
Cell[258533, 6492, 1308, 31, 213, "Input", "ExpressionUUID" -> \
"a9184859-c949-4e9f-88c7-1e2e39d34984"],
Cell[CellGroupData[{
Cell[259866, 6527, 531, 12, 63, "Input", "ExpressionUUID" -> \
"3445692b-c03d-4399-acb3-cd95d571d5bd"],
Cell[260400, 6541, 385, 8, 87, "Output", "ExpressionUUID" -> \
"01a8a0eb-5457-435e-8256-23a526dff462"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260822, 6554, 343, 8, 63, "Input", "ExpressionUUID" -> \
"9f07ce97-a97b-4cc8-9e6c-70537fa3669b"],
Cell[261168, 6564, 359, 8, 87, "Output", "ExpressionUUID" -> \
"62128a34-580c-4400-9db5-da73e3db7a94"]
}, Open  ]],
Cell[261542, 6575, 680, 13, 63, "Input", "ExpressionUUID" -> \
"67b5d60b-cd3a-4513-93fa-6dbbe68dd7c7"],
Cell[CellGroupData[{
Cell[262247, 6592, 223, 5, 63, "Input", "ExpressionUUID" -> \
"36e3cb19-be19-40a3-86e7-a6678a3d4a19"],
Cell[262473, 6599, 171, 4, 87, "Output", "ExpressionUUID" -> \
"de6b3173-5bf8-4fc9-ad0d-8cd2e2718eb6"]
}, Open  ]],
Cell[262659, 6606, 509, 11, 63, "Input", "ExpressionUUID" -> \
"79b09721-d056-44ac-929c-712efbaf3908"],
Cell[263171, 6619, 638, 15, 106, "Input", "ExpressionUUID" -> \
"1a06cf2d-48c0-452c-882b-c830661e46e0"],
Cell[263812, 6636, 1104, 30, 110, "Input", "ExpressionUUID" -> \
"a7cd9709-264e-4fc1-bf3a-9a397dda670c"],
Cell[264919, 6668, 1075, 29, 110, "Input", "ExpressionUUID" -> \
"09d44404-3c78-40a6-aa12-aa361d490dc3"],
Cell[265997, 6699, 537, 13, 106, "Input", "ExpressionUUID" -> \
"1248b998-e90a-44e4-9d7d-584802f1c348"],
Cell[266537, 6714, 276, 7, 63, "Input", "ExpressionUUID" -> \
"37d3e421-ee2c-4e0d-9293-8cff263da424"],
Cell[266816, 6723, 4557, 95, 697, "Code", "ExpressionUUID" -> \
"c20950c1-b387-4d71-aafc-9c39dd9774c3"],
Cell[271376, 6820, 2196, 51, 438, "Code", "ExpressionUUID" -> \
"e09ad023-a5ad-4301-8f5e-341d1cf22154"],
Cell[CellGroupData[{
Cell[273597, 6875, 749, 14, 102, "Input", "ExpressionUUID" -> \
"982a06ab-e132-4674-9a95-3d0ee3e9e8c2"],
Cell[274349, 6891, 346, 7, 87, "Print", "ExpressionUUID" -> \
"d3a17099-0f24-4d69-8d10-a74421da3990"],
Cell[274698, 6900, 349, 8, 87, "Print", "ExpressionUUID" -> \
"0f6ccc6f-9ebc-409f-b498-c151b84cc208"],
Cell[275050, 6910, 351, 8, 87, "Print", "ExpressionUUID" -> \
"5112700d-d127-4e16-b38e-58ae751625c4"],
Cell[275404, 6920, 349, 8, 87, "Print", "ExpressionUUID" -> \
"f0891890-0f4e-422a-aafc-933041ecc59d"],
Cell[275756, 6930, 346, 7, 87, "Print", "ExpressionUUID" -> \
"7dadbef7-11d0-4e73-9bbd-fe27af431c6d"],
Cell[276105, 6939, 349, 8, 87, "Print", "ExpressionUUID" -> \
"2c6ea4a2-388c-4135-9b00-f46fbacbec7c"],
Cell[276457, 6949, 351, 8, 87, "Print", "ExpressionUUID" -> \
"ba63a955-384f-4cf7-acd9-d7000d37aec5"],
Cell[276811, 6959, 349, 8, 87, "Print", "ExpressionUUID" -> \
"3af54475-43be-48fb-9e48-29164c51e74e"],
Cell[277163, 6969, 351, 8, 87, "Print", "ExpressionUUID" -> \
"240c8274-8931-43a8-aa87-61a6bfd22e21"],
Cell[277517, 6979, 349, 8, 87, "Print", "ExpressionUUID" -> \
"497e9579-0291-4790-a550-64898950ff95"],
Cell[277869, 6989, 349, 8, 87, "Print", "ExpressionUUID" -> \
"1fc214a6-31f7-48df-8c1b-d7bda6eaa266"],
Cell[278221, 6999, 351, 8, 87, "Print", "ExpressionUUID" -> \
"9e52f489-6144-4e96-ad2e-46c06d69148a"]
}, Open  ]],
Cell[278587, 7010, 234, 5, 58, "Subsubsection", "ExpressionUUID" -> \
"09c0c0f8-cd97-40d3-a1a1-f921d3e1174e"],
Cell[CellGroupData[{
Cell[278846, 7019, 189, 4, 47, "Input", "ExpressionUUID" -> \
"b79d8e5b-16e9-4c78-8a2f-438ee6aaa943"],
Cell[279038, 7025, 157, 3, 87, "Output", "ExpressionUUID" -> \
"23917c2a-7a36-4ff1-b68c-4aca4a966c5e"]
}, Open  ]],
Cell[279210, 7031, 187, 3, 160, "Section", "ExpressionUUID" -> \
"e6ce6857-cc90-4239-a1df-e442a8d52a2f"],
Cell[279400, 7036, 343, 9, 87, "Code", "ExpressionUUID" -> \
"ae4993fa-865f-4f84-b943-fb64b4319906"],
Cell[279746, 7047, 3351, 76, 512, "Code", "ExpressionUUID" -> \
"fbbf1644-2eee-4c9c-9740-8c12eb5090da"],
Cell[283100, 7125, 858, 20, 215, "Code", "ExpressionUUID" -> \
"818ef731-d807-4f6c-8612-26a3c53915c4"],
Cell[283961, 7147, 2313, 58, 400, "Input", "ExpressionUUID" -> \
"97454f10-3f99-4bb2-808a-4931900b2926"],
Cell[286277, 7207, 414, 11, 63, "Input", "ExpressionUUID" -> \
"af4f7656-b332-4a0f-8933-d23cb6e32181"],
Cell[CellGroupData[{
Cell[286716, 7222, 219, 4, 63, "Input", "ExpressionUUID" -> \
"80c7660e-d278-4017-9f6f-b049c02bf4be"],
Cell[286938, 7228, 1143, 27, 87, "Output", "ExpressionUUID" -> \
"c7fcbcfe-0a60-4d5f-862b-3b10a7c4191d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288118, 7260, 1229, 34, 190, "Input", "ExpressionUUID" -> \
"8155b724-a0ae-457b-be3d-e25534053b96"],
Cell[289350, 7296, 567, 11, 87, "Print", "ExpressionUUID" -> \
"a25b5c4d-64f7-46f0-a1bf-d9110a90ea78"],
Cell[289920, 7309, 567, 11, 87, "Print", "ExpressionUUID" -> \
"e37674ed-1454-4074-8164-0210a48ff612"],
Cell[290490, 7322, 567, 11, 87, "Print", "ExpressionUUID" -> \
"62f67f09-90c6-4704-87a4-c75900ee2d8d"],
Cell[291060, 7335, 569, 11, 87, "Print", "ExpressionUUID" -> \
"7254694a-3af4-4b88-83dc-ef71037bb7a7"],
Cell[291632, 7348, 567, 11, 87, "Print", "ExpressionUUID" -> \
"87f1796c-7088-432e-89d4-a9168cdf19fe"],
Cell[292202, 7361, 567, 11, 87, "Print", "ExpressionUUID" -> \
"3ee4ee80-d43c-46d4-b498-776937bb3f0a"],
Cell[292772, 7374, 567, 11, 87, "Print", "ExpressionUUID" -> \
"07ab12c6-d038-4532-961c-c9eee65f28a9"],
Cell[293342, 7387, 567, 11, 87, "Print", "ExpressionUUID" -> \
"1268e973-35f8-42dc-9c5a-1faf45f10d7a"],
Cell[293912, 7400, 567, 11, 87, "Print", "ExpressionUUID" -> \
"4b74df23-2c08-48c4-850b-4ebe204c6852"]
}, Open  ]],
Cell[CellGroupData[{
Cell[294516, 7416, 306, 8, 102, "Input", "ExpressionUUID" -> \
"697f1200-5fee-42fa-a65d-f95674684066"],
Cell[294825, 7426, 215, 5, 87, "Output", "ExpressionUUID" -> \
"cea6a84f-0b32-4c4f-8b0c-7c45db7cb054"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295077, 7436, 1179, 34, 190, "Input", "ExpressionUUID" -> \
"e4d1d576-8adc-4ffa-b70b-89ed9d802766"],
Cell[296259, 7472, 569, 11, 87, "Print", "ExpressionUUID" -> \
"71fbba6a-2c49-455d-9a5d-e67677758bb1"],
Cell[296831, 7485, 567, 11, 87, "Print", "ExpressionUUID" -> \
"285015de-d834-46fb-81fd-5413f6234820"],
Cell[297401, 7498, 567, 11, 87, "Print", "ExpressionUUID" -> \
"9129409b-77a3-4233-a65d-18b27f6fc2a9"],
Cell[297971, 7511, 569, 11, 87, "Print", "ExpressionUUID" -> \
"6a67a8ab-b9db-4479-acfe-1ef230d22285"],
Cell[298543, 7524, 569, 11, 87, "Print", "ExpressionUUID" -> \
"488fdeb4-d6f9-4d5c-8ebe-117244b23831"],
Cell[299115, 7537, 564, 10, 87, "Print", "ExpressionUUID" -> \
"1fe31e9b-2f00-44d5-82cc-6b73e9b5d47f"],
Cell[299682, 7549, 567, 11, 87, "Print", "ExpressionUUID" -> \
"6f5039cb-cbe4-4820-954a-b151c9a79410"],
Cell[300252, 7562, 567, 11, 87, "Print", "ExpressionUUID" -> \
"87a36947-680a-4dc9-b460-ae5b80464ba5"],
Cell[300822, 7575, 564, 10, 87, "Print", "ExpressionUUID" -> \
"09e89caf-9d46-4550-b8ce-9f53ccb4bb16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301423, 7590, 1719, 49, 266, "Input", "ExpressionUUID" -> \
"2419fd9f-db58-42d0-85ba-9a7247fff49a"],
Cell[303145, 7641, 567, 11, 87, "Print", "ExpressionUUID" -> \
"870c169e-1ff6-40c8-bdba-99c8e4cbd719"],
Cell[303715, 7654, 567, 11, 87, "Print", "ExpressionUUID" -> \
"4de6f437-8b03-4d0e-a091-dceb2902a116"],
Cell[304285, 7667, 567, 11, 87, "Print", "ExpressionUUID" -> \
"1b7fb24d-6d6b-4d86-a4b5-f757510e408f"],
Cell[304855, 7680, 567, 11, 87, "Print", "ExpressionUUID" -> \
"5199ffe4-4342-4959-bb03-90507320424f"],
Cell[305425, 7693, 567, 11, 87, "Print", "ExpressionUUID" -> \
"6bc49b71-1b2b-4787-9189-46d9b3acb44a"],
Cell[305995, 7706, 567, 11, 87, "Print", "ExpressionUUID" -> \
"ab86d5a9-79fc-44b1-a30b-2cc9c2e95437"],
Cell[306565, 7719, 567, 11, 87, "Print", "ExpressionUUID" -> \
"d80781ff-1230-4266-930f-214e58a13c1b"],
Cell[307135, 7732, 567, 11, 87, "Print", "ExpressionUUID" -> \
"a514206b-25f6-4d14-b47f-30be9137a5a2"],
Cell[307705, 7745, 567, 11, 87, "Print", "ExpressionUUID" -> \
"8d5d1c17-244c-4680-8884-8a6b54d8b54f"]
}, Open  ]],
Cell[308287, 7759, 247, 6, 58, "Subsubsection", "ExpressionUUID" -> \
"7ef8a81a-c07c-4f1d-9829-b42d5a4420a4"],
Cell[CellGroupData[{
Cell[308559, 7769, 1543, 42, 301, "Input", "ExpressionUUID" -> \
"0a1d5a51-b369-4814-aaab-f6ff43fb0093"],
Cell[310105, 7813, 566, 11, 87, "Print", "ExpressionUUID" -> \
"c258df2f-f53c-4ce5-a262-ddf26745b7b2"],
Cell[310674, 7826, 568, 11, 87, "Print", "ExpressionUUID" -> \
"a3b462c2-7aa0-4ed9-9903-8b3cc40d1696"],
Cell[311245, 7839, 568, 11, 87, "Print", "ExpressionUUID" -> \
"f56c8e30-52cf-4790-8ef0-82207153383d"],
Cell[311816, 7852, 566, 11, 87, "Print", "ExpressionUUID" -> \
"d6b07bd3-5d1e-490a-b99d-4543057f2e13"],
Cell[312385, 7865, 568, 11, 87, "Print", "ExpressionUUID" -> \
"b404323c-76f9-446d-a5d3-e1ca087948eb"],
Cell[312956, 7878, 566, 11, 87, "Print", "ExpressionUUID" -> \
"cc0c9d4b-2614-419c-b474-7b1a032d07ea"],
Cell[313525, 7891, 566, 11, 87, "Print", "ExpressionUUID" -> \
"becfda79-c21b-4f29-b9c8-97d961431cec"],
Cell[314094, 7904, 566, 11, 87, "Print", "ExpressionUUID" -> \
"1bff31a8-ed0a-49e6-bc49-ba2f72f2d116"],
Cell[314663, 7917, 566, 11, 87, "Print", "ExpressionUUID" -> \
"9b915d88-31ef-4cf2-a0d8-927087542a4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315266, 7933, 587, 15, 102, "Input", "ExpressionUUID" -> \
"fc58003b-c069-4e3f-93e0-26ad1d1726ea"],
Cell[CellGroupData[{
Cell[315878, 7952, 196, 3, 63, "Input", "ExpressionUUID" -> \
"a9bcd4dd-adbd-41c2-a342-2dabdf4bd00b"],
Cell[316077, 7957, 569, 11, 87, "Print", "ExpressionUUID" -> \
"5d4ccded-47fc-4342-8ed6-6de5a049c594"],
Cell[316649, 7970, 567, 11, 87, "Print", "ExpressionUUID" -> \
"194d28a6-f293-4651-beb4-952b3b9ded7d"],
Cell[317219, 7983, 567, 11, 87, "Print", "ExpressionUUID" -> \
"29c3b613-7947-4ec2-9bf2-54b44b642795"],
Cell[317789, 7996, 569, 11, 87, "Print", "ExpressionUUID" -> \
"cd3c9679-409d-4d61-bafc-3ae9c78d1de7"],
Cell[318361, 8009, 567, 11, 87, "Print", "ExpressionUUID" -> \
"0aa4db91-cf95-4674-b652-b0d132536ba8"],
Cell[318931, 8022, 564, 10, 87, "Print", "ExpressionUUID" -> \
"b9d984b4-5b89-4c7d-b37f-6a53c4d1825f"],
Cell[319498, 8034, 567, 11, 87, "Print", "ExpressionUUID" -> \
"8b3d05d2-45d5-4b17-9ad1-50accd330de1"],
Cell[320068, 8047, 569, 11, 87, "Print", "ExpressionUUID" -> \
"8ffdbab1-038b-46aa-b01a-332e7076b3ef"],
Cell[320640, 8060, 567, 11, 87, "Print", "ExpressionUUID" -> \
"17cfa122-a7a7-4230-b38b-c4225e7ca8c4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[321256, 8077, 3462, 99, 463, "Input", "ExpressionUUID" -> \
"311ac420-578d-4b74-91b8-b211053c896e"],
Cell[CellGroupData[{
Cell[324743, 8180, 215, 4, 63, "Input", "ExpressionUUID" -> \
"a256f25f-84e0-47ed-a790-c7b12f18325e"],
Cell[324961, 8186, 569, 11, 87, "Print", "ExpressionUUID" -> \
"ffc4da7e-0273-4f3d-8259-6103937166f5"],
Cell[325533, 8199, 569, 11, 87, "Print", "ExpressionUUID" -> \
"577801fd-b7ac-4b62-9e87-1811d3300e5d"],
Cell[326105, 8212, 571, 11, 87, "Print", "ExpressionUUID" -> \
"08f81ff9-acf5-4d33-9242-5f755b0ca2cb"],
Cell[326679, 8225, 571, 11, 87, "Print", "ExpressionUUID" -> \
"0761f223-972d-434b-83c0-9daea34528eb"],
Cell[327253, 8238, 569, 11, 87, "Print", "ExpressionUUID" -> \
"668a48d8-3236-45b5-bb82-bb93ff8c87f1"],
Cell[327825, 8251, 569, 11, 87, "Print", "ExpressionUUID" -> \
"3027af83-529d-4774-a4ef-df50a73722e3"],
Cell[328397, 8264, 569, 11, 87, "Print", "ExpressionUUID" -> \
"df69e36c-97f5-48c9-a246-776ada8b2e1d"],
Cell[328969, 8277, 569, 11, 87, "Print", "ExpressionUUID" -> \
"0e5bf1ed-5cb9-4d2e-9e88-e9eb1990d821"],
Cell[329541, 8290, 569, 11, 87, "Print", "ExpressionUUID" -> \
"59771135-50e3-4cea-b3ae-34cd3e0c619e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[330159, 8307, 203, 4, 63, "Input", "ExpressionUUID" -> \
"77802582-5735-4d6f-9e69-436c6f8e4697"],
Cell[330365, 8313, 201, 5, 87, "Output", "ExpressionUUID" -> \
"6308e0fa-7c54-4283-9056-d79a9c699281"]
}, Open  ]],
Cell[330581, 8321, 236, 5, 58, "Subsubsection", "ExpressionUUID" -> \
"4cd4bd7b-1050-48fc-bb39-da6b322c36ac"],
Cell[CellGroupData[{
Cell[330842, 8330, 756, 19, 47, "Input", "ExpressionUUID" -> \
"c87ee2ff-3b45-40eb-80bf-7517f1956a50"],
Cell[331601, 8351, 1478, 36, 87, "Output", "ExpressionUUID" -> \
"2329c981-d063-427f-a952-59dde1b3bb1f"]
}, Open  ]],
Cell[333094, 8390, 213, 4, 58, "Subsubsection", "ExpressionUUID" -> \
"84ff1a83-79bc-4815-bcc9-bd989d07957a"],
Cell[333310, 8396, 307, 7, 47, "Input", "ExpressionUUID" -> \
"d54bbfcc-bb19-4018-8b6b-f8907422029d"],
Cell[CellGroupData[{
Cell[333642, 8407, 250, 5, 63, "Input", "ExpressionUUID" -> \
"25080c3e-fc56-45e0-b4b0-cca4bf869951"],
Cell[333895, 8414, 198, 5, 87, "Output", "ExpressionUUID" -> \
"296a4521-1741-4da2-9376-95f3ebed2783"]
}, Open  ]],
Cell[334108, 8422, 211, 4, 58, "Subsubsection", "ExpressionUUID" -> \
"c617accd-a743-4794-b1bc-f304fb024346"],
Cell[334322, 8428, 464, 10, 47, "Input", "ExpressionUUID" -> \
"a173a9b2-e17c-4c46-b2a7-8701e2a61f81"],
Cell[CellGroupData[{
Cell[334811, 8442, 247, 5, 63, "Input", "ExpressionUUID" -> \
"c8f1936f-f3ba-4a5a-84b2-85adc3176359"],
Cell[335061, 8449, 199, 5, 87, "Output", "ExpressionUUID" -> \
"16e64c04-6045-439a-9b35-8926c1db2923"]
}, Open  ]],
Cell[335275, 8457, 205, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"76961292-be05-4504-abd4-0bbee05f532d"],
Cell[CellGroupData[{
Cell[335505, 8464, 228, 5, 47, "Input", "ExpressionUUID" -> \
"c096a14b-20ca-4bf9-9e4f-f2572a8defad"],
Cell[335736, 8471, 1497, 39, 87, "Output", "ExpressionUUID" -> \
"4254b3f3-541d-4a9d-b175-a0e6a45a51bc"],
Cell[337236, 8512, 733, 14, 63, "Input", "ExpressionUUID" -> \
"a0f5de58-4205-4238-a1e2-0d4db4f8bc50"],
Cell[337972, 8528, 250, 6, 215, "Section", "ExpressionUUID" -> \
"c58c016a-b440-4836-a571-255ff16af27f"],
Cell[338225, 8536, 387, 9, 47, "Input", "ExpressionUUID" -> \
"dfcb5487-80d0-4a7f-b413-cd6e8cd164ac"],
Cell[338615, 8547, 515, 13, 63, "Input", "ExpressionUUID" -> \
"e1c5ecac-1834-40ab-826f-a79b1c2e853d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339167, 8565, 194, 4, 63, "Input", "ExpressionUUID" -> \
"e61b8955-ba8a-44ce-8444-1c01fe1e9009"],
Cell[339364, 8571, 199, 5, 87, "Output", "ExpressionUUID" -> \
"09fdd977-820c-4cd1-ab46-6b84ad81f7b8"]
}, Open  ]],
Cell[339578, 8579, 198, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"a7b8e041-80a8-45cc-a9dd-69a8bf0c75b5"],
Cell[339779, 8584, 849, 23, 527, "Text", "ExpressionUUID" -> \
"ace1dd46-998a-4f42-96ae-3cb13cd1784d"],
Cell[340631, 8609, 185, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"79385e94-e374-4bf9-983d-6de23ed3a597"],
Cell[340819, 8614, 4601, 98, 682, "Code", "ExpressionUUID" -> \
"2c720dce-a8ae-47ab-8c31-8d7b2d33de18"],
Cell[345423, 8714, 1405, 33, 290, "Code", "ExpressionUUID" -> \
"8d7b5ad7-c356-4422-8d36-2926e3135c02"],
Cell[CellGroupData[{
Cell[346853, 8751, 190, 4, 63, "Input", "ExpressionUUID" -> \
"67bd358d-da44-40c7-a97a-0ae034977f1e"],
Cell[347046, 8757, 153, 3, 87, "Output", "ExpressionUUID" -> \
"bc2bb6a7-8f33-4be2-ba39-4b3c075b7c3f"]
}, Open  ]],
Cell[347214, 8763, 518, 11, 135, "Text", "ExpressionUUID" -> \
"30f7b878-2fa4-4b9b-8d42-b82983000d9c"],
Cell[CellGroupData[{
Cell[347757, 8778, 369, 10, 63, "Input", "ExpressionUUID" -> \
"4ecbe97e-c997-414e-8512-f83cc0cbdbca"],
Cell[348129, 8790, 2221, 53, 87, "Output", "ExpressionUUID" -> \
"f9aef2af-4909-407b-8ade-54ec8c13792e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350387, 8848, 557, 12, 140, "Input", "ExpressionUUID" -> \
"bfda6e6a-3078-4804-977a-134934e70666"],
Cell[350947, 8862, 515, 11, 87, "Print", "ExpressionUUID" -> \
"1f30d53b-6457-4aa2-8148-596564722626"],
Cell[351465, 8875, 517, 11, 87, "Print", "ExpressionUUID" -> \
"0c4ad8f1-5b12-4a51-805e-e1a4bd1b4a25"],
Cell[351985, 8888, 517, 11, 87, "Print", "ExpressionUUID" -> \
"5ba7f340-37e2-4567-976a-fb167be8bbef"],
Cell[352505, 8901, 515, 11, 87, "Print", "ExpressionUUID" -> \
"b640a912-c5ac-48c7-b575-d3516a1c8a68"],
Cell[353023, 8914, 515, 11, 87, "Print", "ExpressionUUID" -> \
"88fd48e5-5158-4461-8084-c9be5c534a1d"],
Cell[353541, 8927, 517, 11, 87, "Print", "ExpressionUUID" -> \
"0922e7ee-c505-41ea-8279-0de55cc818bd"],
Cell[354061, 8940, 515, 11, 87, "Print", "ExpressionUUID" -> \
"48b0d338-5852-488d-bc8c-d992284c9ba9"],
Cell[354579, 8953, 515, 11, 87, "Print", "ExpressionUUID" -> \
"d9875674-769e-4145-bb4a-ac21748f9d89"],
Cell[355097, 8966, 517, 11, 87, "Print", "ExpressionUUID" -> \
"b362366d-97bf-445d-96e9-40b5f6e4d5fb"],
Cell[355617, 8979, 519, 11, 87, "Print", "ExpressionUUID" -> \
"82a9f437-3490-4180-8f8b-fb2c99cb5f9f"],
Cell[356139, 8992, 519, 11, 87, "Print", "ExpressionUUID" -> \
"8b323fcf-2638-4edf-a5e3-a28ae0b20d75"],
Cell[356661, 9005, 519, 11, 87, "Print", "ExpressionUUID" -> \
"7dbed0f3-5c81-4006-b8fb-0d16aadc86c9"]
}, Open  ]],
Cell[357195, 9019, 187, 3, 58, "Subsubsection", "ExpressionUUID" -> \
"27a8054e-cdbe-4ff5-98a1-d930da91445a"],
Cell[357385, 9024, 1943, 45, 347, "Code", "ExpressionUUID" -> \
"07797665-0d89-4c61-9c8c-d75c71ae3df6"],
Cell[359331, 9071, 177, 3, 63, "Input", "ExpressionUUID" -> \
"f346a6f9-76ba-45b3-a7c7-b0dc460203a1"],
Cell[CellGroupData[{
Cell[359533, 9078, 564, 12, 140, "Input", "ExpressionUUID" -> \
"68f064d4-1e6e-4980-94a2-5720704abaa8"],
Cell[360100, 9092, 513, 11, 87, "Print", "ExpressionUUID" -> \
"a088095d-9cca-42a2-bb65-d8fe7291a627"],
Cell[360616, 9105, 515, 11, 87, "Print", "ExpressionUUID" -> \
"edd32b07-2199-4531-9520-7e2a0595b389"],
Cell[361134, 9118, 513, 11, 87, "Print", "ExpressionUUID" -> \
"acc7d86e-eeda-4f3a-92ee-62c76436642f"],
Cell[361650, 9131, 513, 11, 87, "Print", "ExpressionUUID" -> \
"e4a07e53-e721-49c1-b8a7-d5da97843e2b"],
Cell[362166, 9144, 513, 11, 87, "Print", "ExpressionUUID" -> \
"164d454f-6acb-4a45-9546-59f05cc04a4b"],
Cell[362682, 9157, 513, 11, 87, "Print", "ExpressionUUID" -> \
"1afe54df-a377-41d3-a799-f69abe5cd91d"],
Cell[363198, 9170, 513, 11, 87, "Print", "ExpressionUUID" -> \
"3e13fef1-9530-4096-9205-ae13e8f89984"],
Cell[363714, 9183, 513, 11, 87, "Print", "ExpressionUUID" -> \
"939ac74e-594d-4e2f-8110-f8af185b5f72"],
Cell[364230, 9196, 515, 11, 87, "Print", "ExpressionUUID" -> \
"ffa6fde2-ffff-435f-9810-017c5d5361d8"],
Cell[364748, 9209, 515, 11, 87, "Print", "ExpressionUUID" -> \
"95497bed-5312-480f-af46-113ae09dcb5e"],
Cell[365266, 9222, 515, 11, 87, "Print", "ExpressionUUID" -> \
"71cce138-76f3-4a50-8243-900ed4b5ae10"],
Cell[365784, 9235, 513, 11, 87, "Print", "ExpressionUUID" -> \
"29030a03-fb8e-4cc3-ad1e-458cd763197a"],
Cell[366300, 9248, 513, 11, 87, "Print", "ExpressionUUID" -> \
"c1d4dc8e-8e0e-4932-a835-1e9d3282bb0e"],
Cell[366816, 9261, 515, 11, 87, "Print", "ExpressionUUID" -> \
"213ac765-f631-4a9e-8fd6-f8faabe12d23"],
Cell[367334, 9274, 513, 11, 87, "Print", "ExpressionUUID" -> \
"859014c6-b641-44b8-8fe1-aa721abffa0c"],
Cell[367850, 9287, 513, 11, 87, "Print", "ExpressionUUID" -> \
"c1931f23-1357-4085-a70c-e8b53f72b47a"],
Cell[368366, 9300, 513, 11, 87, "Print", "ExpressionUUID" -> \
"32694f18-8d2d-40a3-aa09-3090e1a8fe01"],
Cell[368882, 9313, 513, 11, 87, "Print", "ExpressionUUID" -> \
"751fe4e9-3633-4d6c-a32f-fcb46f42f177"],
Cell[369398, 9326, 515, 11, 87, "Print", "ExpressionUUID" -> \
"94ff1441-0827-4d32-a6e3-276fe3442c68"],
Cell[369916, 9339, 515, 11, 87, "Print", "ExpressionUUID" -> \
"a1a99f8b-f1cc-4714-870f-ea6ba36102a9"],
Cell[370434, 9352, 515, 11, 87, "Print", "ExpressionUUID" -> \
"5171dbd3-06e0-48c8-b7a7-aa1522df2fc3"],
Cell[370952, 9365, 510, 10, 87, "Print", "ExpressionUUID" -> \
"8ddce326-5823-4dc9-a81f-133b21064a5d"],
Cell[371465, 9377, 513, 11, 87, "Print", "ExpressionUUID" -> \
"37dd8206-0917-4875-87eb-81e959e8ebab"],
Cell[371981, 9390, 513, 11, 87, "Print", "ExpressionUUID" -> \
"b9151e92-72ba-46d6-8c51-5116c90fa5c0"],
Cell[372497, 9403, 513, 11, 87, "Print", "ExpressionUUID" -> \
"835c0291-7f86-4d06-abbf-b023ddb3b5cc"],
Cell[373013, 9416, 513, 11, 87, "Print", "ExpressionUUID" -> \
"b8cdaf83-c4c6-45a1-a493-aac73171b582"],
Cell[373529, 9429, 515, 11, 87, "Print", "ExpressionUUID" -> \
"a40352bf-cb64-4360-9382-ff06264d0d81"],
Cell[374047, 9442, 515, 11, 87, "Print", "ExpressionUUID" -> \
"a037737d-14c6-4fbe-971e-09fe809e1377"],
Cell[374565, 9455, 515, 11, 87, "Print", "ExpressionUUID" -> \
"51663cb1-1d51-419f-83b5-deea2adf869d"],
Cell[375083, 9468, 515, 11, 87, "Print", "ExpressionUUID" -> \
"58aa095e-36f9-45a0-8a73-e7e5ba6282e6"],
Cell[375601, 9481, 513, 11, 87, "Print", "ExpressionUUID" -> \
"9ed15b8e-9b3b-4f48-9039-f7ec321a85eb"],
Cell[376117, 9494, 513, 11, 87, "Print", "ExpressionUUID" -> \
"c8457b85-3ee8-43df-a7cf-8d5e55752b2c"],
Cell[376633, 9507, 515, 11, 87, "Print", "ExpressionUUID" -> \
"c3d4e289-f4cd-4823-82d2-4db3e7541512"],
Cell[377151, 9520, 513, 11, 87, "Print", "ExpressionUUID" -> \
"e89985f4-1c9b-43f8-829a-f5719f23ee71"],
Cell[377667, 9533, 513, 11, 87, "Print", "ExpressionUUID" -> \
"a6a6b993-9fde-4dd2-b38c-5da680b071b2"],
Cell[378183, 9546, 512, 10, 87, "Print", "ExpressionUUID" -> \
"e1a6dc8d-d5a1-454f-a1cb-578b1bf88b24"],
Cell[378698, 9558, 517, 11, 87, "Print", "ExpressionUUID" -> \
"f6910e33-8422-4805-9a62-165a1825e6aa"],
Cell[379218, 9571, 517, 11, 87, "Print", "ExpressionUUID" -> \
"b7409094-622a-4ff0-a380-d809b638448e"],
Cell[379738, 9584, 513, 11, 87, "Print", "ExpressionUUID" -> \
"17ce68fe-d850-49f6-b673-ae9343cf6d85"],
Cell[380254, 9597, 515, 11, 87, "Print", "ExpressionUUID" -> \
"da39c297-8b87-4b9c-970e-4e5b1424c864"],
Cell[380772, 9610, 513, 11, 87, "Print", "ExpressionUUID" -> \
"1e778aba-21d6-4f3e-8b45-0334f9b3e653"],
Cell[381288, 9623, 515, 11, 87, "Print", "ExpressionUUID" -> \
"dcf7b567-5487-4b90-8fd3-c694b711e7ff"],
Cell[381806, 9636, 515, 11, 87, "Print", "ExpressionUUID" -> \
"1299885d-48fb-4ae7-b479-6a6135ce72f2"],
Cell[382324, 9649, 517, 11, 87, "Print", "ExpressionUUID" -> \
"008e598a-f034-4051-b764-018260cacafc"],
Cell[382844, 9662, 517, 11, 87, "Print", "ExpressionUUID" -> \
"2a20141e-8995-4937-afdd-ad5ce3926b03"],
Cell[383364, 9675, 510, 10, 87, "Print", "ExpressionUUID" -> \
"e1769f64-ddae-4b02-95a7-d3396a66ba75"],
Cell[383877, 9687, 513, 11, 87, "Print", "ExpressionUUID" -> \
"5379925a-e7b5-40fc-952c-405e8a22f9e7"],
Cell[384393, 9700, 515, 11, 87, "Print", "ExpressionUUID" -> \
"4d0ab2b5-b83f-42f4-9084-e83ac07891ff"],
Cell[384911, 9713, 517, 11, 87, "Print", "ExpressionUUID" -> \
"5b62c400-b077-4371-b90d-be646aa66992"],
Cell[385431, 9726, 515, 11, 87, "Print", "ExpressionUUID" -> \
"6e2dabc7-5f8e-4d67-b66e-88e0c00bde6a"],
Cell[385949, 9739, 515, 11, 87, "Print", "ExpressionUUID" -> \
"8632fe7d-4fae-4284-88fa-9bd0b59b4de4"],
Cell[386467, 9752, 513, 11, 87, "Print", "ExpressionUUID" -> \
"58abe94c-1bd6-47e2-8634-56706a77b094"],
Cell[386983, 9765, 513, 11, 87, "Print", "ExpressionUUID" -> \
"b96a4ff9-f81a-4e3e-b085-b40a3304cfb5"],
Cell[387499, 9778, 515, 11, 87, "Print", "ExpressionUUID" -> \
"c0fc7298-2b94-4359-8fcc-3d8f67d711d5"],
Cell[388017, 9791, 515, 11, 87, "Print", "ExpressionUUID" -> \
"af6c2998-2237-41d9-8292-47aa9fda04bd"],
Cell[388535, 9804, 515, 11, 87, "Print", "ExpressionUUID" -> \
"b8fa86f6-4907-4370-9ffc-32c3f33e71cf"],
Cell[389053, 9817, 513, 11, 87, "Print", "ExpressionUUID" -> \
"60f0edc7-3323-47b5-849e-f3f1634b5b01"],
Cell[389569, 9830, 517, 11, 87, "Print", "ExpressionUUID" -> \
"f0b47445-a2d9-4f3a-83bb-dbef0fd1f738"],
Cell[390089, 9843, 515, 11, 87, "Print", "ExpressionUUID" -> \
"79ad2c81-fe56-4f9a-81b5-90f23fc8ae50"],
Cell[390607, 9856, 517, 11, 87, "Print", "ExpressionUUID" -> \
"1040c662-c606-4826-b7fc-69247b3ecef7"],
Cell[391127, 9869, 515, 11, 87, "Print", "ExpressionUUID" -> \
"8556e21d-7b71-41dd-840e-2a05091ff71f"],
Cell[391645, 9882, 512, 10, 87, "Print", "ExpressionUUID" -> \
"36261411-9090-4ad4-b764-d362e20b9720"],
Cell[392160, 9894, 515, 11, 87, "Print", "ExpressionUUID" -> \
"957ee08b-c198-4aea-9c86-44d5353ee14b"],
Cell[392678, 9907, 517, 11, 87, "Print", "ExpressionUUID" -> \
"03a6017d-4ffe-4ad9-a590-ff95517c6032"],
Cell[393198, 9920, 519, 11, 87, "Print", "ExpressionUUID" -> \
"a5be12ce-f6ea-4414-b01a-d8d162c62317"],
Cell[393720, 9933, 517, 11, 87, "Print", "ExpressionUUID" -> \
"6c541bcb-82b4-4a69-b6b7-422e5e7c540b"]
}, Open  ]],
Cell[394252, 9947, 433, 12, 207, "Text", "ExpressionUUID" -> \
"2e2bc07e-e2ad-49f6-a4b6-9e9eb76ff002"],
Cell[394688, 9961, 3468, 92, 696, "Input", "ExpressionUUID" -> \
"cfca20f3-afbb-4b20-bd91-2a15bbbb4491"],
Cell[398159, 10055, 262, 7, 63, "Input", "ExpressionUUID" -> \
"e1d9f5be-fe48-49f3-9f92-76f8c880d9fe"],
Cell[398424, 10064, 275, 6, 63, "Input", "ExpressionUUID" -> \
"b22fda30-cd35-4302-afa2-c83af9e27620"],
Cell[398702, 10072, 434, 11, 140, "Input", "ExpressionUUID" -> \
"ae140613-cb79-4cbd-878c-04eb13252ece"],
Cell[399139, 10085, 2015, 38, 400, "Input", "ExpressionUUID" -> \
"e9e88c15-0168-4b53-8b95-08cf9433142e"],
Cell[401157, 10125, 317, 8, 102, "Input", "ExpressionUUID" -> \
"3405d47b-5a59-45ba-9417-50a514d54119"],
Cell[401477, 10135, 393, 8, 63, "Input", "ExpressionUUID" -> \
"5b66b768-1150-4143-8054-c0104b392102"],
Cell[401873, 10145, 475, 9, 63, "Input", "ExpressionUUID" -> \
"0c4d1f08-177a-4f78-9b86-929c095bcc20"],
Cell[CellGroupData[{
Cell[402373, 10158, 224, 4, 63, "Input", "ExpressionUUID" -> \
"0ff1f008-d4fc-4f35-a176-b34fec49f697"],
Cell[402600, 10164, 5553, 144, 87, "Output", "ExpressionUUID" -> \
"6b82eab0-f24e-4db3-bfb9-0252f1a9e736"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[408202, 10314, 376, 6, 63, "Subtitle", "ExpressionUUID" -> \
"6294fc58-93c7-413b-bfd3-f8035c6e9d8f"],
Cell[408581, 10322, 2025, 51, 223, "Input", "ExpressionUUID" -> \
"f86a40de-3ba0-4293-8b41-ed5344aef4c4"],
Cell[CellGroupData[{
Cell[410631, 10377, 1771, 39, 197, "Input", "ExpressionUUID" -> \
"835b3b05-90de-48c6-9009-ce83d26b2cd4"],
Cell[412405, 10418, 201, 3, 29, "Print", "ExpressionUUID" -> \
"661b1b5e-6315-482a-8085-f276ec29df18"],
Cell[412609, 10423, 199, 3, 29, "Print", "ExpressionUUID" -> \
"cf283ef5-8e7c-4923-925e-182a0cad9446"],
Cell[412811, 10428, 199, 3, 29, "Print", "ExpressionUUID" -> \
"6611f494-0a6c-4150-b29d-97fb8786b49d"],
Cell[413013, 10433, 201, 3, 29, "Print", "ExpressionUUID" -> \
"2d78ccc5-1c64-4643-9e1a-efb606f7a659"],
Cell[413217, 10438, 199, 3, 29, "Print", "ExpressionUUID" -> \
"28996062-22cf-43dd-923a-de151ee34d76"],
Cell[413419, 10443, 199, 3, 29, "Print", "ExpressionUUID" -> \
"107baf80-aa18-4c2c-b10b-3eb5fe88b915"],
Cell[413621, 10448, 196, 2, 29, "Print", "ExpressionUUID" -> \
"dddd5aa5-3ce4-4e2b-b41e-392dbdb84dad"],
Cell[413820, 10452, 201, 3, 29, "Print", "ExpressionUUID" -> \
"8a6b57dc-b8fb-4510-9fab-64523b4e572f"],
Cell[414024, 10457, 199, 3, 29, "Print", "ExpressionUUID" -> \
"a551e50d-58ed-4b4a-a612-512ca0fb3a4e"],
Cell[414226, 10462, 199, 3, 29, "Print", "ExpressionUUID" -> \
"c805aa5a-18ac-4443-aa0b-b9e4fa7bf59a"],
Cell[414428, 10467, 201, 3, 29, "Print", "ExpressionUUID" -> \
"a3bcfb61-92b3-4495-9d3f-1d3eb7467a7f"],
Cell[414632, 10472, 201, 3, 29, "Print", "ExpressionUUID" -> \
"f1a16da3-ed63-4e7c-9518-0196ef50696a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[414870, 10480, 357, 6, 40, "Input", "ExpressionUUID" -> \
"de8f2c6f-2735-409a-9f5d-4d826e94cfd7"],
Cell[415230, 10488, 2818, 89, 547, "Output", "ExpressionUUID" -> \
"666e893c-5924-49c5-b47b-7e09936232cc"]
}, Open  ]],
Cell[418063, 10580, 252, 6, 40, "Input", "ExpressionUUID" -> \
"095fcc8e-d676-42e2-9add-ee433dc19a10"],
Cell[418318, 10588, 174, 3, 54, "Subsection", "ExpressionUUID" -> \
"36c4f395-0f02-4352-9d3d-4dec7b6332f4"],
Cell[418495, 10593, 250, 6, 31, "Input", "ExpressionUUID" -> \
"9a9ae81a-f2b8-4496-acec-180c9d217d3b"],
Cell[CellGroupData[{
Cell[418770, 10603, 405, 11, 40, "Input", "ExpressionUUID" -> \
"116db58d-4626-4f3e-9560-6802e8f20566"],
Cell[419178, 10616, 5375, 96, 305, "Output", "ExpressionUUID" -> \
"c49dedf9-e567-4e28-9d39-7bd55de8f50e"]
}, Open  ]],
Cell[424568, 10715, 726, 19, 62, "Input", "ExpressionUUID" -> \
"9a9ce9d8-0b9b-4f31-b895-4b75a5802870"],
Cell[425297, 10736, 848, 23, 62, "Input", "ExpressionUUID" -> \
"00883389-7ed5-41bf-924c-be0b364281ba"],
Cell[426148, 10761, 1141, 26, 171, "Input", "ExpressionUUID" -> \
"6676b413-f633-44a6-ae0b-3dba93ea9113"],
Cell[427292, 10789, 1053, 22, 40, "Input", "ExpressionUUID" -> \
"6fc2c491-dcac-4859-8c59-7015d47007fe"],
Cell[428348, 10813, 867, 18, 40, "Input", "ExpressionUUID" -> \
"27aea4b1-e160-427b-827c-afc057e87392"],
Cell[CellGroupData[{
Cell[429240, 10835, 545, 13, 40, "Input", "ExpressionUUID" -> \
"b306c8be-0667-41d7-ae6e-38be3c2a1d50"],
Cell[429788, 10850, 16562, 280, 312, "Output", "ExpressionUUID" -> \
"f8d3e2a3-8b75-4934-942f-a8f0cd4400c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446387, 11135, 568, 13, 40, "Input", "ExpressionUUID" -> \
"7a260924-3134-42b2-8ac6-7a700cd51442"],
Cell[446958, 11150, 17951, 301, 307, "Output", "ExpressionUUID" -> \
"b7dafbbe-8e08-4e2d-a36b-601538e846fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[464946, 11456, 594, 13, 40, "Input", "ExpressionUUID" -> \
"517c0ba0-5bd6-47e0-9d06-c0742b3470d6"],
Cell[465543, 11471, 18242, 306, 307, "Output", "ExpressionUUID" -> \
"056f3aed-2e32-4739-b015-8f393f009482"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483822, 11782, 451, 9, 88, "Subsubtitle", "ExpressionUUID" -> \
"0492afaf-a27f-46bb-9a09-ebdaede94796"],
Cell[484276, 11793, 186, 4, 40, "Input", "ExpressionUUID" -> \
"88289d8c-6ce2-487c-b772-c03b2405f5f2"],
Cell[484465, 11799, 339, 9, 133, "Text", "ExpressionUUID" -> \
"6f34dfaa-a4e5-45d0-9d62-e25af533992c"],
Cell[484807, 11810, 245, 6, 40, "Input", "ExpressionUUID" -> \
"d3c28cf4-827b-453c-aa78-a90880d6ce7c"],
Cell[485055, 11818, 301, 8, 40, "Input", "ExpressionUUID" -> \
"a946248e-5f50-4f44-91d8-a729969d255b"],
Cell[485359, 11828, 808, 20, 119, "Input", "ExpressionUUID" -> \
"cc00a176-43c6-412b-a3bb-3344c68cd8ff"],
Cell[486170, 11850, 186, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"8081db88-88db-4117-840f-f1cb021a78d5"],
Cell[486359, 11855, 762, 16, 58, "Input", "ExpressionUUID" -> \
"d58eeefc-24f9-4db4-8bc2-0e4555a37971"],
Cell[487124, 11873, 827, 17, 67, "Input", "ExpressionUUID" -> \
"8f9716d6-4ad4-4289-a6bf-471898ff94eb"],
Cell[487954, 11892, 1099, 23, 353, "Input", "ExpressionUUID" -> \
"1fc63750-b30f-491c-b764-c3a834d9ebe7"],
Cell[489056, 11917, 1115, 23, 535, "Input", "ExpressionUUID" -> \
"b4a4b86f-dd27-4989-9eb9-73c6f4edaf8b"],
Cell[490174, 11942, 422, 11, 65, "Code", "ExpressionUUID" -> \
"2558cbdc-f926-492f-8450-cdf5703327e6"],
Cell[490599, 11955, 209, 4, 54, "Subsection", "ExpressionUUID" -> \
"2db8ce0c-0fa9-470e-946d-b2c5a16aeef0"],
Cell[490811, 11961, 474, 8, 57, "Text", "ExpressionUUID" -> \
"abd73772-a9c2-41b8-a7fe-c4ad8aba99b1"],
Cell[491288, 11971, 249, 6, 40, "Input", "ExpressionUUID" -> \
"06b305c9-f063-4556-89bb-e2c1fa78e4fb"],
Cell[CellGroupData[{
Cell[491562, 11981, 315, 8, 61, "Input", "ExpressionUUID" -> \
"b89ec56d-ef0d-4e23-9a04-f081ace5174a"],
Cell[491880, 11991, 347, 10, 59, "Output", "ExpressionUUID" -> \
"bc15d112-7043-4ec1-9689-9f04b9b9181c"]
}, Open  ]],
Cell[492242, 12004, 370, 9, 40, "Input", "ExpressionUUID" -> \
"24b01632-4f8e-4c84-84e2-1cd93c5d242e"],
Cell[CellGroupData[{
Cell[492637, 12017, 686, 13, 41, "Input", "ExpressionUUID" -> \
"41edba45-7fc6-4a4a-aa9c-649c63bb203b"],
Cell[493326, 12032, 307, 7, 41, "Output", "ExpressionUUID" -> \
"c72af60c-94bd-4060-a3a5-2b46fd446684"]
}, Open  ]],
Cell[493648, 12042, 621, 13, 40, "Input", "ExpressionUUID" -> \
"4a8151f5-cb64-4cb7-bf25-32e1180ac46c"],
Cell[494272, 12057, 623, 15, 93, "Input", "ExpressionUUID" -> \
"df2714fc-1093-484f-a66d-c8be0175df42"],
Cell[494898, 12074, 204, 3, 44, "Subsubsection", "ExpressionUUID" -> \
"b00a03b7-7880-439a-beb6-7dd5c00b8a05"],
Cell[CellGroupData[{
Cell[495127, 12081, 678, 13, 31, "Input", "ExpressionUUID" -> \
"c25f6040-1a79-49f1-9e9f-cffcc60e7376"],
Cell[495808, 12096, 352, 8, 40, "Output", "ExpressionUUID" -> \
"2d13f7ac-52d8-4ba2-92a9-cc99730b5625"]
}, Open  ]],
Cell[CellGroupData[{
Cell[496197, 12109, 361, 8, 40, "Input", "ExpressionUUID" -> \
"724303b8-d74c-4dfe-8f3e-dd160b80c0d5"],
Cell[496561, 12119, 550, 17, 59, "Output", "ExpressionUUID" -> \
"92ee1ac4-bcc6-42fa-b65c-ed010c0393d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[497148, 12141, 891, 14, 40, "Input", "ExpressionUUID" -> \
"1fe6106e-de71-49f7-a2c1-eaf6d4ec420f"],
Cell[498042, 12157, 925, 29, 69, "Output", "ExpressionUUID" -> \
"90a370a1-2294-4e95-b60d-66ce6b5077d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499004, 12191, 285, 6, 40, "Input", "ExpressionUUID" -> \
"2910f3f5-58f4-4e2d-972b-4959237de5fb"],
Cell[499292, 12199, 1926, 61, 139, "Output", "ExpressionUUID" -> \
"4ae08207-fd63-471c-8227-f61e32362a3c"]
}, Open  ]],
Cell[501233, 12263, 240, 6, 40, "Input", "ExpressionUUID" -> \
"0b799d17-b79c-4581-9ab9-d4a12de264b7"],
Cell[CellGroupData[{
Cell[501498, 12273, 1220, 26, 197, "Input", "ExpressionUUID" -> \
"594b4891-4211-450b-98d7-71de46981d6d"],
Cell[502721, 12301, 351, 8, 29, "Print", "ExpressionUUID" -> \
"799f82cd-b4bb-4e7e-9364-b682e3e470d2"],
Cell[503075, 12311, 351, 8, 29, "Print", "ExpressionUUID" -> \
"be48f682-c8ae-405f-8418-3768892caeef"],
Cell[503429, 12321, 349, 8, 29, "Print", "ExpressionUUID" -> \
"377be842-5d00-4296-89d1-db24bf838735"],
Cell[503781, 12331, 349, 8, 29, "Print", "ExpressionUUID" -> \
"f65cad09-0324-4663-a421-5017f240df89"],
Cell[504133, 12341, 351, 8, 29, "Print", "ExpressionUUID" -> \
"d41d8e51-f936-47e9-b641-6e8a779d14cf"],
Cell[504487, 12351, 351, 8, 29, "Print", "ExpressionUUID" -> \
"639abf69-8c46-4340-b010-cd1fb06c5861"],
Cell[504841, 12361, 349, 8, 29, "Print", "ExpressionUUID" -> \
"46c6b869-4bbd-444a-9900-1a7ac0862968"],
Cell[505193, 12371, 349, 8, 29, "Print", "ExpressionUUID" -> \
"75b7762f-0af5-421a-91db-20acd624e499"],
Cell[505545, 12381, 349, 8, 29, "Print", "ExpressionUUID" -> \
"a166aa2b-c059-46fc-a0b2-e075d8fd242d"],
Cell[505897, 12391, 349, 8, 29, "Print", "ExpressionUUID" -> \
"f5fcf46c-c6ea-4fa4-b182-9b8ea0adb346"],
Cell[506249, 12401, 351, 8, 29, "Print", "ExpressionUUID" -> \
"f16ce09b-7566-4362-bf0b-c452022031b1"],
Cell[506603, 12411, 351, 8, 29, "Print", "ExpressionUUID" -> \
"f8f3f22a-b36c-44f4-8a88-9110836d1cb6"]
}, Open  ]],
Cell[506969, 12422, 743, 16, 67, "Input", "ExpressionUUID" -> \
"8e6abcd4-fb7e-4029-abb2-45c4666bea00"],
Cell[CellGroupData[{
Cell[507737, 12442, 213, 4, 40, "Input", "ExpressionUUID" -> \
"88ceb5f1-c2c5-40fc-b989-a3842fbdfb3a"],
Cell[507953, 12448, 201, 5, 40, "Output", "ExpressionUUID" -> \
"de92ea5b-393d-46d3-9529-6d142b062e07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[508191, 12458, 378, 10, 40, "Input", "ExpressionUUID" -> \
"3f66efb8-cc7b-4d9d-9b46-7dfbaa7fdbcf"],
Cell[508572, 12470, 2217, 53, 171, "Output", "ExpressionUUID" -> \
"e27caf59-6c02-4afd-a4a7-1087a026710d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[510826, 12528, 811, 15, 119, "Input", "ExpressionUUID" -> \
"a9e7fd83-df64-4891-944a-1c00bdef6d8b"],
Cell[511640, 12545, 513, 11, 29, "Print", "ExpressionUUID" -> \
"324db2a0-5348-43e3-bc26-0f1d02a5b681"],
Cell[512156, 12558, 515, 11, 29, "Print", "ExpressionUUID" -> \
"3686059a-e398-44cc-970a-90fecb655e6e"],
Cell[512674, 12571, 513, 11, 29, "Print", "ExpressionUUID" -> \
"8e54482b-3b0e-4fe3-9cec-0d7062e3e07c"],
Cell[513190, 12584, 513, 11, 29, "Print", "ExpressionUUID" -> \
"0831f303-c83b-4f8d-b76a-82b44ff27523"],
Cell[513706, 12597, 513, 11, 29, "Print", "ExpressionUUID" -> \
"a48b3d45-3deb-4c0d-a067-3105ba19a136"],
Cell[514222, 12610, 513, 11, 29, "Print", "ExpressionUUID" -> \
"30107b58-7abf-4137-be89-8e8b18823c4e"],
Cell[514738, 12623, 513, 11, 29, "Print", "ExpressionUUID" -> \
"0bc21bfa-d4f2-4e8f-bd20-cba688105d03"],
Cell[515254, 12636, 515, 11, 29, "Print", "ExpressionUUID" -> \
"2a4aff83-fd89-476e-b60d-6b28a0e3112a"],
Cell[515772, 12649, 515, 11, 29, "Print", "ExpressionUUID" -> \
"6128311c-0eee-48c9-b5a8-1dd582748000"],
Cell[516290, 12662, 514, 10, 29, "Print", "ExpressionUUID" -> \
"d46cc3fa-fe02-45cd-bece-29ac8bcba62c"],
Cell[516807, 12674, 514, 10, 29, "Print", "ExpressionUUID" -> \
"3742cfb8-3b87-4bf1-ae81-ca62d31159c7"],
Cell[517324, 12686, 519, 11, 29, "Print", "ExpressionUUID" -> \
"6a449048-5cc1-4296-b37e-7e4eb4d43eae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[517880, 12702, 741, 15, 119, "Input", "ExpressionUUID" -> \
"baa34df7-eac0-4a3c-bf0a-841d6356b87d"],
Cell[518624, 12719, 513, 11, 29, "Print", "ExpressionUUID" -> \
"e838e7fb-91b3-48a0-94cb-adb93cbf2c3d"],
Cell[519140, 12732, 513, 11, 29, "Print", "ExpressionUUID" -> \
"d97c9378-39e3-42ec-80ba-2fd32d0c579f"],
Cell[519656, 12745, 510, 10, 29, "Print", "ExpressionUUID" -> \
"3a307625-082c-4b29-844e-3011c7d2dbd9"],
Cell[520169, 12757, 513, 11, 29, "Print", "ExpressionUUID" -> \
"b8343f5b-ec4d-426c-98c5-07ac47ca0050"],
Cell[520685, 12770, 515, 11, 29, "Print", "ExpressionUUID" -> \
"ac39699a-d670-49c8-816c-3aab9397eb42"],
Cell[521203, 12783, 515, 11, 29, "Print", "ExpressionUUID" -> \
"5c5d2952-c72c-459f-ad34-f8aff9ee8e0d"],
Cell[521721, 12796, 515, 11, 29, "Print", "ExpressionUUID" -> \
"e7deab54-9823-4547-8c09-a2a6f192f595"],
Cell[522239, 12809, 515, 11, 29, "Print", "ExpressionUUID" -> \
"c0049c49-67f2-4700-ac51-984cdd46dc60"],
Cell[522757, 12822, 517, 11, 29, "Print", "ExpressionUUID" -> \
"8ac7cfc9-e6a3-4346-9370-2fa5e7521e89"],
Cell[523277, 12835, 517, 11, 29, "Print", "ExpressionUUID" -> \
"9ea8555c-6d4e-4628-8f8d-2a57ed5ee8b2"],
Cell[523797, 12848, 515, 11, 29, "Print", "ExpressionUUID" -> \
"50941b71-d165-4569-89c5-c2c95c51ae7c"],
Cell[524315, 12861, 515, 11, 29, "Print", "ExpressionUUID" -> \
"fbf4b6ab-806f-4cf7-96bf-12654c87e1ab"],
Cell[524833, 12874, 513, 11, 29, "Print", "ExpressionUUID" -> \
"3ad1c3d0-6870-410a-9251-a039abd0e224"],
Cell[525349, 12887, 515, 11, 29, "Print", "ExpressionUUID" -> \
"ec98363b-8212-4331-97df-88fd3e8a8d0b"],
Cell[525867, 12900, 513, 11, 29, "Print", "ExpressionUUID" -> \
"e1dc8865-47e5-4ce3-be65-7403187b2ce5"],
Cell[526383, 12913, 513, 11, 29, "Print", "ExpressionUUID" -> \
"6eb9220a-d64f-4be4-9021-b2e9a30a1f1b"],
Cell[526899, 12926, 510, 10, 29, "Print", "ExpressionUUID" -> \
"db601486-9aaa-431a-b1d9-dd07da455410"],
Cell[527412, 12938, 513, 11, 29, "Print", "ExpressionUUID" -> \
"7d865e99-d180-49ed-accc-5563416e09c9"],
Cell[527928, 12951, 517, 11, 29, "Print", "ExpressionUUID" -> \
"73880027-d9ad-4eca-8a07-8e46faf2fbbd"],
Cell[528448, 12964, 515, 11, 29, "Print", "ExpressionUUID" -> \
"0995f2ea-bad5-4d93-9872-f6e81f589772"],
Cell[528966, 12977, 517, 11, 29, "Print", "ExpressionUUID" -> \
"13b7da7e-8ba4-4076-9872-555c7d85c146"],
Cell[529486, 12990, 513, 11, 29, "Print", "ExpressionUUID" -> \
"a459ae10-0722-438a-8a7f-b2a7692dc49a"],
Cell[530002, 13003, 513, 11, 29, "Print", "ExpressionUUID" -> \
"4959a354-98c8-48ac-b4be-91a662c129f9"],
Cell[530518, 13016, 513, 11, 29, "Print", "ExpressionUUID" -> \
"1a31c5b2-7a0a-4a01-972f-b10e865a1520"],
Cell[531034, 13029, 515, 11, 29, "Print", "ExpressionUUID" -> \
"fba846e5-6119-48c3-a203-1cf3cf1126ed"],
Cell[531552, 13042, 515, 11, 29, "Print", "ExpressionUUID" -> \
"390ae55a-e36b-45b9-b7b4-62a2e874a1db"],
Cell[532070, 13055, 515, 11, 29, "Print", "ExpressionUUID" -> \
"f6eb6468-ca13-4ddc-82fd-041355600be6"],
Cell[532588, 13068, 515, 11, 29, "Print", "ExpressionUUID" -> \
"9ae7810b-07d8-4a0b-bec5-2c4cc1239923"],
Cell[533106, 13081, 515, 11, 29, "Print", "ExpressionUUID" -> \
"9508b57d-20ef-4d2f-8662-383db3d8f579"],
Cell[533624, 13094, 512, 10, 29, "Print", "ExpressionUUID" -> \
"b029570e-9539-4bac-905d-6e4f75472238"],
Cell[534139, 13106, 515, 11, 29, "Print", "ExpressionUUID" -> \
"1ce63593-778c-410c-9ac2-5664fcb248be"],
Cell[534657, 13119, 513, 11, 29, "Print", "ExpressionUUID" -> \
"9727be23-ff70-4d6b-8416-8b2061a4cfbb"],
Cell[535173, 13132, 513, 11, 29, "Print", "ExpressionUUID" -> \
"68cac04f-2c72-4b55-b466-9324c71a7049"],
Cell[535689, 13145, 510, 10, 29, "Print", "ExpressionUUID" -> \
"77d85206-cc9b-4588-a4cc-c90a4b763a15"],
Cell[536202, 13157, 513, 11, 29, "Print", "ExpressionUUID" -> \
"79ce868d-eaa6-43bf-b31b-be1c9439abc7"],
Cell[536718, 13170, 515, 11, 29, "Print", "ExpressionUUID" -> \
"9e12468f-6960-460a-839a-6c3a8e721c4e"],
Cell[537236, 13183, 515, 11, 29, "Print", "ExpressionUUID" -> \
"e58b4907-b7ba-4bb6-9059-b0c5b208ae97"],
Cell[537754, 13196, 517, 11, 29, "Print", "ExpressionUUID" -> \
"1a6e3e36-3eef-445b-ab74-3434780f7d53"],
Cell[538274, 13209, 513, 11, 29, "Print", "ExpressionUUID" -> \
"329fbd3f-8eb6-46b1-b262-6692f4b200df"],
Cell[538790, 13222, 513, 11, 29, "Print", "ExpressionUUID" -> \
"994dfb99-b6b6-4109-bee0-7d150402ca9d"],
Cell[539306, 13235, 510, 10, 29, "Print", "ExpressionUUID" -> \
"2a60be1b-74df-47fc-b0e2-a9a15328c721"],
Cell[539819, 13247, 513, 11, 29, "Print", "ExpressionUUID" -> \
"3e0a5606-c499-495b-b2e5-827158b90f6f"],
Cell[540335, 13260, 517, 11, 29, "Print", "ExpressionUUID" -> \
"35c139a7-05b8-4de5-8d1d-a28529ee391f"],
Cell[540855, 13273, 515, 11, 29, "Print", "ExpressionUUID" -> \
"0c44c8cb-eeac-4d84-9762-cd116e49677a"],
Cell[541373, 13286, 515, 11, 29, "Print", "ExpressionUUID" -> \
"c305b4d6-889e-46bd-b510-c3c2e178ffae"],
Cell[541891, 13299, 513, 11, 29, "Print", "ExpressionUUID" -> \
"8407c0f4-5870-40fe-aca2-825a52d0402e"],
Cell[542407, 13312, 513, 11, 29, "Print", "ExpressionUUID" -> \
"78c5472b-9c1c-43fe-9d31-192747610545"],
Cell[542923, 13325, 513, 11, 29, "Print", "ExpressionUUID" -> \
"6402491b-c2b8-40cf-8f6e-b8b1390ab952"],
Cell[543439, 13338, 515, 11, 29, "Print", "ExpressionUUID" -> \
"ec52311f-2c81-48c1-a13f-aa18e8a4de98"],
Cell[543957, 13351, 517, 11, 29, "Print", "ExpressionUUID" -> \
"9e849409-6eb1-48c4-81a0-d098f53a8a78"],
Cell[544477, 13364, 515, 11, 29, "Print", "ExpressionUUID" -> \
"50cb6b9d-8886-48a7-822f-b2862ae4b6e5"],
Cell[544995, 13377, 513, 11, 29, "Print", "ExpressionUUID" -> \
"53cc7003-9693-4b1e-be42-011b87218c6a"],
Cell[545511, 13390, 513, 11, 29, "Print", "ExpressionUUID" -> \
"8cc83812-a52c-4958-a0cb-e52ca9a68f64"],
Cell[546027, 13403, 515, 11, 29, "Print", "ExpressionUUID" -> \
"c854c091-d973-4d09-b471-fde852379dbe"],
Cell[546545, 13416, 515, 11, 29, "Print", "ExpressionUUID" -> \
"a95807f1-c956-4a41-9af7-4d20b3e0b492"],
Cell[547063, 13429, 515, 11, 29, "Print", "ExpressionUUID" -> \
"95fb0bcd-24be-477f-b503-61fbfbd418f9"],
Cell[547581, 13442, 513, 11, 29, "Print", "ExpressionUUID" -> \
"0b8a087f-3c82-46ca-9735-82651361c996"],
Cell[548097, 13455, 515, 11, 29, "Print", "ExpressionUUID" -> \
"9b179cc7-40c4-4b05-9be9-cefbee6514ed"],
Cell[548615, 13468, 515, 11, 29, "Print", "ExpressionUUID" -> \
"5672149b-3eb4-4fdf-a7a9-e2917bea5915"],
Cell[549133, 13481, 517, 11, 29, "Print", "ExpressionUUID" -> \
"a1dc5d8d-7ccd-4a00-9d80-77db2f7ae280"],
Cell[549653, 13494, 517, 11, 29, "Print", "ExpressionUUID" -> \
"3a45f228-b6cb-42e7-ae09-80e0bfc67e6f"],
Cell[550173, 13507, 515, 11, 29, "Print", "ExpressionUUID" -> \
"2c74316f-653d-45e0-b8d5-3bff77d8721e"],
Cell[550691, 13520, 515, 11, 29, "Print", "ExpressionUUID" -> \
"bcd0e1dd-2c08-4efe-a517-10b04f2604d1"],
Cell[551209, 13533, 517, 11, 29, "Print", "ExpressionUUID" -> \
"a45e520b-bafd-48f2-90f7-84cbb1882067"],
Cell[551729, 13546, 519, 11, 29, "Print", "ExpressionUUID" -> \
"1b35ca80-83dc-40b0-82ea-6bd3d31e0b37"],
Cell[552251, 13559, 517, 11, 29, "Print", "ExpressionUUID" -> \
"848196d3-ded9-4b5b-8e6c-405f09c4b13c"]
}, Open  ]],
Cell[552783, 13573, 946, 22, 138, "Code", "ExpressionUUID" -> \
"1dc963d6-f3c6-4a07-a2ed-fadac30c734f"],
Cell[553732, 13597, 6179, 159, 925, "Input", "ExpressionUUID" -> \
"8abdfec6-cd5c-4542-ba2d-cb8cecc20f18"],
Cell[559914, 13758, 349, 8, 40, "Input", "ExpressionUUID" -> \
"006a7203-5bc5-4d07-837c-6594d827b962"],
Cell[CellGroupData[{
Cell[560288, 13770, 255, 4, 40, "Input", "ExpressionUUID" -> \
"9c2bb84b-96f9-4522-951e-1a1c518c535b"],
Cell[560546, 13776, 1594, 24, 249, "Output", "ExpressionUUID" -> \
"9d6d9764-9fe4-4bf8-af4e-2fdb8b5f5dec"]
}, Open  ]],
Cell[562155, 13803, 1994, 36, 249, "Input", "ExpressionUUID" -> \
"f997ec67-1942-403e-a9f4-5d6e140b6d4c"],
Cell[564152, 13841, 427, 9, 40, "Input", "ExpressionUUID" -> \
"88b074e4-54dd-4e2b-bad9-ea91168a7288"],
Cell[564582, 13852, 550, 11, 40, "Input", "ExpressionUUID" -> \
"46a79b8d-1e2e-4535-ba78-012f08930ac0"],
Cell[CellGroupData[{
Cell[565157, 13867, 260, 5, 40, "Input", "ExpressionUUID" -> \
"2a284c8e-4f9e-49f4-930c-443e7a9801d2"],
Cell[565420, 13874, 5547, 144, 273, "Output", "ExpressionUUID" -> \
"a4c826aa-41ea-44c6-99ef-0d1967d642cf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[571040, 14026, 235, 7, 100, "Subtitle", "ExpressionUUID" -> \
"8eff8c93-b291-4cb0-9b17-7199246e51d1"],
Cell[571278, 14035, 276, 7, 63, "Input", "ExpressionUUID" -> \
"d9b7948b-774f-4824-9b60-dd99d81dc301"],
Cell[571557, 14044, 922, 25, 176, "Input", "ExpressionUUID" -> \
"0f08a473-a77c-4983-a9fe-f066073c6889"],
Cell[572482, 14071, 703, 17, 176, "Input", "ExpressionUUID" -> \
"1b5613f7-9999-40e8-9a1b-8dd9afcb6daf"],
Cell[573188, 14090, 202, 5, 63, "Input", "ExpressionUUID" -> \
"82c0e2c9-adb8-4d29-a03b-298588339569"],
Cell[CellGroupData[{
Cell[573415, 14099, 1050, 23, 116, "Input", "ExpressionUUID" -> \
"0598a9a2-9737-43e0-86c2-d657b3486f10"],
Cell[574468, 14124, 2889, 87, 87, "Output", "ExpressionUUID" -> \
"fdf51f13-8f25-4433-bb46-99b5baff4f4b"]
}, Open  ]],
Cell[577372, 14214, 248, 6, 63, "Input", "ExpressionUUID" -> \
"bc5287ed-a6e8-45ab-901e-e489e9525923"],
Cell[CellGroupData[{
Cell[577645, 14224, 345, 8, 63, "Input", "ExpressionUUID" -> \
"3a6e0aa1-a05a-4b66-a123-ad1af56a4132"],
Cell[577993, 14234, 316, 7, 87, "Output", "ExpressionUUID" -> \
"1ced6d6b-6317-4bf3-9d81-1d985f8e52d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[578346, 14246, 163, 3, 81, "Subsection", "ExpressionUUID" -> \
"2e11cee1-5a1a-4cfb-9daf-d12953e14247"],
Cell[578512, 14251, 1796, 45, 547, "Input", "ExpressionUUID" -> \
"2a0cd881-05a5-4cbf-bcf9-331914dde335"],
Cell[580311, 14298, 1723, 45, 288, "Input", "ExpressionUUID" -> \
"ef2df254-04a0-405b-80b4-73e467060be2"],
Cell[CellGroupData[{
Cell[582059, 14347, 1937, 43, 325, "Input", "ExpressionUUID" -> \
"8d9c1630-18cf-4acf-95fa-6725807f7890"],
Cell[583999, 14392, 194, 2, 87, "Print", "ExpressionUUID" -> \
"12e0f06b-ffd4-46bd-9aef-bd1ffa60c695"],
Cell[584196, 14396, 197, 3, 87, "Print", "ExpressionUUID" -> \
"4415f723-c9d3-4f0b-bc23-b1611d9e58ce"],
Cell[584396, 14401, 199, 3, 87, "Print", "ExpressionUUID" -> \
"51d6868e-6586-412c-b194-2cd432ef3d8e"],
Cell[584598, 14406, 197, 3, 87, "Print", "ExpressionUUID" -> \
"4301ac88-8304-4756-8e19-87fe2c2df6b5"],
Cell[584798, 14411, 197, 3, 87, "Print", "ExpressionUUID" -> \
"e5291bd0-2135-4cc0-8d69-22bedea078d8"],
Cell[584998, 14416, 197, 3, 87, "Print", "ExpressionUUID" -> \
"89bfc307-3ddc-434d-aac6-89c3dc5e3675"],
Cell[585198, 14421, 197, 3, 87, "Print", "ExpressionUUID" -> \
"d6157c73-9410-4601-b99f-b7260e12dd57"],
Cell[585398, 14426, 197, 3, 87, "Print", "ExpressionUUID" -> \
"157381e1-66c5-41ba-8fe8-b7ded043bf2b"],
Cell[585598, 14431, 194, 2, 87, "Print", "ExpressionUUID" -> \
"bc3476d3-6ecd-4d90-bea3-eedf5b92513e"],
Cell[585795, 14435, 197, 3, 87, "Print", "ExpressionUUID" -> \
"1fe98ff6-2685-44eb-8ab1-a60d589c97f5"],
Cell[585995, 14440, 197, 3, 87, "Print", "ExpressionUUID" -> \
"89c7dc2c-3a5c-4d70-b100-474cb34b1fb5"],
Cell[586195, 14445, 197, 3, 87, "Print", "ExpressionUUID" -> \
"d5270762-c0ed-424a-997b-a49d567a0527"]
}, Open  ]],
Cell[CellGroupData[{
Cell[586429, 14453, 333, 6, 63, "Input", "ExpressionUUID" -> \
"8c67aaa1-28c3-4dea-b832-1cc4a7c7e851"],
Cell[586765, 14461, 2574, 74, 87, "Output", "ExpressionUUID" -> \
"274b37da-b49b-41c5-9a35-de194b8a0294"]
}, Open  ]],
Cell[589354, 14538, 2827, 60, 362, "Input", "ExpressionUUID" -> \
"7ca4aa3f-9612-4a74-a023-640a1363418a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[592218, 14603, 178, 3, 63, "Input", "ExpressionUUID" -> \
"4921a7bc-f8ea-4c3c-acec-c55baca17f9e"],
Cell[592399, 14608, 3117, 89, 87, "Output", "ExpressionUUID" -> \
"f15177b9-ee85-4220-be57-0f9bd2cc0f42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595553, 14702, 178, 3, 63, "Input", "ExpressionUUID" -> \
"481536ab-85bd-482a-97ce-22ea51eeb596"],
Cell[595734, 14707, 419, 9, 87, "Output", "ExpressionUUID" -> \
"d02981d4-0ec0-4238-80c9-420ce0d04d27"]
}, Open  ]],
Cell[596168, 14719, 216, 4, 81, "Subsection", "ExpressionUUID" -> \
"4ef27c07-ee8e-4cee-8fe9-e5efaf3cfd75"],
Cell[CellGroupData[{
Cell[596409, 14727, 202, 3, 47, "Input", "ExpressionUUID" -> \
"94317aa6-0b03-47ef-8eba-a96962bf3937"],
Cell[596614, 14732, 2891, 87, 87, "Output", "ExpressionUUID" -> \
"264bcb25-4f23-426f-aa8a-c3ad55d98f35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[599542, 14824, 522, 14, 63, "Input", "ExpressionUUID" -> \
"9c0ffe86-94ca-49d6-ba4c-7a16bd99a8d7"],
Cell[600067, 14840, 1481, 30, 87, "Output", "ExpressionUUID" -> \
"76fe7a06-6623-477b-b4c5-771a3255aa94"]
}, Open  ]],
Cell[601563, 14873, 280, 6, 63, "Input", "ExpressionUUID" -> \
"eed2827b-c4c2-40ac-8d06-c3f32cb0fe02"],
Cell[601846, 14881, 620, 12, 102, "Input", "ExpressionUUID" -> \
"18bf73ed-011e-4d62-8661-97de2962c28e"],
Cell[CellGroupData[{
Cell[602491, 14897, 282, 5, 63, "Input", "ExpressionUUID" -> \
"3579a211-b219-427c-a8d3-2e2a49232288"],
Cell[602776, 14904, 1623, 30, 87, "Output", "ExpressionUUID" -> \
"9e6dd4f7-bb72-4edd-b121-4d6d9740804f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[604436, 14939, 199, 3, 63, "Input", "ExpressionUUID" -> \
"abdbc1c0-1f0f-4a9a-af20-8267acb8e44f"],
Cell[604638, 14944, 1577, 23, 87, "Output", "ExpressionUUID" -> \
"fb0a8cac-3db0-4aa0-8f4b-6582750ae5e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[606252, 14972, 183, 3, 81, "Subsection", "ExpressionUUID" -> \
"97ea9cdc-80ab-43bd-ae91-5478f81d636f"],
Cell[606438, 14977, 2225, 54, 400, "Input", "ExpressionUUID" -> \
"04ed4df2-046d-4f8f-bdd7-d96cb606975d"],
Cell[608666, 15033, 332, 7, 63, "Input", "ExpressionUUID" -> \
"08ae4ef2-8503-453a-95f2-17ae3af1ae68"],
Cell[609001, 15042, 584, 12, 63, "Input", "ExpressionUUID" -> \
"7aee63a8-8c6f-4f95-ae72-75d7f5a8e959"],
Cell[609588, 15056, 1905, 35, 362, "Input", "ExpressionUUID" -> \
"c145ce0d-1735-4fc7-a475-9cda3f545571"],
Cell[611496, 15093, 376, 9, 63, "Input", "ExpressionUUID" -> \
"a8eddba7-569c-4584-bcbf-e1a79d33794d"],
Cell[611875, 15104, 553, 11, 63, "Input", "ExpressionUUID" -> \
"622eeef3-ba27-43e4-a2f3-1472ced362ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[612465, 15120, 279, 5, 63, "Input", "ExpressionUUID" -> \
"65a3ea34-3ede-44da-9f37-973bd9a24806"],
Cell[612747, 15127, 5548, 144, 87, "Output", "ExpressionUUID" -> \
"5e48f388-7f23-46c5-ac75-f3d5a653e3d4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[618344, 15277, 377, 9, 136, "Subtitle", "ExpressionUUID" -> \
"e1911cd3-0e16-4ce7-89eb-7925443f20a0"],
Cell[618724, 15288, 364, 9, 63, "Input", "ExpressionUUID" -> \
"216f22c8-83eb-4f7b-829e-16a5b07ceaf1"],
Cell[619091, 15299, 579, 15, 102, "Input", "ExpressionUUID" -> \
"957c5682-b448-4275-93a1-5fea2f3d7431"],
Cell[619673, 15316, 575, 13, 63, "Input", "ExpressionUUID" -> \
"0f2cb3fb-5e2a-423b-a49e-7bd83017c0f3"],
Cell[CellGroupData[{
Cell[620273, 15333, 699, 12, 63, "Input", "ExpressionUUID" -> \
"84596d0c-af08-4482-b3eb-660f5b099729"],
Cell[620975, 15347, 472, 14, 87, "Output", "ExpressionUUID" -> \
"0e0399b6-f01d-4e0e-ab0a-d9de2bda9973"]
}, Open  ]],
Cell[CellGroupData[{
Cell[621484, 15366, 248, 6, 63, "Input", "ExpressionUUID" -> \
"60ed279c-0020-40ec-849d-2a9046d0cbcb"],
Cell[621735, 15374, 211, 5, 87, "Output", "ExpressionUUID" -> \
"268bc2a3-3811-4f33-a8ad-289768c58953"]
}, Open  ]],
Cell[CellGroupData[{
Cell[621983, 15384, 163, 3, 81, "Subsection", "ExpressionUUID" -> \
"b630c207-9811-4dbf-a935-44cc6da0b53f"],
Cell[622149, 15389, 783, 18, 213, "Input", "ExpressionUUID" -> \
"b6c4f516-a68b-4dc8-86f8-6b0c609f2e87"],
Cell[622935, 15409, 1569, 40, 251, "Input", "ExpressionUUID" -> \
"a9cfde97-ddb6-4908-8a33-448455ede328"],
Cell[CellGroupData[{
Cell[624529, 15453, 1623, 37, 251, "Input", "ExpressionUUID" -> \
"e088c280-1e67-49f8-a3d6-dc5054ccce1f"],
Cell[626155, 15492, 197, 3, 87, "Print", "ExpressionUUID" -> \
"b8f240f1-4685-429c-b554-92b057265b1f"],
Cell[626355, 15497, 197, 3, 87, "Print", "ExpressionUUID" -> \
"54bbef55-0411-43d8-a983-077be41d0a69"],
Cell[626555, 15502, 197, 3, 87, "Print", "ExpressionUUID" -> \
"fd825468-0dad-4e79-8bc9-b4c008078692"]
}, Open  ]],
Cell[CellGroupData[{
Cell[626789, 15510, 274, 5, 63, "Input", "ExpressionUUID" -> \
"6e3a1361-6e11-418f-86ae-32d90ce468cc"],
Cell[627066, 15517, 1539, 44, 87, "Output", "ExpressionUUID" -> \
"ee19a6ec-f992-4345-942c-556e7d1a6d2f"]
}, Open  ]],
Cell[628620, 15564, 2117, 44, 251, "Input", "ExpressionUUID" -> \
"a40b46e8-8d16-464f-aee4-0bd267e62af8"]
}, Open  ]],
Cell[630752, 15611, 216, 4, 81, "Subsection", "ExpressionUUID" -> \
"690ceaa6-7f80-4d08-a085-d1355e1abf45"],
Cell[CellGroupData[{
Cell[630993, 15619, 193, 3, 47, "Input", "ExpressionUUID" -> \
"4eaf5511-f42c-4baf-998c-b0c82ead7bd6"],
Cell[631189, 15624, 477, 15, 87, "Output", "ExpressionUUID" -> \
"f03a476b-b67f-404a-a9b5-a1b0a23d92e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[631703, 15644, 459, 13, 63, "Input", "ExpressionUUID" -> \
"1386436e-e2c5-4667-87d0-8456c6abeee6"],
Cell[632165, 15659, 897, 24, 87, "Output", "ExpressionUUID" -> \
"162f8637-cce1-4c3e-b727-3421c6930929"]
}, Open  ]],
Cell[633077, 15686, 269, 6, 63, "Input", "ExpressionUUID" -> \
"b68e0a34-bca3-43ee-acab-bef2a6e2892a"],
Cell[633349, 15694, 624, 12, 102, "Input", "ExpressionUUID" -> \
"a4eea477-b970-450a-ac49-e462576267c4"],
Cell[CellGroupData[{
Cell[633998, 15710, 275, 5, 63, "Input", "ExpressionUUID" -> \
"9b582343-aad8-406b-8acb-61b7bc63b91e"],
Cell[634276, 15717, 903, 24, 87, "Output", "ExpressionUUID" -> \
"8daa09b0-1d72-4acd-a9c5-6538dba2a9a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[635216, 15746, 190, 3, 63, "Input", "ExpressionUUID" -> \
"8e679f38-fa53-4896-96c7-5208e3185127"],
Cell[635409, 15751, 330, 8, 87, "Output", "ExpressionUUID" -> \
"11b2f38e-7786-4bb6-afc3-f2d6da614c88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[635776, 15764, 183, 3, 81, "Subsection", "ExpressionUUID" -> \
"54bf2ce1-a97b-42d8-ac9b-f9b8c5d266d1"],
Cell[635962, 15769, 531, 12, 176, "Input", "ExpressionUUID" -> \
"f2b20cb6-1ad4-4ce2-a374-9521872030cc"],
Cell[636496, 15783, 311, 7, 63, "Input", "ExpressionUUID" -> \
"4d5bfe03-8d22-48c2-8e2f-fee5e1105709"],
Cell[CellGroupData[{
Cell[636832, 15794, 270, 5, 63, "Input", "ExpressionUUID" -> \
"294dc2ea-bc6e-4f72-823d-041a33df6363"],
Cell[637105, 15801, 6090, 197, 87, "Output", "ExpressionUUID" -> \
"7af4d9de-6186-40da-9e1c-6a6e65093716"]
}, Open  ]],
Cell[643210, 16001, 506, 11, 63, "Input", "ExpressionUUID" -> \
"ffeb086d-42cc-4124-a1cb-dd098c459d7d"],
Cell[643719, 16014, 304, 7, 63, "Input", "ExpressionUUID" -> \
"5bf34cf6-a3f5-42ae-9674-896e8f83c2c6"],
Cell[644026, 16023, 1943, 34, 362, "Input", "ExpressionUUID" -> \
"15794cbd-d819-4d9c-82f4-b172fc964652"],
Cell[645972, 16059, 339, 7, 63, "Input", "ExpressionUUID" -> \
"c02aa680-e3c7-4ae4-b996-c0691378d843"],
Cell[646314, 16068, 541, 9, 62, "Text", "ExpressionUUID" -> \
"01f4c3ba-a397-4574-a553-a150aaca596a"],
Cell[646858, 16079, 633, 11, 63, "Input", "ExpressionUUID" -> \
"2ec0963f-6f13-4043-9c58-b09df6efdce1"]
}, Open  ]],
Cell[647506, 16093, 306, 7, 62, "Text", "ExpressionUUID" -> \
"aa084058-801a-4bc7-986f-2b5f5ca6b07d"],
Cell[CellGroupData[{
Cell[647837, 16104, 268, 5, 63, "Input", "ExpressionUUID" -> \
"10510d75-92c9-492e-bb5a-e7c15906dd0e"],
Cell[648108, 16111, 7354, 195, 87, "Output", "ExpressionUUID" -> \
"e20cefa8-d728-4d20-80a5-eafb96e70fde"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[655511, 16312, 488, 10, 208, "Subtitle", "ExpressionUUID" -> \
"028542b0-9e01-4307-97e6-99990bb77936"],
Cell[656002, 16324, 526, 11, 63, "Input", "ExpressionUUID" -> \
"d45b0108-56bb-4fca-b48f-2ac5299781fb"],
Cell[656531, 16337, 551, 14, 102, "Input", "ExpressionUUID" -> \
"35bd7349-9cf0-41e4-b3b9-b4e82c85baec"],
Cell[CellGroupData[{
Cell[657107, 16355, 599, 12, 63, "Input", "ExpressionUUID" -> \
"b968ff22-b750-4d22-930f-2e5aeaea0053"],
Cell[657709, 16369, 288, 7, 87, "Output", "ExpressionUUID" -> \
"3daf3144-fa9a-49d8-8840-ab2b3fa0dad9"]
}, Open  ]],
Cell[658012, 16379, 501, 13, 63, "Input", "ExpressionUUID" -> \
"5175a19b-cadc-4cf9-a2ea-2e6ff34f9a37"],
Cell[CellGroupData[{
Cell[658538, 16396, 852, 16, 112, "Input", "ExpressionUUID" -> \
"0656a7b9-dff3-4051-9108-426d8947cded"],
Cell[659393, 16414, 912, 30, 87, "Output", "ExpressionUUID" -> \
"942c4592-836f-4986-ac86-f1fc1266bc16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[660342, 16449, 859, 14, 108, "Input", "ExpressionUUID" -> \
"ecbcb2b6-aa93-4c3a-b8c2-e4bd24114318"],
Cell[661204, 16465, 465, 15, 87, "Output", "ExpressionUUID" -> \
"4744d089-a0c9-47e9-8ea1-f15d7ba88206"]
}, Open  ]],
Cell[CellGroupData[{
Cell[661706, 16485, 462, 8, 63, "Input", "ExpressionUUID" -> \
"03211933-86df-447e-9097-fe0d5177abcf"],
Cell[662171, 16495, 1249, 42, 87, "Output", "ExpressionUUID" -> \
"76712b84-b288-4724-91db-918b49bbf04e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[663457, 16542, 224, 6, 63, "Input", "ExpressionUUID" -> \
"b36739b1-2872-4a36-93cd-8f386123e486"],
Cell[663684, 16550, 210, 5, 87, "Output", "ExpressionUUID" -> \
"cf3167fb-2693-4abb-a9a2-adeb6269f8f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[663931, 16560, 154, 3, 81, "Subsection", "ExpressionUUID" -> \
"0a514688-2796-42a4-8d97-e99b96ec4515"],
Cell[664088, 16565, 838, 19, 213, "Input", "ExpressionUUID" -> \
"1bc1c738-9349-49fb-a281-14abdbe3c3b2"],
Cell[664929, 16586, 2159, 48, 362, "Input", "ExpressionUUID" -> \
"233c2c4b-3120-4b17-b635-49ab217c950d"],
Cell[CellGroupData[{
Cell[667113, 16638, 1701, 38, 251, "Input", "ExpressionUUID" -> \
"c3ac488b-12cb-406e-b380-02c49e2d9980"],
Cell[668817, 16678, 191, 3, 87, "Print", "ExpressionUUID" -> \
"c0c62098-4dc4-4ab3-83df-fafc5981ab4d"],
Cell[669011, 16683, 189, 3, 87, "Print", "ExpressionUUID" -> \
"35886d45-e201-4a17-94f3-19bba89ea1ce"],
Cell[669203, 16688, 191, 3, 87, "Print", "ExpressionUUID" -> \
"77239f2f-4d5c-4fe9-adaa-2a2d2db16926"]
}, Open  ]],
Cell[CellGroupData[{
Cell[669431, 16696, 328, 6, 63, "Input", "ExpressionUUID" -> \
"c37157b1-8af0-450e-b06b-949c8f04abe0"],
Cell[669762, 16704, 1611, 41, 87, "Output", "ExpressionUUID" -> \
"4d408d39-232d-4136-ac71-c35ab2b47399"]
}, Open  ]],
Cell[671388, 16748, 3310, 77, 472, "Input", "ExpressionUUID" -> \
"55b61fed-3600-47b5-9a4a-a363e99518b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[674735, 16830, 448, 11, 63, "Input", "ExpressionUUID" -> \
"68fa6a2b-5c0b-4a90-828e-89fb63d5a696"],
Cell[675186, 16843, 794, 23, 87, "Output", "ExpressionUUID" -> \
"e2ac34bc-66eb-41d9-a176-941678481ad7"]
}, Open  ]],
Cell[675995, 16869, 272, 6, 63, "Input", "ExpressionUUID" -> \
"7a226d62-64ac-41c8-9781-36fce0c0c137"],
Cell[676270, 16877, 597, 12, 102, "Input", "ExpressionUUID" -> \
"c98df20f-80b3-4514-86ca-93bd115476dd"],
Cell[CellGroupData[{
Cell[676892, 16893, 171, 3, 81, "Subsection", "ExpressionUUID" -> \
"1f90bdff-6a7b-4eb0-bd76-d26eebfa5627"],
Cell[CellGroupData[{
Cell[677088, 16900, 377, 8, 63, "Input", "ExpressionUUID" -> \
"bd8205e4-3988-425e-8ba3-b0246b7cf448"],
Cell[677468, 16910, 388, 8, 87, "Output", "ExpressionUUID" -> \
"dc6ef73d-d8d7-443d-a3fd-db2718bab369"]
}, Open  ]],
Cell[CellGroupData[{
Cell[677893, 16923, 252, 5, 63, "Input", "ExpressionUUID" -> \
"87c12af7-e8b0-44b7-9f06-17b225e6568b"],
Cell[678148, 16930, 529, 14, 87, "Output", "ExpressionUUID" -> \
"d87f5b5a-8c40-4d1c-a942-8b6b0bf2e5f1"]
}, Open  ]],
Cell[678692, 16947, 452, 11, 63, "Input", "ExpressionUUID" -> \
"be515830-4a76-44b3-97cb-e431b83ecdd2"],
Cell[679147, 16960, 1782, 34, 400, "Input", "ExpressionUUID" -> \
"42f56f94-f1ce-4a55-bb60-fbbc45663e12"],
Cell[680932, 16996, 390, 8, 63, "Input", "ExpressionUUID" -> \
"736fec4b-5b0b-4e73-8419-8d251b781d8a"],
Cell[681325, 17006, 502, 9, 63, "Input", "ExpressionUUID" -> \
"bb92f06f-cb0a-4b46-bcbd-e1c27bcc98cb"],
Cell[CellGroupData[{
Cell[681852, 17019, 197, 4, 63, "Input", "ExpressionUUID" -> \
"c39afa8d-3ca8-4076-9a52-a2899a9a466c"],
Cell[682052, 17025, 31939, 862, 87, "Output", "ExpressionUUID" -> \
"27867a28-9c26-488f-a3c2-af8d9cbf7d6a"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

